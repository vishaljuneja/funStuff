
(function(t,e){function n(t){var e,n,r=F[t]={};for(t=t.split(/\s+/),e=0,n=t.length;n>e;e++)r[t[e]]=!0;return r}function r(t,n,r){if(r===e&&1===t.nodeType){var i="data-"+n.replace(H,"-$1").toLowerCase();if(r=t.getAttribute(i),"string"==typeof r){try{r="true"===r?!0:"false"===r?!1:"null"===r?null:P.isNumeric(r)?parseFloat(r):j.test(r)?P.parseJSON(r):r}catch(o){}P.data(t,n,r)}else r=e}return r}function i(t){for(var e in t)if(("data"!==e||!P.isEmptyObject(t[e]))&&"toJSON"!==e)return!1;return!0}function o(t,e,n){var r=e+"defer",i=e+"queue",o=e+"mark",a=P._data(t,r);!a||"queue"!==n&&P._data(t,i)||"mark"!==n&&P._data(t,o)||setTimeout(function(){P._data(t,i)||P._data(t,o)||(P.removeData(t,r,!0),a.fire())},0)}function a(){return!1}function s(){return!0}function l(t){return!t||!t.parentNode||11===t.parentNode.nodeType}function u(t,e,n){if(e=e||0,P.isFunction(e))return P.grep(t,function(t,r){var i=!!e.call(t,r,t);return i===n});if(e.nodeType)return P.grep(t,function(t){return t===e===n});if("string"==typeof e){var r=P.grep(t,function(t){return 1===t.nodeType});if(de.test(e))return P.filter(e,r,!n);e=P.filter(e,r)}return P.grep(t,function(t){return P.inArray(t,e)>=0===n})}function c(t){var e=ge.split("|"),n=t.createDocumentFragment();if(n.createElement)for(;e.length;)n.createElement(e.pop());return n}function d(t){return P.nodeName(t,"table")?t.getElementsByTagName("tbody")[0]||t.appendChild(t.ownerDocument.createElement("tbody")):t}function h(t,e){if(1===e.nodeType&&P.hasData(t)){var n,r,i,o=P._data(t),a=P._data(e,o),s=o.events;if(s){delete a.handle,a.events={};for(n in s)for(r=0,i=s[n].length;i>r;r++)P.event.add(e,n+(s[n][r].namespace?".":"")+s[n][r].namespace,s[n][r],s[n][r].data)}a.data&&(a.data=P.extend({},a.data))}}function f(t,e){var n;1===e.nodeType&&(e.clearAttributes&&e.clearAttributes(),e.mergeAttributes&&e.mergeAttributes(t),n=e.nodeName.toLowerCase(),"object"===n?e.outerHTML=t.outerHTML:"input"!==n||"checkbox"!==t.type&&"radio"!==t.type?"option"===n?e.selected=t.defaultSelected:("input"===n||"textarea"===n)&&(e.defaultValue=t.defaultValue):(t.checked&&(e.defaultChecked=e.checked=t.checked),e.value!==t.value&&(e.value=t.value)),e.removeAttribute(P.expando))}function p(t){return t.getElementsByTagName!==e?t.getElementsByTagName("*"):t.querySelectorAll!==e?t.querySelectorAll("*"):[]}function g(t){("checkbox"===t.type||"radio"===t.type)&&(t.defaultChecked=t.checked)}function m(t){var n=(t.nodeName||"").toLowerCase();"input"===n?g(t):"script"!==n&&t.getElementsByTagName!==e&&P.grep(t.getElementsByTagName("input"),g)}function v(t){var e=R.createElement("div");return Ne.appendChild(e),e.innerHTML=t.outerHTML,e.firstChild}function y(t,e){e.src?P.ajax({url:e.src,async:!1,dataType:"script"}):P.globalEval((e.text||e.textContent||e.innerHTML||"").replace(Se,"/*$0*/")),e.parentNode&&e.parentNode.removeChild(e)}function b(t,e,n){var r="width"===e?t.offsetWidth:t.offsetHeight,i="width"===e?He:qe,o=0,a=i.length;if(r>0){if("border"!==n)for(;a>o;o++)n||(r-=parseFloat(P.css(t,"padding"+i[o]))||0),"margin"===n?r+=parseFloat(P.css(t,n+i[o]))||0:r-=parseFloat(P.css(t,"border"+i[o]+"Width"))||0;return r+"px"}if(r=Me(t,e,e),(0>r||null==r)&&(r=t.style[e]||0),r=parseFloat(r)||0,n)for(;a>o;o++)r+=parseFloat(P.css(t,"padding"+i[o]))||0,"padding"!==n&&(r+=parseFloat(P.css(t,"border"+i[o]+"Width"))||0),"margin"===n&&(r+=parseFloat(P.css(t,n+i[o]))||0);return r+"px"}function x(t){return function(e,n){if("string"!=typeof e&&(n=e,e="*"),P.isFunction(n))for(var r,i,o,a=e.toLowerCase().split(nn),s=0,l=a.length;l>s;s++)r=a[s],o=/^\+/.test(r),o&&(r=r.substr(1)||"*"),i=t[r]=t[r]||[],i[o?"unshift":"push"](n)}}function w(t,n,r,i,o,a){o=o||n.dataTypes[0],a=a||{},a[o]=!0;for(var s,l=t[o],u=0,c=l?l.length:0,d=t===sn;c>u&&(d||!s);u++)s=l[u](n,r,i),"string"==typeof s&&(!d||a[s]?s=e:(n.dataTypes.unshift(s),s=w(t,n,r,i,s,a)));return!d&&s||a["*"]||(s=w(t,n,r,i,"*",a)),s}function C(t,n){var r,i,o=P.ajaxSettings.flatOptions||{};for(r in n)n[r]!==e&&((o[r]?t:i||(i={}))[r]=n[r]);i&&P.extend(!0,t,i)}function k(t,e,n,r){if(P.isArray(e))P.each(e,function(e,i){n||Ue.test(t)?r(t,i):k(t+"["+("object"==typeof i||P.isArray(i)?e:"")+"]",i,n,r)});else if(n||null==e||"object"!=typeof e)r(t,e);else for(var i in e)k(t+"["+i+"]",e[i],n,r)}function A(t,n,r){var i,o,a,s,l=t.contents,u=t.dataTypes,c=t.responseFields;for(o in c)o in r&&(n[c[o]]=r[o]);for(;"*"===u[0];)u.shift(),i===e&&(i=t.mimeType||n.getResponseHeader("content-type"));if(i)for(o in l)if(l[o]&&l[o].test(i)){u.unshift(o);break}if(u[0]in r)a=u[0];else{for(o in r){if(!u[0]||t.converters[o+" "+u[0]]){a=o;break}s||(s=o)}a=a||s}return a?(a!==u[0]&&u.unshift(a),r[a]):e}function E(t,n){t.dataFilter&&(n=t.dataFilter(n,t.dataType));var r,i,o,a,s,l,u,c,d=t.dataTypes,h={},f=d.length,p=d[0];for(r=1;f>r;r++){if(1===r)for(i in t.converters)"string"==typeof i&&(h[i.toLowerCase()]=t.converters[i]);if(a=p,p=d[r],"*"===p)p=a;else if("*"!==a&&a!==p){if(s=a+" "+p,l=h[s]||h["* "+p],!l){c=e;for(u in h)if(o=u.split(" "),(o[0]===a||"*"===o[0])&&(c=h[o[1]+" "+p])){u=h[u],u===!0?l=c:c===!0&&(l=u);break}}l||c||P.error("No conversion from "+s.replace(" "," to ")),l!==!0&&(n=l?l(n):c(u(n)))}}return n}function T(){try{return new t.XMLHttpRequest}catch(e){}}function S(){try{return new t.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}function _(){return setTimeout(N,0),bn=P.now()}function N(){bn=e}function M(t,e){var n={};return P.each(kn.concat.apply([],kn.slice(0,e)),function(){n[this]=t}),n}function O(t){if(!xn[t]){var e=R.body,n=P("<"+t+">").appendTo(e),r=n.css("display");n.remove(),("none"===r||""===r)&&(mn||(mn=R.createElement("iframe"),mn.frameBorder=mn.width=mn.height=0),e.appendChild(mn),vn&&mn.createElement||(vn=(mn.contentWindow||mn.contentDocument).document,vn.write(("CSS1Compat"===R.compatMode?"<!doctype html>":"")+"<html><body>"),vn.close()),n=vn.createElement(t),vn.body.appendChild(n),r=P.css(n,"display"),e.removeChild(mn)),xn[t]=r}return xn[t]}function D(t){return P.isWindow(t)?t:9===t.nodeType?t.defaultView||t.parentWindow:!1}var R=t.document,I=t.navigator,L=t.location,P=function(){function n(){if(!s.isReady){try{R.documentElement.doScroll("left")}catch(t){return setTimeout(n,1),e}s.ready()}}var r,i,o,a,s=function(t,e){return new s.fn.init(t,e,r)},l=t.jQuery,u=t.$,c=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,d=/\S/,h=/^\s+/,f=/\s+$/,p=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,g=/^[\],:{}\s]*$/,m=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,v=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,y=/(?:^|:|,)(?:\s*\[)+/g,b=/(webkit)[ \/]([\w.]+)/,x=/(opera)(?:.*version)?[ \/]([\w.]+)/,w=/(msie) ([\w.]+)/,C=/(mozilla)(?:.*? rv:([\w.]+))?/,k=/-([a-z]|[0-9])/gi,A=/^-ms-/,E=function(t,e){return(e+"").toUpperCase()},T=I.userAgent,S=Object.prototype.toString,_=Object.prototype.hasOwnProperty,N=Array.prototype.push,M=Array.prototype.slice,O=String.prototype.trim,D=Array.prototype.indexOf,L={};return s.fn=s.prototype={constructor:s,init:function(t,n,r){var i,o,a,l;if(!t)return this;if(t.nodeType)return this.context=this[0]=t,this.length=1,this;if("body"===t&&!n&&R.body)return this.context=R,this[0]=R.body,this.selector=t,this.length=1,this;if("string"==typeof t){if(i="<"===t.charAt(0)&&">"===t.charAt(t.length-1)&&t.length>=3?[null,t,null]:c.exec(t),!i||!i[1]&&n)return!n||n.jquery?(n||r).find(t):this.constructor(n).find(t);if(i[1])return n=n instanceof s?n[0]:n,l=n?n.ownerDocument||n:R,a=p.exec(t),a?s.isPlainObject(n)?(t=[R.createElement(a[1])],s.fn.attr.call(t,n,!0)):t=[l.createElement(a[1])]:(a=s.buildFragment([i[1]],[l]),t=(a.cacheable?s.clone(a.fragment):a.fragment).childNodes),s.merge(this,t);if(o=R.getElementById(i[2]),o&&o.parentNode){if(o.id!==i[2])return r.find(t);this.length=1,this[0]=o}return this.context=R,this.selector=t,this}return s.isFunction(t)?r.ready(t):(t.selector!==e&&(this.selector=t.selector,this.context=t.context),s.makeArray(t,this))},selector:"",jquery:"1.7.1",length:0,size:function(){return this.length},toArray:function(){return M.call(this,0)},get:function(t){return null==t?this.toArray():0>t?this[this.length+t]:this[t]},pushStack:function(t,e,n){var r=this.constructor();return s.isArray(t)?N.apply(r,t):s.merge(r,t),r.prevObject=this,r.context=this.context,"find"===e?r.selector=this.selector+(this.selector?" ":"")+n:e&&(r.selector=this.selector+"."+e+"("+n+")"),r},each:function(t,e){return s.each(this,t,e)},ready:function(t){return s.bindReady(),o.add(t),this},eq:function(t){return t=+t,-1===t?this.slice(t):this.slice(t,t+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(M.apply(this,arguments),"slice",M.call(arguments).join(","))},map:function(t){return this.pushStack(s.map(this,function(e,n){return t.call(e,n,e)}))},end:function(){return this.prevObject||this.constructor(null)},push:N,sort:[].sort,splice:[].splice},s.fn.init.prototype=s.fn,s.extend=s.fn.extend=function(){var t,n,r,i,o,a,l=arguments[0]||{},u=1,c=arguments.length,d=!1;for("boolean"==typeof l&&(d=l,l=arguments[1]||{},u=2),"object"==typeof l||s.isFunction(l)||(l={}),c===u&&(l=this,--u);c>u;u++)if(null!=(t=arguments[u]))for(n in t)r=l[n],i=t[n],l!==i&&(d&&i&&(s.isPlainObject(i)||(o=s.isArray(i)))?(o?(o=!1,a=r&&s.isArray(r)?r:[]):a=r&&s.isPlainObject(r)?r:{},l[n]=s.extend(d,a,i)):i!==e&&(l[n]=i));return l},s.extend({noConflict:function(e){return t.$===s&&(t.$=u),e&&t.jQuery===s&&(t.jQuery=l),s},isReady:!1,readyWait:1,holdReady:function(t){t?s.readyWait++:s.ready(!0)},ready:function(t){if(t===!0&&!--s.readyWait||t!==!0&&!s.isReady){if(!R.body)return setTimeout(s.ready,1);if(s.isReady=!0,t!==!0&&--s.readyWait>0)return;o.fireWith(R,[s]),s.fn.trigger&&s(R).trigger("ready").off("ready")}},bindReady:function(){if(!o){if(o=s.Callbacks("once memory"),"complete"===R.readyState)return setTimeout(s.ready,1);if(R.addEventListener)R.addEventListener("DOMContentLoaded",a,!1),t.addEventListener("load",s.ready,!1);else if(R.attachEvent){R.attachEvent("onreadystatechange",a),t.attachEvent("onload",s.ready);var e=!1;try{e=null==t.frameElement}catch(r){}R.documentElement.doScroll&&e&&n()}}},isFunction:function(t){return"function"===s.type(t)},isArray:Array.isArray||function(t){return"array"===s.type(t)},isWindow:function(t){return t&&"object"==typeof t&&"setInterval"in t},isNumeric:function(t){return!isNaN(parseFloat(t))&&isFinite(t)},type:function(t){return null==t?t+"":L[S.call(t)]||"object"},isPlainObject:function(t){if(!t||"object"!==s.type(t)||t.nodeType||s.isWindow(t))return!1;try{if(t.constructor&&!_.call(t,"constructor")&&!_.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(n){return!1}var r;for(r in t);return r===e||_.call(t,r)},isEmptyObject:function(t){for(var e in t)return!1;return!0},error:function(t){throw Error(t)},parseJSON:function(n){return"string"==typeof n&&n?(n=s.trim(n),t.JSON&&t.JSON.parse?t.JSON.parse(n):g.test(n.replace(m,"@").replace(v,"]").replace(y,""))?Function("return "+n)():(s.error("Invalid JSON: "+n),e)):null},parseXML:function(n){var r,i;try{t.DOMParser?(i=new DOMParser,r=i.parseFromString(n,"text/xml")):(r=new ActiveXObject("Microsoft.XMLDOM"),r.async="false",r.loadXML(n))}catch(o){r=e}return r&&r.documentElement&&!r.getElementsByTagName("parsererror").length||s.error("Invalid XML: "+n),r},noop:function(){},globalEval:function(e){e&&d.test(e)&&(t.execScript||function(e){t.eval.call(t,e)})(e)},camelCase:function(t){return t.replace(A,"ms-").replace(k,E)},nodeName:function(t,e){return t.nodeName&&t.nodeName.toUpperCase()===e.toUpperCase()},each:function(t,n,r){var i,o=0,a=t.length,l=a===e||s.isFunction(t);if(r)if(l){for(i in t)if(n.apply(t[i],r)===!1)break}else for(;a>o&&n.apply(t[o++],r)!==!1;);else if(l){for(i in t)if(n.call(t[i],i,t[i])===!1)break}else for(;a>o&&n.call(t[o],o,t[o++])!==!1;);return t},trim:O?function(t){return null==t?"":O.call(t)}:function(t){return null==t?"":(""+t).replace(h,"").replace(f,"")},makeArray:function(t,e){var n=e||[];if(null!=t){var r=s.type(t);null==t.length||"string"===r||"function"===r||"regexp"===r||s.isWindow(t)?N.call(n,t):s.merge(n,t)}return n},inArray:function(t,e,n){var r;if(e){if(D)return D.call(e,t,n);for(r=e.length,n=n?0>n?Math.max(0,r+n):n:0;r>n;n++)if(n in e&&e[n]===t)return n}return-1},merge:function(t,n){var r=t.length,i=0;if("number"==typeof n.length)for(var o=n.length;o>i;i++)t[r++]=n[i];else for(;n[i]!==e;)t[r++]=n[i++];return t.length=r,t},grep:function(t,e,n){var r,i=[];n=!!n;for(var o=0,a=t.length;a>o;o++)r=!!e(t[o],o),n!==r&&i.push(t[o]);return i},map:function(t,n,r){var i,o,a=[],l=0,u=t.length,c=t instanceof s||u!==e&&"number"==typeof u&&(u>0&&t[0]&&t[u-1]||0===u||s.isArray(t));if(c)for(;u>l;l++)i=n(t[l],l,r),null!=i&&(a[a.length]=i);else for(o in t)i=n(t[o],o,r),null!=i&&(a[a.length]=i);return a.concat.apply([],a)},guid:1,proxy:function(t,n){if("string"==typeof n){var r=t[n];n=t,t=r}if(!s.isFunction(t))return e;var i=M.call(arguments,2),o=function(){return t.apply(n,i.concat(M.call(arguments)))};return o.guid=t.guid=t.guid||o.guid||s.guid++,o},access:function(t,n,r,i,o,a){var l=t.length;if("object"==typeof n){for(var u in n)s.access(t,u,n[u],i,o,r);return t}if(r!==e){i=!a&&i&&s.isFunction(r);for(var c=0;l>c;c++)o(t[c],n,i?r.call(t[c],c,o(t[c],n)):r,a);return t}return l?o(t[0],n):e},now:function(){return(new Date).getTime()},uaMatch:function(t){t=t.toLowerCase();var e=b.exec(t)||x.exec(t)||w.exec(t)||0>t.indexOf("compatible")&&C.exec(t)||[];return{browser:e[1]||"",version:e[2]||"0"}},sub:function(){function t(e,n){return new t.fn.init(e,n)}s.extend(!0,t,this),t.superclass=this,t.fn=t.prototype=this(),t.fn.constructor=t,t.sub=this.sub,t.fn.init=function(n,r){return r&&r instanceof s&&!(r instanceof t)&&(r=t(r)),s.fn.init.call(this,n,r,e)},t.fn.init.prototype=t.fn;var e=t(R);return t},browser:{}}),s.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(t,e){L["[object "+e+"]"]=e.toLowerCase()}),i=s.uaMatch(T),i.browser&&(s.browser[i.browser]=!0,s.browser.version=i.version),s.browser.webkit&&(s.browser.safari=!0),d.test("Â ")&&(h=/^[\s\xA0]+/,f=/[\s\xA0]+$/),r=s(R),R.addEventListener?a=function(){R.removeEventListener("DOMContentLoaded",a,!1),s.ready()}:R.attachEvent&&(a=function(){"complete"===R.readyState&&(R.detachEvent("onreadystatechange",a),s.ready())}),s}(),F={};P.Callbacks=function(t){t=t?F[t]||n(t):{};var r,i,o,a,s,l=[],u=[],c=function(e){var n,r,i,o;for(n=0,r=e.length;r>n;n++)i=e[n],o=P.type(i),"array"===o?c(i):"function"===o&&(t.unique&&h.has(i)||l.push(i))},d=function(e,n){for(n=n||[],r=!t.memory||[e,n],i=!0,s=o||0,o=0,a=l.length;l&&a>s;s++)if(l[s].apply(e,n)===!1&&t.stopOnFalse){r=!0;break}i=!1,l&&(t.once?r===!0?h.disable():l=[]:u&&u.length&&(r=u.shift(),h.fireWith(r[0],r[1])))},h={add:function(){if(l){var t=l.length;c(arguments),i?a=l.length:r&&r!==!0&&(o=t,d(r[0],r[1]))}return this},remove:function(){if(l)for(var e=arguments,n=0,r=e.length;r>n;n++)for(var o=0;l.length>o&&(e[n]!==l[o]||(i&&a>=o&&(a--,s>=o&&s--),l.splice(o--,1),!t.unique));o++);return this},has:function(t){if(l)for(var e=0,n=l.length;n>e;e++)if(t===l[e])return!0;return!1},empty:function(){return l=[],this},disable:function(){return l=u=r=e,this},disabled:function(){return!l},lock:function(){return u=e,r&&r!==!0||h.disable(),this},locked:function(){return!u},fireWith:function(e,n){return u&&(i?t.once||u.push([e,n]):t.once&&r||d(e,n)),this},fire:function(){return h.fireWith(this,arguments),this},fired:function(){return!!r}};return h};var B=[].slice;P.extend({Deferred:function(t){var e,n=P.Callbacks("once memory"),r=P.Callbacks("once memory"),i=P.Callbacks("memory"),o="pending",a={resolve:n,reject:r,notify:i},s={done:n.add,fail:r.add,progress:i.add,state:function(){return o},isResolved:n.fired,isRejected:r.fired,then:function(t,e,n){return l.done(t).fail(e).progress(n),this},always:function(){return l.done.apply(l,arguments).fail.apply(l,arguments),this},pipe:function(t,e,n){return P.Deferred(function(r){P.each({done:[t,"resolve"],fail:[e,"reject"],progress:[n,"notify"]},function(t,e){var n,i=e[0],o=e[1];P.isFunction(i)?l[t](function(){n=i.apply(this,arguments),n&&P.isFunction(n.promise)?n.promise().then(r.resolve,r.reject,r.notify):r[o+"With"](this===l?r:this,[n])}):l[t](r[o])})}).promise()},promise:function(t){if(null==t)t=s;else for(var e in s)t[e]=s[e];return t}},l=s.promise({});for(e in a)l[e]=a[e].fire,l[e+"With"]=a[e].fireWith;return l.done(function(){o="resolved"},r.disable,i.lock).fail(function(){o="rejected"},n.disable,i.lock),t&&t.call(l,l),l},when:function(t){function e(t){return function(e){r[t]=arguments.length>1?B.call(arguments,0):e,--s||l.resolveWith(l,r)}}function n(t){return function(e){a[t]=arguments.length>1?B.call(arguments,0):e,l.notifyWith(u,a)}}var r=B.call(arguments,0),i=0,o=r.length,a=Array(o),s=o,l=1>=o&&t&&P.isFunction(t.promise)?t:P.Deferred(),u=l.promise();if(o>1){for(;o>i;i++)r[i]&&r[i].promise&&P.isFunction(r[i].promise)?r[i].promise().then(e(i),l.reject,n(i)):--s;s||l.resolveWith(l,r)}else l!==t&&l.resolveWith(l,o?[t]:[]);return u}}),P.support=function(){var n,r,i,o,a,s,l,u,c,d,h,f,p=R.createElement("div");if(R.documentElement,p.setAttribute("className","t"),p.innerHTML="   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/>",r=p.getElementsByTagName("*"),i=p.getElementsByTagName("a")[0],!r||!r.length||!i)return{};o=R.createElement("select"),a=o.appendChild(R.createElement("option")),s=p.getElementsByTagName("input")[0],n={leadingWhitespace:3===p.firstChild.nodeType,tbody:!p.getElementsByTagName("tbody").length,htmlSerialize:!!p.getElementsByTagName("link").length,style:/top/.test(i.getAttribute("style")),hrefNormalized:"/a"===i.getAttribute("href"),opacity:/^0.55/.test(i.style.opacity),cssFloat:!!i.style.cssFloat,checkOn:"on"===s.value,optSelected:a.selected,getSetAttribute:"t"!==p.className,enctype:!!R.createElement("form").enctype,html5Clone:"<:nav></:nav>"!==R.createElement("nav").cloneNode(!0).outerHTML,submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0},s.checked=!0,n.noCloneChecked=s.cloneNode(!0).checked,o.disabled=!0,n.optDisabled=!a.disabled;try{delete p.test}catch(g){n.deleteExpando=!1}if(!p.addEventListener&&p.attachEvent&&p.fireEvent&&(p.attachEvent("onclick",function(){n.noCloneEvent=!1}),p.cloneNode(!0).fireEvent("onclick")),s=R.createElement("input"),s.value="t",s.setAttribute("type","radio"),n.radioValue="t"===s.value,s.setAttribute("checked","checked"),p.appendChild(s),u=R.createDocumentFragment(),u.appendChild(p.lastChild),n.checkClone=u.cloneNode(!0).cloneNode(!0).lastChild.checked,n.appendChecked=s.checked,u.removeChild(s),u.appendChild(p),p.innerHTML="",t.getComputedStyle&&(l=R.createElement("div"),l.style.width="0",l.style.marginRight="0",p.style.width="2px",p.appendChild(l),n.reliableMarginRight=0===(parseInt((t.getComputedStyle(l,null)||{marginRight:0}).marginRight,10)||0)),p.attachEvent)for(h in{submit:1,change:1,focusin:1})d="on"+h,f=d in p,f||(p.setAttribute(d,"return;"),f="function"==typeof p[d]),n[h+"Bubbles"]=f;return u.removeChild(p),u=o=a=l=p=s=null,P(function(){var t,r,i,o,a,s,l,u,d,h,g=R.getElementsByTagName("body")[0];g&&(s=1,l="position:absolute;top:0;left:0;width:1px;height:1px;margin:0;",u="visibility:hidden;border:0;",d="style='"+l+"border:5px solid #000;padding:0;'",h="<div "+d+"><div></div></div>"+"<table "+d+" cellpadding='0' cellspacing='0'>"+"<tr><td></td></tr></table>",t=R.createElement("div"),t.style.cssText=u+"width:0;height:0;position:static;top:0;margin-top:"+s+"px",g.insertBefore(t,g.firstChild),p=R.createElement("div"),t.appendChild(p),p.innerHTML="<table><tr><td style='padding:0;border:0;display:none'></td><td>t</td></tr></table>",c=p.getElementsByTagName("td"),f=0===c[0].offsetHeight,c[0].style.display="",c[1].style.display="none",n.reliableHiddenOffsets=f&&0===c[0].offsetHeight,p.innerHTML="",p.style.width=p.style.paddingLeft="1px",P.boxModel=n.boxModel=2===p.offsetWidth,p.style.zoom!==e&&(p.style.display="inline",p.style.zoom=1,n.inlineBlockNeedsLayout=2===p.offsetWidth,p.style.display="",p.innerHTML="<div style='width:4px;'></div>",n.shrinkWrapBlocks=2!==p.offsetWidth),p.style.cssText=l+u,p.innerHTML=h,r=p.firstChild,i=r.firstChild,o=r.nextSibling.firstChild.firstChild,a={doesNotAddBorder:5!==i.offsetTop,doesAddBorderForTableAndCells:5===o.offsetTop},i.style.position="fixed",i.style.top="20px",a.fixedPosition=20===i.offsetTop||15===i.offsetTop,i.style.position=i.style.top="",r.style.overflow="hidden",r.style.position="relative",a.subtractsBorderForOverflowNotVisible=-5===i.offsetTop,a.doesNotIncludeMarginInBodyOffset=g.offsetTop!==s,g.removeChild(t),p=t=null,P.extend(n,a))}),n}();var j=/^(?:\{.*\}|\[.*\])$/,H=/([A-Z])/g;P.extend({cache:{},uuid:0,expando:"jQuery"+(P.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(t){return t=t.nodeType?P.cache[t[P.expando]]:t[P.expando],!!t&&!i(t)},data:function(t,n,r,i){if(P.acceptData(t)){var o,a,s,l=P.expando,u="string"==typeof n,c=t.nodeType,d=c?P.cache:t,h=c?t[l]:t[l]&&l,f="events"===n;if(h&&d[h]&&(f||i||d[h].data)||!u||r!==e)return h||(c?t[l]=h=++P.uuid:h=l),d[h]||(d[h]={},c||(d[h].toJSON=P.noop)),("object"==typeof n||"function"==typeof n)&&(i?d[h]=P.extend(d[h],n):d[h].data=P.extend(d[h].data,n)),o=a=d[h],i||(a.data||(a.data={}),a=a.data),r!==e&&(a[P.camelCase(n)]=r),f&&!a[n]?o.events:(u?(s=a[n],null==s&&(s=a[P.camelCase(n)])):s=a,s)}},removeData:function(t,e,n){if(P.acceptData(t)){var r,o,a,s=P.expando,l=t.nodeType,u=l?P.cache:t,c=l?t[s]:s;if(u[c]){if(e&&(r=n?u[c]:u[c].data)){P.isArray(e)||(e in r?e=[e]:(e=P.camelCase(e),e=e in r?[e]:e.split(" ")));for(o=0,a=e.length;a>o;o++)delete r[e[o]];if(!(n?i:P.isEmptyObject)(r))return}(n||(delete u[c].data,i(u[c])))&&(P.support.deleteExpando||!u.setInterval?delete u[c]:u[c]=null,l&&(P.support.deleteExpando?delete t[s]:t.removeAttribute?t.removeAttribute(s):t[s]=null))}}},_data:function(t,e,n){return P.data(t,e,n,!0)},acceptData:function(t){if(t.nodeName){var e=P.noData[t.nodeName.toLowerCase()];if(e)return!(e===!0||t.getAttribute("classid")!==e)}return!0}}),P.fn.extend({data:function(t,n){var i,o,a,s=null;if(t===e){if(this.length&&(s=P.data(this[0]),1===this[0].nodeType&&!P._data(this[0],"parsedAttrs"))){o=this[0].attributes;for(var l=0,u=o.length;u>l;l++)a=o[l].name,0===a.indexOf("data-")&&(a=P.camelCase(a.substring(5)),r(this[0],a,s[a]));P._data(this[0],"parsedAttrs",!0)}return s}return"object"==typeof t?this.each(function(){P.data(this,t)}):(i=t.split("."),i[1]=i[1]?"."+i[1]:"",n===e?(s=this.triggerHandler("getData"+i[1]+"!",[i[0]]),s===e&&this.length&&(s=P.data(this[0],t),s=r(this[0],t,s)),s===e&&i[1]?this.data(i[0]):s):this.each(function(){var e=P(this),r=[i[0],n];e.triggerHandler("setData"+i[1]+"!",r),P.data(this,t,n),e.triggerHandler("changeData"+i[1]+"!",r)}))},removeData:function(t){return this.each(function(){P.removeData(this,t)})}}),P.extend({_mark:function(t,e){t&&(e=(e||"fx")+"mark",P._data(t,e,(P._data(t,e)||0)+1))},_unmark:function(t,e,n){if(t!==!0&&(n=e,e=t,t=!1),e){n=n||"fx";var r=n+"mark",i=t?0:(P._data(e,r)||1)-1;i?P._data(e,r,i):(P.removeData(e,r,!0),o(e,n,"mark"))}},queue:function(t,n,r){var i;return t?(n=(n||"fx")+"queue",i=P._data(t,n),r&&(!i||P.isArray(r)?i=P._data(t,n,P.makeArray(r)):i.push(r)),i||[]):e},dequeue:function(t,e){e=e||"fx";var n=P.queue(t,e),r=n.shift(),i={};"inprogress"===r&&(r=n.shift()),r&&("fx"===e&&n.unshift("inprogress"),P._data(t,e+".run",i),r.call(t,function(){P.dequeue(t,e)},i)),n.length||(P.removeData(t,e+"queue "+e+".run",!0),o(t,e,"queue"))}}),P.fn.extend({queue:function(t,n){return"string"!=typeof t&&(n=t,t="fx"),n===e?P.queue(this[0],t):this.each(function(){var e=P.queue(this,t,n);"fx"===t&&"inprogress"!==e[0]&&P.dequeue(this,t)})},dequeue:function(t){return this.each(function(){P.dequeue(this,t)})},delay:function(t,e){return t=P.fx?P.fx.speeds[t]||t:t,e=e||"fx",this.queue(e,function(e,n){var r=setTimeout(e,t);n.stop=function(){clearTimeout(r)}})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,n){function r(){--l||o.resolveWith(a,[a])}"string"!=typeof t&&(n=t,t=e),t=t||"fx";for(var i,o=P.Deferred(),a=this,s=a.length,l=1,u=t+"defer",c=t+"queue",d=t+"mark";s--;)(i=P.data(a[s],u,e,!0)||(P.data(a[s],c,e,!0)||P.data(a[s],d,e,!0))&&P.data(a[s],u,P.Callbacks("once memory"),!0))&&(l++,i.add(r));return r(),o.promise()}});var q,z,$,W=/[\n\t\r]/g,U=/\s+/,V=/\r/g,Y=/^(?:button|input)$/i,X=/^(?:button|input|object|select|textarea)$/i,K=/^a(?:rea)?$/i,G=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,Z=P.support.getSetAttribute;P.fn.extend({attr:function(t,e){return P.access(this,t,e,!0,P.attr)},removeAttr:function(t){return this.each(function(){P.removeAttr(this,t)})},prop:function(t,e){return P.access(this,t,e,!0,P.prop)},removeProp:function(t){return t=P.propFix[t]||t,this.each(function(){try{this[t]=e,delete this[t]}catch(n){}})},addClass:function(t){var e,n,r,i,o,a,s;if(P.isFunction(t))return this.each(function(e){P(this).addClass(t.call(this,e,this.className))});if(t&&"string"==typeof t)for(e=t.split(U),n=0,r=this.length;r>n;n++)if(i=this[n],1===i.nodeType)if(i.className||1!==e.length){for(o=" "+i.className+" ",a=0,s=e.length;s>a;a++)~o.indexOf(" "+e[a]+" ")||(o+=e[a]+" ");i.className=P.trim(o)}else i.className=t;return this},removeClass:function(t){var n,r,i,o,a,s,l;if(P.isFunction(t))return this.each(function(e){P(this).removeClass(t.call(this,e,this.className))});if(t&&"string"==typeof t||t===e)for(n=(t||"").split(U),r=0,i=this.length;i>r;r++)if(o=this[r],1===o.nodeType&&o.className)if(t){for(a=(" "+o.className+" ").replace(W," "),s=0,l=n.length;l>s;s++)a=a.replace(" "+n[s]+" "," ");o.className=P.trim(a)}else o.className="";return this},toggleClass:function(t,e){var n=typeof t,r="boolean"==typeof e;return P.isFunction(t)?this.each(function(n){P(this).toggleClass(t.call(this,n,this.className,e),e)}):this.each(function(){if("string"===n)for(var i,o=0,a=P(this),s=e,l=t.split(U);i=l[o++];)s=r?s:!a.hasClass(i),a[s?"addClass":"removeClass"](i);else("undefined"===n||"boolean"===n)&&(this.className&&P._data(this,"__className__",this.className),this.className=this.className||t===!1?"":P._data(this,"__className__")||"")})},hasClass:function(t){for(var e=" "+t+" ",n=0,r=this.length;r>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(W," ").indexOf(e)>-1)return!0;return!1},val:function(t){var n,r,i,o=this[0];{if(arguments.length)return i=P.isFunction(t),this.each(function(r){var o,a=P(this);1===this.nodeType&&(o=i?t.call(this,r,a.val()):t,null==o?o="":"number"==typeof o?o+="":P.isArray(o)&&(o=P.map(o,function(t){return null==t?"":t+""})),n=P.valHooks[this.nodeName.toLowerCase()]||P.valHooks[this.type],n&&"set"in n&&n.set(this,o,"value")!==e||(this.value=o))});if(o)return n=P.valHooks[o.nodeName.toLowerCase()]||P.valHooks[o.type],n&&"get"in n&&(r=n.get(o,"value"))!==e?r:(r=o.value,"string"==typeof r?r.replace(V,""):null==r?"":r)}}}),P.extend({valHooks:{option:{get:function(t){var e=t.attributes.value;return!e||e.specified?t.value:t.text}},select:{get:function(t){var e,n,r,i,o=t.selectedIndex,a=[],s=t.options,l="select-one"===t.type;if(0>o)return null;for(n=l?o:0,r=l?o+1:s.length;r>n;n++)if(i=s[n],!(!i.selected||(P.support.optDisabled?i.disabled:null!==i.getAttribute("disabled"))||i.parentNode.disabled&&P.nodeName(i.parentNode,"optgroup"))){if(e=P(i).val(),l)return e;a.push(e)}return l&&!a.length&&s.length?P(s[o]).val():a},set:function(t,e){var n=P.makeArray(e);return P(t).find("option").each(function(){this.selected=P.inArray(P(this).val(),n)>=0}),n.length||(t.selectedIndex=-1),n}}},attrFn:{val:!0,css:!0,html:!0,text:!0,data:!0,width:!0,height:!0,offset:!0},attr:function(t,n,r,i){var o,a,s,l=t.nodeType;if(t&&3!==l&&8!==l&&2!==l)return i&&n in P.attrFn?P(t)[n](r):t.getAttribute===e?P.prop(t,n,r):(s=1!==l||!P.isXMLDoc(t),s&&(n=n.toLowerCase(),a=P.attrHooks[n]||(G.test(n)?z:q)),r!==e?null===r?(P.removeAttr(t,n),e):a&&"set"in a&&s&&(o=a.set(t,r,n))!==e?o:(t.setAttribute(n,""+r),r):a&&"get"in a&&s&&null!==(o=a.get(t,n))?o:(o=t.getAttribute(n),null===o?e:o))},removeAttr:function(t,e){var n,r,i,o,a=0;if(e&&1===t.nodeType)for(r=e.toLowerCase().split(U),o=r.length;o>a;a++)i=r[a],i&&(n=P.propFix[i]||i,P.attr(t,i,""),t.removeAttribute(Z?i:n),G.test(i)&&n in t&&(t[n]=!1))},attrHooks:{type:{set:function(t,e){if(Y.test(t.nodeName)&&t.parentNode)P.error("type property can't be changed");else if(!P.support.radioValue&&"radio"===e&&P.nodeName(t,"input")){var n=t.value;return t.setAttribute("type",e),n&&(t.value=n),e}}},value:{get:function(t,e){return q&&P.nodeName(t,"button")?q.get(t,e):e in t?t.value:null},set:function(t,n,r){return q&&P.nodeName(t,"button")?q.set(t,n,r):(t.value=n,e)}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(t,n,r){var i,o,a,s=t.nodeType;if(t&&3!==s&&8!==s&&2!==s)return a=1!==s||!P.isXMLDoc(t),a&&(n=P.propFix[n]||n,o=P.propHooks[n]),r!==e?o&&"set"in o&&(i=o.set(t,r,n))!==e?i:t[n]=r:o&&"get"in o&&null!==(i=o.get(t,n))?i:t[n]},propHooks:{tabIndex:{get:function(t){var n=t.getAttributeNode("tabindex");return n&&n.specified?parseInt(n.value,10):X.test(t.nodeName)||K.test(t.nodeName)&&t.href?0:e}}}}),P.attrHooks.tabindex=P.propHooks.tabIndex,z={get:function(t,n){var r,i=P.prop(t,n);return i===!0||"boolean"!=typeof i&&(r=t.getAttributeNode(n))&&r.nodeValue!==!1?n.toLowerCase():e},set:function(t,e,n){var r;return e===!1?P.removeAttr(t,n):(r=P.propFix[n]||n,r in t&&(t[r]=!0),t.setAttribute(n,n.toLowerCase())),n}},Z||($={name:!0,id:!0},q=P.valHooks.button={get:function(t,n){var r;return r=t.getAttributeNode(n),r&&($[n]?""!==r.nodeValue:r.specified)?r.nodeValue:e},set:function(t,e,n){var r=t.getAttributeNode(n);return r||(r=R.createAttribute(n),t.setAttributeNode(r)),r.nodeValue=e+""}},P.attrHooks.tabindex.set=q.set,P.each(["width","height"],function(t,n){P.attrHooks[n]=P.extend(P.attrHooks[n],{set:function(t,r){return""===r?(t.setAttribute(n,"auto"),r):e}})}),P.attrHooks.contenteditable={get:q.get,set:function(t,e,n){""===e&&(e="false"),q.set(t,e,n)}}),P.support.hrefNormalized||P.each(["href","src","width","height"],function(t,n){P.attrHooks[n]=P.extend(P.attrHooks[n],{get:function(t){var r=t.getAttribute(n,2);return null===r?e:r}})}),P.support.style||(P.attrHooks.style={get:function(t){return t.style.cssText.toLowerCase()||e},set:function(t,e){return t.style.cssText=""+e}}),P.support.optSelected||(P.propHooks.selected=P.extend(P.propHooks.selected,{get:function(t){var e=t.parentNode;return e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex),null}})),P.support.enctype||(P.propFix.enctype="encoding"),P.support.checkOn||P.each(["radio","checkbox"],function(){P.valHooks[this]={get:function(t){return null===t.getAttribute("value")?"on":t.value}}}),P.each(["radio","checkbox"],function(){P.valHooks[this]=P.extend(P.valHooks[this],{set:function(t,n){return P.isArray(n)?t.checked=P.inArray(P(t).val(),n)>=0:e}})});var Q=/^(?:textarea|input|select)$/i,J=/^([^\.]*)?(?:\.(.+))?$/,te=/\bhover(\.\S+)?\b/,ee=/^key/,ne=/^(?:mouse|contextmenu)|click/,re=/^(?:focusinfocus|focusoutblur)$/,ie=/^(\w*)(?:#([\w\-]+))?(?:\.([\w\-]+))?$/,oe=function(t){var e=ie.exec(t);return e&&(e[1]=(e[1]||"").toLowerCase(),e[3]=e[3]&&RegExp("(?:^|\\s)"+e[3]+"(?:\\s|$)")),e},ae=function(t,e){var n=t.attributes||{};return!(e[1]&&t.nodeName.toLowerCase()!==e[1]||e[2]&&(n.id||{}).value!==e[2]||e[3]&&!e[3].test((n["class"]||{}).value))},se=function(t){return P.event.special.hover?t:t.replace(te,"mouseenter$1 mouseleave$1")};P.event={add:function(t,n,r,i,o){var a,s,l,u,c,d,h,f,p,g,m;if(3!==t.nodeType&&8!==t.nodeType&&n&&r&&(a=P._data(t))){for(r.handler&&(p=r,r=p.handler),r.guid||(r.guid=P.guid++),l=a.events,l||(a.events=l={}),s=a.handle,s||(a.handle=s=function(t){return P===e||t&&P.event.triggered===t.type?e:P.event.dispatch.apply(s.elem,arguments)
},s.elem=t),n=P.trim(se(n)).split(" "),u=0;n.length>u;u++)c=J.exec(n[u])||[],d=c[1],h=(c[2]||"").split(".").sort(),m=P.event.special[d]||{},d=(o?m.delegateType:m.bindType)||d,m=P.event.special[d]||{},f=P.extend({type:d,origType:c[1],data:i,handler:r,guid:r.guid,selector:o,quick:oe(o),namespace:h.join(".")},p),g=l[d],g||(g=l[d]=[],g.delegateCount=0,m.setup&&m.setup.call(t,i,h,s)!==!1||(t.addEventListener?t.addEventListener(d,s,!1):t.attachEvent&&t.attachEvent("on"+d,s))),m.add&&(m.add.call(t,f),f.handler.guid||(f.handler.guid=r.guid)),o?g.splice(g.delegateCount++,0,f):g.push(f),P.event.global[d]=!0;t=null}},global:{},remove:function(t,e,n,r,i){var o,a,s,l,u,c,d,h,f,p,g,m,v=P.hasData(t)&&P._data(t);if(v&&(h=v.events)){for(e=P.trim(se(e||"")).split(" "),o=0;e.length>o;o++)if(a=J.exec(e[o])||[],s=l=a[1],u=a[2],s){for(f=P.event.special[s]||{},s=(r?f.delegateType:f.bindType)||s,g=h[s]||[],c=g.length,u=u?RegExp("(^|\\.)"+u.split(".").sort().join("\\.(?:.*\\.)?")+"(\\.|$)"):null,d=0;g.length>d;d++)m=g[d],!i&&l!==m.origType||n&&n.guid!==m.guid||u&&!u.test(m.namespace)||r&&r!==m.selector&&("**"!==r||!m.selector)||(g.splice(d--,1),m.selector&&g.delegateCount--,f.remove&&f.remove.call(t,m));0===g.length&&c!==g.length&&(f.teardown&&f.teardown.call(t,u)!==!1||P.removeEvent(t,s,v.handle),delete h[s])}else for(s in h)P.event.remove(t,s+e[o],n,r,!0);P.isEmptyObject(h)&&(p=v.handle,p&&(p.elem=null),P.removeData(t,["events","handle"],!0))}},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(n,r,i,o){if(!i||3!==i.nodeType&&8!==i.nodeType){var a,s,l,u,c,d,h,f,p,g,m=n.type||n,v=[];if(!re.test(m+P.event.triggered)&&(m.indexOf("!")>=0&&(m=m.slice(0,-1),s=!0),m.indexOf(".")>=0&&(v=m.split("."),m=v.shift(),v.sort()),i&&!P.event.customEvent[m]||P.event.global[m]))if(n="object"==typeof n?n[P.expando]?n:new P.Event(m,n):new P.Event(m),n.type=m,n.isTrigger=!0,n.exclusive=s,n.namespace=v.join("."),n.namespace_re=n.namespace?RegExp("(^|\\.)"+v.join("\\.(?:.*\\.)?")+"(\\.|$)"):null,d=0>m.indexOf(":")?"on"+m:"",i){if(n.result=e,n.target||(n.target=i),r=null!=r?P.makeArray(r):[],r.unshift(n),h=P.event.special[m]||{},!h.trigger||h.trigger.apply(i,r)!==!1){if(p=[[i,h.bindType||m]],!o&&!h.noBubble&&!P.isWindow(i)){for(g=h.delegateType||m,u=re.test(g+m)?i:i.parentNode,c=null;u;u=u.parentNode)p.push([u,g]),c=u;c&&c===i.ownerDocument&&p.push([c.defaultView||c.parentWindow||t,g])}for(l=0;p.length>l&&!n.isPropagationStopped();l++)u=p[l][0],n.type=p[l][1],f=(P._data(u,"events")||{})[n.type]&&P._data(u,"handle"),f&&f.apply(u,r),f=d&&u[d],f&&P.acceptData(u)&&f.apply(u,r)===!1&&n.preventDefault();return n.type=m,o||n.isDefaultPrevented()||h._default&&h._default.apply(i.ownerDocument,r)!==!1||"click"===m&&P.nodeName(i,"a")||!P.acceptData(i)||d&&i[m]&&("focus"!==m&&"blur"!==m||0!==n.target.offsetWidth)&&!P.isWindow(i)&&(c=i[d],c&&(i[d]=null),P.event.triggered=m,i[m](),P.event.triggered=e,c&&(i[d]=c)),n.result}}else{a=P.cache;for(l in a)a[l].events&&a[l].events[m]&&P.event.trigger(n,r,a[l].handle.elem,!0)}}},dispatch:function(n){n=P.event.fix(n||t.event);var r,i,o,a,s,l,u,c,d,h,f=(P._data(this,"events")||{})[n.type]||[],p=f.delegateCount,g=[].slice.call(arguments,0),m=!n.exclusive&&!n.namespace,v=[];if(g[0]=n,n.delegateTarget=this,p&&!n.target.disabled&&(!n.button||"click"!==n.type))for(a=P(this),a.context=this.ownerDocument||this,o=n.target;o!=this;o=o.parentNode||this){for(l={},c=[],a[0]=o,r=0;p>r;r++)d=f[r],h=d.selector,l[h]===e&&(l[h]=d.quick?ae(o,d.quick):a.is(h)),l[h]&&c.push(d);c.length&&v.push({elem:o,matches:c})}for(f.length>p&&v.push({elem:this,matches:f.slice(p)}),r=0;v.length>r&&!n.isPropagationStopped();r++)for(u=v[r],n.currentTarget=u.elem,i=0;u.matches.length>i&&!n.isImmediatePropagationStopped();i++)d=u.matches[i],(m||!n.namespace&&!d.namespace||n.namespace_re&&n.namespace_re.test(d.namespace))&&(n.data=d.data,n.handleObj=d,s=((P.event.special[d.origType]||{}).handle||d.handler).apply(u.elem,g),s!==e&&(n.result=s,s===!1&&(n.preventDefault(),n.stopPropagation())));return n.result},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(t,e){return null==t.which&&(t.which=null!=e.charCode?e.charCode:e.keyCode),t}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(t,n){var r,i,o,a=n.button,s=n.fromElement;return null==t.pageX&&null!=n.clientX&&(r=t.target.ownerDocument||R,i=r.documentElement,o=r.body,t.pageX=n.clientX+(i&&i.scrollLeft||o&&o.scrollLeft||0)-(i&&i.clientLeft||o&&o.clientLeft||0),t.pageY=n.clientY+(i&&i.scrollTop||o&&o.scrollTop||0)-(i&&i.clientTop||o&&o.clientTop||0)),!t.relatedTarget&&s&&(t.relatedTarget=s===t.target?n.toElement:s),t.which||a===e||(t.which=1&a?1:2&a?3:4&a?2:0),t}},fix:function(t){if(t[P.expando])return t;var n,r,i=t,o=P.event.fixHooks[t.type]||{},a=o.props?this.props.concat(o.props):this.props;for(t=P.Event(i),n=a.length;n;)r=a[--n],t[r]=i[r];return t.target||(t.target=i.srcElement||R),3===t.target.nodeType&&(t.target=t.target.parentNode),t.metaKey===e&&(t.metaKey=t.ctrlKey),o.filter?o.filter(t,i):t},special:{ready:{setup:P.bindReady},load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(t,e,n){P.isWindow(this)&&(this.onbeforeunload=n)},teardown:function(t,e){this.onbeforeunload===e&&(this.onbeforeunload=null)}}},simulate:function(t,e,n,r){var i=P.extend(new P.Event,n,{type:t,isSimulated:!0,originalEvent:{}});r?P.event.trigger(i,null,e):P.event.dispatch.call(e,i),i.isDefaultPrevented()&&n.preventDefault()}},P.event.handle=P.event.dispatch,P.removeEvent=R.removeEventListener?function(t,e,n){t.removeEventListener&&t.removeEventListener(e,n,!1)}:function(t,e,n){t.detachEvent&&t.detachEvent("on"+e,n)},P.Event=function(t,n){return this instanceof P.Event?(t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||t.returnValue===!1||t.getPreventDefault&&t.getPreventDefault()?s:a):this.type=t,n&&P.extend(this,n),this.timeStamp=t&&t.timeStamp||P.now(),this[P.expando]=!0,e):new P.Event(t,n)},P.Event.prototype={preventDefault:function(){this.isDefaultPrevented=s;var t=this.originalEvent;t&&(t.preventDefault?t.preventDefault():t.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=s;var t=this.originalEvent;t&&(t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=s,this.stopPropagation()},isDefaultPrevented:a,isPropagationStopped:a,isImmediatePropagationStopped:a},P.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(t,e){P.event.special[t]={delegateType:e,bindType:e,handle:function(t){var n,r=this,i=t.relatedTarget,o=t.handleObj;return o.selector,(!i||i!==r&&!P.contains(r,i))&&(t.type=o.origType,n=o.handler.apply(this,arguments),t.type=e),n}}}),P.support.submitBubbles||(P.event.special.submit={setup:function(){return P.nodeName(this,"form")?!1:(P.event.add(this,"click._submit keypress._submit",function(t){var n=t.target,r=P.nodeName(n,"input")||P.nodeName(n,"button")?n.form:e;r&&!r._submit_attached&&(P.event.add(r,"submit._submit",function(t){this.parentNode&&!t.isTrigger&&P.event.simulate("submit",this.parentNode,t,!0)}),r._submit_attached=!0)}),e)},teardown:function(){return P.nodeName(this,"form")?!1:(P.event.remove(this,"._submit"),e)}}),P.support.changeBubbles||(P.event.special.change={setup:function(){return Q.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(P.event.add(this,"propertychange._change",function(t){"checked"===t.originalEvent.propertyName&&(this._just_changed=!0)}),P.event.add(this,"click._change",function(t){this._just_changed&&!t.isTrigger&&(this._just_changed=!1,P.event.simulate("change",this,t,!0))})),!1):(P.event.add(this,"beforeactivate._change",function(t){var e=t.target;Q.test(e.nodeName)&&!e._change_attached&&(P.event.add(e,"change._change",function(t){!this.parentNode||t.isSimulated||t.isTrigger||P.event.simulate("change",this.parentNode,t,!0)}),e._change_attached=!0)}),e)},handle:function(t){var n=t.target;return this!==n||t.isSimulated||t.isTrigger||"radio"!==n.type&&"checkbox"!==n.type?t.handleObj.handler.apply(this,arguments):e},teardown:function(){return P.event.remove(this,"._change"),Q.test(this.nodeName)}}),P.support.focusinBubbles||P.each({focus:"focusin",blur:"focusout"},function(t,e){var n=0,r=function(t){P.event.simulate(e,t.target,P.event.fix(t),!0)};P.event.special[e]={setup:function(){0===n++&&R.addEventListener(t,r,!0)},teardown:function(){0===--n&&R.removeEventListener(t,r,!0)}}}),P.fn.extend({on:function(t,n,r,i,o){var s,l;if("object"==typeof t){"string"!=typeof n&&(r=n,n=e);for(l in t)this.on(l,n,r,t[l],o);return this}if(null==r&&null==i?(i=n,r=n=e):null==i&&("string"==typeof n?(i=r,r=e):(i=r,r=n,n=e)),i===!1)i=a;else if(!i)return this;return 1===o&&(s=i,i=function(t){return P().off(t),s.apply(this,arguments)},i.guid=s.guid||(s.guid=P.guid++)),this.each(function(){P.event.add(this,t,i,r,n)})},one:function(t,e,n,r){return this.on.call(this,t,e,n,r,1)},off:function(t,n,r){if(t&&t.preventDefault&&t.handleObj){var i=t.handleObj;return P(t.delegateTarget).off(i.namespace?i.type+"."+i.namespace:i.type,i.selector,i.handler),this}if("object"==typeof t){for(var o in t)this.off(o,n,t[o]);return this}return(n===!1||"function"==typeof n)&&(r=n,n=e),r===!1&&(r=a),this.each(function(){P.event.remove(this,t,r,n)})},bind:function(t,e,n){return this.on(t,null,e,n)},unbind:function(t,e){return this.off(t,null,e)},live:function(t,e,n){return P(this.context).on(t,this.selector,e,n),this},die:function(t,e){return P(this.context).off(t,this.selector||"**",e),this},delegate:function(t,e,n,r){return this.on(e,t,n,r)},undelegate:function(t,e,n){return 1==arguments.length?this.off(t,"**"):this.off(e,t,n)},trigger:function(t,e){return this.each(function(){P.event.trigger(t,e,this)})},triggerHandler:function(t,n){return this[0]?P.event.trigger(t,n,this[0],!0):e},toggle:function(t){var e=arguments,n=t.guid||P.guid++,r=0,i=function(n){var i=(P._data(this,"lastToggle"+t.guid)||0)%r;return P._data(this,"lastToggle"+t.guid,i+1),n.preventDefault(),e[i].apply(this,arguments)||!1};for(i.guid=n;e.length>r;)e[r++].guid=n;return this.click(i)},hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}}),P.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(t,e){P.fn[e]=function(t,n){return null==n&&(n=t,t=null),arguments.length>0?this.on(e,null,t,n):this.trigger(e)},P.attrFn&&(P.attrFn[e]=!0),ee.test(e)&&(P.event.fixHooks[e]=P.event.keyHooks),ne.test(e)&&(P.event.fixHooks[e]=P.event.mouseHooks)}),function(){function t(t,e,n,r,o,a){for(var s=0,l=r.length;l>s;s++){var u=r[s];if(u){var c=!1;for(u=u[t];u;){if(u[i]===n){c=r[u.sizset];break}if(1!==u.nodeType||a||(u[i]=n,u.sizset=s),u.nodeName.toLowerCase()===e){c=u;break}u=u[t]}r[s]=c}}}function n(t,e,n,r,o,a){for(var s=0,l=r.length;l>s;s++){var u=r[s];if(u){var c=!1;for(u=u[t];u;){if(u[i]===n){c=r[u.sizset];break}if(1===u.nodeType)if(a||(u[i]=n,u.sizset=s),"string"!=typeof e){if(u===e){c=!0;break}}else if(h.filter(e,[u]).length>0){c=u;break}u=u[t]}r[s]=c}}}var r=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,i="sizcache"+(Math.random()+"").replace(".",""),o=0,a=Object.prototype.toString,s=!1,l=!0,u=/\\/g,c=/\r\n/g,d=/\W/;[0,0].sort(function(){return l=!1,0});var h=function(t,e,n,i){n=n||[],e=e||R;var o=e;if(1!==e.nodeType&&9!==e.nodeType)return[];if(!t||"string"!=typeof t)return n;var s,l,u,c,d,f,m,v,b=!0,x=h.isXML(e),w=[],k=t;do if(r.exec(""),s=r.exec(k),s&&(k=s[3],w.push(s[1]),s[2])){c=s[3];break}while(s);if(w.length>1&&g.exec(t))if(2===w.length&&p.relative[w[0]])l=C(w[0]+w[1],e,i);else for(l=p.relative[w[0]]?[e]:h(w.shift(),e);w.length;)t=w.shift(),p.relative[t]&&(t+=w.shift()),l=C(t,l,i);else if(!i&&w.length>1&&9===e.nodeType&&!x&&p.match.ID.test(w[0])&&!p.match.ID.test(w[w.length-1])&&(d=h.find(w.shift(),e,x),e=d.expr?h.filter(d.expr,d.set)[0]:d.set[0]),e)for(d=i?{expr:w.pop(),set:y(i)}:h.find(w.pop(),1!==w.length||"~"!==w[0]&&"+"!==w[0]||!e.parentNode?e:e.parentNode,x),l=d.expr?h.filter(d.expr,d.set):d.set,w.length>0?u=y(l):b=!1;w.length;)f=w.pop(),m=f,p.relative[f]?m=w.pop():f="",null==m&&(m=e),p.relative[f](u,m,x);else u=w=[];if(u||(u=l),u||h.error(f||t),"[object Array]"===a.call(u))if(b)if(e&&1===e.nodeType)for(v=0;null!=u[v];v++)u[v]&&(u[v]===!0||1===u[v].nodeType&&h.contains(e,u[v]))&&n.push(l[v]);else for(v=0;null!=u[v];v++)u[v]&&1===u[v].nodeType&&n.push(l[v]);else n.push.apply(n,u);else y(u,n);return c&&(h(c,o,n,i),h.uniqueSort(n)),n};h.uniqueSort=function(t){if(x&&(s=l,t.sort(x),s))for(var e=1;t.length>e;e++)t[e]===t[e-1]&&t.splice(e--,1);return t},h.matches=function(t,e){return h(t,null,null,e)},h.matchesSelector=function(t,e){return h(e,null,null,[t]).length>0},h.find=function(t,n,r){var i,o,a,s,l,c;if(!t)return[];for(o=0,a=p.order.length;a>o;o++)if(l=p.order[o],(s=p.leftMatch[l].exec(t))&&(c=s[1],s.splice(1,1),"\\"!==c.substr(c.length-1)&&(s[1]=(s[1]||"").replace(u,""),i=p.find[l](s,n,r),null!=i))){t=t.replace(p.match[l],"");break}return i||(i=n.getElementsByTagName!==e?n.getElementsByTagName("*"):[]),{set:i,expr:t}},h.filter=function(t,n,r,i){for(var o,a,s,l,u,c,d,f,g,m=t,v=[],y=n,b=n&&n[0]&&h.isXML(n[0]);t&&n.length;){for(s in p.filter)if(null!=(o=p.leftMatch[s].exec(t))&&o[2]){if(c=p.filter[s],d=o[1],a=!1,o.splice(1,1),"\\"===d.substr(d.length-1))continue;if(y===v&&(v=[]),p.preFilter[s])if(o=p.preFilter[s](o,y,r,v,i,b)){if(o===!0)continue}else a=l=!0;if(o)for(f=0;null!=(u=y[f]);f++)u&&(l=c(u,o,f,y),g=i^l,r&&null!=l?g?a=!0:y[f]=!1:g&&(v.push(u),a=!0));if(l!==e){if(r||(y=v),t=t.replace(p.match[s],""),!a)return[];break}}if(t===m){if(null!=a)break;h.error(t)}m=t}return y},h.error=function(t){throw Error("Syntax error, unrecognized expression: "+t)};var f=h.getText=function(t){var e,n,r=t.nodeType,i="";if(r){if(1===r||9===r){if("string"==typeof t.textContent)return t.textContent;if("string"==typeof t.innerText)return t.innerText.replace(c,"");for(t=t.firstChild;t;t=t.nextSibling)i+=f(t)}else if(3===r||4===r)return t.nodeValue}else for(e=0;n=t[e];e++)8!==n.nodeType&&(i+=f(n));return i},p=h.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(t){return t.getAttribute("href")},type:function(t){return t.getAttribute("type")}},relative:{"+":function(t,e){var n="string"==typeof e,r=n&&!d.test(e),i=n&&!r;r&&(e=e.toLowerCase());for(var o,a=0,s=t.length;s>a;a++)if(o=t[a]){for(;(o=o.previousSibling)&&1!==o.nodeType;);t[a]=i||o&&o.nodeName.toLowerCase()===e?o||!1:o===e}i&&h.filter(e,t,!0)},">":function(t,e){var n,r="string"==typeof e,i=0,o=t.length;if(r&&!d.test(e)){for(e=e.toLowerCase();o>i;i++)if(n=t[i]){var a=n.parentNode;t[i]=a.nodeName.toLowerCase()===e?a:!1}}else{for(;o>i;i++)n=t[i],n&&(t[i]=r?n.parentNode:n.parentNode===e);r&&h.filter(e,t,!0)}},"":function(e,r,i){var a,s=o++,l=n;"string"!=typeof r||d.test(r)||(r=r.toLowerCase(),a=r,l=t),l("parentNode",r,s,e,a,i)},"~":function(e,r,i){var a,s=o++,l=n;"string"!=typeof r||d.test(r)||(r=r.toLowerCase(),a=r,l=t),l("previousSibling",r,s,e,a,i)}},find:{ID:function(t,n,r){if(n.getElementById!==e&&!r){var i=n.getElementById(t[1]);return i&&i.parentNode?[i]:[]}},NAME:function(t,n){if(n.getElementsByName!==e){for(var r=[],i=n.getElementsByName(t[1]),o=0,a=i.length;a>o;o++)i[o].getAttribute("name")===t[1]&&r.push(i[o]);return 0===r.length?null:r}},TAG:function(t,n){return n.getElementsByTagName!==e?n.getElementsByTagName(t[1]):e}},preFilter:{CLASS:function(t,e,n,r,i,o){if(t=" "+t[1].replace(u,"")+" ",o)return t;for(var a,s=0;null!=(a=e[s]);s++)a&&(i^(a.className&&(" "+a.className+" ").replace(/[\t\n\r]/g," ").indexOf(t)>=0)?n||r.push(a):n&&(e[s]=!1));return!1},ID:function(t){return t[1].replace(u,"")},TAG:function(t){return t[1].replace(u,"").toLowerCase()},CHILD:function(t){if("nth"===t[1]){t[2]||h.error(t[0]),t[2]=t[2].replace(/^\+|\s*/g,"");var e=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec("even"===t[2]&&"2n"||"odd"===t[2]&&"2n+1"||!/\D/.test(t[2])&&"0n+"+t[2]||t[2]);t[2]=e[1]+(e[2]||1)-0,t[3]=e[3]-0}else t[2]&&h.error(t[0]);return t[0]=o++,t},ATTR:function(t,e,n,r,i,o){var a=t[1]=t[1].replace(u,"");return!o&&p.attrMap[a]&&(t[1]=p.attrMap[a]),t[4]=(t[4]||t[5]||"").replace(u,""),"~="===t[2]&&(t[4]=" "+t[4]+" "),t},PSEUDO:function(t,e,n,i,o){if("not"===t[1]){if(!((r.exec(t[3])||"").length>1||/^\w/.test(t[3]))){var a=h.filter(t[3],e,n,!0^o);return n||i.push.apply(i,a),!1}t[3]=h(t[3],null,null,e)}else if(p.match.POS.test(t[0])||p.match.CHILD.test(t[0]))return!0;return t},POS:function(t){return t.unshift(!0),t}},filters:{enabled:function(t){return t.disabled===!1&&"hidden"!==t.type},disabled:function(t){return t.disabled===!0},checked:function(t){return t.checked===!0},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,t.selected===!0},parent:function(t){return!!t.firstChild},empty:function(t){return!t.firstChild},has:function(t,e,n){return!!h(n[3],t).length},header:function(t){return/h\d/i.test(t.nodeName)},text:function(t){var e=t.getAttribute("type"),n=t.type;return"input"===t.nodeName.toLowerCase()&&"text"===n&&(e===n||null===e)},radio:function(t){return"input"===t.nodeName.toLowerCase()&&"radio"===t.type},checkbox:function(t){return"input"===t.nodeName.toLowerCase()&&"checkbox"===t.type},file:function(t){return"input"===t.nodeName.toLowerCase()&&"file"===t.type},password:function(t){return"input"===t.nodeName.toLowerCase()&&"password"===t.type},submit:function(t){var e=t.nodeName.toLowerCase();return("input"===e||"button"===e)&&"submit"===t.type},image:function(t){return"input"===t.nodeName.toLowerCase()&&"image"===t.type},reset:function(t){var e=t.nodeName.toLowerCase();return("input"===e||"button"===e)&&"reset"===t.type},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},input:function(t){return/input|select|textarea|button/i.test(t.nodeName)},focus:function(t){return t===t.ownerDocument.activeElement}},setFilters:{first:function(t,e){return 0===e},last:function(t,e,n,r){return e===r.length-1},even:function(t,e){return 0===e%2},odd:function(t,e){return 1===e%2},lt:function(t,e,n){return n[3]-0>e},gt:function(t,e,n){return e>n[3]-0},nth:function(t,e,n){return n[3]-0===e},eq:function(t,e,n){return n[3]-0===e}},filter:{PSEUDO:function(t,e,n,r){var i=e[1],o=p.filters[i];if(o)return o(t,n,e,r);if("contains"===i)return(t.textContent||t.innerText||f([t])||"").indexOf(e[3])>=0;if("not"===i){for(var a=e[3],s=0,l=a.length;l>s;s++)if(a[s]===t)return!1;return!0}h.error(i)},CHILD:function(t,e){var n,r,o,a,s,l,u=e[1],c=t;switch(u){case"only":case"first":for(;c=c.previousSibling;)if(1===c.nodeType)return!1;if("first"===u)return!0;c=t;case"last":for(;c=c.nextSibling;)if(1===c.nodeType)return!1;return!0;case"nth":if(n=e[2],r=e[3],1===n&&0===r)return!0;if(o=e[0],a=t.parentNode,a&&(a[i]!==o||!t.nodeIndex)){for(s=0,c=a.firstChild;c;c=c.nextSibling)1===c.nodeType&&(c.nodeIndex=++s);a[i]=o}return l=t.nodeIndex-r,0===n?0===l:0===l%n&&l/n>=0}},ID:function(t,e){return 1===t.nodeType&&t.getAttribute("id")===e},TAG:function(t,e){return"*"===e&&1===t.nodeType||!!t.nodeName&&t.nodeName.toLowerCase()===e},CLASS:function(t,e){return(" "+(t.className||t.getAttribute("class"))+" ").indexOf(e)>-1},ATTR:function(t,e){var n=e[1],r=h.attr?h.attr(t,n):p.attrHandle[n]?p.attrHandle[n](t):null!=t[n]?t[n]:t.getAttribute(n),i=r+"",o=e[2],a=e[4];return null==r?"!="===o:!o&&h.attr?null!=r:"="===o?i===a:"*="===o?i.indexOf(a)>=0:"~="===o?(" "+i+" ").indexOf(a)>=0:a?"!="===o?i!==a:"^="===o?0===i.indexOf(a):"$="===o?i.substr(i.length-a.length)===a:"|="===o?i===a||i.substr(0,a.length+1)===a+"-":!1:i&&r!==!1},POS:function(t,n,r,i){var o=n[2],a=p.setFilters[o];return a?a(t,r,n,i):e}}},g=p.match.POS,m=function(t,e){return"\\"+(e-0+1)};for(var v in p.match)p.match[v]=RegExp(p.match[v].source+/(?![^\[]*\])(?![^\(]*\))/.source),p.leftMatch[v]=RegExp(/(^(?:.|\r|\n)*?)/.source+p.match[v].source.replace(/\\(\d+)/g,m));var y=function(t,e){return t=Array.prototype.slice.call(t,0),e?(e.push.apply(e,t),e):t};try{Array.prototype.slice.call(R.documentElement.childNodes,0)[0].nodeType}catch(b){y=function(t,e){var n=0,r=e||[];if("[object Array]"===a.call(t))Array.prototype.push.apply(r,t);else if("number"==typeof t.length)for(var i=t.length;i>n;n++)r.push(t[n]);else for(;t[n];n++)r.push(t[n]);return r}}var x,w;R.documentElement.compareDocumentPosition?x=function(t,e){return t===e?(s=!0,0):t.compareDocumentPosition&&e.compareDocumentPosition?4&t.compareDocumentPosition(e)?-1:1:t.compareDocumentPosition?-1:1}:(x=function(t,e){if(t===e)return s=!0,0;if(t.sourceIndex&&e.sourceIndex)return t.sourceIndex-e.sourceIndex;var n,r,i=[],o=[],a=t.parentNode,l=e.parentNode,u=a;if(a===l)return w(t,e);if(!a)return-1;if(!l)return 1;for(;u;)i.unshift(u),u=u.parentNode;for(u=l;u;)o.unshift(u),u=u.parentNode;n=i.length,r=o.length;for(var c=0;n>c&&r>c;c++)if(i[c]!==o[c])return w(i[c],o[c]);return c===n?w(t,o[c],-1):w(i[c],e,1)},w=function(t,e,n){if(t===e)return n;for(var r=t.nextSibling;r;){if(r===e)return-1;r=r.nextSibling}return 1}),function(){var t=R.createElement("div"),n="script"+(new Date).getTime(),r=R.documentElement;t.innerHTML="<a name='"+n+"'/>",r.insertBefore(t,r.firstChild),R.getElementById(n)&&(p.find.ID=function(t,n,r){if(n.getElementById!==e&&!r){var i=n.getElementById(t[1]);return i?i.id===t[1]||i.getAttributeNode!==e&&i.getAttributeNode("id").nodeValue===t[1]?[i]:e:[]}},p.filter.ID=function(t,n){var r=t.getAttributeNode!==e&&t.getAttributeNode("id");return 1===t.nodeType&&r&&r.nodeValue===n}),r.removeChild(t),r=t=null}(),function(){var t=R.createElement("div");t.appendChild(R.createComment("")),t.getElementsByTagName("*").length>0&&(p.find.TAG=function(t,e){var n=e.getElementsByTagName(t[1]);if("*"===t[1]){for(var r=[],i=0;n[i];i++)1===n[i].nodeType&&r.push(n[i]);n=r}return n}),t.innerHTML="<a href='#'></a>",t.firstChild&&t.firstChild.getAttribute!==e&&"#"!==t.firstChild.getAttribute("href")&&(p.attrHandle.href=function(t){return t.getAttribute("href",2)}),t=null}(),R.querySelectorAll&&function(){var t=h,e=R.createElement("div"),n="__sizzle__";if(e.innerHTML="<p class='TEST'></p>",!e.querySelectorAll||0!==e.querySelectorAll(".TEST").length){h=function(e,r,i,o){if(r=r||R,!o&&!h.isXML(r)){var a=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(e);if(a&&(1===r.nodeType||9===r.nodeType)){if(a[1])return y(r.getElementsByTagName(e),i);if(a[2]&&p.find.CLASS&&r.getElementsByClassName)return y(r.getElementsByClassName(a[2]),i)}if(9===r.nodeType){if("body"===e&&r.body)return y([r.body],i);if(a&&a[3]){var s=r.getElementById(a[3]);if(!s||!s.parentNode)return y([],i);if(s.id===a[3])return y([s],i)}try{return y(r.querySelectorAll(e),i)}catch(l){}}else if(1===r.nodeType&&"object"!==r.nodeName.toLowerCase()){var u=r,c=r.getAttribute("id"),d=c||n,f=r.parentNode,g=/^\s*[+~]/.test(e);c?d=d.replace(/'/g,"\\$&"):r.setAttribute("id",d),g&&f&&(r=r.parentNode);try{if(!g||f)return y(r.querySelectorAll("[id='"+d+"'] "+e),i)}catch(m){}finally{c||u.removeAttribute("id")}}}return t(e,r,i,o)};for(var r in t)h[r]=t[r];e=null}}(),function(){var t=R.documentElement,e=t.matchesSelector||t.mozMatchesSelector||t.webkitMatchesSelector||t.msMatchesSelector;if(e){var n=!e.call(R.createElement("div"),"div"),r=!1;try{e.call(R.documentElement,"[test!='']:sizzle")}catch(i){r=!0}h.matchesSelector=function(t,i){if(i=i.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']"),!h.isXML(t))try{if(r||!p.match.PSEUDO.test(i)&&!/!=/.test(i)){var o=e.call(t,i);if(o||!n||t.document&&11!==t.document.nodeType)return o}}catch(a){}return h(i,null,null,[t]).length>0}}}(),function(){var t=R.createElement("div");t.innerHTML="<div class='test e'></div><div class='test'></div>",t.getElementsByClassName&&0!==t.getElementsByClassName("e").length&&(t.lastChild.className="e",1!==t.getElementsByClassName("e").length&&(p.order.splice(1,0,"CLASS"),p.find.CLASS=function(t,n,r){return n.getElementsByClassName===e||r?e:n.getElementsByClassName(t[1])},t=null))}(),h.contains=R.documentElement.contains?function(t,e){return t!==e&&(t.contains?t.contains(e):!0)}:R.documentElement.compareDocumentPosition?function(t,e){return!!(16&t.compareDocumentPosition(e))}:function(){return!1},h.isXML=function(t){var e=(t?t.ownerDocument||t:0).documentElement;return e?"HTML"!==e.nodeName:!1};var C=function(t,e,n){for(var r,i=[],o="",a=e.nodeType?[e]:e;r=p.match.PSEUDO.exec(t);)o+=r[0],t=t.replace(p.match.PSEUDO,"");t=p.relative[t]?t+"*":t;for(var s=0,l=a.length;l>s;s++)h(t,a[s],i,n);return h.filter(o,i)};h.attr=P.attr,h.selectors.attrMap={},P.find=h,P.expr=h.selectors,P.expr[":"]=P.expr.filters,P.unique=h.uniqueSort,P.text=h.getText,P.isXMLDoc=h.isXML,P.contains=h.contains}();var le=/Until$/,ue=/^(?:parents|prevUntil|prevAll)/,ce=/,/,de=/^.[^:#\[\.,]*$/,he=Array.prototype.slice,fe=P.expr.match.POS,pe={children:!0,contents:!0,next:!0,prev:!0};P.fn.extend({find:function(t){var e,n,r=this;if("string"!=typeof t)return P(t).filter(function(){for(e=0,n=r.length;n>e;e++)if(P.contains(r[e],this))return!0});var i,o,a,s=this.pushStack("","find",t);for(e=0,n=this.length;n>e;e++)if(i=s.length,P.find(t,this[e],s),e>0)for(o=i;s.length>o;o++)for(a=0;i>a;a++)if(s[a]===s[o]){s.splice(o--,1);break}return s},has:function(t){var e=P(t);return this.filter(function(){for(var t=0,n=e.length;n>t;t++)if(P.contains(this,e[t]))return!0})},not:function(t){return this.pushStack(u(this,t,!1),"not",t)},filter:function(t){return this.pushStack(u(this,t,!0),"filter",t)},is:function(t){return!!t&&("string"==typeof t?fe.test(t)?P(t,this.context).index(this[0])>=0:P.filter(t,this).length>0:this.filter(t).length>0)},closest:function(t,e){var n,r,i=[],o=this[0];if(P.isArray(t)){for(var a=1;o&&o.ownerDocument&&o!==e;){for(n=0;t.length>n;n++)P(o).is(t[n])&&i.push({selector:t[n],elem:o,level:a});o=o.parentNode,a++}return i}var s=fe.test(t)||"string"!=typeof t?P(t,e||this.context):0;for(n=0,r=this.length;r>n;n++)for(o=this[n];o;){if(s?s.index(o)>-1:P.find.matchesSelector(o,t)){i.push(o);break}if(o=o.parentNode,!o||!o.ownerDocument||o===e||11===o.nodeType)break}return i=i.length>1?P.unique(i):i,this.pushStack(i,"closest",t)},index:function(t){return t?"string"==typeof t?P.inArray(this[0],P(t)):P.inArray(t.jquery?t[0]:t,this):this[0]&&this[0].parentNode?this.prevAll().length:-1},add:function(t,e){var n="string"==typeof t?P(t,e):P.makeArray(t&&t.nodeType?[t]:t),r=P.merge(this.get(),n);return this.pushStack(l(n[0])||l(r[0])?r:P.unique(r))},andSelf:function(){return this.add(this.prevObject)}}),P.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return P.dir(t,"parentNode")},parentsUntil:function(t,e,n){return P.dir(t,"parentNode",n)},next:function(t){return P.nth(t,2,"nextSibling")},prev:function(t){return P.nth(t,2,"previousSibling")},nextAll:function(t){return P.dir(t,"nextSibling")},prevAll:function(t){return P.dir(t,"previousSibling")},nextUntil:function(t,e,n){return P.dir(t,"nextSibling",n)},prevUntil:function(t,e,n){return P.dir(t,"previousSibling",n)},siblings:function(t){return P.sibling(t.parentNode.firstChild,t)},children:function(t){return P.sibling(t.firstChild)},contents:function(t){return P.nodeName(t,"iframe")?t.contentDocument||t.contentWindow.document:P.makeArray(t.childNodes)}},function(t,e){P.fn[t]=function(n,r){var i=P.map(this,e,n);return le.test(t)||(r=n),r&&"string"==typeof r&&(i=P.filter(r,i)),i=this.length>1&&!pe[t]?P.unique(i):i,(this.length>1||ce.test(r))&&ue.test(t)&&(i=i.reverse()),this.pushStack(i,t,he.call(arguments).join(","))}}),P.extend({filter:function(t,e,n){return n&&(t=":not("+t+")"),1===e.length?P.find.matchesSelector(e[0],t)?[e[0]]:[]:P.find.matches(t,e)},dir:function(t,n,r){for(var i=[],o=t[n];o&&9!==o.nodeType&&(r===e||1!==o.nodeType||!P(o).is(r));)1===o.nodeType&&i.push(o),o=o[n];return i},nth:function(t,e,n){e=e||1;for(var r=0;t&&(1!==t.nodeType||++r!==e);t=t[n]);return t},sibling:function(t,e){for(var n=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&n.push(t);return n}});var ge="abbr|article|aside|audio|canvas|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",me=/ jQuery\d+="(?:\d+|null)"/g,ve=/^\s+/,ye=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,be=/<([\w:]+)/,xe=/<tbody/i,we=/<|&#?\w+;/,Ce=/<(?:script|style)/i,ke=/<(?:script|object|embed|option|style)/i,Ae=RegExp("<(?:"+ge+")","i"),Ee=/checked\s*(?:[^=]|=\s*.checked.)/i,Te=/\/(java|ecma)script/i,Se=/^\s*<!(?:\[CDATA\[|\-\-)/,_e={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},Ne=c(R);_e.optgroup=_e.option,_e.tbody=_e.tfoot=_e.colgroup=_e.caption=_e.thead,_e.th=_e.td,P.support.htmlSerialize||(_e._default=[1,"div<div>","</div>"]),P.fn.extend({text:function(t){return P.isFunction(t)?this.each(function(e){var n=P(this);n.text(t.call(this,e,n.text()))}):"object"!=typeof t&&t!==e?this.empty().append((this[0]&&this[0].ownerDocument||R).createTextNode(t)):P.text(this)},wrapAll:function(t){if(P.isFunction(t))return this.each(function(e){P(this).wrapAll(t.call(this,e))});if(this[0]){var e=P(t,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var t=this;t.firstChild&&1===t.firstChild.nodeType;)t=t.firstChild;return t}).append(this)}return this},wrapInner:function(t){return P.isFunction(t)?this.each(function(e){P(this).wrapInner(t.call(this,e))}):this.each(function(){var e=P(this),n=e.contents();n.length?n.wrapAll(t):e.append(t)})},wrap:function(t){var e=P.isFunction(t);return this.each(function(n){P(this).wrapAll(e?t.call(this,n):t)})},unwrap:function(){return this.parent().each(function(){P.nodeName(this,"body")||P(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(t){1===this.nodeType&&this.appendChild(t)})},prepend:function(){return this.domManip(arguments,!0,function(t){1===this.nodeType&&this.insertBefore(t,this.firstChild)})},before:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(t){this.parentNode.insertBefore(t,this)});if(arguments.length){var t=P.clean(arguments);return t.push.apply(t,this.toArray()),this.pushStack(t,"before",arguments)}},after:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(t){this.parentNode.insertBefore(t,this.nextSibling)});if(arguments.length){var t=this.pushStack(this,"after",arguments);return t.push.apply(t,P.clean(arguments)),t}},remove:function(t,e){for(var n,r=0;null!=(n=this[r]);r++)(!t||P.filter(t,[n]).length)&&(e||1!==n.nodeType||(P.cleanData(n.getElementsByTagName("*")),P.cleanData([n])),n.parentNode&&n.parentNode.removeChild(n));return this
},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)for(1===t.nodeType&&P.cleanData(t.getElementsByTagName("*"));t.firstChild;)t.removeChild(t.firstChild);return this},clone:function(t,e){return t=null==t?!1:t,e=null==e?t:e,this.map(function(){return P.clone(this,t,e)})},html:function(t){if(t===e)return this[0]&&1===this[0].nodeType?this[0].innerHTML.replace(me,""):null;if("string"!=typeof t||Ce.test(t)||!P.support.leadingWhitespace&&ve.test(t)||_e[(be.exec(t)||["",""])[1].toLowerCase()])P.isFunction(t)?this.each(function(e){var n=P(this);n.html(t.call(this,e,n.html()))}):this.empty().append(t);else{t=t.replace(ye,"<$1></$2>");try{for(var n=0,r=this.length;r>n;n++)1===this[n].nodeType&&(P.cleanData(this[n].getElementsByTagName("*")),this[n].innerHTML=t)}catch(i){this.empty().append(t)}}return this},replaceWith:function(t){return this[0]&&this[0].parentNode?P.isFunction(t)?this.each(function(e){var n=P(this),r=n.html();n.replaceWith(t.call(this,e,r))}):("string"!=typeof t&&(t=P(t).detach()),this.each(function(){var e=this.nextSibling,n=this.parentNode;P(this).remove(),e?P(e).before(t):P(n).append(t)})):this.length?this.pushStack(P(P.isFunction(t)?t():t),"replaceWith",t):this},detach:function(t){return this.remove(t,!0)},domManip:function(t,n,r){var i,o,a,s,l=t[0],u=[];if(!P.support.checkClone&&3===arguments.length&&"string"==typeof l&&Ee.test(l))return this.each(function(){P(this).domManip(t,n,r,!0)});if(P.isFunction(l))return this.each(function(i){var o=P(this);t[0]=l.call(this,i,n?o.html():e),o.domManip(t,n,r)});if(this[0]){if(s=l&&l.parentNode,i=P.support.parentNode&&s&&11===s.nodeType&&s.childNodes.length===this.length?{fragment:s}:P.buildFragment(t,this,u),a=i.fragment,o=1===a.childNodes.length?a=a.firstChild:a.firstChild){n=n&&P.nodeName(o,"tr");for(var c=0,h=this.length,f=h-1;h>c;c++)r.call(n?d(this[c],o):this[c],i.cacheable||h>1&&f>c?P.clone(a,!0,!0):a)}u.length&&P.each(u,y)}return this}}),P.buildFragment=function(t,e,n){var r,i,o,a,s=t[0];return e&&e[0]&&(a=e[0].ownerDocument||e[0]),a.createDocumentFragment||(a=R),!(1===t.length&&"string"==typeof s&&512>s.length&&a===R&&"<"===s.charAt(0))||ke.test(s)||!P.support.checkClone&&Ee.test(s)||!P.support.html5Clone&&Ae.test(s)||(i=!0,o=P.fragments[s],o&&1!==o&&(r=o)),r||(r=a.createDocumentFragment(),P.clean(t,a,r,n)),i&&(P.fragments[s]=o?r:1),{fragment:r,cacheable:i}},P.fragments={},P.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,e){P.fn[t]=function(n){var r=[],i=P(n),o=1===this.length&&this[0].parentNode;if(o&&11===o.nodeType&&1===o.childNodes.length&&1===i.length)return i[e](this[0]),this;for(var a=0,s=i.length;s>a;a++){var l=(a>0?this.clone(!0):this).get();P(i[a])[e](l),r=r.concat(l)}return this.pushStack(r,t,i.selector)}}),P.extend({clone:function(t,e,n){var r,i,o,a=P.support.html5Clone||!Ae.test("<"+t.nodeName)?t.cloneNode(!0):v(t);if(!(P.support.noCloneEvent&&P.support.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||P.isXMLDoc(t)))for(f(t,a),r=p(t),i=p(a),o=0;r[o];++o)i[o]&&f(r[o],i[o]);if(e&&(h(t,a),n))for(r=p(t),i=p(a),o=0;r[o];++o)h(r[o],i[o]);return r=i=null,a},clean:function(t,n,r,i){var o;n=n||R,n.createElement===e&&(n=n.ownerDocument||n[0]&&n[0].ownerDocument||R);for(var a,s,l=[],u=0;null!=(s=t[u]);u++)if("number"==typeof s&&(s+=""),s){if("string"==typeof s)if(we.test(s)){s=s.replace(ye,"<$1></$2>");var d=(be.exec(s)||["",""])[1].toLowerCase(),h=_e[d]||_e._default,f=h[0],p=n.createElement("div");for(n===R?Ne.appendChild(p):c(n).appendChild(p),p.innerHTML=h[1]+s+h[2];f--;)p=p.lastChild;if(!P.support.tbody){var g=xe.test(s),v="table"!==d||g?"<table>"!==h[1]||g?[]:p.childNodes:p.firstChild&&p.firstChild.childNodes;for(a=v.length-1;a>=0;--a)P.nodeName(v[a],"tbody")&&!v[a].childNodes.length&&v[a].parentNode.removeChild(v[a])}!P.support.leadingWhitespace&&ve.test(s)&&p.insertBefore(n.createTextNode(ve.exec(s)[0]),p.firstChild),s=p.childNodes}else s=n.createTextNode(s);var y;if(!P.support.appendChecked)if(s[0]&&"number"==typeof(y=s.length))for(a=0;y>a;a++)m(s[a]);else m(s);s.nodeType?l.push(s):l=P.merge(l,s)}if(r)for(o=function(t){return!t.type||Te.test(t.type)},u=0;l[u];u++)if(!i||!P.nodeName(l[u],"script")||l[u].type&&"text/javascript"!==l[u].type.toLowerCase()){if(1===l[u].nodeType){var b=P.grep(l[u].getElementsByTagName("script"),o);l.splice.apply(l,[u+1,0].concat(b))}r.appendChild(l[u])}else i.push(l[u].parentNode?l[u].parentNode.removeChild(l[u]):l[u]);return l},cleanData:function(t){for(var e,n,r,i=P.cache,o=P.event.special,a=P.support.deleteExpando,s=0;null!=(r=t[s]);s++)if((!r.nodeName||!P.noData[r.nodeName.toLowerCase()])&&(n=r[P.expando])){if(e=i[n],e&&e.events){for(var l in e.events)o[l]?P.event.remove(r,l):P.removeEvent(r,l,e.handle);e.handle&&(e.handle.elem=null)}a?delete r[P.expando]:r.removeAttribute&&r.removeAttribute(P.expando),delete i[n]}}});var Me,Oe,De,Re=/alpha\([^)]*\)/i,Ie=/opacity=([^)]*)/,Le=/([A-Z]|^ms)/g,Pe=/^-?\d+(?:px)?$/i,Fe=/^-?\d/,Be=/^([\-+])=([\-+.\de]+)/,je={position:"absolute",visibility:"hidden",display:"block"},He=["Left","Right"],qe=["Top","Bottom"];P.fn.css=function(t,n){return 2===arguments.length&&n===e?this:P.access(this,t,n,!0,function(t,n,r){return r!==e?P.style(t,n,r):P.css(t,n)})},P.extend({cssHooks:{opacity:{get:function(t,e){if(e){var n=Me(t,"opacity","opacity");return""===n?"1":n}return t.style.opacity}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":P.support.cssFloat?"cssFloat":"styleFloat"},style:function(t,n,r,i){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var o,a,s=P.camelCase(n),l=t.style,u=P.cssHooks[s];if(n=P.cssProps[s]||s,r===e)return u&&"get"in u&&(o=u.get(t,!1,i))!==e?o:l[n];if(a=typeof r,"string"===a&&(o=Be.exec(r))&&(r=+(o[1]+1)*+o[2]+parseFloat(P.css(t,n)),a="number"),!(null==r||"number"===a&&isNaN(r)||("number"!==a||P.cssNumber[s]||(r+="px"),u&&"set"in u&&(r=u.set(t,r))===e)))try{l[n]=r}catch(c){}}},css:function(t,n,r){var i,o;return n=P.camelCase(n),o=P.cssHooks[n],n=P.cssProps[n]||n,"cssFloat"===n&&(n="float"),o&&"get"in o&&(i=o.get(t,!0,r))!==e?i:Me?Me(t,n):e},swap:function(t,e,n){var r={};for(var i in e)r[i]=t.style[i],t.style[i]=e[i];n.call(t);for(i in e)t.style[i]=r[i]}}),P.curCSS=P.css,P.each(["height","width"],function(t,n){P.cssHooks[n]={get:function(t,r,i){var o;return r?0!==t.offsetWidth?b(t,n,i):(P.swap(t,je,function(){o=b(t,n,i)}),o):e},set:function(t,n){return Pe.test(n)?(n=parseFloat(n),n>=0?n+"px":e):n}}}),P.support.opacity||(P.cssHooks.opacity={get:function(t,e){return Ie.test((e&&t.currentStyle?t.currentStyle.filter:t.style.filter)||"")?parseFloat(RegExp.$1)/100+"":e?"1":""},set:function(t,e){var n=t.style,r=t.currentStyle,i=P.isNumeric(e)?"alpha(opacity="+100*e+")":"",o=r&&r.filter||n.filter||"";n.zoom=1,e>=1&&""===P.trim(o.replace(Re,""))&&n.removeAttribute&&(n.removeAttribute("filter"),r&&!r.filter)||(n.filter=Re.test(o)?o.replace(Re,i):o+" "+i)}}),P(function(){P.support.reliableMarginRight||(P.cssHooks.marginRight={get:function(t,e){var n;return P.swap(t,{display:"inline-block"},function(){n=e?Me(t,"margin-right","marginRight"):t.style.marginRight}),n}})}),R.defaultView&&R.defaultView.getComputedStyle&&(Oe=function(t,e){var n,r,i;return e=e.replace(Le,"-$1").toLowerCase(),(r=t.ownerDocument.defaultView)&&(i=r.getComputedStyle(t,null))&&(n=i.getPropertyValue(e),""!==n||P.contains(t.ownerDocument.documentElement,t)||(n=P.style(t,e))),n}),R.documentElement.currentStyle&&(De=function(t,e){var n,r,i,o=t.currentStyle&&t.currentStyle[e],a=t.style;return null===o&&a&&(i=a[e])&&(o=i),!Pe.test(o)&&Fe.test(o)&&(n=a.left,r=t.runtimeStyle&&t.runtimeStyle.left,r&&(t.runtimeStyle.left=t.currentStyle.left),a.left="fontSize"===e?"1em":o||0,o=a.pixelLeft+"px",a.left=n,r&&(t.runtimeStyle.left=r)),""===o?"auto":o}),Me=Oe||De,P.expr&&P.expr.filters&&(P.expr.filters.hidden=function(t){var e=t.offsetWidth,n=t.offsetHeight;return 0===e&&0===n||!P.support.reliableHiddenOffsets&&"none"===(t.style&&t.style.display||P.css(t,"display"))},P.expr.filters.visible=function(t){return!P.expr.filters.hidden(t)});var ze,$e,We=/%20/g,Ue=/\[\]$/,Ve=/\r?\n/g,Ye=/#.*$/,Xe=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Ke=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,Ge=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,Ze=/^(?:GET|HEAD)$/,Qe=/^\/\//,Je=/\?/,tn=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,en=/^(?:select|textarea)/i,nn=/\s+/,rn=/([?&])_=[^&]*/,on=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,an=P.fn.load,sn={},ln={},un=["*/"]+["*"];try{ze=L.href}catch(cn){ze=R.createElement("a"),ze.href="",ze=ze.href}$e=on.exec(ze.toLowerCase())||[],P.fn.extend({load:function(t,n,r){if("string"!=typeof t&&an)return an.apply(this,arguments);if(!this.length)return this;var i=t.indexOf(" ");if(i>=0){var o=t.slice(i,t.length);t=t.slice(0,i)}var a="GET";n&&(P.isFunction(n)?(r=n,n=e):"object"==typeof n&&(n=P.param(n,P.ajaxSettings.traditional),a="POST"));var s=this;return P.ajax({url:t,type:a,dataType:"html",data:n,complete:function(t,e,n){n=t.responseText,t.isResolved()&&(t.done(function(t){n=t}),s.html(o?P("<div>").append(n.replace(tn,"")).find(o):n)),r&&s.each(r,[n,e,t])}}),this},serialize:function(){return P.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?P.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||en.test(this.nodeName)||Ke.test(this.type))}).map(function(t,e){var n=P(this).val();return null==n?null:P.isArray(n)?P.map(n,function(t){return{name:e.name,value:t.replace(Ve,"\r\n")}}):{name:e.name,value:n.replace(Ve,"\r\n")}}).get()}}),P.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(t,e){P.fn[e]=function(t){return this.on(e,t)}}),P.each(["get","post"],function(t,n){P[n]=function(t,r,i,o){return P.isFunction(r)&&(o=o||i,i=r,r=e),P.ajax({type:n,url:t,data:r,success:i,dataType:o})}}),P.extend({getScript:function(t,n){return P.get(t,e,n,"script")},getJSON:function(t,e,n){return P.get(t,e,n,"json")},ajaxSetup:function(t,e){return e?C(t,P.ajaxSettings):(e=t,t=P.ajaxSettings),C(t,e),t},ajaxSettings:{url:ze,isLocal:Ge.test($e[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":un},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":t.String,"text html":!0,"text json":P.parseJSON,"text xml":P.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:x(sn),ajaxTransport:x(ln),ajax:function(t,n){function r(t,n,r,a){if(2!==x){x=2,l&&clearTimeout(l),s=e,o=a||"",C.readyState=t>0?4:0;var u,d,y,b,w,k=n,T=r?A(h,C,r):e;if(t>=200&&300>t||304===t)if(h.ifModified&&((b=C.getResponseHeader("Last-Modified"))&&(P.lastModified[i]=b),(w=C.getResponseHeader("Etag"))&&(P.etag[i]=w)),304===t)k="notmodified",u=!0;else try{d=E(h,T),k="success",u=!0}catch(S){k="parsererror",y=S}else y=k,(!k||t)&&(k="error",0>t&&(t=0));C.status=t,C.statusText=""+(n||k),u?g.resolveWith(f,[d,k,C]):g.rejectWith(f,[C,k,y]),C.statusCode(v),v=e,c&&p.trigger("ajax"+(u?"Success":"Error"),[C,h,u?d:y]),m.fireWith(f,[C,k]),c&&(p.trigger("ajaxComplete",[C,h]),--P.active||P.event.trigger("ajaxStop"))}}"object"==typeof t&&(n=t,t=e),n=n||{};var i,o,a,s,l,u,c,d,h=P.ajaxSetup({},n),f=h.context||h,p=f!==h&&(f.nodeType||f instanceof P)?P(f):P.event,g=P.Deferred(),m=P.Callbacks("once memory"),v=h.statusCode||{},y={},b={},x=0,C={readyState:0,setRequestHeader:function(t,e){if(!x){var n=t.toLowerCase();t=b[n]=b[n]||t,y[t]=e}return this},getAllResponseHeaders:function(){return 2===x?o:null},getResponseHeader:function(t){var n;if(2===x){if(!a)for(a={};n=Xe.exec(o);)a[n[1].toLowerCase()]=n[2];n=a[t.toLowerCase()]}return n===e?null:n},overrideMimeType:function(t){return x||(h.mimeType=t),this},abort:function(t){return t=t||"abort",s&&s.abort(t),r(0,t),this}};if(g.promise(C),C.success=C.done,C.error=C.fail,C.complete=m.add,C.statusCode=function(t){if(t){var e;if(2>x)for(e in t)v[e]=[v[e],t[e]];else e=t[C.status],C.then(e,e)}return this},h.url=((t||h.url)+"").replace(Ye,"").replace(Qe,$e[1]+"//"),h.dataTypes=P.trim(h.dataType||"*").toLowerCase().split(nn),null==h.crossDomain&&(u=on.exec(h.url.toLowerCase()),h.crossDomain=!(!u||u[1]==$e[1]&&u[2]==$e[2]&&(u[3]||("http:"===u[1]?80:443))==($e[3]||("http:"===$e[1]?80:443)))),h.data&&h.processData&&"string"!=typeof h.data&&(h.data=P.param(h.data,h.traditional)),w(sn,h,n,C),2===x)return!1;if(c=h.global,h.type=h.type.toUpperCase(),h.hasContent=!Ze.test(h.type),c&&0===P.active++&&P.event.trigger("ajaxStart"),!h.hasContent&&(h.data&&(h.url+=(Je.test(h.url)?"&":"?")+h.data,delete h.data),i=h.url,h.cache===!1)){var k=P.now(),T=h.url.replace(rn,"$1_="+k);h.url=T+(T===h.url?(Je.test(h.url)?"&":"?")+"_="+k:"")}(h.data&&h.hasContent&&h.contentType!==!1||n.contentType)&&C.setRequestHeader("Content-Type",h.contentType),h.ifModified&&(i=i||h.url,P.lastModified[i]&&C.setRequestHeader("If-Modified-Since",P.lastModified[i]),P.etag[i]&&C.setRequestHeader("If-None-Match",P.etag[i])),C.setRequestHeader("Accept",h.dataTypes[0]&&h.accepts[h.dataTypes[0]]?h.accepts[h.dataTypes[0]]+("*"!==h.dataTypes[0]?", "+un+"; q=0.01":""):h.accepts["*"]);for(d in h.headers)C.setRequestHeader(d,h.headers[d]);if(h.beforeSend&&(h.beforeSend.call(f,C,h)===!1||2===x))return C.abort(),!1;for(d in{success:1,error:1,complete:1})C[d](h[d]);if(s=w(ln,h,n,C)){C.readyState=1,c&&p.trigger("ajaxSend",[C,h]),h.async&&h.timeout>0&&(l=setTimeout(function(){C.abort("timeout")},h.timeout));try{x=1,s.send(y,r)}catch(S){if(!(2>x))throw S;r(-1,S)}}else r(-1,"No Transport");return C},param:function(t,n){var r=[],i=function(t,e){e=P.isFunction(e)?e():e,r[r.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)};if(n===e&&(n=P.ajaxSettings.traditional),P.isArray(t)||t.jquery&&!P.isPlainObject(t))P.each(t,function(){i(this.name,this.value)});else for(var o in t)k(o,t[o],n,i);return r.join("&").replace(We,"+")}}),P.extend({active:0,lastModified:{},etag:{}});var dn=P.now(),hn=/(\=)\?(&|$)|\?\?/i;P.ajaxSetup({jsonp:"callback",jsonpCallback:function(){return P.expando+"_"+dn++}}),P.ajaxPrefilter("json jsonp",function(e,n,r){var i="application/x-www-form-urlencoded"===e.contentType&&"string"==typeof e.data;if("jsonp"===e.dataTypes[0]||e.jsonp!==!1&&(hn.test(e.url)||i&&hn.test(e.data))){var o,a=e.jsonpCallback=P.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,s=t[a],l=e.url,u=e.data,c="$1"+a+"$2";return e.jsonp!==!1&&(l=l.replace(hn,c),e.url===l&&(i&&(u=u.replace(hn,c)),e.data===u&&(l+=(/\?/.test(l)?"&":"?")+e.jsonp+"="+a))),e.url=l,e.data=u,t[a]=function(t){o=[t]},r.always(function(){t[a]=s,o&&P.isFunction(s)&&t[a](o[0])}),e.converters["script json"]=function(){return o||P.error(a+" was not called"),o[0]},e.dataTypes[0]="json","script"}}),P.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(t){return P.globalEval(t),t}}}),P.ajaxPrefilter("script",function(t){t.cache===e&&(t.cache=!1),t.crossDomain&&(t.type="GET",t.global=!1)}),P.ajaxTransport("script",function(t){if(t.crossDomain){var n,r=R.head||R.getElementsByTagName("head")[0]||R.documentElement;return{send:function(i,o){n=R.createElement("script"),n.async="async",t.scriptCharset&&(n.charset=t.scriptCharset),n.src=t.url,n.onload=n.onreadystatechange=function(t,i){(i||!n.readyState||/loaded|complete/.test(n.readyState))&&(n.onload=n.onreadystatechange=null,r&&n.parentNode&&r.removeChild(n),n=e,i||o(200,"success"))},r.insertBefore(n,r.firstChild)},abort:function(){n&&n.onload(0,1)}}}});var fn,pn=t.ActiveXObject?function(){for(var t in fn)fn[t](0,1)}:!1,gn=0;P.ajaxSettings.xhr=t.ActiveXObject?function(){return!this.isLocal&&T()||S()}:T,function(t){P.extend(P.support,{ajax:!!t,cors:!!t&&"withCredentials"in t})}(P.ajaxSettings.xhr()),P.support.ajax&&P.ajaxTransport(function(n){if(!n.crossDomain||P.support.cors){var r;return{send:function(i,o){var a,s,l=n.xhr();if(n.username?l.open(n.type,n.url,n.async,n.username,n.password):l.open(n.type,n.url,n.async),n.xhrFields)for(s in n.xhrFields)l[s]=n.xhrFields[s];n.mimeType&&l.overrideMimeType&&l.overrideMimeType(n.mimeType),n.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");try{for(s in i)l.setRequestHeader(s,i[s])}catch(u){}l.send(n.hasContent&&n.data||null),r=function(t,i){var s,u,c,d,h;try{if(r&&(i||4===l.readyState))if(r=e,a&&(l.onreadystatechange=P.noop,pn&&delete fn[a]),i)4!==l.readyState&&l.abort();else{s=l.status,c=l.getAllResponseHeaders(),d={},h=l.responseXML,h&&h.documentElement&&(d.xml=h),d.text=l.responseText;try{u=l.statusText}catch(f){u=""}s||!n.isLocal||n.crossDomain?1223===s&&(s=204):s=d.text?200:404}}catch(p){i||o(-1,p)}d&&o(s,u,d,c)},n.async&&4!==l.readyState?(a=++gn,pn&&(fn||(fn={},P(t).unload(pn)),fn[a]=r),l.onreadystatechange=r):r()},abort:function(){r&&r(0,1)}}}});var mn,vn,yn,bn,xn={},wn=/^(?:toggle|show|hide)$/,Cn=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i,kn=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]];P.fn.extend({show:function(t,e,n){var r,i;if(t||0===t)return this.animate(M("show",3),t,e,n);for(var o=0,a=this.length;a>o;o++)r=this[o],r.style&&(i=r.style.display,P._data(r,"olddisplay")||"none"!==i||(i=r.style.display=""),""===i&&"none"===P.css(r,"display")&&P._data(r,"olddisplay",O(r.nodeName)));for(o=0;a>o;o++)r=this[o],r.style&&(i=r.style.display,(""===i||"none"===i)&&(r.style.display=P._data(r,"olddisplay")||""));return this},hide:function(t,e,n){if(t||0===t)return this.animate(M("hide",3),t,e,n);for(var r,i,o=0,a=this.length;a>o;o++)r=this[o],r.style&&(i=P.css(r,"display"),"none"===i||P._data(r,"olddisplay")||P._data(r,"olddisplay",i));for(o=0;a>o;o++)this[o].style&&(this[o].style.display="none");return this},_toggle:P.fn.toggle,toggle:function(t,e,n){var r="boolean"==typeof t;return P.isFunction(t)&&P.isFunction(e)?this._toggle.apply(this,arguments):null==t||r?this.each(function(){var e=r?t:P(this).is(":hidden");P(this)[e?"show":"hide"]()}):this.animate(M("toggle",3),t,e,n),this},fadeTo:function(t,e,n,r){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:e},t,n,r)},animate:function(t,e,n,r){function i(){o.queue===!1&&P._mark(this);var e,n,r,i,a,s,l,u,c,d=P.extend({},o),h=1===this.nodeType,f=h&&P(this).is(":hidden");d.animatedProperties={};for(r in t){if(e=P.camelCase(r),r!==e&&(t[e]=t[r],delete t[r]),n=t[e],P.isArray(n)?(d.animatedProperties[e]=n[1],n=t[e]=n[0]):d.animatedProperties[e]=d.specialEasing&&d.specialEasing[e]||d.easing||"swing","hide"===n&&f||"show"===n&&!f)return d.complete.call(this);!h||"height"!==e&&"width"!==e||(d.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY],"inline"===P.css(this,"display")&&"none"===P.css(this,"float")&&(P.support.inlineBlockNeedsLayout&&"inline"!==O(this.nodeName)?this.style.zoom=1:this.style.display="inline-block"))}null!=d.overflow&&(this.style.overflow="hidden");for(r in t)i=new P.fx(this,d,r),n=t[r],wn.test(n)?(c=P._data(this,"toggle"+r)||("toggle"===n?f?"show":"hide":0),c?(P._data(this,"toggle"+r,"show"===c?"hide":"show"),i[c]()):i[n]()):(a=Cn.exec(n),s=i.cur(),a?(l=parseFloat(a[2]),u=a[3]||(P.cssNumber[r]?"":"px"),"px"!==u&&(P.style(this,r,(l||1)+u),s=(l||1)/i.cur()*s,P.style(this,r,s+u)),a[1]&&(l=("-="===a[1]?-1:1)*l+s),i.custom(s,l,u)):i.custom(s,n,""));return!0}var o=P.speed(e,n,r);return P.isEmptyObject(t)?this.each(o.complete,[!1]):(t=P.extend({},t),o.queue===!1?this.each(i):this.queue(o.queue,i))},stop:function(t,n,r){return"string"!=typeof t&&(r=n,n=t,t=e),n&&t!==!1&&this.queue(t||"fx",[]),this.each(function(){function e(t,e,n){var i=e[n];P.removeData(t,n,!0),i.stop(r)}var n,i=!1,o=P.timers,a=P._data(this);if(r||P._unmark(!0,this),null==t)for(n in a)a[n]&&a[n].stop&&n.indexOf(".run")===n.length-4&&e(this,a,n);else a[n=t+".run"]&&a[n].stop&&e(this,a,n);for(n=o.length;n--;)o[n].elem!==this||null!=t&&o[n].queue!==t||(r?o[n](!0):o[n].saveState(),i=!0,o.splice(n,1));r&&i||P.dequeue(this,t)})}}),P.each({slideDown:M("show",1),slideUp:M("hide",1),slideToggle:M("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,e){P.fn[t]=function(t,n,r){return this.animate(e,t,n,r)}}),P.extend({speed:function(t,e,n){var r=t&&"object"==typeof t?P.extend({},t):{complete:n||!n&&e||P.isFunction(t)&&t,duration:t,easing:n&&e||e&&!P.isFunction(e)&&e};return r.duration=P.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in P.fx.speeds?P.fx.speeds[r.duration]:P.fx.speeds._default,(null==r.queue||r.queue===!0)&&(r.queue="fx"),r.old=r.complete,r.complete=function(t){P.isFunction(r.old)&&r.old.call(this),r.queue?P.dequeue(this,r.queue):t!==!1&&P._unmark(this)},r},easing:{linear:function(t,e,n,r){return n+r*t},swing:function(t,e,n,r){return(-Math.cos(t*Math.PI)/2+.5)*r+n}},timers:[],fx:function(t,e,n){this.options=e,this.elem=t,this.prop=n,e.orig=e.orig||{}}}),P.fx.prototype={update:function(){this.options.step&&this.options.step.call(this.elem,this.now,this),(P.fx.step[this.prop]||P.fx.step._default)(this)},cur:function(){if(null!=this.elem[this.prop]&&(!this.elem.style||null==this.elem.style[this.prop]))return this.elem[this.prop];var t,e=P.css(this.elem,this.prop);return isNaN(t=parseFloat(e))?e&&"auto"!==e?e:0:t},custom:function(t,n,r){function i(t){return o.step(t)}var o=this,a=P.fx;this.startTime=bn||_(),this.end=n,this.now=this.start=t,this.pos=this.state=0,this.unit=r||this.unit||(P.cssNumber[this.prop]?"":"px"),i.queue=this.options.queue,i.elem=this.elem,i.saveState=function(){o.options.hide&&P._data(o.elem,"fxshow"+o.prop)===e&&P._data(o.elem,"fxshow"+o.prop,o.start)},i()&&P.timers.push(i)&&!yn&&(yn=setInterval(a.tick,a.interval))},show:function(){var t=P._data(this.elem,"fxshow"+this.prop);this.options.orig[this.prop]=t||P.style(this.elem,this.prop),this.options.show=!0,t!==e?this.custom(this.cur(),t):this.custom("width"===this.prop||"height"===this.prop?1:0,this.cur()),P(this.elem).show()},hide:function(){this.options.orig[this.prop]=P._data(this.elem,"fxshow"+this.prop)||P.style(this.elem,this.prop),this.options.hide=!0,this.custom(this.cur(),0)},step:function(t){var e,n,r,i=bn||_(),o=!0,a=this.elem,s=this.options;if(t||i>=s.duration+this.startTime){this.now=this.end,this.pos=this.state=1,this.update(),s.animatedProperties[this.prop]=!0;for(e in s.animatedProperties)s.animatedProperties[e]!==!0&&(o=!1);if(o){if(null==s.overflow||P.support.shrinkWrapBlocks||P.each(["","X","Y"],function(t,e){a.style["overflow"+e]=s.overflow[t]}),s.hide&&P(a).hide(),s.hide||s.show)for(e in s.animatedProperties)P.style(a,e,s.orig[e]),P.removeData(a,"fxshow"+e,!0),P.removeData(a,"toggle"+e,!0);r=s.complete,r&&(s.complete=!1,r.call(a))}return!1}return 1/0==s.duration?this.now=i:(n=i-this.startTime,this.state=n/s.duration,this.pos=P.easing[s.animatedProperties[this.prop]](this.state,n,0,1,s.duration),this.now=this.start+(this.end-this.start)*this.pos),this.update(),!0}},P.extend(P.fx,{tick:function(){for(var t,e=P.timers,n=0;e.length>n;n++)t=e[n],t()||e[n]!==t||e.splice(n--,1);e.length||P.fx.stop()},interval:13,stop:function(){clearInterval(yn),yn=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(t){P.style(t.elem,"opacity",t.now)},_default:function(t){t.elem.style&&null!=t.elem.style[t.prop]?t.elem.style[t.prop]=t.now+t.unit:t.elem[t.prop]=t.now}}}),P.each(["width","height"],function(t,e){P.fx.step[e]=function(t){P.style(t.elem,e,Math.max(0,t.now)+t.unit)}}),P.expr&&P.expr.filters&&(P.expr.filters.animated=function(t){return P.grep(P.timers,function(e){return t===e.elem}).length});var An=/^t(?:able|d|h)$/i,En=/^(?:body|html)$/i;P.fn.offset="getBoundingClientRect"in R.documentElement?function(t){var e,n=this[0];if(t)return this.each(function(e){P.offset.setOffset(this,t,e)});if(!n||!n.ownerDocument)return null;if(n===n.ownerDocument.body)return P.offset.bodyOffset(n);try{e=n.getBoundingClientRect()}catch(r){}var i=n.ownerDocument,o=i.documentElement;if(!e||!P.contains(o,n))return e?{top:e.top,left:e.left}:{top:0,left:0};var a=i.body,s=D(i),l=o.clientTop||a.clientTop||0,u=o.clientLeft||a.clientLeft||0,c=s.pageYOffset||P.support.boxModel&&o.scrollTop||a.scrollTop,d=s.pageXOffset||P.support.boxModel&&o.scrollLeft||a.scrollLeft,h=e.top+c-l,f=e.left+d-u;return{top:h,left:f}}:function(t){var e=this[0];if(t)return this.each(function(e){P.offset.setOffset(this,t,e)});if(!e||!e.ownerDocument)return null;if(e===e.ownerDocument.body)return P.offset.bodyOffset(e);for(var n,r=e.offsetParent,i=e,o=e.ownerDocument,a=o.documentElement,s=o.body,l=o.defaultView,u=l?l.getComputedStyle(e,null):e.currentStyle,c=e.offsetTop,d=e.offsetLeft;(e=e.parentNode)&&e!==s&&e!==a&&(!P.support.fixedPosition||"fixed"!==u.position);)n=l?l.getComputedStyle(e,null):e.currentStyle,c-=e.scrollTop,d-=e.scrollLeft,e===r&&(c+=e.offsetTop,d+=e.offsetLeft,!P.support.doesNotAddBorder||P.support.doesAddBorderForTableAndCells&&An.test(e.nodeName)||(c+=parseFloat(n.borderTopWidth)||0,d+=parseFloat(n.borderLeftWidth)||0),i=r,r=e.offsetParent),P.support.subtractsBorderForOverflowNotVisible&&"visible"!==n.overflow&&(c+=parseFloat(n.borderTopWidth)||0,d+=parseFloat(n.borderLeftWidth)||0),u=n;return("relative"===u.position||"static"===u.position)&&(c+=s.offsetTop,d+=s.offsetLeft),P.support.fixedPosition&&"fixed"===u.position&&(c+=Math.max(a.scrollTop,s.scrollTop),d+=Math.max(a.scrollLeft,s.scrollLeft)),{top:c,left:d}},P.offset={bodyOffset:function(t){var e=t.offsetTop,n=t.offsetLeft;return P.support.doesNotIncludeMarginInBodyOffset&&(e+=parseFloat(P.css(t,"marginTop"))||0,n+=parseFloat(P.css(t,"marginLeft"))||0),{top:e,left:n}},setOffset:function(t,e,n){var r=P.css(t,"position");"static"===r&&(t.style.position="relative");var i,o,a=P(t),s=a.offset(),l=P.css(t,"top"),u=P.css(t,"left"),c=("absolute"===r||"fixed"===r)&&P.inArray("auto",[l,u])>-1,d={},h={};c?(h=a.position(),i=h.top,o=h.left):(i=parseFloat(l)||0,o=parseFloat(u)||0),P.isFunction(e)&&(e=e.call(t,n,s)),null!=e.top&&(d.top=e.top-s.top+i),null!=e.left&&(d.left=e.left-s.left+o),"using"in e?e.using.call(t,d):a.css(d)}},P.fn.extend({position:function(){if(!this[0])return null;var t=this[0],e=this.offsetParent(),n=this.offset(),r=En.test(e[0].nodeName)?{top:0,left:0}:e.offset();return n.top-=parseFloat(P.css(t,"marginTop"))||0,n.left-=parseFloat(P.css(t,"marginLeft"))||0,r.top+=parseFloat(P.css(e[0],"borderTopWidth"))||0,r.left+=parseFloat(P.css(e[0],"borderLeftWidth"))||0,{top:n.top-r.top,left:n.left-r.left}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent||R.body;t&&!En.test(t.nodeName)&&"static"===P.css(t,"position");)t=t.offsetParent;return t})}}),P.each(["Left","Top"],function(t,n){var r="scroll"+n;P.fn[r]=function(n){var i,o;return n===e?(i=this[0])?(o=D(i),o?"pageXOffset"in o?o[t?"pageYOffset":"pageXOffset"]:P.support.boxModel&&o.document.documentElement[r]||o.document.body[r]:i[r]):null:this.each(function(){o=D(this),o?o.scrollTo(t?P(o).scrollLeft():n,t?n:P(o).scrollTop()):this[r]=n})}}),P.each(["Height","Width"],function(t,n){var r=n.toLowerCase();P.fn["inner"+n]=function(){var t=this[0];return t?t.style?parseFloat(P.css(t,r,"padding")):this[r]():null},P.fn["outer"+n]=function(t){var e=this[0];return e?e.style?parseFloat(P.css(e,r,t?"margin":"border")):this[r]():null},P.fn[r]=function(t){var i=this[0];if(!i)return null==t?null:this;if(P.isFunction(t))return this.each(function(e){var n=P(this);n[r](t.call(this,e,n[r]()))});if(P.isWindow(i)){var o=i.document.documentElement["client"+n],a=i.document.body;return"CSS1Compat"===i.document.compatMode&&o||a&&a["client"+n]||o}if(9===i.nodeType)return Math.max(i.documentElement["client"+n],i.body["scroll"+n],i.documentElement["scroll"+n],i.body["offset"+n],i.documentElement["offset"+n]);if(t===e){var s=P.css(i,r),l=parseFloat(s);return P.isNumeric(l)?l:s}return this.css(r,"string"==typeof t?t:t+"px")}}),t.jQuery=t.$=P,"function"==typeof define&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return P})})(window);
(function(){function t(e,n,r){if(e===n)return 0!==e||1/e==1/n;if(null==e||null==n)return e===n;if(e._chain&&(e=e._wrapped),n._chain&&(n=n._wrapped),e.isEqual&&k.isFunction(e.isEqual))return e.isEqual(n);if(n.isEqual&&k.isFunction(n.isEqual))return n.isEqual(e);var i=u.call(e);if(i!=u.call(n))return!1;switch(i){case"[object String]":return e==n+"";case"[object Number]":return e!=+e?n!=+n:0==e?1/e==1/n:e==+n;case"[object Date]":case"[object Boolean]":return+e==+n;case"[object RegExp]":return e.source==n.source&&e.global==n.global&&e.multiline==n.multiline&&e.ignoreCase==n.ignoreCase}if("object"!=typeof e||"object"!=typeof n)return!1;for(var o=r.length;o--;)if(r[o]==e)return!0;r.push(e);var a=0,s=!0;if("[object Array]"==i){if(a=e.length,s=a==n.length)for(;a--&&(s=a in e==a in n&&t(e[a],n[a],r)););}else{if("constructor"in e!="constructor"in n||e.constructor!=n.constructor)return!1;for(var l in e)if(k.has(e,l)&&(a++,!(s=k.has(n,l)&&t(e[l],n[l],r))))break;if(s){for(l in n)if(k.has(n,l)&&!a--)break;s=!a}}return r.pop(),s}var e=this,n=e._,r={},i=Array.prototype,o=Object.prototype,a=Function.prototype,s=i.slice,l=i.unshift,u=o.toString,c=o.hasOwnProperty,d=i.forEach,h=i.map,f=i.reduce,p=i.reduceRight,g=i.filter,m=i.every,v=i.some,y=i.indexOf,b=i.lastIndexOf,w=Array.isArray,x=Object.keys,C=a.bind,k=function(t){return new M(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=k),exports._=k):e._=k,k.VERSION="1.3.1";var A=k.each=k.forEach=function(t,e,n){if(null!=t)if(d&&t.forEach===d)t.forEach(e,n);else if(t.length===+t.length){for(var i=0,o=t.length;o>i;i++)if(i in t&&e.call(n,t[i],i,t)===r)return}else for(var a in t)if(k.has(t,a)&&e.call(n,t[a],a,t)===r)return};k.map=k.collect=function(t,e,n){var r=[];return null==t?r:h&&t.map===h?t.map(e,n):(A(t,function(t,i,o){r[r.length]=e.call(n,t,i,o)}),t.length===+t.length&&(r.length=t.length),r)},k.reduce=k.foldl=k.inject=function(t,e,n,r){var i=arguments.length>2;if(null==t&&(t=[]),f&&t.reduce===f)return r&&(e=k.bind(e,r)),i?t.reduce(e,n):t.reduce(e);if(A(t,function(t,o,a){i?n=e.call(r,n,t,o,a):(n=t,i=!0)}),!i)throw new TypeError("Reduce of empty array with no initial value");return n},k.reduceRight=k.foldr=function(t,e,n,r){var i=arguments.length>2;if(null==t&&(t=[]),p&&t.reduceRight===p)return r&&(e=k.bind(e,r)),i?t.reduceRight(e,n):t.reduceRight(e);var o=k.toArray(t).reverse();return r&&!i&&(e=k.bind(e,r)),i?k.reduce(o,e,n,r):k.reduce(o,e)},k.find=k.detect=function(t,e,n){var r;return E(t,function(t,i,o){return e.call(n,t,i,o)?(r=t,!0):void 0}),r},k.filter=k.select=function(t,e,n){var r=[];return null==t?r:g&&t.filter===g?t.filter(e,n):(A(t,function(t,i,o){e.call(n,t,i,o)&&(r[r.length]=t)}),r)},k.reject=function(t,e,n){var r=[];return null==t?r:(A(t,function(t,i,o){e.call(n,t,i,o)||(r[r.length]=t)}),r)},k.every=k.all=function(t,e,n){var i=!0;return null==t?i:m&&t.every===m?t.every(e,n):(A(t,function(t,o,a){return(i=i&&e.call(n,t,o,a))?void 0:r}),i)};var E=k.some=k.any=function(t,e,n){e||(e=k.identity);var i=!1;return null==t?i:v&&t.some===v?t.some(e,n):(A(t,function(t,o,a){return i||(i=e.call(n,t,o,a))?r:void 0}),!!i)};k.include=k.contains=function(t,e){var n=!1;return null==t?n:y&&t.indexOf===y?-1!=t.indexOf(e):n=E(t,function(t){return t===e})},k.invoke=function(t,e){var n=s.call(arguments,2);return k.map(t,function(t){return(k.isFunction(e)?e||t:t[e]).apply(t,n)})},k.pluck=function(t,e){return k.map(t,function(t){return t[e]})},k.max=function(t,e,n){if(!e&&k.isArray(t))return Math.max.apply(Math,t);if(!e&&k.isEmpty(t))return-1/0;var r={computed:-1/0};return A(t,function(t,i,o){var a=e?e.call(n,t,i,o):t;a>=r.computed&&(r={value:t,computed:a})}),r.value},k.min=function(t,e,n){if(!e&&k.isArray(t))return Math.min.apply(Math,t);if(!e&&k.isEmpty(t))return 1/0;var r={computed:1/0};return A(t,function(t,i,o){var a=e?e.call(n,t,i,o):t;r.computed>a&&(r={value:t,computed:a})}),r.value},k.shuffle=function(t){var e,n=[];return A(t,function(t,r){0==r?n[0]=t:(e=Math.floor(Math.random()*(r+1)),n[r]=n[e],n[e]=t)}),n},k.sortBy=function(t,e,n){return k.pluck(k.map(t,function(t,r,i){return{value:t,criteria:e.call(n,t,r,i)}}).sort(function(t,e){var n=t.criteria,r=e.criteria;return r>n?-1:n>r?1:0}),"value")},k.groupBy=function(t,e){var n={},r=k.isFunction(e)?e:function(t){return t[e]};return A(t,function(t,e){var i=r(t,e);(n[i]||(n[i]=[])).push(t)}),n},k.sortedIndex=function(t,e,n){n||(n=k.identity);for(var r=0,i=t.length;i>r;){var o=r+i>>1;n(t[o])<n(e)?r=o+1:i=o}return r},k.toArray=function(t){return t?t.toArray?t.toArray():k.isArray(t)?s.call(t):k.isArguments(t)?s.call(t):k.values(t):[]},k.size=function(t){return k.toArray(t).length},k.first=k.head=function(t,e,n){return null==e||n?t[0]:s.call(t,0,e)},k.initial=function(t,e,n){return s.call(t,0,t.length-(null==e||n?1:e))},k.last=function(t,e,n){return null==e||n?t[t.length-1]:s.call(t,Math.max(t.length-e,0))},k.rest=k.tail=function(t,e,n){return s.call(t,null==e||n?1:e)},k.compact=function(t){return k.filter(t,function(t){return!!t})},k.flatten=function(t,e){return k.reduce(t,function(t,n){return k.isArray(n)?t.concat(e?n:k.flatten(n)):(t[t.length]=n,t)},[])},k.without=function(t){return k.difference(t,s.call(arguments,1))},k.uniq=k.unique=function(t,e,n){var r=n?k.map(t,n):t,i=[];return k.reduce(r,function(n,r,o){return 0!=o&&(e===!0?k.last(n)==r:k.include(n,r))||(n[n.length]=r,i[i.length]=t[o]),n},[]),i},k.union=function(){return k.uniq(k.flatten(arguments,!0))},k.intersection=k.intersect=function(t){var e=s.call(arguments,1);return k.filter(k.uniq(t),function(t){return k.every(e,function(e){return k.indexOf(e,t)>=0})})},k.difference=function(t){var e=k.flatten(s.call(arguments,1));return k.filter(t,function(t){return!k.include(e,t)})},k.zip=function(){for(var t=s.call(arguments),e=k.max(k.pluck(t,"length")),n=Array(e),r=0;e>r;r++)n[r]=k.pluck(t,""+r);return n},k.indexOf=function(t,e,n){if(null==t)return-1;var r,i;if(n)return r=k.sortedIndex(t,e),t[r]===e?r:-1;if(y&&t.indexOf===y)return t.indexOf(e);for(r=0,i=t.length;i>r;r++)if(r in t&&t[r]===e)return r;return-1},k.lastIndexOf=function(t,e){if(null==t)return-1;if(b&&t.lastIndexOf===b)return t.lastIndexOf(e);for(var n=t.length;n--;)if(n in t&&t[n]===e)return n;return-1},k.range=function(t,e,n){1>=arguments.length&&(e=t||0,t=0),n=arguments[2]||1;for(var r=Math.max(Math.ceil((e-t)/n),0),i=0,o=Array(r);r>i;)o[i++]=t,t+=n;return o};var T=function(){};k.bind=function(t,e){var n,r;if(t.bind===C&&C)return C.apply(t,s.call(arguments,1));if(!k.isFunction(t))throw new TypeError;return r=s.call(arguments,2),n=function(){if(!(this instanceof n))return t.apply(e,r.concat(s.call(arguments)));T.prototype=t.prototype;var i=new T,o=t.apply(i,r.concat(s.call(arguments)));return Object(o)===o?o:i}},k.bindAll=function(t){var e=s.call(arguments,1);return 0==e.length&&(e=k.functions(t)),A(e,function(e){t[e]=k.bind(t[e],t)}),t},k.memoize=function(t,e){var n={};return e||(e=k.identity),function(){var r=e.apply(this,arguments);return k.has(n,r)?n[r]:n[r]=t.apply(this,arguments)}},k.delay=function(t,e){var n=s.call(arguments,2);return setTimeout(function(){return t.apply(t,n)},e)},k.defer=function(t){return k.delay.apply(k,[t,1].concat(s.call(arguments,1)))},k.throttle=function(t,e){var n,r,i,o,a,s=k.debounce(function(){a=o=!1},e);return function(){n=this,r=arguments;var l=function(){i=null,a&&t.apply(n,r),s()};i||(i=setTimeout(l,e)),o?a=!0:t.apply(n,r),s(),o=!0}},k.debounce=function(t,e){var n;return function(){var r=this,i=arguments,o=function(){n=null,t.apply(r,i)};clearTimeout(n),n=setTimeout(o,e)}},k.once=function(t){var e,n=!1;return function(){return n?e:(n=!0,e=t.apply(this,arguments))}},k.wrap=function(t,e){return function(){var n=[t].concat(s.call(arguments,0));return e.apply(this,n)}},k.compose=function(){var t=arguments;return function(){for(var e=arguments,n=t.length-1;n>=0;n--)e=[t[n].apply(this,e)];return e[0]}},k.after=function(t,e){return 0>=t?e():function(){return 1>--t?e.apply(this,arguments):void 0}},k.keys=x||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var e=[];for(var n in t)k.has(t,n)&&(e[e.length]=n);return e},k.values=function(t){return k.map(t,k.identity)},k.functions=k.methods=function(t){var e=[];for(var n in t)k.isFunction(t[n])&&e.push(n);return e.sort()},k.extend=function(t){return A(s.call(arguments,1),function(e){for(var n in e)t[n]=e[n]}),t},k.defaults=function(t){return A(s.call(arguments,1),function(e){for(var n in e)null==t[n]&&(t[n]=e[n])}),t},k.clone=function(t){return k.isObject(t)?k.isArray(t)?t.slice():k.extend({},t):t},k.tap=function(t,e){return e(t),t},k.isEqual=function(e,n){return t(e,n,[])},k.isEmpty=function(t){if(k.isArray(t)||k.isString(t))return 0===t.length;for(var e in t)if(k.has(t,e))return!1;return!0},k.isElement=function(t){return!(!t||1!=t.nodeType)},k.isArray=w||function(t){return"[object Array]"==u.call(t)},k.isObject=function(t){return t===Object(t)},k.isArguments=function(t){return"[object Arguments]"==u.call(t)},k.isArguments(arguments)||(k.isArguments=function(t){return!(!t||!k.has(t,"callee"))}),k.isFunction=function(t){return"[object Function]"==u.call(t)},k.isString=function(t){return"[object String]"==u.call(t)},k.isNumber=function(t){return"[object Number]"==u.call(t)},k.isNaN=function(t){return t!==t},k.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"==u.call(t)},k.isDate=function(t){return"[object Date]"==u.call(t)},k.isRegExp=function(t){return"[object RegExp]"==u.call(t)},k.isNull=function(t){return null===t},k.isUndefined=function(t){return void 0===t},k.has=function(t,e){return c.call(t,e)},k.noConflict=function(){return e._=n,this},k.identity=function(t){return t},k.times=function(t,e,n){for(var r=0;t>r;r++)e.call(n,r)},k.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},k.mixin=function(t){A(k.functions(t),function(e){R(e,k[e]=t[e])})};var S=0;k.uniqueId=function(t){var e=S++;return t?t+e:e},k.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var _=/.^/,N=function(t){return t.replace(/\\\\/g,"\\").replace(/\\'/g,"'")};k.template=function(t,e){var n=k.templateSettings,r="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+t.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(n.escape||_,function(t,e){return"',_.escape("+N(e)+"),'"}).replace(n.interpolate||_,function(t,e){return"',"+N(e)+",'"}).replace(n.evaluate||_,function(t,e){return"');"+N(e).replace(/[\r\n\t]/g," ")+";__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",i=Function("obj","_",r);return e?i(e,k):function(t){return i.call(this,t,k)}},k.chain=function(t){return k(t).chain()};var M=function(t){this._wrapped=t};k.prototype=M.prototype;var O=function(t,e){return e?k(t).chain():t},R=function(t,e){M.prototype[t]=function(){var t=s.call(arguments);return l.call(t,this._wrapped),O(e.apply(k,t),this._chain)}};k.mixin(k),A(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=i[t];M.prototype[t]=function(){var n=this._wrapped;e.apply(n,arguments);var r=n.length;return"shift"!=t&&"splice"!=t||0!==r||delete n[0],O(n,this._chain)}}),A(["concat","join","slice"],function(t){var e=i[t];M.prototype[t]=function(){return O(e.apply(this._wrapped,arguments),this._chain)}}),M.prototype.chain=function(){return this._chain=!0,this},M.prototype.value=function(){return this._wrapped}}).call(this);
define("underscore", (function (global) {
    return function () {
        var ret, fn;
        return ret || global._;
    };
}(this)));

(function(){var t,e=this,n=e.Backbone,r=Array.prototype.slice,i=Array.prototype.splice;t="undefined"!=typeof exports?exports:e.Backbone={},t.VERSION="0.9.2";var o=e._;o||"undefined"==typeof require||(o=require("underscore"));var a=e.jQuery||e.Zepto||e.ender;t.setDomLibrary=function(t){a=t},t.noConflict=function(){return e.Backbone=n,this},t.emulateHTTP=!1,t.emulateJSON=!1;var s=/\s+/,l=t.Events={on:function(t,e,n){var r,i,o,a,l;if(!e)return this;for(t=t.split(s),r=this._callbacks||(this._callbacks={});i=t.shift();)l=r[i],o=l?l.tail:{},o.next=a={},o.context=n,o.callback=e,r[i]={tail:a,next:l?l.next:o};return this},off:function(t,e,n){var r,i,a,l,u,c;if(i=this._callbacks){if(!(t||e||n))return delete this._callbacks,this;for(t=t?t.split(s):o.keys(i);r=t.shift();)if(a=i[r],delete i[r],a&&(e||n))for(l=a.tail;(a=a.next)!==l;)u=a.callback,c=a.context,(e&&u!==e||n&&c!==n)&&this.on(r,u,c);return this}},trigger:function(t){var e,n,i,o,a,l,u;if(!(i=this._callbacks))return this;for(l=i.all,t=t.split(s),u=r.call(arguments,1);e=t.shift();){if(n=i[e])for(o=n.tail;(n=n.next)!==o;)n.callback.apply(n.context||this,u);if(n=l)for(o=n.tail,a=[e].concat(u);(n=n.next)!==o;)n.callback.apply(n.context||this,a)}return this}};l.bind=l.on,l.unbind=l.off;var u=t.Model=function(t,e){var n;t||(t={}),e&&e.parse&&(t=this.parse(t)),(n=S(this,"defaults"))&&(t=o.extend({},n,t)),e&&e.collection&&(this.collection=e.collection),this.attributes={},this._escapedAttributes={},this.cid=o.uniqueId("c"),this.changed={},this._silent={},this._pending={},this.set(t,{silent:!0}),this.changed={},this._silent={},this._pending={},this._previousAttributes=o.clone(this.attributes),this.initialize.apply(this,arguments)};o.extend(u.prototype,l,{changed:null,_silent:null,_pending:null,idAttribute:"id",initialize:function(){},toJSON:function(){return o.clone(this.attributes)},get:function(t){return this.attributes[t]},escape:function(t){var e;if(e=this._escapedAttributes[t])return e;var n=this.get(t);return this._escapedAttributes[t]=o.escape(null==n?"":""+n)},has:function(t){return null!=this.get(t)},set:function(t,e,n){var r,i,a;if(o.isObject(t)||null==t?(r=t,n=e):(r={},r[t]=e),n||(n={}),!r)return this;if(r instanceof u&&(r=r.attributes),n.unset)for(i in r)r[i]=void 0;if(!this._validate(r,n))return!1;this.idAttribute in r&&(this.id=r[this.idAttribute]);var s=n.changes={},l=this.attributes,c=this._escapedAttributes,d=this._previousAttributes||{};for(i in r)a=r[i],(!o.isEqual(l[i],a)||n.unset&&o.has(l,i))&&(delete c[i],(n.silent?this._silent:s)[i]=!0),n.unset?delete l[i]:l[i]=a,o.isEqual(d[i],a)&&o.has(l,i)==o.has(d,i)?(delete this.changed[i],delete this._pending[i]):(this.changed[i]=a,n.silent||(this._pending[i]=!0));return n.silent||this.change(n),this},unset:function(t,e){return(e||(e={})).unset=!0,this.set(t,null,e)},clear:function(t){return(t||(t={})).unset=!0,this.set(o.clone(this.attributes),t)},fetch:function(e){e=e?o.clone(e):{};var n=this,r=e.success;return e.success=function(t,i,o){return n.set(n.parse(t,o),e)?(r&&r(n,t),void 0):!1},e.error=t.wrapError(e.error,n,e),(this.sync||t.sync).call(this,"read",this,e)},save:function(e,n,r){var i,a;if(o.isObject(e)||null==e?(i=e,r=n):(i={},i[e]=n),r=r?o.clone(r):{},r.wait){if(!this._validate(i,r))return!1;a=o.clone(this.attributes)}var s=o.extend({},r,{silent:!0});if(i&&!this.set(i,r.wait?s:r))return!1;var l=this,u=r.success;r.success=function(t,e,n){var a=l.parse(t,n);return r.wait&&(delete r.wait,a=o.extend(i||{},a)),l.set(a,r)?(u?u(l,t):l.trigger("sync",l,t,r),void 0):!1},r.error=t.wrapError(r.error,l,r);var c=this.isNew()?"create":"update",d=(this.sync||t.sync).call(this,c,this,r);return r.wait&&this.set(a,s),d},destroy:function(e){e=e?o.clone(e):{};var n=this,r=e.success,i=function(){n.trigger("destroy",n,n.collection,e)};if(this.isNew())return i(),!1;e.success=function(t){e.wait&&i(),r?r(n,t):n.trigger("sync",n,t,e)},e.error=t.wrapError(e.error,n,e);var a=(this.sync||t.sync).call(this,"delete",this,e);return e.wait||i(),a},url:function(){var t=S(this,"urlRoot")||S(this.collection,"url")||T();return this.isNew()?t:t+("/"==t.charAt(t.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(t){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},change:function(t){t||(t={});var e=this._changing;this._changing=!0;for(var n in this._silent)this._pending[n]=!0;var r=o.extend({},t.changes,this._silent);this._silent={};for(var n in r)this.trigger("change:"+n,this,this.get(n),t);if(e)return this;for(;!o.isEmpty(this._pending);){this._pending={},this.trigger("change",this,t);for(var n in this.changed)this._pending[n]||this._silent[n]||delete this.changed[n];this._previousAttributes=o.clone(this.attributes)}return this._changing=!1,this},hasChanged:function(t){return arguments.length?o.has(this.changed,t):!o.isEmpty(this.changed)},changedAttributes:function(t){if(!t)return this.hasChanged()?o.clone(this.changed):!1;var e,n=!1,r=this._previousAttributes;for(var i in t)o.isEqual(r[i],e=t[i])||((n||(n={}))[i]=e);return n},previous:function(t){return arguments.length&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return o.clone(this._previousAttributes)},isValid:function(){return!this.validate(this.attributes)},_validate:function(t,e){if(e.silent||!this.validate)return!0;t=o.extend({},this.attributes,t);var n=this.validate(t,e);return n?(e&&e.error?e.error(this,n,e):this.trigger("error",this,n,e),!1):!0}});var c=t.Collection=function(t,e){e||(e={}),e.model&&(this.model=e.model),e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,{silent:!0,parse:e.parse})};o.extend(c.prototype,l,{model:u,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},add:function(t,e){var n,r,a,s,l,u,c={},d={},h=[];for(e||(e={}),t=o.isArray(t)?t.slice():[t],n=0,a=t.length;a>n;n++){if(!(s=t[n]=this._prepareModel(t[n],e)))throw Error("Can't add an invalid model to a collection");l=s.cid,u=s.id,c[l]||this._byCid[l]||null!=u&&(d[u]||this._byId[u])?h.push(n):c[l]=d[u]=s}for(n=h.length;n--;)t.splice(h[n],1);for(n=0,a=t.length;a>n;n++)(s=t[n]).on("all",this._onModelEvent,this),this._byCid[s.cid]=s,null!=s.id&&(this._byId[s.id]=s);if(this.length+=a,r=null!=e.at?e.at:this.models.length,i.apply(this.models,[r,0].concat(t)),this.comparator&&this.sort({silent:!0}),e.silent)return this;for(n=0,a=this.models.length;a>n;n++)c[(s=this.models[n]).cid]&&(e.index=n,s.trigger("add",s,this,e));return this},remove:function(t,e){var n,r,i,a;for(e||(e={}),t=o.isArray(t)?t.slice():[t],n=0,r=t.length;r>n;n++)a=this.getByCid(t[n])||this.get(t[n]),a&&(delete this._byId[a.id],delete this._byCid[a.cid],i=this.indexOf(a),this.models.splice(i,1),this.length--,e.silent||(e.index=i,a.trigger("remove",a,this,e)),this._removeReference(a));return this},push:function(t,e){return t=this._prepareModel(t,e),this.add(t,e),t},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t),e},unshift:function(t,e){return t=this._prepareModel(t,e),this.add(t,o.extend({at:0},e)),t},shift:function(t){var e=this.at(0);return this.remove(e,t),e},get:function(t){return null==t?void 0:this._byId[null!=t.id?t.id:t]},getByCid:function(t){return t&&this._byCid[t.cid||t]},at:function(t){return this.models[t]},where:function(t){return o.isEmpty(t)?[]:this.filter(function(e){for(var n in t)if(t[n]!==e.get(n))return!1;return!0})},sort:function(t){if(t||(t={}),!this.comparator)throw Error("Cannot sort a set without a comparator");var e=o.bind(this.comparator,this);return 1==this.comparator.length?this.models=this.sortBy(e):this.models.sort(e),t.silent||this.trigger("reset",this,t),this},pluck:function(t){return o.map(this.models,function(e){return e.get(t)})},reset:function(t,e){t||(t=[]),e||(e={});for(var n=0,r=this.models.length;r>n;n++)this._removeReference(this.models[n]);return this._reset(),this.add(t,o.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),this},fetch:function(e){e=e?o.clone(e):{},void 0===e.parse&&(e.parse=!0);var n=this,r=e.success;return e.success=function(t,i,o){n[e.add?"add":"reset"](n.parse(t,o),e),r&&r(n,t)},e.error=t.wrapError(e.error,n,e),(this.sync||t.sync).call(this,"read",this,e)},create:function(t,e){var n=this;if(e=e?o.clone(e):{},t=this._prepareModel(t,e),!t)return!1;e.wait||n.add(t,e);var r=e.success;return e.success=function(i,o){e.wait&&n.add(i,e),r?r(i,o):i.trigger("sync",t,o,e)},t.save(null,e),t},parse:function(t){return t},chain:function(){return o(this.models).chain()},_reset:function(){this.length=0,this.models=[],this._byId={},this._byCid={}},_prepareModel:function(t,e){if(e||(e={}),t instanceof u)t.collection||(t.collection=this);else{var n=t;e.collection=this,t=new this.model(n,e),t._validate(t.attributes,e)||(t=!1)}return t},_removeReference:function(t){this==t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,n,r){("add"!=t&&"remove"!=t||n==this)&&("destroy"==t&&this.remove(e,r),e&&t==="change:"+e.idAttribute&&(delete this._byId[e.previous(e.idAttribute)],this._byId[e.id]=e),this.trigger.apply(this,arguments))}});var d=["forEach","each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","sortBy","sortedIndex","toArray","size","first","initial","rest","last","without","indexOf","shuffle","lastIndexOf","isEmpty","groupBy"];o.each(d,function(t){c.prototype[t]=function(){return o[t].apply(o,[this.models].concat(o.toArray(arguments)))}});var h=t.Router=function(t){t||(t={}),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},f=/:\w+/g,p=/\*\w+/g,g=/[-[\]{}()+?.,\\^$|#\s]/g;o.extend(h.prototype,l,{initialize:function(){},route:function(e,n,r){return t.history||(t.history=new m),o.isRegExp(e)||(e=this._routeToRegExp(e)),r||(r=this[n]),t.history.route(e,o.bind(function(i){var o=this._extractParameters(e,i);r&&r.apply(this,o),this.trigger.apply(this,["route:"+n].concat(o)),t.history.trigger("route",this,n,o)},this)),this},navigate:function(e,n){t.history.navigate(e,n)},_bindRoutes:function(){if(this.routes){var t=[];for(var e in this.routes)t.unshift([e,this.routes[e]]);for(var n=0,r=t.length;r>n;n++)this.route(t[n][0],t[n][1],this[t[n][1]])}},_routeToRegExp:function(t){return t=t.replace(g,"\\$&").replace(f,"([^/]+)").replace(p,"(.*?)"),RegExp("^"+t+"$")},_extractParameters:function(t,e){return t.exec(e).slice(1)}});var m=t.History=function(){this.handlers=[],o.bindAll(this,"checkUrl")},v=/^[#\/]/,y=/msie [\w.]+/;m.started=!1,o.extend(m.prototype,l,{interval:50,getHash:function(t){var e=t?t.location:window.location,n=e.href.match(/#(.*)$/);return n?n[1]:""},getFragment:function(t,e){if(null==t)if(this._hasPushState||e){t=window.location.pathname;var n=window.location.search;n&&(t+=n)}else t=this.getHash();return t.indexOf(this.options.root)||(t=t.substr(this.options.root.length)),t.replace(v,"")},start:function(t){if(m.started)throw Error("Backbone.history has already been started");m.started=!0,this.options=o.extend({},{root:"/"},this.options,t),this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&window.history&&window.history.pushState);var e=this.getFragment(),n=document.documentMode,r=y.exec(navigator.userAgent.toLowerCase())&&(!n||7>=n);r&&(this.iframe=a('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(e)),this._hasPushState?a(window).bind("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!r?a(window).bind("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=e;var i=window.location,s=i.pathname==this.options.root;return this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!s?(this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0):(this._wantsPushState&&this._hasPushState&&s&&i.hash&&(this.fragment=this.getHash().replace(v,""),window.history.replaceState({},document.title,i.protocol+"//"+i.host+this.options.root+this.fragment)),this.options.silent?void 0:this.loadUrl())},stop:function(){a(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),m.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(){var t=this.getFragment();return t==this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe))),t==this.fragment?!1:(this.iframe&&this.navigate(t),this.loadUrl()||this.loadUrl(this.getHash()),void 0)},loadUrl:function(t){var e=this.fragment=this.getFragment(t),n=o.any(this.handlers,function(t){return t.route.test(e)?(t.callback(e),!0):void 0});return n},navigate:function(t,e){if(!m.started)return!1;e&&e!==!0||(e={trigger:e});var n=(t||"").replace(v,"");this.fragment!=n&&(this._hasPushState?(0!=n.indexOf(this.options.root)&&(n=this.options.root+n),this.fragment=n,window.history[e.replace?"replaceState":"pushState"]({},document.title,n)):this._wantsHashChange?(this.fragment=n,this._updateHash(window.location,n,e.replace),this.iframe&&n!=this.getFragment(this.getHash(this.iframe))&&(e.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,n,e.replace))):window.location.assign(this.options.root+t),e.trigger&&this.loadUrl(t))},_updateHash:function(t,e,n){n?t.replace((""+t).replace(/(javascript:|#).*$/,"")+"#"+e):t.hash=e}});var b=t.View=function(t){this.cid=o.uniqueId("view"),this._configure(t||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},x=/^(\S+)\s*(.*)$/,w=["model","collection","el","id","attributes","className","tagName"];o.extend(b.prototype,l,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this},make:function(t,e,n){var r=document.createElement(t);return e&&a(r).attr(e),n&&a(r).html(n),r},setElement:function(t,e){return this.$el&&this.undelegateEvents(),this.$el=t instanceof a?t:a(t),this.el=this.$el[0],e!==!1&&this.delegateEvents(),this},delegateEvents:function(t){if(t||(t=S(this,"events"))){this.undelegateEvents();for(var e in t){var n=t[e];if(o.isFunction(n)||(n=this[t[e]]),!n)throw Error('Method "'+t[e]+'" does not exist');var r=e.match(x),i=r[1],a=r[2];n=o.bind(n,this),i+=".delegateEvents"+this.cid,""===a?this.$el.bind(i,n):this.$el.delegate(a,i,n)}}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(t){this.options&&(t=o.extend({},this.options,t));for(var e=0,n=w.length;n>e;e++){var r=w[e];t[r]&&(this[r]=t[r])}this.options=t},_ensureElement:function(){if(this.el)this.setElement(this.el,!1);else{var t=S(this,"attributes")||{};this.id&&(t.id=this.id),this.className&&(t["class"]=this.className),this.setElement(this.make(this.tagName,t),!1)}}});var C=function(t,e){var n=E(this,t,e);return n.extend=this.extend,n};u.extend=c.extend=h.extend=b.extend=C;var k={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};t.sync=function(e,n,r){var i=k[e];r||(r={});var s={type:i,dataType:"json"};return r.url||(s.url=S(n,"url")||T()),r.data||!n||"create"!=e&&"update"!=e||(s.contentType="application/json",s.data=JSON.stringify(n.toJSON())),t.emulateJSON&&(s.contentType="application/x-www-form-urlencoded",s.data=s.data?{model:s.data}:{}),t.emulateHTTP&&("PUT"===i||"DELETE"===i)&&(t.emulateJSON&&(s.data._method=i),s.type="POST",s.beforeSend=function(t){t.setRequestHeader("X-HTTP-Method-Override",i)}),"GET"===s.type||t.emulateJSON||(s.processData=!1),a.ajax(o.extend(s,r))},t.wrapError=function(t,e,n){return function(r,i){i=r===e?i:r,t?t(e,i,n):e.trigger("error",e,i,n)}};var A=function(){},E=function(t,e,n){var r;return r=e&&e.hasOwnProperty("constructor")?e.constructor:function(){t.apply(this,arguments)},o.extend(r,t),A.prototype=t.prototype,r.prototype=new A,e&&o.extend(r.prototype,e),n&&o.extend(r,n),r.prototype.constructor=r,r.__super__=t.prototype,r},S=function(t,e){return t&&t[e]?o.isFunction(t[e])?t[e]():t[e]:null},T=function(){throw Error('A "url" property or function must be specified')}}).call(this);
define("backbone", ["underscore","jquery"], (function (global) {
    return function () {
        var ret, fn;
       fn = function (_, $) {
            _.noConflict();
            $.noConflict();
            return Backbone.noConflict();
          };
        ret = fn.apply(global, arguments);
        return ret || global.Backbone;
    };
}(this)));

(function(t,e){function n(t,e){this._d=t,this._isUTC=!!e}function r(t){return 0>t?Math.ceil(t):Math.floor(t)}function i(t){var e=this._data={},n=t.years||t.y||0,i=t.months||t.M||0,o=t.weeks||t.w||0,a=t.days||t.d||0,s=t.hours||t.h||0,l=t.minutes||t.m||0,u=t.seconds||t.s||0,c=t.milliseconds||t.ms||0;this._milliseconds=c+1e3*u+6e4*l+36e5*s,this._days=a+7*o,this._months=i+12*n,e.milliseconds=c%1e3,u+=r(c/1e3),e.seconds=u%60,l+=r(u/60),e.minutes=l%60,s+=r(l/60),e.hours=s%24,a+=r(s/24),a+=7*o,e.days=a%30,i+=r(a/30),e.months=i%12,n+=r(i/12),e.years=n}function o(t,e){for(var n=t+"";e>n.length;)n="0"+n;return n}function a(t,e,n){var r,i=e._milliseconds,o=e._days,a=e._months;i&&t._d.setTime(+t+i*n),o&&t.date(t.date()+o*n),a&&(r=t.date(),t.date(1).month(t.month()+a*n).date(Math.min(r,t.daysInMonth())))}function s(t){return"[object Array]"===Object.prototype.toString.call(t)}function l(e){return new t(e[0],e[1]||0,e[2]||1,e[3]||0,e[4]||0,e[5]||0,e[6]||0)}function u(e,n){function r(n){var v,y;switch(n){case"M":return i+1;case"Mo":return i+1+g(i+1);case"MM":return o(i+1,2);case"MMM":return x.monthsShort[i];case"MMMM":return x.months[i];case"D":return a;case"Do":return a+g(a);case"DD":return o(a,2);case"DDD":return v=new t(s,i,a),y=new t(s,0,1),~~((v-y)/864e5+1.5);case"DDDo":return v=r("DDD"),v+g(v);case"DDDD":return o(r("DDD"),3);case"d":return l;case"do":return l+g(l);case"ddd":return x.weekdaysShort[l];case"dddd":return x.weekdays[l];case"w":return v=new t(s,i,a-l+5),y=new t(v.getFullYear(),0,4),~~((v-y)/864e5/7+1.5);case"wo":return v=r("w"),v+g(v);case"ww":return o(r("w"),2);case"YY":return o(s%100,2);case"YYYY":return s;case"a":return m?m(c,d,!1):c>11?"pm":"am";case"A":return m?m(c,d,!0):c>11?"PM":"AM";case"H":return c;case"HH":return o(c,2);case"h":return c%12||12;case"hh":return o(c%12||12,2);case"m":return d;case"mm":return o(d,2);case"s":return h;case"ss":return o(h,2);case"S":return~~(f/100);case"SS":return o(~~(f/10),2);case"SSS":return o(f,3);case"Z":return(0>p?"-":"+")+o(~~(Math.abs(p)/60),2)+":"+o(~~(Math.abs(p)%60),2);case"ZZ":return(0>p?"-":"+")+o(~~(10*Math.abs(p)/6),4);case"L":case"LL":case"LLL":case"LLLL":case"LT":return u(e,x.longDateFormat[n]);default:return n.replace(/(^\[)|(\\)|\]$/g,"")}}var i=e.month(),a=e.date(),s=e.year(),l=e.day(),c=e.hours(),d=e.minutes(),h=e.seconds(),f=e.milliseconds(),p=-e.zone(),g=x.ordinal,m=x.meridiem;return n.replace(N,r)}function c(t){switch(t){case"DDDD":return D;case"YYYY":return P;case"S":case"SS":case"SSS":case"DDD":return I;case"MMM":case"MMMM":case"ddd":case"dddd":case"a":case"A":return L;case"Z":case"ZZ":return F;case"T":return B;case"MM":case"DD":case"dd":case"YY":case"HH":case"hh":case"mm":case"ss":case"M":case"D":case"d":case"H":case"h":case"m":case"s":return O;default:return RegExp(t.replace("\\",""))}}function d(t,e,n,r){var i;switch(t){case"M":case"MM":n[1]=null==e?0:~~e-1;break;case"MMM":case"MMMM":for(i=0;12>i;i++)if(x.monthsParse[i].test(e)){n[1]=i;break}break;case"D":case"DD":case"DDD":case"DDDD":n[2]=~~e;break;case"YY":e=~~e,n[0]=e+(e>70?1900:2e3);break;case"YYYY":n[0]=~~Math.abs(e);break;case"a":case"A":r.isPm="pm"===(e+"").toLowerCase();break;case"H":case"HH":case"h":case"hh":n[3]=~~e;break;case"m":case"mm":n[4]=~~e;break;case"s":case"ss":n[5]=~~e;break;case"S":case"SS":case"SSS":n[6]=~~(1e3*("0."+e));break;case"Z":case"ZZ":r.isUTC=!0,i=(e+"").match(z),i&&i[1]&&(r.tzh=~~i[1]),i&&i[2]&&(r.tzm=~~i[2]),i&&"+"===i[0]&&(r.tzh=-r.tzh,r.tzm=-r.tzm)}}function h(e,n){var r,i,o=[0,0,1,0,0,0,0],a={tzh:0,tzm:0},s=n.match(N);for(r=0;s.length>r;r++)i=(c(s[r]).exec(e)||[])[0],e=e.replace(c(s[r]),""),d(s[r],i,o,a);return a.isPm&&12>o[3]&&(o[3]+=12),a.isPm===!1&&12===o[3]&&(o[3]=0),o[3]+=a.tzh,o[4]+=a.tzm,a.isUTC?new t(t.UTC.apply({},o)):l(o)}function f(t,e){var n,r=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),o=0;for(n=0;r>n;n++)~~t[n]!==~~e[n]&&o++;return o+i}function p(t,e){var r,i,o,a,s,l=t.match(R)||[],c=99;for(o=0;e.length>o;o++)a=h(t,e[o]),i=u(new n(a),e[o]).match(R)||[],s=f(l,i),c>s&&(c=s,r=a);return r}function g(e){var n,r="YYYY-MM-DDT";if(H.exec(e)){for(n=0;4>n;n++)if($[n][1].exec(e)){r+=$[n][0];break}return F.exec(e)?h(e,r+" Z"):h(e,r)}return new t(e)}function m(t,e,n,r){var i=x.relativeTime[t];return"function"==typeof i?i(e||1,!!n,t,r):i.replace(/%d/i,e||1)}function v(t,e){var n=A(Math.abs(t)/1e3),r=A(n/60),i=A(r/60),o=A(i/24),a=A(o/365),s=45>n&&["s",n]||1===r&&["m"]||45>r&&["mm",r]||1===i&&["h"]||22>i&&["hh",i]||1===o&&["d"]||25>=o&&["dd",o]||45>=o&&["M"]||345>o&&["MM",A(o/30)]||1===a&&["y"]||["yy",a];return s[2]=e,s[3]=t>0,m.apply({},s)}function y(t,e){x.fn[t]=function(t){var n=this._isUTC?"UTC":"";return null!=t?(this._d["set"+n+e](t),this):this._d["get"+n+e]()}}function b(t){x.duration.fn[t]=function(){return this._data[t]}}function w(t,e){x.duration.fn["as"+t]=function(){return+this/e}}var x,C,k="1.6.2",A=Math.round,E={},S="en",T="undefined"!=typeof module,_="months|monthsShort|monthsParse|weekdays|weekdaysShort|longDateFormat|calendar|relativeTime|ordinal|meridiem".split("|"),M=/^\/?Date\((\-?\d+)/i,N=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|dddd?|do?|w[o|w]?|YYYY|YY|a|A|hh?|HH?|mm?|ss?|SS?S?|zz?|ZZ?|LT|LL?L?L?)/g,R=/([0-9a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+)/gi,O=/\d\d?/,I=/\d{1,3}/,D=/\d{3}/,P=/\d{4}/,L=/[0-9a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+/i,F=/Z|[\+\-]\d\d:?\d\d/i,B=/T/i,H=/^\s*\d{4}-\d\d-\d\d(T(\d\d(:\d\d(:\d\d(\.\d\d?\d?)?)?)?)?([\+\-]\d\d:?\d\d)?)?/,j="YYYY-MM-DDTHH:mm:ssZ",$=[["HH:mm:ss.S",/T\d\d:\d\d:\d\d\.\d{1,3}/],["HH:mm:ss",/T\d\d:\d\d:\d\d/],["HH:mm",/T\d\d:\d\d/],["HH",/T\d\d/]],z=/([\+\-]|\d\d)/gi,q="Month|Date|Hours|Minutes|Seconds|Milliseconds".split("|"),W={Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6};for(x=function(r,i){if(null===r||""===r)return null;var o,a,u;return x.isMoment(r)?(o=new t(+r._d),u=r._isUTC):i?o=s(i)?p(r,i):h(r,i):(a=M.exec(r),o=r===e?new t:a?new t(+a[1]):r instanceof t?r:s(r)?l(r):"string"==typeof r?g(r):new t(r)),new n(o,u)},x.utc=function(e,r){return s(e)?new n(new t(t.UTC.apply({},e)),!0):r&&e?x(e+" +0000",r+" Z").utc():x(e&&!F.exec(e)?e+"+0000":e).utc()},x.unix=function(t){return x(1e3*t)},x.duration=function(t,e){var n=x.isDuration(t),r="number"==typeof t,o=n?t._data:r?{}:t;return r&&(e?o[e]=t:o.milliseconds=t),new i(o)},x.humanizeDuration=function(t,e,n){return x.duration(t,e===!0?null:e).humanize(e===!0?!0:n)},x.version=k,x.defaultFormat=j,x.lang=function(t,e){var n,r,i=[];if(!t)return S;if(e){for(n=0;12>n;n++)i[n]=RegExp("^"+e.months[n]+"|^"+e.monthsShort[n].replace(".",""),"i");e.monthsParse=e.monthsParse||i,E[t]=e}if(E[t]){for(n=0;_.length>n;n++)x[_[n]]=E[t][_[n]]||E.en[_[n]];S=t}else T&&(r=require("./lang/"+t),x.lang(t,r))},x.lang("en",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},meridiem:!1,calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},ordinal:function(t){var e=t%10;return 1===~~(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th"}}),x.isMoment=function(t){return t instanceof n},x.isDuration=function(t){return t instanceof i},x.fn=n.prototype={clone:function(){return x(this)},valueOf:function(){return+this._d},unix:function(){return Math.floor(+this._d/1e3)},toString:function(){return""+this._d},toDate:function(){return this._d},toArray:function(){var t=this;return[t.year(),t.month(),t.date(),t.hours(),t.minutes(),t.seconds(),t.milliseconds()]},isValid:function(){var t,e;if(this._a)for(t=0;7>t;t++)if(e=(this._a[7]?x.utc(this):this).toArray(),this._a[t]!==e[t])return!1;return!isNaN(this._d.getTime())},utc:function(){return this._isUTC=!0,this},local:function(){return this._isUTC=!1,this},format:function(t){return u(this,t?t:x.defaultFormat)},add:function(t,e){var n=e?x.duration(+e,t):x.duration(t);return a(this,n,1),this},subtract:function(t,e){var n=e?x.duration(+e,t):x.duration(t);return a(this,n,-1),this},diff:function(t,e,n){var r,i=this._isUTC?x(t).utc():x(t).local(),o=6e4*(this.zone()-i.zone()),a=this._d-i._d-o,s=this.year()-i.year(),l=this.month()-i.month(),u=this.date()-i.date();return r="months"===e?12*s+l+u/30:"years"===e?s+(l+u/30)/12:"seconds"===e?a/1e3:"minutes"===e?a/6e4:"hours"===e?a/36e5:"days"===e?a/864e5:"weeks"===e?a/6048e5:a,n?r:A(r)},from:function(t,e){return x.duration(this.diff(t)).humanize(!e)},fromNow:function(t){return this.from(x(),t)},calendar:function(){var t=this.diff(x().sod(),"days",!0),e=x.calendar,n=e.sameElse,r=-6>t?n:-1>t?e.lastWeek:0>t?e.lastDay:1>t?e.sameDay:2>t?e.nextDay:7>t?e.nextWeek:n;return this.format("function"==typeof r?r.apply(this):r)},isLeapYear:function(){var t=this.year();return 0===t%4&&0!==t%100||0===t%400},isDST:function(){return this.zone()<x([this.year()]).zone()||this.zone()<x([this.year(),5]).zone()},day:function(t){var e=this._isUTC?this._d.getUTCDay():this._d.getDay();return null==t?e:this.add({d:t-e})},sod:function(){return x(this).hours(0).minutes(0).seconds(0).milliseconds(0)},eod:function(){return this.sod().add({d:1,ms:-1})},zone:function(){return this._isUTC?0:this._d.getTimezoneOffset()},daysInMonth:function(){return x(this).month(this.month()+1).date(0).date()}},C=0;q.length>C;C++)y(q[C].toLowerCase(),q[C]);y("year","FullYear"),x.duration.fn=i.prototype={weeks:function(){return r(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+2592e6*this._months},humanize:function(t){var e=+this,n=x.relativeTime,r=v(e,!t);return t&&(r=(0>=e?n.past:n.future).replace(/%s/i,r)),r}};for(C in W)W.hasOwnProperty(C)&&(w(C,W[C]),b(C.toLowerCase()));w("Weeks",6048e5),"function"==typeof define&&define.amd?define('js/lib/moment',[],function(){return x}):"undefined"!=typeof window&&"undefined"==typeof ender&&(window.moment=x)})(Date);
(function(e){var u=function(u){var t=function(t,r,n){if(arguments.length>1&&(!/Object/.test(Object.prototype.toString.call(r))||null===r||void 0===r)){if(n=u.extend({},n),(null===r||void 0===r)&&(n.expires=-1),n.path||(n.path="/"),"number"==typeof n.expires){var i=n.expires,a=n.expires=new Date;a.setDate(a.getDate()+i)}return r+="",e.document.cookie=[encodeURIComponent(t),"=",n.raw?r:encodeURIComponent(r),n.expires?"; expires="+n.expires.toUTCString():"",n.path?"; path="+n.path:"",n.domain?"; domain="+n.domain:"",n.secure?"; secure":""].join("")}n=r||{};for(var s,o=n.raw?function(e){return e}:decodeURIComponent,l=e.document.cookie.split("; "),c=0;l[c];c++)if(s=l[c].split("="),o(s[0])===t)return o(s[1]||"");return null};return{get:t,set:t,clear:function(u,r){for(var n=e.document.cookie.split("; "),i=0;n.length>i;i++){var a=n[i].indexOf("="),s=a>-1?n[i].substr(0,a):n[i];u&&u!=s||t(s,null,r)}}}};"function"==typeof define&&define.amd?define('js/lib/cookie',["jquery"],function(e){return u(e)}):e!==void 0&&"undefined"==typeof ender&&(e.Cookie=u(e.$))})(window);
(function(t){"function"==typeof define&&define.amd?define('js/lib/lucid',t):"object"!=typeof module&&"function"!=typeof module||!module.exports?window.LucidJS=t():module.exports=t()})(function(){function t(t){function e(t){function n(){if(h[t]){for(o=0;s.length>o;o+=1)h[t].splice(h[t].indexOf(s[o]),1);1>h[t].length&&delete h[t]}}function r(t,n){function r(){var t;for(t=0;a.length>t;t+=1)a[t].clear()}var i,o={},a=[];for(i=0;t.length>i;i+=1)n.unshift(t[i]),a.push(e.apply(this,n)),n.shift();return o.clear=r,o}var o,a,s=Array.prototype.slice.apply(arguments,[1]),l={};if("object"==typeof t&&"function"==typeof t.push)return r(t,s);if("emitter"!==t.slice(0,7)&&i("emitter.listener",t,s),p[t]){for(o=0;s.length>o;o+=1){if("function"!=typeof s[o])throw Error("Cannot bind event. All callbacks must be functions.");for(a=0;p[t].length>a;a+=1)s[o].apply(this,p[t][a])}return l.clear=function(){},l}for(h[t]||(h[t]=[]),o=0;s.length>o;o+=1){if("function"!=typeof s[o])throw Error("Cannot bind event. All callbacks must be functions.");h[t].push(s[o])}return l.clear=n,l}function n(t){var e,r,i=Array.prototype.slice.apply(arguments,[1]);if("object"!=typeof t||"function"!=typeof t.push){if(!h[t])throw Error('Tried to remove an event from a non-existant event of type "'+t+'".');for(e=0;i.length>e;e+=1){if("function"!=typeof i[e])throw Error("Tried to remove a non-function.");var o=h[t].indexOf(i[e]);h[t].splice(o,1)}}else for(r=0;t.length>r;r+=1)n.apply(null,[t[r]].concat(i))}function r(t){var n,r=Array.prototype.slice.apply(arguments,[1]),i=!0;return n=e(t,function(){var t,e=Array.prototype.slice.apply(arguments);for(n.clear(),t=0;r.length>t;t+=1)r[t].apply(this,e)===!1&&(i=!1);return i})}function i(t,e,n,r,o,a){function s(t,e,n,r,o,a){var s,u=!0;for(a!==void 0&&(l=Array.prototype.slice.apply(arguments,[1])),s=0;t.length>s;s+=1)l?(args.unshift(t[s]),i.apply(this,args)===!1&&(u=!1),args.shift()):i(t[s],e,n,r,o)===!1&&(u=!1);return u}var l,u,c,d=!0;if(a!==void 0&&(l=Array.prototype.slice.apply(arguments,[1])),"object"==typeof t&&"function"==typeof t.push)return l?s.apply(null,arguments):s(t,e,n,r,o);for(t=t.split(".");t.length;){if(c=h[t.join(".")],"emitter"!==t[0]&&(l?i.apply(this,[].concat("emitter.event",t.join("."),l)):i("emitter.event",e,n,r,o)),c)for(c=[].concat(c),u=0;c.length>u;u+=1)l?c[u].apply(this,l)===!1&&(d=!1):c[u](e,n,r,o)===!1&&(d=!1);t.pop()}return d}function o(t){function e(t,e){var n,r=!0;for(n=0;t.length>n;n+=1)e.unshift(t[n]),i.apply(this,e)===!1&&(r=!1),e.shift();return r}function n(){p[t]&&(p[t].splice(p[t].indexOf(r),1),1>p[t].length&&delete p[t])}var r=Array.prototype.slice.apply(arguments),o={};return"object"==typeof t&&"function"==typeof t.push?e(t,r):(i.apply(this,r),c(t),p[t]||(p[t]=[]),p[t].push(r.slice(1)),o.clear=n,o)}function a(t){t?delete p[t]:p={}}function s(t){function n(t,n){t.listenerBinding=e("emitter.listener",function(e){-1===t.events.indexOf(e)&&(t.bindings.push(r(n,e)),t.events.push(e))})}function r(t,e){return t.on(e,function(){var t=Array.prototype.slice.apply(arguments);return t.unshift(e),i.apply(this,t)})}function o(){if(y.length)for(;y.length;)y[0].clear(),y.splice(0,1)}function a(){for(;v.length;){for(v[0].listenerBinding&&v[0].listenerBinding.clear();v[0].bindings.length;)v[0].bindings[0].clear(),v[0].bindings.splice(0,1);m.splice(m.indexOf(v[0]),1),v.splice(0,1)}}var l,u,c,d,f,p={},g=Array.prototype.slice.apply(arguments),v=[],y=[];if("object"==typeof t&&"function"==typeof t.push&&"string"==typeof t[0]){for(l=0;t.length>l;l+=1)y.push(s.apply(null,[t[l]].concat(g)));return p.clear=o,p}if("object"==typeof t&&"function"==typeof t.on?t=!1:g.shift(),t!==!1&&"string"!=typeof t)throw Error("Cannot create pipe. The first argument must be an event string or an emitter.");for(u=0;g.length>u;u+=1){for(c=0;m.length>c;c+=1)if(m[c].emitter===g[u]){d=m[c];break}if((!d||2!==d.type)&&(d||(d={},d.emitter=g[u],d.bindings=[],d.events=[],d.type=t?1:2),-1===d.events.indexOf(t))){if(d.events.push(t),1===d.type)f=r(g[u],t),f.event=t,d.bindings.push(f);else if(2===d.type){for(t in h)h.hasOwnProperty(t)&&(f=g[u].on(t,r),f.event=t,d.bindings.push(f),d.events.push(t));n(d,g[u])}v.push(d),m.push(d)}}return p.clear=a,p}function l(t){var e,n;for(e=0;m.length>e;e+=1){if(t){if(2===m[e].type)continue;if(-1===m[e].events.indexOf(t))continue;m[e].events.splice(m[e].events.indexOf(t),1)}for(2===m[e].type&&m[e].listenerBinding.clear(),n=0;m[e].bindings.length>n;n+=1)t&&m[e].bindings[n].event!==t||(m[e].bindings[n].clear(),m[e].bindings.splice(n,1),n-=1);1>m[e].bindings.length&&(m.splice(e,1),e-=1)}}function u(t){return t?h[t]:h}function c(t){t?delete h[t]:h={}}function d(t){function n(){var e;for(e=0;a.length>e;e+=1)try{t.removeEventListener?t.removeEventListener(a[e].event,a[e].listener,!1):t.detachEvent&&t.detachEvent("on"+a[e].event,a[e].listener)}catch(n){console.error(n)}o=[],r.clear()}var r,o=[],a=[];r=e("emitter.listener",function(e){function n(t){var n=Array.prototype.slice.apply(arguments);n.unshift([e,"dom."+e]),i.apply(this,n)===!1&&(t.preventDefault(),t.stopPropagation())}if(!(o.indexOf(e)>-1)){o.push(e);try{t.addEventListener?(t.addEventListener(e,n,!1),a.push({event:e,listener:n})):t.attachEvent&&(t.attachEvent("on"+e,n),a.push({event:e,listener:n}))}catch(r){console.error(r)}}}),f.clearNodeEmitter=n}var f=t||{},h={},p={},m=[];return f.on||f.once||f.trigger||f.set||f.pipe||f.listeners?f:(f.on=e,f.off=n,f.once=r,f.trigger=i,f.set=o,f.set.clear=a,f.pipe=s,f.pipe.clear=l,f.listeners=u,f.listeners.clear=c,(f.addEventListener||f.attachEvent)&&d(f),f)}var e;return e={emitter:t},[].indexOf||(Array.prototype.indexOf=function(t,e,n){for(n=this.length,e=(n+~~e)%n;n>e&&(!(e in this)||this[e]!==t);e++);return e^n?e:-1}),e});
(function(){var t=function(t){var e=function(e,n,r){var i={},o=r||"";for(var a in n){var s=o+a.replace(/\./g,"-"),l=t(e).attr(s);i[a]=void 0===l?n[a]:"string"==typeof l&&0===l.length||/^\s*true\s*$/.test(l)||s==l?!0:/^\s*false\s*$/.test(l)?!1:l}return i},n={parse:e};return n};"function"==typeof define&&define.amd?define('js/lib/data.attributes',["jquery"],function(e){return t(e)}):"undefined"!=typeof window&&"undefined"==typeof ender&&(window.DataAttributes=t(window.$))})();
(function(){var t=function(t,i,o,e){var a=0,s=1,n={defaults:{"bind.open":"click","bind.close":"click","bind.action":"click","attribute.open":"data-modal","attribute.close":"data-modal-close","attribute.iframe":"data-modal-iframe","attribute.action":"data-modal-action","animate.modal.open":null,"animate.modal.close":null,"animate.modal.duration":250,"animate.overlay.open":null,"animate.overlay.close":null,"animate.overlay.duration":250,"overlay.show":!0,"overlay.class":"overlay","overlay.close":!0,"z.index":9999,"position.top":"50%","position.left":"50%",position:"fixed","iframe.autoclose":!0},$overlay:null,count:0,prevScroll:null,prevModal:null,getModal:function(i,o){var e=t(i).data("modal.me");return e&&e.constructor==r.prototype.constructor?o?e.customize(o):e:null},makeModal:function(i,o){var e=t(i),a=n.getModal(e);return a||(a=new r(e,o),e.data("modal.me",a)),a},setOverlayHeight:function(){t(window).height()<t(document).height()?n.$overlay.css({height:t(document).height()+"px"}):n.$overlay.css({height:"100%"})},observeKeyPress:function(t){(27==t.keyCode||27==t.DOM_VK_ESCAPE&&0===t.which)&&(this.emitter.trigger("action",!1,this),this.close())},actionTrigger:function(i){var o=t(i.currentTarget),e=o.attr(this.options["attribute.action"]);this.emitter.trigger("action",e,this)},open:function(){if("fixed"!=this.options.position&&(n.prevScroll={top:t(document).scrollTop(),left:t(document).scrollLeft()},window.scrollTo(0,0)),this.$iframe){var i=this.options["iframe.url"]||t(this.anchor).attr(this.options["attribute.iframe"]);this.$iframe.attr("src",i),this.$iframe.focus()}else this.$el.focus();this.state=s,this.$el.on(this.options["bind.action"],"["+this.options["attribute.action"]+"]",o.bind(n.actionTrigger,this)),this.emitter.trigger("open")},close:function(){var t=this.$el.find("iframe");this.$el.off(".modal").hide(),this.options["iframe.autoclose"]&&t.size()&&t.attr({src:"about:blank"}),n.prevScroll&&(window.scrollTo(n.prevScroll.left,n.prevScroll.top),n.prevScroll=null),this.anchor=null,this.$parent.append(this.$el),this.state=a,this.emitter.trigger("close")}},r=function(o,e){this.$el=t(o),this.state=a,this.$parent=this.$el.parent(),this.customize(e),this.emitter=i.emitter(this)};r.prototype.customize=function(t){return this.options=o.extend({},e.parse(this.$el,n.defaults,"data-modal-"),t),this},r.prototype.open=function(){var i,e=this;return this.anchor&&(i=t(this.anchor).attr(this.options["attribute.iframe"])),this.options["iframe.url"]&&(i=this.options["iframe.url"]),i&&(this.$iframe=this.$el.find("iframe"),/^https?:\/\/|^\/|^\.\.\//.test(i)&&(this.$iframe.size()&&this.$iframe.attr("src")==i||(this.$iframe.attr("src","about:blank").remove(),this.$iframe=t("<iframe>").css({height:"100%",width:"100%"}).attr({scrolling:"no",frameborder:0}),this.$el.append(this.$iframe),this.state!=a&&this.$iframe.attr("src",i)))),this.state==a?(this.options["overlay.show"]&&(n.$overlay&&"none"!=n.$overlay.css("display")&&n.$overlay.hasClass(this.options["overlay.class"])?this.$overlay=n.$overlay:(n.$overlay&&n.$overlay.off(".modal").hide().remove(),this.$overlay=n.$overlay=t("<div>").addClass(this.options["overlay.class"]).hide(),this.$overlay.css({position:"fixed",width:"100%",top:0,left:0,right:0,bottom:0,zIndex:this.options["z.index"]++}),t("body").append(this.$overlay)),n.setOverlayHeight(),this.reposition(),this.options["animate.overlay.open"]?this.$overlay.animate(this.options["animate.overlay.open"],{duration:this.options["animate.overlay.duration"]}):this.$overlay.show(),n.count++,this.$overlay.data("modal",this)),this.emitter.trigger("opening"),("fixed"!=this.options.position||0===this.$el.closest("html").length)&&this.$el.appendTo("body"),this.reposition(),this.$el.show(),this.options["animate.modal.open"]?this.$el.animate(this.options["animate.modal.open"],{duration:this.options["animate.modal.duration"],complete:function(){n.open.call(e)}}):n.open.call(this),t(window).on("resize.modal",o.bind(n.setOverlayHeight,e)).on("resize.modal",o.bind(e.reposition,e)).on("scroll.modal",o.bind(e.reposition,e)),this.options["overlay.close"]&&(t(window).on("keyup.modal",o.bind(n.observeKeyPress,e)),this.$overlay.on(this.options["bind.close"]+".modal",function(){e.emitter.trigger("action",!1,e),e.close()})),this.options["attribute.close"]&&this.$el.on(this.options["bind.close"]+".modal","["+this.options["attribute.close"]+"]",function(i){var o=t(i.currentTarget);"disabled"!=o.attr("disabled")&&(void 0===o.attr(e.options["attribute.action"])&&e.emitter.trigger("action",!1,e),e.close())}),this):void 0},r.prototype.reposition=function(){var t=this.options["position.left"],i=this.options["position.top"];return t&&this.$el.css({position:this.options.position,left:t,marginLeft:/%/.test(t)?-1*(this.$el.outerWidth()/2):0,zIndex:this.options["z.index"]++}),i&&this.$el.css({position:this.options.position,top:i,marginTop:/%/.test(i)?-1*(this.$el.outerHeight()/2):0,zIndex:this.options["z.index"]++}),this},r.prototype.close=function(){var i=this;if(this.state==s)return this.$el.off(".modal"),t(window).off(".modal"),this.emitter.trigger("closing"),this.options["animate.modal.close"]?this.$el.animate(this.options["animate.modal.close"],{duration:this.options["animate.modal.duration"],complete:function(){n.close.call(i)}}):n.close.call(this),0===--n.count&&this.options["overlay.show"]&&this.$overlay&&(this.$overlay.off(".modal"),this.options["animate.overlay.close"]?this.$overlay.animate(this.options["animate.overlay.close"],{duration:this.options["animate.overlay.duration"],complete:function(){this.$overlay.hide().remove()}}):this.$overlay.hide().remove()),this};var l=function(){return n.getModal.apply(null,arguments)||n.makeModal.apply(this,arguments)};return l.start=function(i,a){var s=t(i),r=o.extend({},n.defaults,a);s.data("modals-initialized")||(s.data("modals-initialized",1),s.on(r["bind.open"]+".modal","["+r["attribute.open"]+"]",function(i){var a=t(this),l=a.attr(r["attribute.open"]),h=s.find(l);r=o.extend({},r,e.parse(h,n.defaults,"data-modal-"));var d=n.getModal(h,r)||n.makeModal(h,r);!/^https?:\/\/|^\/|^\.\.\//.test(a.attr("href"))||i.ctrlKey||i.metaKey||i.preventDefault(),d.anchor=this,n.prevModal=h[0],d.open()}))},l.stop=function(i){var o=t(i);o.unbind(".modal"),o.data("modals-initialized",0),n.prevModal&&r(n.prevModal).close()},l.start("body"),l};"function"==typeof define&&define.amd?define('js/lib/modals',["jquery","js/lib/lucid","underscore","js/lib/data.attributes"],function(i,o,e,a){return t(i,o,e,a)}):"undefined"!=typeof window&&"undefined"==typeof ender&&(window.Modal=t(window.$,window.LucidJS,window._,window.DataAttributes))})();
(function(r){function e(r){return null!==r}var t={};Array.isArray||(Array.isArray=function(r){return"[object Array]"==Object.prototype.toString.call(r)}),Object.keys||(Object.keys=function(r){var e=[];for(var t in r)r.hasOwnProperty(t)&&e.push(t);return e}),t.merge=function(r,t){var n=r["class"],a=t["class"];(n||a)&&(n=n||[],a=a||[],Array.isArray(n)||(n=[n]),Array.isArray(a)||(a=[a]),n=n.filter(e),a=a.filter(e),r["class"]=n.concat(a).join(" "));for(var s in t)"class"!=s&&(r[s]=t[s]);return r},t.attrs=function(r,e){var n=[],a=r.terse;delete r.terse;var s=Object.keys(r),i=s.length;if(i){n.push("");for(var o=0;i>o;++o){var c=s[o],u=r[c];"boolean"==typeof u||null===u?u&&(a?n.push(c):n.push(c+'="'+c+'"')):0===c.indexOf("data")&&"string"!=typeof u?n.push(c+"='"+JSON.stringify(u)+"'"):"class"==c&&Array.isArray(u)?n.push(c+'="'+t.escape(u.join(" "))+'"'):e&&e[c]?n.push(c+'="'+t.escape(u)+'"'):n.push(c+'="'+u+'"')}}return n.join(" ")},t.escape=function(r){return(r+"").replace(/&(?!(\w+|\#\d+);)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},t.rethrow=function(r,e,t){if(!e)throw r;throw r.path=e,r.message=(e||"Jade")+":"+t+"\n"+3+"\n\n"+r.message,r},"function"==typeof define&&define.amd?define('js/lib/jade',[],function(){return t}):r.jade={helpers:t,templates:{}}})(window);
(function(wndw){var jadify=function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{})buf.push('<div class="hide confirm-navigation modal"><div class="modal-header"><h3>Confirm Navigation</h3></div><div class="modal-body"><div class="confirm-navigation-message"></div><div>Are you sure you want to leave this page?</div></div><div class="modal-footer"><button data-modal-close="data-modal-close" class="btn confirm-navigation-stay">Stay on this Page</button><button data-modal-close="data-modal-close" class="btn btn-danger confirm-navigation-leave">Leave this Page</button></div></div>');return buf.join("")}};"function"==typeof define&&define.amd?define('js/core/confirmNavigation.html',["js/lib/jade"],function(t){return jadify(t)}):wndw.jade.templates.confirmNavigation=jadify(wndw.jade.helpers)})(window);
define('js/core/origami',["jquery","underscore","backbone","require","js/lib/modals","js/core/confirmNavigation.html"],function(t,e,n,r,o,a){n.View.prototype._super=function(t){return this.constructor.__super__[t].apply(this,e.rest(arguments))};var i=null,l={current:null,body:"#origami",views:{},beforeUnloadMessage:"There are unsaved changes that will be lost if you reload or leave this page.",regionHasUnsavedModel:function(t){if(!t)return!1;var e=t.view.hasUnsavedModel?t.view.hasUnsavedModel():!1;if(e)return!0;for(var n in t.regions){var r=t.regions[n];if(l.regionHasUnsavedModel(r))return!0}return!1}},s=n.Router.extend({initialize:function(){var e=this;e.routePrefix="",e.linkClass="internal",t("body").on("click","a.internal",function(n){n.ctrlKey||n.metaKey||(n.preventDefault(),e.navigate(t(n.currentTarget).attr("href"),!0))}),this.$confirmNavigation=t(a()),t("body").append(this.$confirmNavigation),t(window).on("beforeunload.origami",function(){return l.regionHasUnsavedModel(l.current)?l.beforeUnloadMessage:void 0})},setupLinks:function(e,n){var r=this;this.routePrefix=e,this.linkClass=n,t("body").on("click","a."+this.linkClass,function(e){e.ctrlKey||e.metaKey||(e.preventDefault(),r.navigateTo(t(e.currentTarget).attr("href"),!0))})},navigateTo:function(t,e){this.navigate(t.replace(this.routePrefix,""),e)},navigate:function(e,r){if(l.current&&l.regionHasUnsavedModel(l.current)){var a=t(".confirm-navigation-message");a.text(l.beforeUnloadMessage);var i=t(".confirm-navigation-leave");i.one("click",function(){n.Router.prototype.navigate.call(this,e,r)});var s={"overlay.class":"coursera-overlay"};o(".confirm-navigation",s).open()}else n.Router.prototype.navigate.call(this,e,r)},addRoutes:function(t){var e=this;for(var r in t)e.route(r,r,t[r]),e.route(r+"/",r+"/",function(){var t=n.history.getFragment(),r=t.replace(/\/(?:\?.*)*$/,"");e.navigate(r,{trigger:!0,replace:!0})})}}),u={resize:function(e,n,r){t("body").append(n.$el.css({visibility:"hidden"}));var o={from:e.$el.outerHeight(),to:n.$el.outerHeight()};e.$el.animate({height:o.to},300,function(){e.$el.replaceWith(n.$el.css({visibility:"visible"})),n.$el.find("img").on("load",function(){n.$el.animate({height:n.$el.outerHeight()})}),r&&r()})},slideLeft:function(e,n,r){var o=e.$el,a=n.$el,i=o.position(),l=o.outerWidth(),s=o.outerHeight(),u=t("<div>").css({position:"relative",width:l,height:s}),c={position:a.css("absolute")||"static",width:a.get(0).style.width,left:a.get(0).style.left},d={position:o.css("absolute")||"static",width:o.get(0).style.width,left:o.get(0).style.left};o.wrap(u),o.css({width:l,left:i.left,position:"absolute"}),a.css({width:l,left:i.left+l,position:"absolute"}),o.parent().append(a),o.animate({left:-l},{duration:500,step:function(t){a.css({left:i.left+l+t})},complete:function(){a.css(c),o.css(d).hide(),o.unwrap(),r&&r()}})},slideRight:function(e,n,r){var o=e.$el,a=n.$el,i=o.position(),l=o.outerWidth(),s=o.outerHeight(),u=t("<div>").css({position:"relative",width:l,height:s}),c={position:a.css("absolute")||"static",width:a.get(0).style.width,left:a.get(0).style.left},d={position:o.css("absolute")||"static",width:o.get(0).style.width,left:o.get(0).style.left};o.wrap(u),o.css({width:l,left:i.left,position:"absolute"}),a.css({width:l,left:-(i.left+l),position:"absolute"}),o.parent().append(a),o.animate({left:l},{duration:500,step:function(t){a.css({left:-(i.left+l)+t})},complete:function(){a.css(c),o.css(d).hide(),o.unwrap(),r&&r()}})},replace:function(t,e,n){t.$el.replaceWith(e.el),n&&n()}},c=function(e,n){var r=this,o=n||{};r.type=e,r.animate=o.animate||{},r.regions=o.regions||{},r.initialize=o.initialize||{},r.options={},r.id=o.id||e.prototype.name,r.name=e.prototype.name,r.view=null,r.regions=t.extend(!0,{},e.prototype.subregions,o.regions||{})};c.prototype.close=function(t){var n=this;e.each(n.regions,function(e,r){delete n.regions[r],e.close(t)}),t||n.view.remove(),n.view.undelegateEvents(),n.view.trigger("view:closed"),n.view.off("view")},c.prototype.closing=function(){this.view.trigger("view:closing"),delete l.views[this.view.cid]},c.prototype.render=function(t){var n=this;return e.each(n.regions,function(t){t&&(t.render(),t.parent=n)}),n.view=new n.type(n.initialize),n.view.region=n,n.view.render(n.render),t&&n.view.on("view:appended",function(){t.trigger("region:appended",{name:n.name})}),n},c.prototype.appended=function(){var t=this;t.view&&setTimeout(function(){t.view.trigger("view:appended")},0)},c.prototype.append=function(t,e){var n=this;this.regions||(this.regions={});var r=function(r){for(var o,a=t,l=0;n.regions[a];)a+=++l;return n.regions[a]=r,r.render(i),o=e.to?n.view.$(e.to):n.view.$el,o.append(r.view.el),r.appended(),i.trigger("region:rendered",{name:r}),r};"string"==typeof t?i.region.fetch(t,e,r):r(new c(t,e))},c.prototype.is=function(t){return t.type==this.type&&t.id==this.id},c.prototype.replace=function(t,n){var r=this,o="replace",a={incoming:t.view.animate,outgoing:r.view.animate};e.isString(a.incoming)?o=a.incoming:e.isFunction(a.incoming)?o=a.incoming():e.isString(a.outgoing)?o=a.outgoing:e.isFunction(a.outgoing)&&(o=a.outgoing()),u[o]||(o="replace"),u[o](r.view,t.view,n)},c.prototype.merge=function(t,n){var r=this;r.is(t)?e.each(t.regions,function(t,e){r.regions[e].view.trigger("view:merging",t.initialize),r.regions[e].merge(t,n),r.regions[e].view.trigger("view:merged",t.initialize)}):r.name==t.name&&(r.closing(),t.render(n),r.replace(t,function(){r.parent&&(r.parent.regions[t.name]=t,t.parent=r.parent,r.parent.appended()),r.close(),t.appended()}))};var d=function(n,o){if(i)return i;i=this;var a=this;l.body=n,l.current=o,t(window).on("resize",function(){for(var t in l.views)l.views[t].trigger("view:resize")}),this.region={make:function(t,e){return new c(t,e)},fetch:function(t,n,o){var i=e.uniqueId();a.trigger("region:fetching",{name:t,uid:i}),r([t],function(e){a.trigger("region:fetched",{name:t,uid:i}),o(new c(e,n))})},append:function(t,e,n,r){t||(t={regions:{}});var o=function(n){for(var o=e,i=0;t.regions[o];)o+=++i;return t.regions[o]=n,n.render(a),r&&r(n),n.appended(),a.trigger("region:rendered",{name:n}),n};return"string"!=typeof e?o(new c(e,n)):(a.region.fetch(e,n,o),void 0)},open:function(n,r){var o=n,i={};e.isObject(n)&&(o=e.keys(n)[0],i=n[o]),a.region.fetch(o,i,r||function(n){var r=e(n.regions).filter(function(t){return t}),o=e.after(e.keys(r||{}).length,function(){if(l.current){if(l.current.is(n))return l.current.merge(n,a),void 0;if(l.current.name==n.name)return n.render(a),l.current.replace(n,function(){l.current.close(),l.current=n,l.current.appended()}),void 0;l.current.close(!0)}l.current=n,t(l.body).html(l.current.render(a).view.el),l.current.appended(),e.each(l.current.regions,function(t){t&&t.appended()})});e.each(n.regions,function(t,e){t&&a.region.open(t,function(t){n.regions[e]=t,o(a)})})})}},this.animate=u,this.router=new s,this.store={},this.tracker=[]};return e.extend(d.prototype,n.Events),d});
(function(wndw) {    var config = {"environment":"production","out":"js/core/config.js","log":"error","debug":false,"url":{"maestro":"/maestro/api/","base":"https://www.coursera.org/","api":"/maestro/api/","cloudfront_api":"https://d1hpa2gdx2lr6r.cloudfront.net/maestro/api/","assets":"https://d2wvvaown1ul17.cloudfront.net/site-static/","app_assets":"https://d2wvvaown1ul17.cloudfront.net/site-static/8be561f5d56b20136c99ea175f81d0a2cc74b164/"},"version":"8be561f5d56b20136c99ea175f81d0a2cc74b164","dir":{"home":"/"},"gapi_eventing_data":{"project_number":"274249572679","api_key":"","client_id":"274249572679-al8nc3ttcavj0n91due232a3h6s3r9vk.apps.googleusercontent.com"},"bigquery":{"dataset":"mydataset","table_prefix":"livedata_"}};   if(typeof define === "function" && define.amd) {     define('js/core/config',[], function() {       return config;     });   } else {     return wndw.configure = config;    }})(window);
define('js/lib/supports',[],function(){var t={},e="supports-";return document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#Image","1.1")&&(document.documentElement.className=e+"svg",t.svg=!0),window.XMLHttpRequest&&"withCredentials"in new window.XMLHttpRequest&&0>navigator.userAgent.indexOf("MSIE 10.0")&&(t.cors=!0),t});
(function(){var t=function(t){var e={loadScript:function(t,e,o){var n=document.createElement("script"),i=document.getElementsByTagName("script");n.type="text/javascript",n.async=!0,n.src=t,o&&(n.innerHTML=o),e&&(n.onload=n.onreadystatechange=function(){n.onreadystatechange=n.onload=null,e()}),i&&i.length?i[0].parentNode.insertBefore(n,i[0]):window.document&&window.document.body&&window.document.body.appendChild(n)},isDefined:function(t,e){for(var o=e.split("."),n=o.shift(),i=t;n;)i[n]?(i=i[n],n=o.shift()):(i=null,n=null);return null!==i},ready:function(n,s){if(e.isDefined(window,n))s.call();else{var a=n.split(".")[0];t.isArray(o[n])?o[n].push(s):(o[n]=[s],i[a].call(null,n))}}},o={},n=function(t){if(e.isDefined(window,t))for(t.split(".")[0];o[t]&&o[t].length;)o[t].pop().call();else window.setTimeout(function(){n(t)},100)},i={IN:function(t){var o="itsThirdPartyTime"+(new Date).getTime();window[o]=function(){delete window[o],n(t)},e.loadScript("https://platform.linkedin.com/in.js",function(){},"onLoad:"+o+"\napi_key: "+"v7ah6tdxsqt6")},google:function(t){var o;/^google\.maps.places/.test(t)&&(o="itsThirdPartyTime"+(new Date).getTime(),window[o]=function(){delete window[o],n(t)},e.loadScript("https://maps.googleapis.com/maps/api/js?sensor=false&key=AIzaSyCzodUI0p0hH-8n6tZ45vMNlaNfKEpuEMU&libraries=places&callback="+o)),/^google\.maps\.Map/.test(t)&&(o="itsThirdPartyTime"+(new Date).getTime(),window[o]=function(){delete window[o],n(t)},e.loadScript("https://maps.googleapis.com/maps/api/js?sensor=false&key=AIzaSyCzodUI0p0hH-8n6tZ45vMNlaNfKEpuEMU&callback="+o))},FB:function(t){e.loadScript("https://connect.facebook.net/en_US/all.js#xfbml=1&appId=274998519252278",function(){n(t)})},gapi:function(t){window.___gcfg={lang:"en-US",parsetags:"explicit"},e.loadScript("https://apis.google.com/js/plusone.js",function(){delete window.___gcfg,n(t)})},twttr:function(t){e.loadScript("https://platform.twitter.com/widgets.js",function(){n(t)})},MathJax:function(t){e.loadScript("https://d2265nx4vomwra.cloudfront.net/2.1/MathJax.js?delayStartupUntil=configured",function(){n(t)})}};return e};"function"==typeof define&&define.amd?define('js/lib/third-parties',["underscore","jquery"],function(e,o){return t(e,o)}):window.thirdparties=t(window._,window.$)})(window);
(function(t){var e=function(){t.console=t.console||{},t.console.log=t.console.log||function(){},t.console.error=t.console.error||function(){},t.console.warn=t.console.warn||function(){},t.console.info=t.console.info||function(){};var e=function(t){this.options=t||{}};e.prototype.customize=function(t){return this.options=t||{},this},e.prototype.info=function(){return"info"==this.options.level&&t.console.info.apply(t.console,arguments),this},e.prototype.warn=function(){return/info|warn/.test(this.options.level)&&t.console.warn.apply(t.console,arguments),this},e.prototype.error=function(){return/error|warn|info/.test(this.options.level)&&t.console.error.apply(t.console,arguments),this};var u=function(t){return new e(t)};return u};"function"==typeof define&&define.amd?define('js/lib/log',[],function(){return e()}):t!==void 0&&"undefined"==typeof ender&&(t.Log=e())})(window);
(function(){var JSON;JSON||(JSON={});var json=function(){function f(t){return 10>t?"0"+t:t}function quote(t){return escapable.lastIndex=0,escapable.test(t)?'"'+t.replace(escapable,function(t){var e=meta[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}function str(t,e){var n,r,i,o,a,s=gap,u=e[t];switch(u&&"object"==typeof u&&"function"==typeof u.toJSON&&(u=u.toJSON(t)),"function"==typeof rep&&(u=rep.call(e,t,u)),typeof u){case"string":return quote(u);case"number":return isFinite(u)?u+"":"null";case"boolean":case"null":return u+"";case"object":if(!u)return"null";if(gap+=indent,a=[],"[object Array]"===Object.prototype.toString.apply(u)){for(o=u.length,n=0;o>n;n+=1)a[n]=str(n,u)||"null";return i=0===a.length?"[]":gap?"[\n"+gap+a.join(",\n"+gap)+"\n"+s+"]":"["+a.join(",")+"]",gap=s,i}if(rep&&"object"==typeof rep)for(o=rep.length,n=0;o>n;n+=1)"string"==typeof rep[n]&&(r=rep[n],i=str(r,u),i&&a.push(quote(r)+(gap?": ":":")+i));else for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(i=str(r,u),i&&a.push(quote(r)+(gap?": ":":")+i));return i=0===a.length?"{}":gap?"{\n"+gap+a.join(",\n"+gap)+"\n"+s+"}":"{"+a.join(",")+"}",gap=s,i}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(t,e,n){var r;if(gap="",indent="","number"==typeof n)for(r=0;n>r;r+=1)indent+=" ";else"string"==typeof n&&(indent=n);if(rep=e,e&&"function"!=typeof e&&("object"!=typeof e||"number"!=typeof e.length))throw Error("JSON.stringify");return str("",{"":t})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(t,e){var n,r,i=t[e];if(i&&"object"==typeof i)for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r=walk(i,n),void 0!==r?i[n]=r:delete i[n]);return reviver.call(t,e,i)}var j;if(text+="",cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})};"function"==typeof define&&define.amd?define('js/lib/json2',[],function(){return json(),JSON}):"undefined"!=typeof window&&"undefined"==typeof ender&&(json(),window.JSON=JSON)})();
(function(t){var e=function(t){var e=function(t){var e=t||{};this.trackers={},this.logger=e.logger||Log({level:"error"})};e.prototype.register=function(t,e,u,o){this.trackers[t]={queue:e||[],type:u||"key-value",parse:o}},e.prototype.get=function(t){return this.trackers[t]},e.prototype.push=function(){for(var e=arguments,u=0;e.length>u;u++){var o=t.isArray(e[u])?e[u]:[e[u]];for(var n in this.trackers)if("google"==this.trackers[n].type){var i,r=[];switch(o[0]){case"pageview":for(r=["_trackPageview"],i=1;o.length>i;i++)r.push(t.isString(o[i])?o[i]:JSON.stringify(o[i]));break;case"event":for(r=["_trackEvent"],i=1;o.length>i;i++)r.push(t.isString(o[i])?o[i]:JSON.stringify(o[i]));break;default:for(r=["_trackEvent"],i=0;o.length>i;i++)r.push(t.isString(o[i])?o[i]:JSON.stringify(o[i]))}this.trackers[n].queue.push(r)}else if("key-value"==this.trackers[n].type){for(var s=[],a=1;o.length>a;a++)s.push(t.isString(o[a])?o[a]:JSON.stringify(o[a]));s.length?this.trackers[n].queue.push({key:o[0],value:s.join(".")}):this.trackers[n].queue.push({key:o[0]})}else"custom"==this.trackers[n].type&&this.trackers[n].parse&&this.trackers[n].queue.push(this.trackers[n].parse.apply(this,o));this.logger.info.apply(this.logger,o)}};var u=function(t){return new e(t)};return u};"function"==typeof define&&define.amd?define('js/lib/multitracker',["underscore","js/lib/json2"],function(t){return e(t)}):t.MultiTracker=e(t._)})(window);
define('js/core/coursera',["js/core/origami","js/core/config","jquery","underscore","backbone","js/lib/supports","js/lib/third-parties","js/lib/log","js/lib/multitracker"],function(e,r,t,o,n,a,s,i,c){var u=new e("#origami");return u.config=r,u.supports=a,u.log=i({level:r.log}),window.onerror=function(e,r,t){if(r=r||window.location.href,void 0!==t&&null!=t){e.target&&e.type&&(e=e.type),e.indexOf||(e="Non-string, non-event error: "+typeof e);var o={message:e,script:r,line:t,url:document.URL};u.multitracker.push(["page.error.javascript",o])}},requirejs.onError=function(e){u.multitracker.push(["page.error.requirejs",{url:location.href,message:e.message,type:e.requireType,modules:e.requireModules}]);var r=e.message.match(/context:\s*(.*)\s*\n/);if(r&&"_"==r[1]){var o="<div>oooops! something unexpected happened, please <a href='"+location.href+"'>refresh</a> your browser</div>",n=t("<div>").addClass("fullscreen");u.message.add(t(o).addClass("message")),n.appendTo("body").show()}},u.multitracker=c({logger:u.log}),u.multitracker.register("204",[]),u.multitracker.register("ga",window._gaq=[],"google"),t(document).ready(function(){/staging|production/.test(u.config.environment)&&(requirejs.config({context:"204js",paths:{_204:"https://eventing.coursera.org/204.min"}})(["_204"],function(e){e&&(u.multitracker.get("204").queue=e.batch(u.multitracker.get("204").queue))}),u.multitracker.get("ga").queue.push(["_setAccount","UA-28377374-1"],["_setDomainName","coursera.org"],["_setAllowLinker",!0],["_trackPageview"]),s.loadScript(("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js",function(){u.multitracker.get("ga").queue=window._gaq})),u.router.on("all",function(){u.multitracker.push(["pageview",u.config.dir.home+n.history.getFragment()])})}),n.noConflict(),t.noConflict(),o.noConflict(),u});
define('js/lib/util',["jquery","underscore","js/lib/moment","js/lib/cookie","js/core/coursera"],function(u,e,t,r,a){function n(u,e){404==u?a.router.trigger("error",404,e,{message:"this page does not exist"}):500==u?a.router.trigger("error",500,e,{message:"backend server has seen an error"}):401==u?a.router.navigate("/account/signin?r="+e,{trigger:!0,replace:!0}):403==u&&a.router.trigger("error",403,e,{message:"you do not have permission to view this page"})}function s(u){if(u){var e=/(?:https?:\/\/)?((?:[\d\w\-\.]+?\.)?[\w\d]+(?:\.[\w]+)?)(\/.*)?$/,t=e.exec(u),r=(t&&t.length?t[1]:"").split("."),n=e.exec(location.host)[1].split(".");r&&r.length&&r[r.length-1]==n[n.length-1]&&r[r.length-2]==n[n.length-2]?location.href=u:/^\/.*/.test(u)?location.href=u:a.router.navigate(a.config.dir.home,!0)}}function o(e,t){var r=e.find('[data-section="'+t+'"]');if(r.length){var n=r.position().top,s=Math.abs(u(document).scrollTop()-n);s>1e3?u("html,body").scrollTop(n):u("html,body").animate({scrollTop:n}),a.multitracker&&a.multitracker.push([document.title.split(" |")[0]+" "+t,"Open"])}}function i(u){u.bind("view:appended",function(){o(u.$el,this.options.section)}),u.$el.on("click","a.internal-page",function(e){if(!e.ctrlKey&&!e.metaKey){var t=e.currentTarget.pathname,r=t.substr(t.lastIndexOf("/")+1);u.$("[data-section="+r+"]").length&&(e.preventDefault(),o(u.$el,r),a.router.navigateTo(t,{trigger:!1}))}})}function E(u){return u.length>1?u.slice(0,-1).join(", ")+" and "+u[u.length-1]:""+u}function l(u,e){if(!u)return"";if(e>=u.length)return u;var t=e-3,r=u.lastIndexOf(" ",t);return(-1==r||e/2>r)&&(r=t),u.substr(0,r)+"..."}function c(u){return u.replace(/^http:\/\//i,"https://")}function g(u,e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t="[\\?&]"+e+"=([^&#]*)",r=RegExp(t),a=r.exec(unescape(u));return null===a?null:a[1]}function d(u,e,t){var r=RegExp("([?&])"+e+"=.*(&|$)","i");return separator=-1!==u.indexOf("?")?"&":"?",u.match(r)?u.replace(r,"$1"+e+"="+t+"$2"):u+separator+e+"="+t}function f(t,r,n){function s(u){var e=c.attr("data-"+u+"-message");c.html(e)}function o(){var u=t.find('input[type="checkbox"]').filter("[required]");return u.length&&!u.is(":checked")?(c.attr("disabled","disabled"),void 0):(c.removeAttr("disabled"),s("default"),void 0)}function i(){l=t.serialize();var e=(r.type||"POST").toLowerCase();a.api[e]&&a.api[e](r.url,{data:r.data||t.serialize()||null,headers:r.headers||{},dataType:r.dataType||"json"}).done(function(u,e,a){r.success&&r.success(u,e,a),s("success"),g.html("(Saved!)"),A(t,null)}).fail(function(e,a,n){var s=u.parseJSON(e.responseText);r.error&&r.error(e,a,n),o(),t.find("input").off(".validate"),A(t,s)})}function E(){t.serialize()!=l&&(c.trigger("click"),g.html("(Saving...)"))}r=r||{};var l=t.serialize();r.url=r.url||t.attr("action"),r.type=r.type||t.attr("type");var c=t.find('button[type="submit"]'),g=u(c.attr("data-update"));t.find("input, select").on("change",o),t.find("input, textarea").on("keyup",o);var d=t.find("input, select");d.each(function(e,t){e!=d.length-1&&u(t).on("keypress",function(u){return 13!=u.keyCode})});var f="true"==t.attr("data-validate");if(f&&t.find("input").each(function(){var e=u(this);"checkbox"!=e.attr("type")&&(e.on("keyup.validate",function(){F(e)||b(e,null)}),e.on("blur.validate paste.validate",function(){b(e,F(e))}))}),c.on("click",function(u){u.preventDefault(),(!f||f&&!h(t))&&(s("inflight"),c.attr("disabled","disabled"),i(r))}),n){var p=e.debounce(E,1e3);t.find("input, select").on("change.autosave",p),t.find("input, textarea").on("keyup.autosave",p),t.find("input, select, blur").on("blur.autosave paste.autosave",E)}}function h(e){var t=null;if(e.find("input").each(function(){var e=u(this),r=F(e);b(e,r),t=t||r,r&&!t&&0===u("input:focus").length&&e.focus()}),t){var r=e.attr("data-invalid-message")||"Uh-oh, please check the form!";p(e,r),e.find('button[type="submit"]').animate({opacity:.4},100).animate({"margin-left":"-=10"},100).animate({"margin-left":"+=20"},100).animate({"margin-left":"-=20"},100).animate({"margin-left":"+=10"},100).animate({opacity:1},100)}return t}function F(u){var e=u.attr("type"),t=u.val(),r=u.attr("pattern"),a=null,n=null;return"email"==e?n=RegExp(/[a-zA-Z0-9!#$%&'*+\/=?\^_`{|}~\-]+(?:\.[a-zA-Z0-9!#$%&'*+\/=?\^_`{|}~\-]+)*@(?:[a-zA-Z0-9](?:[a-zA-Z0-9\-]*[a-zA-Z0-9])?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9\-]*[a-zA-Z0-9])?/):r&&(n=RegExp(r)),n&&(n.test(t)||(a=u.attr("data-invalid-message")||"Invalid field")),u.attr("required")&&("text"==e&&0===t.length&&(a="This field is required."),"checkbox"!=e||u.is(":checked")||(a="â¬ Please check this!")),a}function A(u,e){if(u.find(".form-errors").remove(),u.find(".error .help-inline").remove(),u.find(".error").removeClass("error"),e&&(e.error_message&&p(u,e.error_message),e.field_errors))for(var t in e.field_errors){var r=u.find('*[name="'+t+'"]');b(r,e.field_errors[t]),r.focus()}}function p(e,t){e.find(".form-errors").remove(),$errorsDom=u("<span></span>").addClass("form-errors").attr("role","alert").attr("aria-live","assertive").html(t),e.find(".actions").length?e.find(".actions").children(":last").after($errorsDom):e.find(".modal-footer").length?e.find(".modal-footer").children(":last").after($errorsDom):e.find('button[type="submit"]')&&e.find('button[type="submit"]').after($errorsDom)}function b(e,t){var r=e.parents(".control-mini-group").length&&e.parents(".control-mini-group")||e.parents(".control-group");if(r.removeClass("error"),r.find(".help-inline.error").remove(),t){var a=(e.attr("id")||"")+"-form-field-error-"+(new Date).getTime(),n=(e.attr("aria-describedby")||"").split(",");if(n.push(a),e.attr("aria-describedby",n.join(",")),$errorsDom=u("<span></span>").addClass("help-inline error").attr("role","alert").attr("aria-live","assertive").attr("id",a),t instanceof Array)for(var s=0;t.length>s;s++)$errorsDom.append("<span>"+t[s]+"</span>");else $errorsDom.append(t);r.addClass("error"),"checkbox"==e.attr("type")?r.find(".controls").append($errorsDom):e.after($errorsDom)}}function C(){var u=navigator.userAgent||navigator.vendor||window.opera;return/iPhone|iPod|iPad|Android|BlackBerry|Opera Mini|IEMobile/.test(u)}function v(){var u=navigator.userAgent||navigator.vendor||window.opera;return/iPhone|iPod|iPad/.test(u)}function m(){return"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch}function D(){var u=document.createElement("canvas");return!(!u.getContext||!u.getContext("2d"))}function B(e,t,r){var a="meta["+e+"='"+t+"']",n=u(a);if(0===n.length){var s="<meta "+e+'="'+t+'" />';n=u(s).appendTo("head")}n.attr("content",r)}function y(){var e=window.innerHeight,t=document.compatMode;return(t||!u.support.boxModel)&&(e="CSS1Compat"==t?document.documentElement.clientHeight:document.body.clientHeight),e}function w(u,e){e=e||0;var t=y(),r=document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop,a=r-e,n=r+t+e,s=u.offset().top,o=u.height(),i=s+o;return n>i&&i>a}function k(u){var t=0,r=["cs-programming","cs-systems","cs-theory","cs-ai","cs","fmgb"];return u.each(function(u){u.get("topic")&&e.intersection(u.get("topic").get("category-ids"),r).length>0&&t++}),t}function x(){var e=u("[data-promo-id]");e.each(function(){var e=u(this);if(e.find(".close").length){var t=e.attr("data-promo-id");r.get(t)?e.hide():(e.show(),e.find(".close").on("click",function(){e.hide(),r.set(t,"closed")}))}})}function T(u){var e=t.unix(u.attr("datetime"));6e4>Math.abs(t().diff(e))?u.text("just now"):u.text(e.fromNow()),u.attr("title",e.format("dddd, MMMM Do YYYY, h:mm a Z"))}function j(u){return u=u.replace(/^.*:\/\//,""),u=u.replace(/\/$/,"")}function M(u){var t=u.text(),r=0,a=function(){u.prop("scrollHeight")>u.height()+6&&(r+=1,u.text(t.slice(0,t.length-r)),u.append("&hellip;"),e.defer(a))};e.defer(a)}function I(u){return u&&(u=u.replace(/((https?\:\/\/)|(www\.))(\S+)(\w{2,4})(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/gi,function(u){var e=u;return e.match("^https?://")||(e="http://"+e),'<a target="_blank" href="'+e+'">'+u+"</a>"})),u}function $(u,e,t){u/=255,e/=255,t/=255;var r,a,n=Math.max(u,e,t),s=Math.min(u,e,t),o=(n+s)/2;if(n==s)r=a=0;else{var i=n-s;switch(a=o>.5?i/(2-n-s):i/(n+s),n){case u:r=(e-t)/i+(t>e?6:0);break;case e:r=(t-u)/i+2;break;case t:r=(u-e)/i+4}r/=6}return[r,a,o]}function z(u,e,t){var r,a,n;if(0===e)r=a=n=t;else{var s=function(u,e,t){return 0>t&&(t+=1),t>1&&(t-=1),1/6>t?u+6*(e-u)*t:.5>t?e:2/3>t?u+6*(e-u)*(2/3-t):u},o=.5>t?t*(1+e):t+e-t*e,i=2*t-o;r=s(i,o,u+1/3),a=s(i,o,u),n=s(i,o,u-1/3)}return[Math.round(255*r),Math.round(255*a),Math.round(255*n)]}function _(u,e,t){u/=255,e/=255,t/=255;var r,a,n=Math.max(u,e,t),s=Math.min(u,e,t),o=n,i=n-s;if(a=0===n?0:i/n,n==s)r=0;else{switch(n){case u:r=(e-t)/i+(t>e?6:0);break;case e:r=(t-u)/i+2;break;case t:r=(u-e)/i+4}r/=6}return[r,a,o]}function S(u,e,t){var r,a,n,s=Math.floor(6*u),o=6*u-s,i=t*(1-e),E=t*(1-o*e),l=t*(1-(1-o)*e);switch(s%6){case 0:r=t,a=l,n=i;break;case 1:r=E,a=t,n=i;break;case 2:r=i,a=t,n=l;break;case 3:r=i,a=E,n=t;break;case 4:r=l,a=i,n=t;break;case 5:r=t,a=i,n=E}return[Math.round(255*r),Math.round(255*a),Math.round(255*n)]}function O(u,t,r){var a=e.groupBy(u,t);return a=e.sortBy(a,r)}function P(u,e){for(var t=Math.ceil(u.length/e),r=[],a=0;u.length>a;a+=t)r.push(u.slice(a,a+t));return r}function Z(u,e){e.css("position","relative"),e.css("top",u.height()/2-e.height()/2)}function H(u){var e=u.first_name;return u.middle_name&&(e=e+" "+u.middle_name),u.last_name&&(e=e+" "+u.last_name),e}function R(u){switch(u){case"en":return"English";case"zh-Hant":return"Chinese";case"zh-Hans":return"Chinese";case"it":return"Italian";case"fr":return"French";case"es":return"Spanish"}}function V(u){for(var e=0;L.length>e;e++)u=u.replace(L[e].letters,L[e].base);return u}var L=[{base:"A",letters:/[\u0041\u24B6\uFF21\u00C0\u00C1\u00C2\u1EA6\u1EA4\u1EAA\u1EA8\u00C3\u0100\u0102\u1EB0\u1EAE\u1EB4\u1EB2\u0226\u01E0\u00C4\u01DE\u1EA2\u00C5\u01FA\u01CD\u0200\u0202\u1EA0\u1EAC\u1EB6\u1E00\u0104\u023A\u2C6F]/g},{base:"AA",letters:/[\uA732]/g},{base:"AE",letters:/[\u00C6\u01FC\u01E2]/g},{base:"AO",letters:/[\uA734]/g},{base:"AU",letters:/[\uA736]/g},{base:"AV",letters:/[\uA738\uA73A]/g},{base:"AY",letters:/[\uA73C]/g},{base:"B",letters:/[\u0042\u24B7\uFF22\u1E02\u1E04\u1E06\u0243\u0182\u0181]/g},{base:"C",letters:/[\u0043\u24B8\uFF23\u0106\u0108\u010A\u010C\u00C7\u1E08\u0187\u023B\uA73E]/g},{base:"D",letters:/[\u0044\u24B9\uFF24\u1E0A\u010E\u1E0C\u1E10\u1E12\u1E0E\u0110\u018B\u018A\u0189\uA779]/g},{base:"DZ",letters:/[\u01F1\u01C4]/g},{base:"Dz",letters:/[\u01F2\u01C5]/g},{base:"E",letters:/[\u0045\u24BA\uFF25\u00C8\u00C9\u00CA\u1EC0\u1EBE\u1EC4\u1EC2\u1EBC\u0112\u1E14\u1E16\u0114\u0116\u00CB\u1EBA\u011A\u0204\u0206\u1EB8\u1EC6\u0228\u1E1C\u0118\u1E18\u1E1A\u0190\u018E]/g},{base:"F",letters:/[\u0046\u24BB\uFF26\u1E1E\u0191\uA77B]/g},{base:"G",letters:/[\u0047\u24BC\uFF27\u01F4\u011C\u1E20\u011E\u0120\u01E6\u0122\u01E4\u0193\uA7A0\uA77D\uA77E]/g},{base:"H",letters:/[\u0048\u24BD\uFF28\u0124\u1E22\u1E26\u021E\u1E24\u1E28\u1E2A\u0126\u2C67\u2C75\uA78D]/g},{base:"I",letters:/[\u0049\u24BE\uFF29\u00CC\u00CD\u00CE\u0128\u012A\u012C\u0130\u00CF\u1E2E\u1EC8\u01CF\u0208\u020A\u1ECA\u012E\u1E2C\u0197]/g},{base:"J",letters:/[\u004A\u24BF\uFF2A\u0134\u0248]/g},{base:"K",letters:/[\u004B\u24C0\uFF2B\u1E30\u01E8\u1E32\u0136\u1E34\u0198\u2C69\uA740\uA742\uA744\uA7A2]/g},{base:"L",letters:/[\u004C\u24C1\uFF2C\u013F\u0139\u013D\u1E36\u1E38\u013B\u1E3C\u1E3A\u0141\u023D\u2C62\u2C60\uA748\uA746\uA780]/g},{base:"LJ",letters:/[\u01C7]/g},{base:"Lj",letters:/[\u01C8]/g},{base:"M",letters:/[\u004D\u24C2\uFF2D\u1E3E\u1E40\u1E42\u2C6E\u019C]/g},{base:"N",letters:/[\u004E\u24C3\uFF2E\u01F8\u0143\u00D1\u1E44\u0147\u1E46\u0145\u1E4A\u1E48\u0220\u019D\uA790\uA7A4]/g},{base:"NJ",letters:/[\u01CA]/g},{base:"Nj",letters:/[\u01CB]/g},{base:"O",letters:/[\u004F\u24C4\uFF2F\u00D2\u00D3\u00D4\u1ED2\u1ED0\u1ED6\u1ED4\u00D5\u1E4C\u022C\u1E4E\u014C\u1E50\u1E52\u014E\u022E\u0230\u00D6\u022A\u1ECE\u0150\u01D1\u020C\u020E\u01A0\u1EDC\u1EDA\u1EE0\u1EDE\u1EE2\u1ECC\u1ED8\u01EA\u01EC\u00D8\u01FE\u0186\u019F\uA74A\uA74C]/g},{base:"OI",letters:/[\u01A2]/g},{base:"OO",letters:/[\uA74E]/g},{base:"OU",letters:/[\u0222]/g},{base:"P",letters:/[\u0050\u24C5\uFF30\u1E54\u1E56\u01A4\u2C63\uA750\uA752\uA754]/g},{base:"Q",letters:/[\u0051\u24C6\uFF31\uA756\uA758\u024A]/g},{base:"R",letters:/[\u0052\u24C7\uFF32\u0154\u1E58\u0158\u0210\u0212\u1E5A\u1E5C\u0156\u1E5E\u024C\u2C64\uA75A\uA7A6\uA782]/g},{base:"S",letters:/[\u0053\u24C8\uFF33\u1E9E\u015A\u1E64\u015C\u1E60\u0160\u1E66\u1E62\u1E68\u0218\u015E\u2C7E\uA7A8\uA784]/g},{base:"T",letters:/[\u0054\u24C9\uFF34\u1E6A\u0164\u1E6C\u021A\u0162\u1E70\u1E6E\u0166\u01AC\u01AE\u023E\uA786]/g},{base:"TZ",letters:/[\uA728]/g},{base:"U",letters:/[\u0055\u24CA\uFF35\u00D9\u00DA\u00DB\u0168\u1E78\u016A\u1E7A\u016C\u00DC\u01DB\u01D7\u01D5\u01D9\u1EE6\u016E\u0170\u01D3\u0214\u0216\u01AF\u1EEA\u1EE8\u1EEE\u1EEC\u1EF0\u1EE4\u1E72\u0172\u1E76\u1E74\u0244]/g},{base:"V",letters:/[\u0056\u24CB\uFF36\u1E7C\u1E7E\u01B2\uA75E\u0245]/g},{base:"VY",letters:/[\uA760]/g},{base:"W",letters:/[\u0057\u24CC\uFF37\u1E80\u1E82\u0174\u1E86\u1E84\u1E88\u2C72]/g},{base:"X",letters:/[\u0058\u24CD\uFF38\u1E8A\u1E8C]/g},{base:"Y",letters:/[\u0059\u24CE\uFF39\u1EF2\u00DD\u0176\u1EF8\u0232\u1E8E\u0178\u1EF6\u1EF4\u01B3\u024E\u1EFE]/g},{base:"Z",letters:/[\u005A\u24CF\uFF3A\u0179\u1E90\u017B\u017D\u1E92\u1E94\u01B5\u0224\u2C7F\u2C6B\uA762]/g},{base:"a",letters:/[\u0061\u24D0\uFF41\u1E9A\u00E0\u00E1\u00E2\u1EA7\u1EA5\u1EAB\u1EA9\u00E3\u0101\u0103\u1EB1\u1EAF\u1EB5\u1EB3\u0227\u01E1\u00E4\u01DF\u1EA3\u00E5\u01FB\u01CE\u0201\u0203\u1EA1\u1EAD\u1EB7\u1E01\u0105\u2C65\u0250]/g},{base:"aa",letters:/[\uA733]/g},{base:"ae",letters:/[\u00E6\u01FD\u01E3]/g},{base:"ao",letters:/[\uA735]/g},{base:"au",letters:/[\uA737]/g},{base:"av",letters:/[\uA739\uA73B]/g},{base:"ay",letters:/[\uA73D]/g},{base:"b",letters:/[\u0062\u24D1\uFF42\u1E03\u1E05\u1E07\u0180\u0183\u0253]/g},{base:"c",letters:/[\u0063\u24D2\uFF43\u0107\u0109\u010B\u010D\u00E7\u1E09\u0188\u023C\uA73F\u2184]/g},{base:"d",letters:/[\u0064\u24D3\uFF44\u1E0B\u010F\u1E0D\u1E11\u1E13\u1E0F\u0111\u018C\u0256\u0257\uA77A]/g},{base:"dz",letters:/[\u01F3\u01C6]/g},{base:"e",letters:/[\u0065\u24D4\uFF45\u00E8\u00E9\u00EA\u1EC1\u1EBF\u1EC5\u1EC3\u1EBD\u0113\u1E15\u1E17\u0115\u0117\u00EB\u1EBB\u011B\u0205\u0207\u1EB9\u1EC7\u0229\u1E1D\u0119\u1E19\u1E1B\u0247\u025B\u01DD]/g},{base:"f",letters:/[\u0066\u24D5\uFF46\u1E1F\u0192\uA77C]/g},{base:"g",letters:/[\u0067\u24D6\uFF47\u01F5\u011D\u1E21\u011F\u0121\u01E7\u0123\u01E5\u0260\uA7A1\u1D79\uA77F]/g},{base:"h",letters:/[\u0068\u24D7\uFF48\u0125\u1E23\u1E27\u021F\u1E25\u1E29\u1E2B\u1E96\u0127\u2C68\u2C76\u0265]/g},{base:"hv",letters:/[\u0195]/g},{base:"i",letters:/[\u0069\u24D8\uFF49\u00EC\u00ED\u00EE\u0129\u012B\u012D\u00EF\u1E2F\u1EC9\u01D0\u0209\u020B\u1ECB\u012F\u1E2D\u0268\u0131]/g},{base:"j",letters:/[\u006A\u24D9\uFF4A\u0135\u01F0\u0249]/g},{base:"k",letters:/[\u006B\u24DA\uFF4B\u1E31\u01E9\u1E33\u0137\u1E35\u0199\u2C6A\uA741\uA743\uA745\uA7A3]/g},{base:"l",letters:/[\u006C\u24DB\uFF4C\u0140\u013A\u013E\u1E37\u1E39\u013C\u1E3D\u1E3B\u017F\u0142\u019A\u026B\u2C61\uA749\uA781\uA747]/g},{base:"lj",letters:/[\u01C9]/g},{base:"m",letters:/[\u006D\u24DC\uFF4D\u1E3F\u1E41\u1E43\u0271\u026F]/g},{base:"n",letters:/[\u006E\u24DD\uFF4E\u01F9\u0144\u00F1\u1E45\u0148\u1E47\u0146\u1E4B\u1E49\u019E\u0272\u0149\uA791\uA7A5]/g},{base:"nj",letters:/[\u01CC]/g},{base:"o",letters:/[\u006F\u24DE\uFF4F\u00F2\u00F3\u00F4\u1ED3\u1ED1\u1ED7\u1ED5\u00F5\u1E4D\u022D\u1E4F\u014D\u1E51\u1E53\u014F\u022F\u0231\u00F6\u022B\u1ECF\u0151\u01D2\u020D\u020F\u01A1\u1EDD\u1EDB\u1EE1\u1EDF\u1EE3\u1ECD\u1ED9\u01EB\u01ED\u00F8\u01FF\u0254\uA74B\uA74D\u0275]/g},{base:"oi",letters:/[\u01A3]/g},{base:"ou",letters:/[\u0223]/g},{base:"oo",letters:/[\uA74F]/g},{base:"p",letters:/[\u0070\u24DF\uFF50\u1E55\u1E57\u01A5\u1D7D\uA751\uA753\uA755]/g},{base:"q",letters:/[\u0071\u24E0\uFF51\u024B\uA757\uA759]/g},{base:"r",letters:/[\u0072\u24E1\uFF52\u0155\u1E59\u0159\u0211\u0213\u1E5B\u1E5D\u0157\u1E5F\u024D\u027D\uA75B\uA7A7\uA783]/g},{base:"s",letters:/[\u0073\u24E2\uFF53\u00DF\u015B\u1E65\u015D\u1E61\u0161\u1E67\u1E63\u1E69\u0219\u015F\u023F\uA7A9\uA785\u1E9B]/g},{base:"t",letters:/[\u0074\u24E3\uFF54\u1E6B\u1E97\u0165\u1E6D\u021B\u0163\u1E71\u1E6F\u0167\u01AD\u0288\u2C66\uA787]/g},{base:"tz",letters:/[\uA729]/g},{base:"u",letters:/[\u0075\u24E4\uFF55\u00F9\u00FA\u00FB\u0169\u1E79\u016B\u1E7B\u016D\u00FC\u01DC\u01D8\u01D6\u01DA\u1EE7\u016F\u0171\u01D4\u0215\u0217\u01B0\u1EEB\u1EE9\u1EEF\u1EED\u1EF1\u1EE5\u1E73\u0173\u1E77\u1E75\u0289]/g},{base:"v",letters:/[\u0076\u24E5\uFF56\u1E7D\u1E7F\u028B\uA75F\u028C]/g},{base:"vy",letters:/[\uA761]/g},{base:"w",letters:/[\u0077\u24E6\uFF57\u1E81\u1E83\u0175\u1E87\u1E85\u1E98\u1E89\u2C73]/g},{base:"x",letters:/[\u0078\u24E7\uFF58\u1E8B\u1E8D]/g},{base:"y",letters:/[\u0079\u24E8\uFF59\u1EF3\u00FD\u0177\u1EF9\u0233\u1E8F\u00FF\u1EF7\u1E99\u1EF5\u01B4\u024F\u1EFF]/g},{base:"z",letters:/[\u007A\u24E9\uFF5A\u017A\u1E91\u017C\u017E\u1E93\u1E95\u01B6\u0225\u0240\u2C6C\uA763]/g}];return{handleAPIError:n,handleRedirect:s,setupInternalLinks:i,truncateText:l,setupFormSave:f,renderAllErrors:A,renderFieldErrors:b,isMobileDevice:C,isIOS:v,isTouchSupported:m,isCanvasSupported:D,scrollToInternalLink:o,makeHttps:c,prettyJoin:E,getUrlParam:g,changeUrlParam:d,setMetaTag:B,inView:w,countCS:k,setupPromos:x,prettifyTime:T,prettifyUrl:j,truncateElemText:M,linkifyText:I,rgbToHsl:$,hslToRgb:z,rgbToHsv:_,hsvToRgb:S,verticalCenterEl:Z,sortedGroupBy:O,splitIntoGroups:P,concatName:H,languageCodeToName:R,removeDiacritics:V}});
(function(e){var t=0,s=function(e,s,i,o){var r={defaults:{type:"normal","csrf.token":"X-CSRFToken","csrf.cookie":"csrftoken","csrf.path":null,"csrf.domain":null,"emulate.patch":!0,"emulate.put":!1,"emulate.delete":!1},csrfGet:function(){var e=i.get(this.options["csrf.cookie"]);return e?e:r.csrfSet.call(this,r.csrfMake())},csrfClear:function(){i.clear(this.options["csrf.cookie"],{secure:this.options["csrf.secure"],path:this.options["csrf.path"],domain:this.options["csrf.domain"]})},csrfSet:function(e){return i.set(this.options["csrf.cookie"],e,{secure:this.options["csrf.secure"],path:this.options["csrf.path"],domain:this.options["csrf.domain"],expires:new Date((new Date).getTime()+6e4)}),e},csrfMake:function(e,t){var s=[];t=t||"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",e=e||24;for(var i=0;e>i;i++)s.push(t[Math.floor(Math.random()*t.length)]);return s.join("")},invoke:function(i,o){var a,n=o||{};a=0!==i.indexOf("http")?this.root+i:i,this.trigger("before",a,n);var c="GET"==n.type?n.data:null,d=function(e,t){this.remove(t.options.id)},u=n.message||{},p=u.codes?s.keys(u.codes):[],f=this.options.message,l=this;delete n.message,"GET"!=n.type&&s.isUndefined(n.processData)&&"rest"==this.options.type&&(n.contentType="application/json; charset=utf-8",n.processData=!1,n.data=JSON.stringify(n.data)),n.beforeSend=function(){t++};var h=e.ajax(a,n);if(f){if(u.waiting){var y=f.add(e("<div>").append(u.waiting).addClass("waiting"),{delay:100});h.always(function(){f.remove(y)})}(u.success||u.codes&&300>s.min(p))&&h.done(function(t){u.codes&&u.codes[t.status]?f.add(e("<div>").append(u.codes[t.status]).addClass("success"),{timeout:500}):u.success&&f.add(e("<div>").append(u.success).addClass("success"),{timeout:500})}),(u.error||u.timeout||u.codes&&s.max(p)>=300)&&h.fail(function(t,s){u.timeout&&"timeout"==s?f.add(e("<div>").append(u.timeout).addClass("error"),{events:{click:d}}):u.codes&&u.codes[t.status]?f.add(e("<div>").append(u.codes[jsXHR.status]).addClass("error"),{events:{click:d}}):u.error&&f.add(e("<div>").append(u.error).addClass("error"),{events:{click:d}})})}var T=(new Date).getTime();return l.trigger("send",{xhr:h,url:a}),h.always(function(){0===--t&&r.csrfClear.call(l),l.trigger("always",{xhr:h,url:a,params:c,timing:(new Date).getTime()-T})}),h.fail(function(){l.trigger("fail",{xhr:h,url:a,params:c})}),h},restify:function(e,t){var s=t||{};switch(s.data=s.data||{},s.headers=s.headers||{},e){case"POST":s.type="POST";break;case"PATCH":this.options["emulate.patch"]?(s.type="POST",s.headers["X-HTTP-Method-Override"]="PATCH"):s.type="PATCH";break;case"PUT":this.options["emulate.put"]?(s.type="POST",s.headers["X-HTTP-Method-Override"]="PUT"):s.type="PUT";break;case"DELETE":this.options["emulate.delete"]?(s.type="POST",s.headers["X-HTTP-Method-Override"]="DELETE"):s.type="DELETE";break;default:s.type="GET"}return"GET"!=s.type&&(s.headers[this.options["csrf.token"]]=r.csrfGet.call(this)),s}},a=function(e,t){this.root=e,this.options=s.extend({},r.defaults,t)};return a.prototype.get=function(e,t){return r.invoke.call(this,e,r.restify.call(this,"GET",t))},a.prototype.patch=function(e,t){return r.invoke.call(this,e,r.restify.call(this,"PATCH",t))},a.prototype["delete"]=function(e,t){return r.invoke.call(this,e,r.restify.call(this,"DELETE",t))},a.prototype.post=function(e,t){return r.invoke.call(this,e,r.restify.call(this,"POST",t))},a.prototype.put=function(e,t){return r.invoke.call(this,e,r.restify.call(this,"PUT",t))},s.extend(a.prototype,o.Events),function(e,t){return new a(e,t)}};"function"==typeof define&&define.amd?define('js/lib/api',["jquery","underscore","js/lib/cookie","backbone","js/lib/json2"],function(e,t,i,o){return s(e,t,i,o)}):e.API=s(e.$,e._,e.Cookie,e.Backbone)})(window);
define('js/lib/asyncMessages',["jquery","underscore","js/lib/cookie","backbone"],function(t,e,n,i){var r={defaults:{selector:null},defaults_item:{timeout:0},item_remove:function(t){var n=e.indexOf(this.stack,t.options.id);if(-1!=n){this.stack.splice(n,1);for(var i in t.options.events)t.$ele.off(i+".asyncMessage");t.$ele.remove()}delete this.items[t.options.id]},item_show:function(t){var e=this;if(this.stack.length){var n=this.items[this.stack[0]];n&&n.$ele.remove()}this.$container.append(t.$ele),this.trigger("showing",t.$ele),this.$container.show(),this.stack.unshift(t.options.id),this.trigger("show",t),t.options.timeout&&setTimeout(function(){e.trigger("hiding",t),e.remove(t.options.id),e.trigger("hide",t)},t.options.timeout);for(var i in t.options.events)t.$ele.on(i+".asyncMessage",function(n){t.options.events[i].call(e,n,t)})}},o=function(e,n){this.options=t.extend({},r.defaults,n),this.$ele=t(e||t("<div>").appendTo("body")),this.$container=this.options.selector?this.$ele.find(this.options.selector):this.$ele,this.stack=[],this.items={}};return o.prototype.add=function(n,i){var o=t(n),a=t.extend({},r.defaults_item,i),s=this;if(a.id=a.id||e.uniqueId(),e.has(this.items,a.id))return a.id;this.items[a.id]={$ele:o,options:a,timer:null};var u=function(){s.stack.length||s.trigger("opening"),r.item_show.call(s,s.items[a.id]),1==s.stack.length&&s.trigger("open")};return a.delay?this.items[a.id].timer=setTimeout(u,a.delay):u(),a.id},o.prototype.remove=function(t){var e=this.items[t];if(e)if(clearTimeout(e.timer),1==this.stack.length)this.trigger("closing"),r.item_remove.call(this,e),this.$container.hide(),this.trigger("close");else{if(this.stack.length){var n=this.items[this.stack.shift()];n&&r.item_show.call(this,n)}r.item_remove.call(this,e)}},e.extend(o.prototype,i.Events),{create:function(t,e){return new o(t,e)}}});
define('pages/forum/app',["jquery","underscore","backbone","js/core/coursera","js/lib/api","js/lib/asyncMessages"],function(e,t,o,n,r,i){var s=e("<div>").appendTo("body").addClass("coursera-async-message");return n.message=i.create(s),n.on("region:fetching",function(t){n.message.add(e("<div>loading page</div>").addClass("waiting"),{id:t.name+t.uid})}),n.on("region:fetched",function(e){n.message.remove(e.name+e.uid)}),n.setup=function(e){n.path=e,n.path&&(n.apiWWW=new r("",{type:"rest","csrf.cookie":"csrf_token","csrf.token":"X-CSRF-Token"}),n.api=r("/"+n.path+"/api/",{message:n.message,type:"rest","csrf.cookie":"csrf_token","csrf.token":"X-CSRF-Token","csrf.path":"/"+n.path+"/"}),n.api.on("always",function(e){e.xhr.status>=400?n.multitracker.push(["api.error."+e.xhr.status,{timing:e.timing,url:e.url,status:e.xhr.status,response:e.xhr.responseText}]):n.multitracker.push(["api.ok."+e.xhr.status,{timing:e.timing,url:e.url,status:e.xhr.status}])}))},n.setup(location.pathname.match(RegExp("^/([^/]*)/.*"))[1]),n});
define('js/lib/backbone.api',["backbone","underscore","js/lib/api"],function(t,i,o){var e={sync:function(e,a,s){var n=this,r=this.urlId||this.idAttribute||"id",l=s.url?s.url:i.isFunction(this.url)?this.url():this.url;if(!this.api){var h=l||(i.isFunction(this.urlRoot)?this.urlRoot():this.urlRoot);this.api=o(h)}return"create"==e?(s.data=i.extend(this.toJSON(),s.data||{}),this.api.post(l,s)):"update"==e?this.partialUpdate?(s.data=i.extend(this.changedAttributes()||{},s.data||{}),s.force&&(i.isArray(s.force)?i.each(s.force,function(t){s.data[t]=n.get(t)}):s.data[s.force]=this.get(s.force)),this.api.patch(l+"/"+this.get(r),s)):(s.data=i.extend(this.toJSON(),s.data||{}),this.api.put(l+"/"+this.get(r),s)):"delete"==e?this.api["delete"](l+"/"+this.get(r),s):"read"==e?this instanceof t.Collection||void 0===this.get(r)?this.api.get(l,s):this.api.get(l+"/"+this.get(r),s):void 0},create:function(t,i){var o=this;return this.save(null,t).done(function(t){i&&i.call(o,null,t)}).fail(function(t,e){i&&i.call(o,e)})},update:function(t,i,o){var e=this,a=i||{};return t&&!this.isNew()&&(a.silent=void 0!==a.silent?a.silent:!0),this.save(t,a).done(function(t){o&&o.call(e,null,t)}).fail(function(t,i){o&&o.call(e,i)})},read:function(t,i){var o=this;return this.fetch(t).done(function(t){i&&i.call(o,null,t)}).fail(function(t,e){i&&i.call(o,e)})},"delete":function(t,i){var o=this;return this.destroy(t).done(function(t){i&&i.call(o,null,t)}).fail(function(t,e){i&&i.call(o,e)})}};return e});
define('pages/forum/models/UserModel',["underscore","backbone","pages/forum/app","js/lib/api","js/lib/backbone.api"],function(e,t,n,i,r){var o=t.Model.extend({api:n.api,url:"user/information",activitiesUrl:function(){return this.url+"/"+this.get("id")+"/activities"},canModerateForum:function(){return 1==this.get("forum_moderate")},canAccessAdmin:function(){return 1==this.get("admin_access")},displayName:function(){return this.get("display_name")||this.get("full_name")},fullProfileUrl:function(){return this.get("external_id")?n.config.url.base+"user/i/"+this.get("external_id"):null},getFullProfile:function(){var e=this,t=new i(""),r=n.config.url.base+n.config.url.api+"user/profiles?user-ids="+this.get("id");t.get(r,{dataType:"jsonp",type:"get",success:function(t){t.length&&e.set(t[0])}})}});return e.extend(o.prototype,r),o});
define('js/lib/backbone.relational',["backbone","underscore"],function(t,e){var n=window;t.Relational={showWarnings:!0},t.Semaphore={_permitsAvailable:null,_permitsUsed:0,acquire:function(){if(this._permitsAvailable&&this._permitsUsed>=this._permitsAvailable)throw Error("Max permits acquired");this._permitsUsed++},release:function(){if(0===this._permitsUsed)throw Error("All permits released");this._permitsUsed--},isLocked:function(){return this._permitsUsed>0},setAvailablePermits:function(t){if(this._permitsUsed>t)throw Error("Available permits cannot be less than used permits");this._permitsAvailable=t}},t.BlockingQueue=function(){this._queue=[]},e.extend(t.BlockingQueue.prototype,t.Semaphore,{_queue:null,add:function(t){this.isBlocked()?this._queue.push(t):t()},process:function(){for(;this._queue&&this._queue.length;)this._queue.shift()()},block:function(){this.acquire()},unblock:function(){this.release(),this.isBlocked()||this.process()},isBlocked:function(){return this.isLocked()}}),t.Relational.eventQueue=new t.BlockingQueue,t.Store=function(){this._collections=[],this._reverseRelations=[],this._subModels=[],this._modelScopes=[n]},e.extend(t.Store.prototype,t.Events,{addModelScope:function(t){this._modelScopes.push(t)},addSubModels:function(t,e){this._subModels.push({superModelType:e,subModels:t})},setupSuperModel:function(t){e.find(this._subModels,function(n){return e.find(n.subModels,function(e,r){var i=this.getObjectByName(e);return t===i?(n.superModelType._subModels[r]=t,t._superModel=n.superModelType,t._subModelTypeValue=r,t._subModelTypeAttribute=n.superModelType.prototype.subModelTypeAttribute,!0):void 0},this)},this)},addReverseRelation:function(t){var n=e.any(this._reverseRelations,function(n){return e.all(t,function(t,e){return t===n[e]})});if(!n&&t.model&&t.type){this._reverseRelations.push(t);var r=function(t,n){t.prototype.relations||(t.prototype.relations=[]),t.prototype.relations.push(n),e.each(t._subModels,function(t){r(t,n)},this)};r(t.model,t),this.retroFitRelation(t)}},retroFitRelation:function(t){var e=this.getCollection(t.model);e.each(function(e){e instanceof t.model&&new t.type(e,t)},this)},getCollection:function(n){n instanceof t.RelationalModel&&(n=n.constructor);for(var r=n;r._superModel;)r=r._superModel;var i=e.detect(this._collections,function(t){return t.model===r});return i||(i=this._createCollection(r)),i},getObjectByName:function(t){var n=t.split("."),r=null;return e.find(this._modelScopes,function(t){return r=e.reduce(n,function(t,e){return t[e]},t),r&&r!==t?!0:void 0},this),r},_createCollection:function(e){var n;return e instanceof t.RelationalModel&&(e=e.constructor),e.prototype instanceof t.RelationalModel&&(n=new t.Collection,n.model=e,this._collections.push(n)),n},resolveIdForItem:function(n,r){var i=e.isString(r)||e.isNumber(r)?r:null;return null===i&&(r instanceof t.RelationalModel?i=r.id:e.isObject(r)&&(i=r[n.prototype.idAttribute])),i||0===i||(i=null),i},find:function(t,e){var n=this.resolveIdForItem(t,e),r=this.getCollection(t);if(r){var i=r.get(n);if(i instanceof t)return i}return null},register:function(t){var e=t.collection,n=this.getCollection(t);n&&n.add(t),t.bind("destroy",this.unregister,this),t.collection=e},update:function(t){var e=this.getCollection(t);e._onModelEvent("change:"+t.idAttribute,t,e)},unregister:function(t){t.unbind("destroy",this.unregister);var e=this.getCollection(t);e&&e.remove(t)}}),t.Relational.store=new t.Store,t.Relation=function(n,r){return this.instance=n,r=e.isObject(r)?r:{},this.reverseRelation=e.defaults(r.reverseRelation||{},this.options.reverseRelation),this.reverseRelation.type=e.isString(this.reverseRelation.type)?t[this.reverseRelation.type]||t.Relational.store.getObjectByName(this.reverseRelation.type):this.reverseRelation.type,this.model=r.model||this.instance.constructor,this.options=e.defaults(r,this.options,t.Relation.prototype.options),this.key=this.options.key,this.keySource=this.options.keySource||this.key,this.keyDestination=this.options.keyDestination||this.keySource||this.key,this.relatedModel=this.options.relatedModel,e.isString(this.relatedModel)&&(this.relatedModel=t.Relational.store.getObjectByName(this.relatedModel)),this.checkPreconditions()?(n&&(this.keyContents=this.instance.get(this.keySource),this.key!==this.keySource&&this.instance.unset(this.keySource,{silent:!0}),this.instance._relations.push(this)),!this.options.isAutoRelation&&this.reverseRelation.type&&this.reverseRelation.key&&t.Relational.store.addReverseRelation(e.defaults({isAutoRelation:!0,model:this.relatedModel,relatedModel:this.model,reverseRelation:this.options},this.reverseRelation)),e.bindAll(this,"_modelRemovedFromCollection","_relatedModelAdded","_relatedModelRemoved"),n&&(this.initialize(),t.Relational.store.getCollection(this.instance).bind("relational:remove",this._modelRemovedFromCollection),t.Relational.store.getCollection(this.relatedModel).bind("relational:add",this._relatedModelAdded).bind("relational:remove",this._relatedModelRemoved)),void 0):!1},t.Relation.extend=t.Model.extend,e.extend(t.Relation.prototype,t.Events,t.Semaphore,{options:{createModels:!0,includeInJSON:!0,isAutoRelation:!1},instance:null,key:null,keyContents:null,relatedModel:null,reverseRelation:null,related:null,_relatedModelAdded:function(t,e,n){var r=this;t.queue(function(){r.tryAddRelated(t,n)})},_relatedModelRemoved:function(t,e,n){this.removeRelated(t,n)},_modelRemovedFromCollection:function(t){t===this.instance&&this.destroy()},checkPreconditions:function(){var n=this.instance,r=this.key,i=this.model,o=this.relatedModel,a=t.Relational.showWarnings&&"undefined"!=typeof console;if(!i||!r||!o)return a&&console.warn("Relation=%o; no model, key or relatedModel (%o, %o, %o)",this,i,r,o),!1;if(!(i.prototype instanceof t.RelationalModel))return a&&console.warn("Relation=%o; model does not inherit from Backbone.RelationalModel (%o)",this,n),!1;if(!(o.prototype instanceof t.RelationalModel))return a&&console.warn("Relation=%o; relatedModel does not inherit from Backbone.RelationalModel (%o)",this,o),!1;if(this instanceof t.HasMany&&this.reverseRelation.type===t.HasMany)return a&&console.warn("Relation=%o; relation is a HasMany, and the reverseRelation is HasMany as well.",this),!1;if(n&&n._relations.length){var u=e.any(n._relations,function(t){var e=this.reverseRelation.key&&t.reverseRelation.key;return t.relatedModel===o&&t.key===r&&(!e||this.reverseRelation.key===t.reverseRelation.key)},this);if(u)return a&&console.warn("Relation=%o between instance=%o.%s and relatedModel=%o.%s already exists",this,n,r,o,this.reverseRelation.key),!1}return!0},setRelated:function(t,n){this.related=t,this.instance.acquire(),this.instance.set(this.key,t,e.defaults(n||{},{silent:!0})),this.instance.release()},_isReverseRelation:function(t){return t.instance instanceof this.relatedModel&&this.reverseRelation.key===t.key&&this.key===t.reverseRelation.key?!0:!1},getReverseRelations:function(t){var n=[],r=e.isUndefined(t)?this.related&&(this.related.models||[this.related]):[t];return e.each(r,function(t){e.each(t.getRelations(),function(t){this._isReverseRelation(t)&&n.push(t)},this)},this),n},sanitizeOptions:function(t){return t=t?e.clone(t):{},t.silent&&(t.silentChange=!0,delete t.silent),t},unsanitizeOptions:function(t){return t=t?e.clone(t):{},t.silentChange&&(t.silent=!0,delete t.silentChange),t},destroy:function(){t.Relational.store.getCollection(this.instance).unbind("relational:remove",this._modelRemovedFromCollection),t.Relational.store.getCollection(this.relatedModel).unbind("relational:add",this._relatedModelAdded).unbind("relational:remove",this._relatedModelRemoved),e.each(this.getReverseRelations(),function(t){t.removeRelated(this.instance)},this)}}),t.HasOne=t.Relation.extend({options:{reverseRelation:{type:"HasMany"}},initialize:function(){e.bindAll(this,"onChange"),this.instance.bind("relational:change:"+this.key,this.onChange);var t=this.findRelated({silent:!0});this.setRelated(t),e.each(this.getReverseRelations(),function(t){t.addRelated(this.instance)},this)},findRelated:function(){var t=this.keyContents,e=null;return t instanceof this.relatedModel?e=t:(t||0===t)&&(e=this.relatedModel.findOrCreate(t,{create:this.options.createModels})),e},onChange:function(n,r,i){if(!this.isLocked()){this.acquire(),i=this.sanitizeOptions(i);var o=e.isUndefined(i._related),a=o?this.related:i._related;if(o)if(this.keyContents=r,r instanceof this.relatedModel)this.related=r;else if(r){var u=this.findRelated(i);this.setRelated(u)}else this.setRelated(null);if(a&&this.related!==a&&e.each(this.getReverseRelations(a),function(t){t.removeRelated(this.instance,i)},this),e.each(this.getReverseRelations(),function(t){t.addRelated(this.instance,i)},this),!i.silentChange&&this.related!==a){var s=this;t.Relational.eventQueue.add(function(){s.instance.trigger("update:"+s.key,s.instance,s.related,i)})}this.release()}},tryAddRelated:function(n,r){if(!this.related){r=this.sanitizeOptions(r);var i=this.keyContents;if(i||0===i){var o=t.Relational.store.resolveIdForItem(this.relatedModel,i);e.isNull(o)||n.id!==o||this.addRelated(n,r)}}},addRelated:function(t){if(t!==this.related){var e=this.related||null;this.setRelated(t),this.onChange(this.instance,t,{_related:e})}},removeRelated:function(t){if(this.related&&t===this.related){var e=this.related||null;this.setRelated(null),this.onChange(this.instance,t,{_related:e})}}}),t.HasMany=t.Relation.extend({collectionType:null,options:{reverseRelation:{type:"HasOne"},collectionType:t.Collection,collectionKey:!0,collectionOptions:{}},initialize:function(){if(e.bindAll(this,"onChange","handleAddition","handleRemoval","handleReset"),this.instance.bind("relational:change:"+this.key,this.onChange),this.collectionType=this.options.collectionType,e.isString(this.collectionType)&&(this.collectionType=t.Relational.store.getObjectByName(this.collectionType)),!this.collectionType.prototype instanceof t.Collection)throw Error("collectionType must inherit from Backbone.Collection");this.keyContents instanceof t.Collection?this.setRelated(this._prepareCollection(this.keyContents)):this.setRelated(this._prepareCollection()),this.findRelated({silent:!0})},_getCollectionOptions:function(){return e.isFunction(this.options.collectionOptions)?this.options.collectionOptions(this.instance):this.options.collectionOptions},_prepareCollection:function(e){if(this.related&&this.related.unbind("relational:add",this.handleAddition).unbind("relational:remove",this.handleRemoval).unbind("relational:reset",this.handleReset),e&&e instanceof t.Collection||(e=new this.collectionType([],this._getCollectionOptions())),e.model=this.relatedModel,this.options.collectionKey){var n=this.options.collectionKey===!0?this.options.reverseRelation.key:this.options.collectionKey;e[n]&&e[n]!==this.instance?t.Relational.showWarnings&&"undefined"!=typeof console&&console.warn("Relation=%o; collectionKey=%s already exists on collection=%o",this,n,this.options.collectionKey):n&&(e[n]=this.instance)}return e.bind("relational:add",this.handleAddition).bind("relational:remove",this.handleRemoval).bind("relational:reset",this.handleReset),e},findRelated:function(n){if(this.keyContents){var r=[];this.keyContents instanceof t.Collection?r=this.keyContents.models:(this.keyContents=e.isArray(this.keyContents)?this.keyContents:[this.keyContents],e.each(this.keyContents,function(t){var e=null;t instanceof this.relatedModel?e=t:(t||0===t)&&(e=this.relatedModel.findOrCreate(t,{create:this.options.createModels})),!e||this.related.getByCid(e)||this.related.get(e)||r.push(e)},this)),r.length&&(n=this.unsanitizeOptions(n),this.related.add(r,n))}},onChange:function(n,r,i){if(i=this.sanitizeOptions(i),this.keyContents=r,e.each(this.getReverseRelations(),function(t){t.removeRelated(this.instance,i)},this),r instanceof t.Collection)this._prepareCollection(r),this.related=r;else{var o;this.related instanceof t.Collection?(o=this.related,o.remove(o.models)):o=this._prepareCollection(),this.setRelated(o),this.findRelated(i)}e.each(this.getReverseRelations(),function(t){t.addRelated(this.instance,i)},this);var a=this;t.Relational.eventQueue.add(function(){!i.silentChange&&a.instance.trigger("update:"+a.key,a.instance,a.related,i)})},tryAddRelated:function(n,r){if(r=this.sanitizeOptions(r),!this.related.getByCid(n)&&!this.related.get(n)){var i=e.any(this.keyContents,function(r){var i=t.Relational.store.resolveIdForItem(this.relatedModel,r);return!e.isNull(i)&&i===n.id},this);i&&this.related.add(n,r)}},handleAddition:function(n,r,i){if(n instanceof t.Model){i=this.sanitizeOptions(i),e.each(this.getReverseRelations(n),function(t){t.addRelated(this.instance,i)},this);var o=this;t.Relational.eventQueue.add(function(){!i.silentChange&&o.instance.trigger("add:"+o.key,n,o.related,i)})}},handleRemoval:function(n,r,i){if(n instanceof t.Model){i=this.sanitizeOptions(i),e.each(this.getReverseRelations(n),function(t){t.removeRelated(this.instance,i)},this);var o=this;t.Relational.eventQueue.add(function(){!i.silentChange&&o.instance.trigger("remove:"+o.key,n,o.related,i)})}},handleReset:function(e,n){n=this.sanitizeOptions(n);var r=this;t.Relational.eventQueue.add(function(){!n.silentChange&&r.instance.trigger("reset:"+r.key,r.related,n)})},addRelated:function(t,e){var n=this;e=this.unsanitizeOptions(e),t.queue(function(){!n.related||n.related.getByCid(t)||n.related.get(t)||n.related.add(t,e)})},removeRelated:function(t,e){e=this.unsanitizeOptions(e),(this.related.getByCid(t)||this.related.get(t))&&this.related.remove(t,e)}}),t.RelationalModel=t.Model.extend({relations:null,_relations:null,_isInitialized:!1,_deferProcessing:!1,_queue:null,subModelTypeAttribute:"type",subModelTypes:null,constructor:function(n,r){var i=this;if(r&&r.collection){this._deferProcessing=!0;var o=function(t){t===i&&(i._deferProcessing=!1,i.processQueue(),r.collection.unbind("relational:add",o))};r.collection.bind("relational:add",o),e.defer(function(){o(i)})}this._queue=new t.BlockingQueue,this._queue.block(),t.Relational.eventQueue.block(),t.Model.apply(this,arguments),t.Relational.eventQueue.unblock()},trigger:function(e){if(e.length>5&&"change"===e.substr(0,6)){var n=this,r=arguments;t.Relational.eventQueue.add(function(){t.Model.prototype.trigger.apply(n,r)})}else t.Model.prototype.trigger.apply(this,arguments);return this},initializeRelations:function(){this.acquire(),this._relations=[],e.each(this.relations,function(n){var r=e.isString(n.type)?t[n.type]||t.Relational.store.getObjectByName(n.type):n.type;r&&r.prototype instanceof t.Relation?new r(this,n):t.Relational.showWarnings&&"undefined"!=typeof console&&console.warn("Relation=%o; missing or invalid type!",n)},this),this._isInitialized=!0,this.release(),this.processQueue()},updateRelations:function(t){this._isInitialized&&!this.isLocked()&&e.each(this._relations,function(e){var n=this.attributes[e.keySource]||this.attributes[e.key];e.related!==n&&this.trigger("relational:change:"+e.key,this,n,t||{})},this)},queue:function(t){this._queue.add(t)},processQueue:function(){this._isInitialized&&!this._deferProcessing&&this._queue.isBlocked()&&this._queue.unblock()},getRelation:function(t){return e.detect(this._relations,function(e){return e.key===t?!0:void 0},this)},getRelations:function(){return this._relations},fetchRelated:function(n,r,i){r||(r={});var o,a=[],u=this.getRelation(n),s=u&&u.keyContents,l=s&&e.select(e.isArray(s)?s:[s],function(n){var r=t.Relational.store.resolveIdForItem(u.relatedModel,n);return!e.isNull(r)&&(i||!t.Relational.store.find(u.relatedModel,r))},this);if(l&&l.length){var c=e.map(l,function(t){var n;if(e.isObject(t))n=u.relatedModel.build(t);else{var r={};r[u.relatedModel.prototype.idAttribute]=t,n=u.relatedModel.build(r)}return n},this);if(u.related instanceof t.Collection&&e.isFunction(u.related.url)&&(o=u.related.url(c)),o&&o!==u.related.url()){var f=e.defaults({error:function(){var t=arguments;e.each(c,function(e){e.trigger("destroy",e,e.collection,r),r.error&&r.error.apply(e,t)})},url:o},r,{add:!0});a=[u.related.fetch(f)]}else a=e.map(c,function(t){var n=e.defaults({error:function(){t.trigger("destroy",t,t.collection,r),r.error&&r.error.apply(t,arguments)}},r);return t.fetch(n)},this)}return a},set:function(n,r,i){t.Relational.eventQueue.block();var o;e.isObject(n)||null==n?(o=n,i=r):(o={},o[n]=r);var a=t.Model.prototype.set.apply(this,arguments);return this._isInitialized||this.isLocked()?o&&this.idAttribute in o&&t.Relational.store.update(this):(this.constructor.initializeModelHierarchy(),t.Relational.store.register(this),this.initializeRelations()),o&&this.updateRelations(i),t.Relational.eventQueue.unblock(),a},unset:function(e,n){t.Relational.eventQueue.block();var r=t.Model.prototype.unset.apply(this,arguments);return this.updateRelations(n),t.Relational.eventQueue.unblock(),r},clear:function(e){t.Relational.eventQueue.block();var n=t.Model.prototype.clear.apply(this,arguments);return this.updateRelations(e),t.Relational.eventQueue.unblock(),n},change:function(){var e=this,n=arguments;t.Relational.eventQueue.add(function(){t.Model.prototype.change.apply(e,n)})},clone:function(){var t=e.clone(this.attributes);return e.isUndefined(t[this.idAttribute])||(t[this.idAttribute]=null),e.each(this.getRelations(),function(e){delete t[e.key]}),new this.constructor(t)},toJSON:function(){if(this.isLocked())return this.id;this.acquire();var n=t.Model.prototype.toJSON.call(this);return!this.constructor._superModel||this.constructor._subModelTypeAttribute in n||(n[this.constructor._subModelTypeAttribute]=this.constructor._subModelTypeValue),e.each(this._relations,function(r){var i=n[r.key];if(r.options.includeInJSON===!0)n[r.keyDestination]=i&&e.isFunction(i.toJSON)?i.toJSON():null;else if(e.isString(r.options.includeInJSON))n[r.keyDestination]=i instanceof t.Collection?i.pluck(r.options.includeInJSON):i instanceof t.Model?i.get(r.options.includeInJSON):null;else if(e.isArray(r.options.includeInJSON))if(i instanceof t.Collection){var o=[];i.each(function(t){var n={};e.each(r.options.includeInJSON,function(e){n[e]=t.get(e)}),o.push(n)}),n[r.keyDestination]=o}else if(i instanceof t.Model){var o={};e.each(r.options.includeInJSON,function(t){o[t]=i.get(t)}),n[r.keyDestination]=o}else n[r.keyDestination]=null;else e.isObject(r.options.includeInJSON)?i instanceof t.Model&&e.each(r.options.includeInJSON,function(t,e){n[t]=i.get(e)}):delete n[r.key];r.keyDestination!==r.key&&delete n[r.key]}),this.release(),n}},{setup:function(){return this.prototype.relations=(this.prototype.relations||[]).slice(0),this._subModels={},this._superModel=null,this.prototype.hasOwnProperty("subModelTypes")?t.Relational.store.addSubModels(this.prototype.subModelTypes,this):this.prototype.subModelTypes=null,e.each(this.prototype.relations,function(n){if(n.model||(n.model=this),n.reverseRelation&&n.model===this){var r=!0;if(e.isString(n.relatedModel)){var i=t.Relational.store.getObjectByName(n.relatedModel);r=i&&i.prototype instanceof t.RelationalModel}var o=e.isString(n.type)?t[n.type]||t.Relational.store.getObjectByName(n.type):n.type;r&&o&&o.prototype instanceof t.Relation&&new o(null,n)}},this),this},build:function(t,e){var n=this;if(this.initializeModelHierarchy(),this._subModels&&this.prototype.subModelTypeAttribute in t){var r=t[this.prototype.subModelTypeAttribute],i=this._subModels[r];i&&(n=i)}return new n(t,e)},initializeModelHierarchy:function(){if(e.isUndefined(this._superModel)||e.isNull(this._superModel))if(t.Relational.store.setupSuperModel(this),this._superModel){if(this._superModel.prototype.relations){var n=e.any(this.prototype.relations,function(t){return t.model&&t.model!==this},this);n||(this.prototype.relations=this._superModel.prototype.relations.concat(this.prototype.relations))}}else this._superModel=!1;this.prototype.subModelTypes&&e.keys(this.prototype.subModelTypes).length!==e.keys(this._subModels).length&&e.each(this.prototype.subModelTypes,function(e){var n=t.Relational.store.getObjectByName(e);n&&n.initializeModelHierarchy()})},findOrCreate:function(n,r){var i=t.Relational.store.find(this,n);return e.isObject(n)&&(i?i.set(n,r):(!r||r&&r.create!==!1)&&(i=this.build(n,r))),i}}),e.extend(t.RelationalModel.prototype,t.Semaphore),t.Collection.prototype.__prepareModel=t.Collection.prototype._prepareModel,t.Collection.prototype._prepareModel=function(e,n){if(n||(n={}),e instanceof t.Model)e.collection||(e.collection=this);else{var r=e;n.collection=this,e=this.model.build!==void 0?this.model.build(r,n):new this.model(r,n),e._validate(e.attributes,n)||(e=!1)}return e};var r=t.Collection.prototype.__add=t.Collection.prototype.add;t.Collection.prototype.add=function(n,i){i||(i={}),e.isArray(n)||(n=[n]);var o=[];return e.each(n,function(e){if(!(e instanceof t.Model)){var n=t.Relational.store.find(this.model,e[this.model.prototype.idAttribute]);n?(n.set(n.parse?n.parse(e):e,i),e=n):e=t.Collection.prototype._prepareModel.call(this,e,i)}e instanceof t.Model&&!this.get(e)&&!this.getByCid(e)&&o.push(e)},this),o.length&&(r.call(this,o,i),e.each(o,function(t){this.trigger("relational:add",t,this,i)},this)),this};var i=t.Collection.prototype.__remove=t.Collection.prototype.remove;t.Collection.prototype.remove=function(n,r){return r||(r={}),n=e.isArray(n)?n.slice(0):[n],e.each(n,function(e){e=this.getByCid(e)||this.get(e),e instanceof t.Model&&(i.call(this,e,r),this.trigger("relational:remove",e,this,r))},this),this};var o=t.Collection.prototype.__reset=t.Collection.prototype.reset;t.Collection.prototype.reset=function(t,e){return o.call(this,t,e),this.trigger("relational:reset",this,e),this};var a=t.Collection.prototype.__sort=t.Collection.prototype.sort;t.Collection.prototype.sort=function(t){return a.call(this,t),this.trigger("relational:reset",this,t),this};var u=t.Collection.prototype.__trigger=t.Collection.prototype.trigger;t.Collection.prototype.trigger=function(n){if("add"===n||"remove"===n||"reset"===n){var r=this,i=arguments;"add"===n&&(i=e.toArray(i),e.isObject(i[3])&&(i[3]=e.clone(i[3]))),t.Relational.eventQueue.add(function(){u.apply(r,i)})}else u.apply(this,arguments);return this},t.RelationalModel.extend=function(){var e=t.Model.extend.apply(this,arguments);return e.setup(this),e}});
(function(){function t(t){this.tokens=[],this.tokens.links={},this.options=t||s.defaults,this.rules=l.normal,this.options.gfm&&(this.rules=this.options.tables?l.tables:l.gfm)}function e(t,e){if(this.options=e||s.defaults,this.links=t,this.rules=u.normal,!this.links)throw Error("Tokens array requires a `links` property.");this.options.gfm?this.rules=this.options.breaks?u.breaks:u.gfm:this.options.pedantic&&(this.rules=u.pedantic)}function n(t){this.tokens=[],this.token=null,this.options=t||s.defaults}function i(t,e){return t.replace(e?/&/g:/&(?!#?\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function r(t,e){return t=t.source,e=e||"",function n(i,r){return i?(r=r.source||r,r=r.replace(/(^|[^\[])\^/g,"$1"),t=t.replace(i,r),n):RegExp(t,e)}}function o(){}function a(t){for(var e,n,i=1;arguments.length>i;i++){e=arguments[i];for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t}function s(e,r,o){if(o||"function"==typeof r){o||(o=r,r=null),r&&(r=a({},s.defaults,r));var l=t.lex(l,r),u=r.highlight,c=0,d=l.length,h=0;if(!u||3>u.length)return o(null,n.parse(l,r));for(var f=function(){delete r.highlight;var t=n.parse(l,r);return r.highlight=u,o(null,t)};d>h;h++)(function(t){return"code"===t.type?(c++,u(t.text,t.lang,function(e,n){return null==n||n===t.text?--c||f():(t.text=n,t.escaped=!0,--c||f(),void 0)})):void 0})(l[h])}else try{return r&&(r=a({},s.defaults,r)),n.parse(t.lex(e,r),r)}catch(p){if(p.message+="\nPlease report this to https://github.com/chjj/marked.",(r||s.defaults).silent)return"<p>An error occured:</p><pre>"+i(p.message+"",!0)+"</pre>";throw p}}var l={newline:/^\n+/,code:/^( {4}[^\n]+\n*)+/,fences:o,hr:/^( *[-*_]){3,} *(?:\n+|$)/,heading:/^ *(#{1,6}) *([^\n]+?) *#* *(?:\n+|$)/,nptable:o,lheading:/^([^\n]+)\n *(=|-){3,} *\n*/,blockquote:/^( *>[^\n]+(\n[^\n]+)*\n*)+/,list:/^( *)(bull) [\s\S]+?(?:hr|\n{2,}(?! )(?!\1bull )\n*|\s*$)/,html:/^ *(?:comment|closed|closing) *(?:\n{2,}|\s*$)/,def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +["(]([^\n]+)[")])? *(?:\n+|$)/,table:o,paragraph:/^((?:[^\n]+\n?(?!hr|heading|lheading|blockquote|tag|def))+)\n*/,text:/^[^\n]+/};l.bullet=/(?:[*+-]|\d+\.)/,l.item=/^( *)(bull) [^\n]*(?:\n(?!\1bull )[^\n]*)*/,l.item=r(l.item,"gm")(/bull/g,l.bullet)(),l.list=r(l.list)(/bull/g,l.bullet)("hr",/\n+(?=(?: *[-*_]){3,} *(?:\n+|$))/)(),l._tag="(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:/|@)\\b",l.html=r(l.html)("comment",/<!--[\s\S]*?-->/)("closed",/<(tag)[\s\S]+?<\/\1>/)("closing",/<tag(?:"[^"]*"|'[^']*'|[^'">])*?>/)(/tag/g,l._tag)(),l.paragraph=r(l.paragraph)("hr",l.hr)("heading",l.heading)("lheading",l.lheading)("blockquote",l.blockquote)("tag","<"+l._tag)("def",l.def)(),l.normal=a({},l),l.gfm=a({},l.normal,{fences:/^ *(`{3,}|~{3,}) *(\S+)? *\n([\s\S]+?)\s*\1 *(?:\n+|$)/,paragraph:/^/}),l.gfm.paragraph=r(l.paragraph)("(?!","(?!"+l.gfm.fences.source.replace("\\1","\\2")+"|")(),l.tables=a({},l.gfm,{nptable:/^ *(\S.*\|.*)\n *([-:]+ *\|[-| :]*)\n((?:.*\|.*(?:\n|$))*)\n*/,table:/^ *\|(.+)\n *\|( *[-:]+[-| :]*)\n((?: *\|.*(?:\n|$))*)\n*/}),t.rules=l,t.lex=function(e,n){var i=new t(n);return i.lex(e)},t.prototype.lex=function(t){return t=t.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    ").replace(/\u00a0/g," ").replace(/\u2424/g,"\n"),this.token(t,!0)},t.prototype.token=function(t,e){for(var n,i,r,o,a,s,u,c,d,t=t.replace(/^ +$/gm,"");t;)if((r=this.rules.newline.exec(t))&&(t=t.substring(r[0].length),r[0].length>1&&this.tokens.push({type:"space"})),r=this.rules.code.exec(t))t=t.substring(r[0].length),r=r[0].replace(/^ {4}/gm,""),this.tokens.push({type:"code",text:this.options.pedantic?r:r.replace(/\n+$/,"")});else if(r=this.rules.fences.exec(t))t=t.substring(r[0].length),this.tokens.push({type:"code",lang:r[2],text:r[3]});else if(r=this.rules.heading.exec(t))t=t.substring(r[0].length),this.tokens.push({type:"heading",depth:r[1].length,text:r[2]});else if(e&&(r=this.rules.nptable.exec(t))){for(t=t.substring(r[0].length),s={type:"table",header:r[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:r[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:r[3].replace(/\n$/,"").split("\n")},c=0;s.align.length>c;c++)s.align[c]=/^ *-+: *$/.test(s.align[c])?"right":/^ *:-+: *$/.test(s.align[c])?"center":/^ *:-+ *$/.test(s.align[c])?"left":null;for(c=0;s.cells.length>c;c++)s.cells[c]=s.cells[c].split(/ *\| */);this.tokens.push(s)}else if(r=this.rules.lheading.exec(t))t=t.substring(r[0].length),this.tokens.push({type:"heading",depth:"="===r[2]?1:2,text:r[1]});else if(r=this.rules.hr.exec(t))t=t.substring(r[0].length),this.tokens.push({type:"hr"});else if(r=this.rules.blockquote.exec(t))t=t.substring(r[0].length),this.tokens.push({type:"blockquote_start"}),r=r[0].replace(/^ *> ?/gm,""),this.token(r,e),this.tokens.push({type:"blockquote_end"});else if(r=this.rules.list.exec(t)){for(t=t.substring(r[0].length),o=r[2],this.tokens.push({type:"list_start",ordered:o.length>1}),r=r[0].match(this.rules.item),n=!1,d=r.length,c=0;d>c;c++)s=r[c],u=s.length,s=s.replace(/^ *([*+-]|\d+\.) +/,""),~s.indexOf("\n ")&&(u-=s.length,s=this.options.pedantic?s.replace(/^ {1,4}/gm,""):s.replace(RegExp("^ {1,"+u+"}","gm"),"")),this.options.smartLists&&c!==d-1&&(a=l.bullet.exec(r[c+1])[0],o===a||o.length>1&&a.length>1||(t=r.slice(c+1).join("\n")+t,c=d-1)),i=n||/\n\n(?!\s*$)/.test(s),c!==d-1&&(n="\n"===s[s.length-1],i||(i=n)),this.tokens.push({type:i?"loose_item_start":"list_item_start"}),this.token(s,!1),this.tokens.push({type:"list_item_end"});this.tokens.push({type:"list_end"})}else if(r=this.rules.html.exec(t))t=t.substring(r[0].length),this.tokens.push({type:this.options.sanitize?"paragraph":"html",pre:"pre"===r[1]||"script"===r[1],text:r[0]});else if(e&&(r=this.rules.def.exec(t)))t=t.substring(r[0].length),this.tokens.links[r[1].toLowerCase()]={href:r[2],title:r[3]};else if(e&&(r=this.rules.table.exec(t))){for(t=t.substring(r[0].length),s={type:"table",header:r[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:r[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:r[3].replace(/(?: *\| *)?\n$/,"").split("\n")},c=0;s.align.length>c;c++)s.align[c]=/^ *-+: *$/.test(s.align[c])?"right":/^ *:-+: *$/.test(s.align[c])?"center":/^ *:-+ *$/.test(s.align[c])?"left":null;for(c=0;s.cells.length>c;c++)s.cells[c]=s.cells[c].replace(/^ *\| *| *\| *$/g,"").split(/ *\| */);this.tokens.push(s)}else if(e&&(r=this.rules.paragraph.exec(t)))t=t.substring(r[0].length),this.tokens.push({type:"paragraph",text:"\n"===r[1][r[1].length-1]?r[1].slice(0,-1):r[1]});else if(r=this.rules.text.exec(t))t=t.substring(r[0].length),this.tokens.push({type:"text",text:r[0]});else if(t)throw Error("Infinite loop on byte: "+t.charCodeAt(0));return this.tokens};var u={escape:/^\\([\\`*{}\[\]()#+\-.!_>])/,autolink:/^<([^ >]+(@|:\/)[^ >]+)>/,url:o,tag:/^<!--[\s\S]*?-->|^<\/?\w+(?:"[^"]*"|'[^']*'|[^'">])*?>/,link:/^!?\[(inside)\]\(href\)/,reflink:/^!?\[(inside)\]\s*\[([^\]]*)\]/,nolink:/^!?\[((?:\[[^\]]*\]|[^\[\]])*)\]/,strong:/^__([\s\S]+?)__(?!_)|^\*\*([\s\S]+?)\*\*(?!\*)/,em:/^\b_((?:__|[\s\S])+?)_\b|^\*((?:\*\*|[\s\S])+?)\*(?!\*)/,code:/^(`+)\s*([\s\S]*?[^`])\s*\1(?!`)/,br:/^ {2,}\n(?!\s*$)/,del:o,text:/^[\s\S]+?(?=[\\<!\[_*`]| {2,}\n|$)/};u._inside=/(?:\[[^\]]*\]|[^\]]|\](?=[^\[]*\]))*/,u._href=/\s*<?([^\s]*?)>?(?:\s+['"]([\s\S]*?)['"])?\s*/,u.link=r(u.link)("inside",u._inside)("href",u._href)(),u.reflink=r(u.reflink)("inside",u._inside)(),u.normal=a({},u),u.pedantic=a({},u.normal,{strong:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,em:/^_(?=\S)([\s\S]*?\S)_(?!_)|^\*(?=\S)([\s\S]*?\S)\*(?!\*)/}),u.gfm=a({},u.normal,{escape:r(u.escape)("])","~|])")(),url:/^(https?:\/\/[^\s<]+[^<.,:;"')\]\s])/,del:/^~~(?=\S)([\s\S]*?\S)~~/,text:r(u.text)("]|","~]|")("|","|https?://|")()}),u.breaks=a({},u.gfm,{br:r(u.br)("{2,}","*")(),text:r(u.gfm.text)("{2,}","*")()}),e.rules=u,e.output=function(t,n,i){var r=new e(n,i);return r.output(t)},e.prototype.output=function(t){for(var e,n,r,o,a="";t;)if(o=this.rules.escape.exec(t))t=t.substring(o[0].length),a+=o[1];else if(o=this.rules.autolink.exec(t))t=t.substring(o[0].length),"@"===o[2]?(n=":"===o[1][6]?this.mangle(o[1].substring(7)):this.mangle(o[1]),r=this.mangle("mailto:")+n):(n=i(o[1]),r=n),a+='<a href="'+r+'">'+n+"</a>";else if(o=this.rules.url.exec(t))t=t.substring(o[0].length),n=i(o[1]),r=n,a+='<a href="'+r+'">'+n+"</a>";else if(o=this.rules.tag.exec(t))t=t.substring(o[0].length),a+=this.options.sanitize?i(o[0]):o[0];else if(o=this.rules.link.exec(t))t=t.substring(o[0].length),a+=this.outputLink(o,{href:o[2],title:o[3]});else if((o=this.rules.reflink.exec(t))||(o=this.rules.nolink.exec(t))){if(t=t.substring(o[0].length),e=(o[2]||o[1]).replace(/\s+/g," "),e=this.links[e.toLowerCase()],!e||!e.href){a+=o[0][0],t=o[0].substring(1)+t;continue}a+=this.outputLink(o,e)}else if(o=this.rules.strong.exec(t))t=t.substring(o[0].length),a+="<strong>"+this.output(o[2]||o[1])+"</strong>";else if(o=this.rules.em.exec(t))t=t.substring(o[0].length),a+="<em>"+this.output(o[2]||o[1])+"</em>";else if(o=this.rules.code.exec(t))t=t.substring(o[0].length),a+="<code>"+i(o[2],!0)+"</code>";else if(o=this.rules.br.exec(t))t=t.substring(o[0].length),a+="<br>";else if(o=this.rules.del.exec(t))t=t.substring(o[0].length),a+="<del>"+this.output(o[1])+"</del>";else if(o=this.rules.text.exec(t))t=t.substring(o[0].length),a+=i(o[0]);else if(t)throw Error("Infinite loop on byte: "+t.charCodeAt(0));return a},e.prototype.outputLink=function(t,e){return"!"!==t[0][0]?'<a href="'+i(e.href)+'"'+(e.title?' title="'+i(e.title)+'"':"")+">"+this.output(t[1])+"</a>":'<img src="'+i(e.href)+'" alt="'+i(t[1])+'"'+(e.title?' title="'+i(e.title)+'"':"")+">"},e.prototype.smartypants=function(t){return this.options.smartypants?t.replace(/--/g,"â").replace(/'([^']*)'/g,"â$1â").replace(/"([^"]*)"/g,"â$1â").replace(/\.{3}/g,"â¦"):t},e.prototype.mangle=function(t){for(var e,n="",i=t.length,r=0;i>r;r++)e=t.charCodeAt(r),Math.random()>.5&&(e="x"+e.toString(16)),n+="&#"+e+";";return n},n.parse=function(t,e){var i=new n(e);return i.parse(t)},n.prototype.parse=function(t){this.inline=new e(t.links,this.options),this.tokens=t.reverse();for(var n="";this.next();)n+=this.tok();return n},n.prototype.next=function(){return this.token=this.tokens.pop()},n.prototype.peek=function(){return this.tokens[this.tokens.length-1]||0},n.prototype.parseText=function(){for(var t=this.token.text;"text"===this.peek().type;)t+="\n"+this.next().text;return this.inline.output(t)},n.prototype.tok=function(){switch(this.token.type){case"space":return"";case"hr":return"<hr>\n";case"heading":return"<h"+this.token.depth+">"+this.inline.output(this.token.text)+"</h"+this.token.depth+">\n";case"code":if(this.options.highlight){var t=this.options.highlight(this.token.text,this.token.lang);null!=t&&t!==this.token.text&&(this.token.escaped=!0,this.token.text=t)}return this.token.escaped||(this.token.text=i(this.token.text,!0)),"<pre><code"+(this.token.lang?' class="'+this.options.langPrefix+this.token.lang+'"':"")+">"+this.token.text+"</code></pre>\n";case"table":var e,n,r,o,a,s="";for(s+="<thead>\n<tr>\n",n=0;this.token.header.length>n;n++)e=this.inline.output(this.token.header[n]),s+=this.token.align[n]?'<th align="'+this.token.align[n]+'">'+e+"</th>\n":"<th>"+e+"</th>\n";for(s+="</tr>\n</thead>\n",s+="<tbody>\n",n=0;this.token.cells.length>n;n++){for(r=this.token.cells[n],s+="<tr>\n",a=0;r.length>a;a++)o=this.inline.output(r[a]),s+=this.token.align[a]?'<td align="'+this.token.align[a]+'">'+o+"</td>\n":"<td>"+o+"</td>\n";s+="</tr>\n"}return s+="</tbody>\n","<table>\n"+s+"</table>\n";case"blockquote_start":for(var s="";"blockquote_end"!==this.next().type;)s+=this.tok();return"<blockquote>\n"+s+"</blockquote>\n";case"list_start":for(var l=this.token.ordered?"ol":"ul",s="";"list_end"!==this.next().type;)s+=this.tok();return"<"+l+">\n"+s+"</"+l+">\n";case"list_item_start":for(var s="";"list_item_end"!==this.next().type;)s+="text"===this.token.type?this.parseText():this.tok();return"<li>"+s+"</li>\n";case"loose_item_start":for(var s="";"list_item_end"!==this.next().type;)s+=this.tok();return"<li>"+s+"</li>\n";case"html":return this.token.pre||this.options.pedantic?this.token.text:this.inline.output(this.token.text);case"paragraph":return"<p>"+this.inline.output(this.token.text)+"</p>\n";case"text":return"<p>"+this.parseText()+"</p>\n"}},o.exec=o,s.options=s.setOptions=function(t){return a(s.defaults,t),s},s.defaults={gfm:!0,tables:!0,breaks:!1,pedantic:!1,sanitize:!1,smartLists:!1,silent:!1,highlight:null,langPrefix:"lang-"},s.Parser=n,s.parser=n.parse,s.Lexer=t,s.lexer=t.lex,s.InlineLexer=e,s.inlineLexer=e.output,s.parse=s,"object"==typeof exports?module.exports=s:"function"==typeof define&&define.amd?define('js/lib/marked',[],function(){return s}):this.marked=s}).call(function(){return this||("undefined"!=typeof window?window:global)}());
define('pages/forum/models/EntryModel',["underscore","backbone","pages/forum/app","js/lib/backbone.api","js/lib/backbone.relational","js/lib/marked"],function(e,i,a,n,t,r){var d=i.RelationalModel.extend({defaults:{_viewer_vote:0,_viewer_voted:!1},api:a.api,partialUpdate:!0,textProp:null,entryType:null,initialize:function(){this.bind("change",this.updateThreadMaybe,this)},updateThreadMaybe:function(){this.changedAttributes()&&e.contains(e.keys(this.changedAttributes()),"_viewer_subscription")&&this.get("thread")&&this.get("thread").set("_viewer_subscription",this.get("_viewer_subscription"))},getPermalinkHash:function(){return this.entryType+"-"+this.get("id")},getPermalink:function(){return window.location.href.split("#")[0]+"#"+this.getPermalinkHash()},votesUrl:function(){return this.url()+"/"+this.get("id")+"/votes"},reportsUrl:function(){return this.url()+"/"+this.get("id")+"/reports"},getMessageHtml:function(){var e=this.get(this.textProp);return e?"html"==this.get("text_type")?e:r(e):""},getEditableHtml:function(){return this.getMessageHtml().replace("&lt;","&amp;lt;").replace("&gt;","&amp;gt;")}});return e.extend(d.prototype,n),d});
define('pages/forum/models/PostModel',["pages/forum/models/EntryModel"],function(e){return e.extend({defaults:{order:9999999999},textProp:"post_text",entryType:"post",url:function(){return"forum/threads/"+this.get("thread_id")+"/posts"}})});
define('pages/forum/models/PostCollection',["backbone","pages/forum/models/PostModel"],function(e,t){var n=e.Collection.extend({model:t});return n});
define('pages/forum/models/CommentModel',["pages/forum/models/EntryModel"],function(e){var t=e.extend({textProp:"comment_text",entryType:"comment",url:function(){return"forum/posts/"+this.get("post_id")+"/comments"}});return t});
define('pages/forum/models/CommentCollection',["backbone","pages/forum/models/CommentModel"],function(e,t){var n=e.Collection.extend({model:t});return n});
(function(){var e=function(){return e};e.isEnabled=function(){return!!window.Badgeville},e.isAPILoaded=function(){return!(!window.Badgeville||!window.BVSDK)},e.getPlayerId=function(e){return e+"@badgeville.coursera.org"},e.getPlayerObject=function(i,a){if(e.isEnabled()){Badgeville.PlayerCache||(Badgeville.PlayerCache={});var n=Badgeville.PlayerCache[i];n?a(n):Badgeville.getPlayer(i,function(e){a(e),Badgeville.PlayerCache[i]=e})}},e.setupPlayerTip=function(i,a){e.isEnabled()&&(e.getPlayerId(i),e.getPlayerObject(e.getPlayerId(i),function(e){Badgeville.Gears.playerTip(window.Badgeville(a),e)}))},e.renderByline=function(e,i){function a(e,i,a,n){if(0!==a){var r=$("<span></span>").css("margin-right","5px").attr("title",a+" "+i+" badges"),d=$('<span class="icon-circle"></span>');d.css({color:n,fontSize:"10px"});var t=$("<span></span>").css("font-weight","bold").append(a);r.append(d),r.append("&nbsp;"),r.append(t),e.append(r)}}function n(e,i){if(!e.tags)return!1;for(var a=0;e.tags.length>a;a++)if(e.tags[a].toLowerCase()==i.toLowerCase())return!0;return!1}for(var r=0,d=0,t=0,s=0,l=0;e.length>l;l++){var p=e[l];p.definition_id&&(p.name,n(p,"diamond")?s++:n(p,"gold")?t++:n(p,"silver")?d++:n(p,"bronze")&&r++)}a(i,"Bronze",r,"#a67c52"),a(i,"Silver",d,"#959595"),a(i,"Gold",t,"#dcae4b"),a(i,"Diamond",s,"white")},e.setupByline=function(i,a){e.isAPILoaded()&&(Badgeville.RewardsCache||(Badgeville.RewardsCache={}),e.getPlayerObject(e.getPlayerId(i),function(i){Badgeville.RewardsCache[i.id]?e.renderByline(Badgeville.RewardsCache[i.id],a):BVSDK("players/rewards",{players:i.id},{fields:"all",limit:50}).ok(function(n){Badgeville.RewardsCache[i.id]=n.rewards,e.renderByline(Badgeville.RewardsCache[i.id],a)})}))},e.setupMissionsDisplay=function(i,a,n,r){function d(e,i){var a=$("<div></div>").addClass("coursera-badgeville-missions-badge"),n=$("<img></img>");return a.attr("title","To earn this badge, "+e.hint),a.append(n),n.attr("src",e.image),i>0?i>1&&a.append('<span class="coursera-badgeville-missions-badge-num">'+i+"</span>"):(n.css("opacity",".4"),a.append('<span class="icon-lock"></span>')),a.append('<div class="coursera-badgeville-missions-badge-name">'+e.name+"</div>"),a}e.isAPILoaded()&&(Badgeville.MissionsCache||(Badgeville.MissionsCache={}),e.getPlayerObject(e.getPlayerId(i),function(e){var i=BVSDK("rewards",{},{limit:50,fields:"all"}),t=BVSDK("players/rewards",{players:e.id},{fields:"hint",limit:50}),s=BVSDK("missions",{players:e.id},{includes:"rewards",fields:["hint","type"]});BVSDK.when(i,t,s).ok(function(e,i,t){function s(e,i){function a(e){return 0===e.name.indexOf("Diamond")?4:0===e.name.indexOf("Gold")?3:0===e.name.indexOf("Silver")?2:0===e.name.indexOf("Bronze")?1:0}return a(e)-a(i)}var l,p,o,c,g,f,h=e.rewards,u=i.rewards,v=t.missions,y={},m={};for(p=h.length;p--;)y[h[p].id]=h[p];for(p=u.length;p--;)m[u[p].definition_id]||(m[u[p].definition_id]=[]),m[u[p].definition_id].push(u[p]);if(p=null,a.empty(),!n){for(a.append("<h5>Badges</h5>"),p=0;v.length>p;p++)for(l=v[p],l.rewards.sort(s),o=0;l.rewards.length>o;o++)c=y[l.rewards[o].definition_id],g=(m[l.rewards[o].definition_id]||[]).length,g>0&&(f=d(c,g),a.append(f));return a.is(":empty")&&a.html("No badges yet. â¹"),void 0}var b=0,w=$("<h5>Single Badges</h5>");for(a.append(w),p=0;v.length>p;p++)if(l=v[p],"progressive"!=l.type)for(l.rewards.sort(s),o=0;l.rewards.length>o;o++)c=y[l.rewards[o].definition_id],g=(m[l.rewards[o].definition_id]||[]).length,g>0&&(f=d(c,g),a.append(f),b+=g);w.append(" ("+b+" earned)");var _=0,B=$("<h5>Badge Series</h5>");a.append(B);var x=$("<div></div>").addClass("coursera-badgeville-missions-header");for(x.append("<div></div>"),x.append("<h4>Bronze</h4>"),x.append("<h4>Silver</h4>"),x.append("<h4>Gold</h4>"),x.append("<h4>Diamond</h4>"),a.append(x),p=0;v.length>p;p++)if(l=v[p],"progressive"==l.type){var P=$("<div></div>").addClass("coursera-badgeville-missions-mission"),C=$("<div></div>");C.append("<h5>"+l.name+"</h5>"),P.append(C);var O=null,A=null;for(l.rewards.sort(s),o=0;l.rewards.length>o;o++){if(c=y[l.rewards[o].definition_id],g=(m[l.rewards[o].definition_id]||[]).length,f=d(c,g),0!==g||O||(O=c.hint,A=c.name.split("-")[0]),P.append(f),l.rewards.length-1>o){var S=$("<div></div>").addClass("coursera-badgeville-missions-bridge");P.append(S)}g&&(_+=g)}O?C.append("<p>To earn the next badge ("+A+"), "+r+" must "+O+".</p>"):C.append("<p>Congrats! You earned every badge in this series!</p>"),a.append(P)}B.append(" ("+_+" earned)")})}))},e.setupMissionsExplanation=function(i,a,n,r){function d(e){var i=$("<div></div>").css({"float":"left",position:"relative"}),a=$("<img></img>").css({width:"65px",height:"64px"});i.append(a),a.attr("src",e.image_medium_url);var n=RegExp(/\d+\s\w+/),r=e.tip.match(n)&&e.tip.match(n)[0];return r&&i.append("<div>"+r+"</div>").css({"text-align":"center","font-size":"13px"}),i}e.isAPILoaded()&&(r="you",e.getPlayerObject(e.getPlayerId(i),function(e){Badgeville.getAPI("player_site_missions",{id:e.id},function(e){a.empty();var i,n,r,t,s,l,p=e.missions,o={"border-bottom":"1px solid #CCC",clear:"left","padding-top":"15px"};for(a.append($("<h5>Single Badges</h5>").css(o)),n=0;p.length>n;n++)if(i=p[n],"ladder"!=i.type)for(r=0;i.reward_definitions.length>r;r++){t=i.reward_definitions[r];var c=$("<div></div>").css({"float":"left","margin-top":"10px"}),g=$("<div></div>").css({width:"300px","float":"left","padding-left":"8px"});g.append($("<h5>"+t.name+"</h5>").css({"margin-top":"0px","margin-bottom":"0px"})),g.append($("<p>To earn this badge, "+t.tip+"</p>").css({margin:"0px","margin-right":"10px"})),l=d(t),c.append(l),c.append(g),a.append(c)}a.append($("<h5>Badge Series</h5>").css(o)).css("clear","left");var f=$("<div></div>").css("clear","left");f.append($("<div>&nbsp;</div>").css({width:"300px","float":"left"}));var h={width:"63px","margin-right":"20px","text-align":"center","float":"left","font-size":"11px","margin-bottom":"0px","margin-top":"0px","text-transform":"uppercase"};for(f.append($("<h4>Bronze</h4>").css(h)),f.append($("<h4>Silver</h4>").css(h)),f.append($("<h4>Gold</h4>").css(h)),f.append($("<h4>Diamond</h4>").css(h)),a.append(f),n=0;p.length>n;n++)if(i=p[n],"ladder"==i.type){var u=$("<div></div>").css({"padding-top":"10px",clear:"left"}),v=$("<div></div>").css({width:"300px","float":"left"});for(v.append($("<h5>"+i.name+"</h5>").css("margin-top","0px")),v.append($("<p>To earn these badges, "+i.tip+"</p>").css({margin:"0px","margin-right":"10px"})),u.append(v),r=0;i.reward_definitions.length>r;r++)if(t=i.reward_definitions[r],s=i.reward_counters[t.id],l=d(t,s),u.append(l),i.reward_definitions.length-1>r){var y=$("<div></div>").css({"background-color":"#BDBDBD",width:"20px",height:"20px","float":"left","border-top":"4px solid lightGrey","border-bottom":"4px solid #9C9C9C","margin-top":"20px","margin-left":"-1px","margin-right":"-1px"});u.append(y)}a.append(u)}a.append('<p style="clear:both">* A reply/thread is considered "good" if it has been upvoted by 3 of your classmates.</p>')})}))},e.setPlayer=function(i){e.isEnabled()&&window.Badgeville.setPlayer({display_name:i.name,nickname:i.id,email:e.getPlayerId(i.id),picture_url:i.photo||null})},e.credit=function(i,a){e.isEnabled()&&window.Badgeville.credit(i,function(e){a&&a(e)})},e.creditOther=function(i,a){e.isEnabled()&&window.Badgeville.creditOther(e.getPlayerId(i),a)},e.getUserBucket=function(e){var i=[{top_byline:0,thread_byline:0,badge_ladder:0},{top_byline:0,thread_byline:0,badge_ladder:1},{top_byline:0,thread_byline:1,badge_ladder:0},{top_byline:0,thread_byline:1,badge_ladder:1},{top_byline:1,thread_byline:0,badge_ladder:0},{top_byline:1,thread_byline:0,badge_ladder:1},{top_byline:1,thread_byline:1,badge_ladder:0},{top_byline:1,thread_byline:1,badge_ladder:1}],a=i[e%8];return a},e.getWeek=function(e){var i=1,a=new Date(2013,3,22),n=e||new Date,r=n.getTime()-a.getTime(),d=r/1e3/60/60/24/7;return d>0&&(i=Math.ceil(d)),i},"function"==typeof define&&define.amd?define('js/lib/badgeville',["jquery"],function(i){return new e(i)}):window.BadgevilleUtil=e})();
define('pages/forum/models/ThreadModel',["jquery","underscore","backbone","js/lib/api","js/lib/util","pages/forum/app","pages/forum/models/PostModel","pages/forum/models/PostCollection","pages/forum/models/CommentModel","pages/forum/models/CommentCollection","js/lib/badgeville","js/lib/backbone.api","js/lib/backbone.relational"],function(t,e,r,s,i,o,a,n,u,d,c,l){var g=r.RelationalModel.extend({url:"forum/threads",subscriptionsUrl:function(){return this.url+"/"+this.get("id")+"/subscriptions"},tagsUrl:function(){return this.url+"/"+this.get("id")+"/tags"},triagePingUrl:function(){return this.url+"/"+this.get("id")+"/triage_ping"},api:o.api,partialUpdate:!0,defaults:{_user_profiles:{},tags:[],sort:"oldest"},relations:[{type:r.HasMany,key:"posts",relatedModel:a,collectionType:n,reverseRelation:{key:"thread"},includeInJSON:!0,collectionOptions:{comparator:function(t){return t.get("order")}}},{type:r.HasMany,key:"comments",relatedModel:u,collectionType:d,reverseRelation:{key:"thread"},includeInJSON:!0}],initialize:function(){this.bind("change",this.updateComputed,this),this.set("sort",i.getUrlParam(window.location,"sort"))},updateComputed:function(){var t=[];this.get("posts").each(function(e){t.push(e.get("user_id"))}),this.get("comments").each(function(e){t.push(e.get("user_id"))}),this.set("_user_ids",t,{silent:!0}),t.length>0&&(this.getUserProfiles(),this.updateProfilesOnEntries())},updateRange:function(){var t=this.getFirstPost(),e=this.getLastPost();this.set("start_range",t.get("order"),{silent:!0}),this.set("end_range",e.get("order"))},getPostsBefore:function(t){var r=this,s=r.getFirstPostId();this.api.get("forum/threads/"+this.get("id"),{data:{post_id:s,position:"before",sort:this.get("_sort_order")}}).done(e.bind(this.onFetchPosts,r,t))},getPostsAfter:function(t){var r=this,s=r.getLastPostId();this.api.get("forum/threads/"+this.get("id"),{data:{post_id:s,position:"after",sort:this.get("_sort_order")}}).done(e.bind(this.onFetchPosts,r,t))},onFetchPosts:function(t,e){e&&(this.get("posts").add(e.posts||[]),this.get("comments").add(e.comments||[])),this.updateRange(),t&&t.call(this)},getSavedPosts:function(){var t=this.get("posts").filter(function(t){return!t.isNew()});return t},getFullPosts:function(){var t=this.get("posts").filter(function(t){return t.get("post_time")});return t},getFirstPost:function(){return this.getFullPosts().shift()},getLastPost:function(){return this.getFullPosts().pop()},getFirstPostId:function(){return this.getFirstPost().get("id")},getLastPostId:function(){return this.getLastPost().get("id")},getCommentsForPost:function(t){var e=this.get("comments").filter(function(e){return e.get("post_id")==t.get("id")});return new d(e)},updateProfilesOnEntries:function(){var t=this;e.each(t.get("_user_profiles"),function(e){t.get("comments").each(function(t){t.get("user_id")!=e.id||t.get("_user_profile")||t.set("_user_profile",e)}),t.get("posts").each(function(t){t.get("user_id")!=e.id||t.get("_user_profile")||t.set("_user_profile",e)})})},getUserProfiles:function(){var t=this,r=e.filter(t.get("_user_ids"),function(e){return e&&!t.get("_user_profiles")[e]});r=e.uniq(r);var s=o.config.url.base+o.config.url.api+"user/profiles?user-ids="+r.join(",");o.apiWWW.get(s,{dataType:"jsonp",type:"get",success:function(r){e.each(r,function(e){t.get("_user_profiles")[e.id]||(t.get("_user_profiles")[e.id]=e),o.user.get("id")===e.id&&c.setPlayer({name:e.display_name,id:e.id,photo:e.photo_120})}),t.updateProfilesOnEntries()}})},getTotalVotes:function(){var t=0;return this.get("comments").each(function(e){t+=e.get("votes")||0}),this.get("posts").each(function(e){t+=e.get("votes")||0}),t},userContributed:function(t){var e=this,r=!1;return e.get("comments").each(function(e){e.get("user_id")==t&&(r=!0)}),e.get("posts").each(function(e){e.get("user_id")==t&&(r=!0)}),r},getURLForSortOrder:function(t){var e=window.location.pathname+window.location.search.split("&sort")[0]+"&sort="+t;return e},getTriageStatus:function(){var t=this;if(o.user.canModerateForum()&&t.get("id")&&t.get("courseId")){var e=o.config.url.base+o.config.url.api+"support/get_triage_status?"+"course_id="+t.get("courseId")+"&"+"thread_ids="+t.get("id");o.apiWWW.get(e,{dataType:"jsonp",type:"get",success:function(e){1==e.length&&t.set("triageStatus",e[0])}})}}});return e.extend(g.prototype,l),g});
define('pages/forum/models/ForumModel',["underscore","backbone","js/lib/backbone.api","js/lib/backbone.relational","js/lib/util","pages/forum/app"],function(e,t,a,r,i,s){var o=t.RelationalModel.extend({defaults:{},url:"forum/forums",api:s.api,subscriptionsUrl:function(){return this.url+"/"+this.get("id")+"/subscriptions"},readRecordsUrl:function(){return this.url+"/"+this.get("id")+"/read_records"},getParent:function(){return this.collection.get(this.get("parent_id"))},getFullName:function(){var e=this.getParent(),t=this.get("name");return e&&-1!=e.get("parent_id")?e.getFullName()+" > "+t:t}});return e.extend(o.prototype,a),o});
define('pages/forum/models/ThreadCollection',["backbone","pages/forum/models/ThreadModel"],function(e,t){var n=e.Collection.extend({model:t});return n});
define('pages/forum/models/ForumThreadsModel',["underscore","backbone","js/lib/backbone.api","js/lib/util","pages/forum/app","pages/forum/models/ThreadModel","pages/forum/models/ThreadCollection"],function(e,t,r,a,s,n,i){var o=t.Model.extend({defaults:{page:1,page_size:25,sort:"lastupdated",threads:new i},api:s.api,loadPage:function(e){var t=this,r="forum/forums/"+this.get("id")+"/threads";return s.api.get(r,{data:{sort:this.get("sort"),tag_id:this.get("tag_id"),tag_name:this.get("tag_name"),page:e,page_size:this.get("page_size")},message:{waiting:"Fetching forum threads...",success:"Fetched threads!"}}).done(function(e){e.threads=new i(e.threads),t.set(e),t.loadTriageStatus()})},loadTriageStatus:function(){var t=this;if(s.user.canModerateForum()&&t.get("threads")&&t.get("course_id")){var r=s.config.url.base+s.config.url.api+"support/get_triage_status?"+"course_id="+t.get("course_id")+"&"+"thread_ids="+this.get("threads").pluck("id").join(",");s.apiWWW.get(r,{dataType:"jsonp",type:"get",success:function(r){e.each(r,function(e){var r=t.get("threads").get(e.thread_id);r&&e.last_pinged&&r.set("_triage_status",e)}),t.set("_triage_update",(new Date).getTime())}})}}});return e.extend(o.prototype,r),o});
define('pages/forum/models/ReputationsCollection',["underscore","backbone","pages/forum/app","pages/forum/models/UserModel","js/lib/backbone.api"],function(e,r,a,t,o){var i=r.Collection.extend({model:t,url:"forum/reputations",api:a.api});return e.extend(i.prototype,o),i});
(function(wndw){var jadify=function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{})buf.push('<div><div class="course-forum-thread-crumbs"></div><div class="course-forum-thread-header-wrapper"></div><div class="course-forum-thread-sort"></div><div class="course-forum-thread-tags"></div><div class="course-forum-thread-area-container"><div class="course-forum-top-scroll-indicator">â¬ scroll up for more â¬</div><ul style="clear: right;" class="course-forum-thread-posts-container"></ul><div class="course-forum-bottom-scroll-indicator">â¬ scroll down for more â¬</div><div class="course-forum-thread-new-post"></div></div><div style="display:none; position: fixed; bottom: 10px; right: 40px; width: 240px;" class="alert alert-info course-forum-hangouts-popup"><button type="button" data-action="hide" class="close">&times;</button>This looks like a great topic! Maybe you\'d like to...<a style="margin-bottom:6px;" data-action="start" class="btn btn-info">Start a Google+ Hangout on this topic</a><p style="margin-bottom:10px; display:none;">Go to <a href="https://class.coursera.org/behavioralecon-001/wiki/view?page=ScheduleGoogleHangouts&from_popout" target="_blank">the scheduler page</a> to learn how, and post the URL to this thread after to let people know.</p><a data-action="join" class="btn btn-info">Join a Google+ Hangout on this topic</a><p style="margin-bottom:15px; display:none;">Hm, it looks like there\'s none yet on this topic, but you can <a href="https://class.coursera.org/behavioralecon-001/wiki/view?page=ScheduleGoogleHangouts&from_popout" target="_blank">go here</a> to check out all the upcoming hangouts or schedule your own.</p><a href="javascript:void(0)" data-action="nothanks">No, thanks, I\'m not interested in hangouts.</a></div></div>');return buf.join("")}};"function"==typeof define&&define.amd?define('pages/forum/views/ThreadView.html',["js/lib/jade"],function(t){return jadify(t)}):wndw.jade.templates.ThreadView=jadify(wndw.jade.helpers)})(window);
(function(wndw){var jadify=function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{})thread.get("num_posts")>1&&(buf.push('<ul class="nav nav-pills pull-right"><li><span style="padding: 8px; display: inline-block;">Sort replies by:</span></li><li data-sort-name="oldest"><a'),buf.push(attrs({href:thread.getURLForSortOrder("oldest")},{href:!0})),buf.push('>Oldest first</a></li><li data-sort-name="newest"><a'),buf.push(attrs({href:thread.getURLForSortOrder("newest")},{href:!0})),buf.push('>Newest first</a></li><li data-sort-name="popular"><a'),buf.push(attrs({href:thread.getURLForSortOrder("popular")},{href:!0})),buf.push(">Most popular</a></li></ul>"));return buf.join("")}};"function"==typeof define&&define.amd?define('pages/forum/views/ThreadSortView.html',["js/lib/jade"],function(e){return jadify(e)}):wndw.jade.templates.ThreadSortView=jadify(wndw.jade.helpers)})(window);
(function(wndw){var jadify=function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{}){var interp;buf.push('<ul class="course-forum-breadcrumb">'),_.each(crumbs,function(e,t){buf.push("<li><a"),buf.push(attrs({href:e.link},{href:!0})),buf.push(">"+escape(null==(interp=e.title)?"":interp)+"</a>"),t!==crumbs.length-1&&buf.push('<span class="divider"> / </span>'),buf.push("</li>")}),buf.push("</ul>")}return buf.join("")}};"function"==typeof define&&define.amd?define('pages/forum/views/ForumCrumbsView.html',["js/lib/jade"],function(e){return jadify(e)}):wndw.jade.templates.ForumCrumbsView=jadify(wndw.jade.helpers)})(window);
(function(wndw){var jadify=function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{}){var interp;buf.push('<div class="course-forum-thread-title"><h2>'+escape(null==(interp=thread.get("title"))?"":interp)+'</h2></div><div class="course-forum-thread-header"><div class="course-forum-thread-controls">'),thread.get("stickied")&&buf.push('<span title="This thread was pinned." class="course-forum-thread-indicator course-forum-indicator-good"><i title="Pinned Post" class="icon-pushpin"></i> Pinned</span>'),thread.get("approved")&&buf.push('<span title="This thread was approved by staff." class="course-forum-thread-indicator course-forum-indicator-good"><i class="icon-star"></i> Approved</span>'),thread.get("_forum_can_be_resolved")&&0===thread.get("unresolved")&&buf.push('<span title="This thread was marked as resolved." class="course-forum-thread-indicator course-forum-indicator-good"><i class="icon-check"></i> Resolved</span>'),thread.get("locked")&&buf.push('<span title="This thread was locked by an admin." class="course-forum-thread-indicator"><i class="icon-lock"></i> Locked</span>'),thread.get("is_spam")&&buf.push('<span title="This thread was marked as spam by an admin." class="course-forum-thread-indicator course-forum-indicator-bad"><i class="icon-trash"></i> Spam</span>'),1==thread.get("deleted")&&buf.push('<span title="This thread was deleted by an admin." class="course-forum-thread-indicator course-forum-indicator-bad"><i class="icon-trash"></i> Deleted</span>');var popupId="course-forum-thread-controls-popup"+thread.get("id");(thread.get("_viewer_can_resolve")||thread.get("_viewer_can_delete")||thread.get("_viewer_can_edit_title")||user.canModerateForum())&&(buf.push("<a"),buf.push(attrs({title:"Thread controls",tabindex:"0",role:"button","aria-haspopup":"true","aria-expanded":"false","aria-owns":popupId,"data-popup":"#"+popupId,"data-popup-direction":"se","class":"course-forum-thread-controls-toggle"},{title:!0,tabindex:!0,role:!0,"aria-haspopup":!0,"aria-expanded":!0,"aria-owns":!0,"data-popup":!0,"data-popup-direction":!0})),buf.push('><i class="icon-cog"><span class="hidden">Thread controls</span></i></a><div'),buf.push(attrs({id:popupId,"class":"course-forum-thread-controls-popup hide"},{id:!0})),buf.push(">"),user.canModerateForum()&&(thread.get("locked")?buf.push('<a href="javascript:void(0)" data-property="locked" data-value="0" class="course-forum-thread-action-link">Un-lock</a>'):buf.push('<a href="javascript:void(0)" data-property="locked" data-value="1" class="course-forum-thread-action-link">Lock</a>'),thread.get("stickied")?buf.push('<a href="javascript:void(0)" data-property="stickied" data-value="0" class="course-forum-thread-action-link">Un-pin</a>'):buf.push('<a href="javascript:void(0)" data-property="stickied" data-value="1" class="course-forum-thread-action-link">Pin</a>'),thread.get("approved")?buf.push('<a href="javascript:void(0)" data-property="approved" data-value="0" class="course-forum-thread-action-link">Un-approve</a>'):buf.push('<a href="javascript:void(0)" data-property="approved" data-value="1" class="course-forum-thread-action-link">Approve</a>'),thread.get("is_spam")?buf.push('<a href="javascript:void(0)" data-property="is_spam" data-value="0" class="course-forum-thread-action-link">Not spam</a>'):buf.push('<a href="javascript:void(0)" data-property="is_spam" data-value="1" class="course-forum-thread-action-link">Spam</a>')),thread.get("_viewer_can_edit_title")&&buf.push('<a href="javascript:void(0)" class="course-forum-thread-edit-title-link">Edit title</a>'),thread.get("_viewer_can_delete")&&(thread.get("deleted")?buf.push('<a href="javascript:void(0)" data-property="deleted" data-value="0" class="course-forum-thread-action-link">Un-delete</a>'):buf.push('<a href="javascript:void(0)" data-property="deleted" data-value="1" class="course-forum-thread-action-link">Delete</a>')),thread.get("_forum_can_be_resolved")&&thread.get("_viewer_can_resolve")&&(0===thread.get("unresolved")?buf.push('<a href="javascript:void(0)" data-property="unresolved" data-value="1" class="course-forum-thread-action-link">Un-resolve</a>'):buf.push('<a href="javascript:void(0)" data-property="unresolved" data-value="0" class="course-forum-thread-action-link">Resolve</a>')),user.canModerateForum()&&buf.push('<a href="javascript:void(0)" class="course-forum-thread-admin-details-link">Show Admin Details</a>'),thread.get("triageEnabled")&&user.canModerateForum()&&(buf.push('<a href="javascript:void(0)" class="course-forum-thread-ping-coursera">'),thread.get("triageStatus")&&thread.get("triageStatus").last_pinged?buf.push("Re-notify Coursera"):buf.push("Notify Coursera"),buf.push("</a>")),buf.push("</div>")),buf.push('</div><div style="margin-right:10px; display:inline-block;">'),thread.get("_viewer_subscription")?buf.push('<i class="icon-envelope"></i> You are subscribed.  <a href="javascript:void(0);" class="course-forum-thread-unsubscribe-link">Unsubscribe</a>'):buf.push('<a href="javascript:void(0);" class="course-forum-thread-subscribe-link">Subscribe for email updates.</a>'),buf.push("</div>"),thread.get("triageEnabled")&&thread.get("triageStatus")&&thread.get("triageStatus").last_pinged&&(buf.push('<div style="margin-right:10px; display:inline-block">'),thread.get("triageStatus").status_resolved?buf.push('<i class="icon-check"></i> Issue resolved. (Please re-notify us if there are still problems).'):buf.push('<i class="icon-exclamation-sign"></i> Coursera notified '+escape(null==(interp=thread.get("triageStatus").last_pinged_pretty)?"":interp)+".\n Priority: "+escape(null==(interp=thread.get("triageStatus").priority_label)?"":interp)+".\n Status: "+escape(null==(interp=thread.get("triageStatus").status_label)?"":interp)+"."),buf.push("</div>")),buf.push("</div>")}return buf.join("")}};"function"==typeof define&&define.amd?define('pages/forum/views/ThreadHeaderView.html',["js/lib/jade"],function(e){return jadify(e)}):wndw.jade.templates.ThreadHeaderView=jadify(wndw.jade.helpers)})(window);
(function(wndw){var jadify=function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{})buf.push('<form class="form-inline"><input'),buf.push(attrs({type:"text",value:thread.get("title"),style:"height:100%;"},{type:!0,value:!0,style:!0})),buf.push('/><button type="submit" style="margin-left: 10px;" class="btn">Save</button><span>&nbsp; &nbsp;</span><a href="javascript:void(0)" role="Button">Cancel</a></form>');return buf.join("")}};"function"==typeof define&&define.amd?define('pages/forum/views/ThreadTitleEditView.html',["js/lib/jade"],function(e){return jadify(e)}):wndw.jade.templates.ThreadTitleEditView=jadify(wndw.jade.helpers)})(window);
(function(wndw){var jadify=function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{})buf.push('<div data-modal-overlay-class="course-modal-overlay-light" style="width:800px;" class="modal hide course-forum-ping-modal"> <div class="modal-header"><a href="javascript:void(0)" data-modal-close="data-modal-close" class="close">Ã</a><h3>Notify Coursera</h3></div><div style="max-height:550px;" class="modal-body"><p>Please choose a priority using the following guidelines: </p><ul><li>Individual Student Issue: affects one or a small group of students (eg. a student can\'t find their Statement of Accomplishment, a student is having trouble viewing lectures)</li><li>Class-Wide Issue: potentially affects all students but does not block progress in the course (eg. course logo has disappeared, a quiz question is definitely incorrect)</li><li>Urgent Issue: needs to be addressed within 24 hours (eg. all students get an error message, a course page was accidentally deleted, all students are unable to submit a quiz)</li></ul><div class="control-group"><label class="control-label">Priority</label><div class="controls"><select name="priority" class="course-forum-ping-priority"><option value="1">Individual Student Issue </option><option value="2">Class-Wide Issue </option><option value="3">Urgent Issue </option></select></div><label class="control-label">Notes (optional)</label><div class="controls"><textarea style="height: 100px; width:90%;" name="notes" class="course-forum-ping-notes"></textarea></div></div><div class="control-group"><div class="controls"><button type="submit" value="value" class="btn course-forum-ping-coursera-send">Send to Coursera</button><span class="course-forum-ping-modal-status"></span></div></div></div></div>');return buf.join("")}};"function"==typeof define&&define.amd?define('pages/forum/views/PingView.html',["js/lib/jade"],function(e){return jadify(e)}):wndw.jade.templates.PingView=jadify(wndw.jade.helpers)})(window);
(function(t){var e=function(t,e,o){var i=38,n=40,s=32,r=27,p=1,a=0,u={defaults:{"bind.open":"click","bind.close":"click","bind.cancel.document":"mousemove","bind.cancel.popup":"mouseleave","bind.uncancel.popup":"mouseenter","bind.keydown":"keydown",direction:"sw","offset.x":0,"offset.y":0,timeout:450,"timeout.intent":350,resize:!1,width:!1,"attribute.open":"data-popup","attribute.close":"data-popup-close","attribute.item":"data-popup-item",position:"absolute"},prevPopup:null,prevTimeout:null,timeout:null,timeoutClear:null,getPopup:function(e,o){var i=t(e).data("popup.me");return i&&i.constructor==c.prototype.constructor?o?i.customize(o):i:null},getPopupForAnchor:function(o,i){var n=o.attr(u.defaults["attribute.open"]),s=t(n),r=u.readDataAttributes(o,"data-popup-",e.extend({},u.defaults,i)),p=u.makePopup(s,r);return p},closeOlderPopups:function(){u.prevPopup&&(u.prevPopup.close(),u.prevPopup=null)},isTouch:"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch,makePopup:function(e,o){var i,n=t(e);return i=n.attr("data-popup")?u.getPopupForAnchor(n):u.getPopup(n),i||(i=new c(n,o),n.data("popup.me",i)),i},monitorKeys:function(t){e.contains([i,n],t.keyCode)&&(t.preventDefault(),t.stopPropagation(),u.changeFocus.call(this,t)),t.keyCode==r&&(this.$anchor.focus(),this.close())},monitorActions:function(e){this.$el[0];var o=t(e.target),i=this;if("mouseleave"!=e.type){if(o.closest(this.$el).size()>0||o.closest(this.$anchor).size()>0)return window.clearTimeout(u.timeout),void 0}else u.timeout=window.setTimeout(function(){i.state==p&&i.close()},this.options.timeout)},readDataAttributes:function(t,e,o){var i={};for(var n in o){var s=t.attr(e+n.replace(/\./g,"-"));i[n]=void 0===s?o[n]:s}return i},intentOpen:function(e,o,i){var n=i[0];e.pageX,e.pageY,u.prevTimeout&&(t(document).off(".popup"),window.clearTimeout(u.prevTimeout)),u.prevTimeout=window.setTimeout(function(){window.clearTimeout(u.prevTimeout),t(document).off(".popup"),o.isOpen()||o.open(i)},o.options["timeout.intent"]),t(document).on("mousemove.popup mouseleave.popup",function(e){("mouseleave"==e.type||e.target!=n&&0===t(e.target).closest(n).size())&&(t(document).off(".popup"),window.clearTimeout(u.prevTimeout))})},changeFocus:function(t){if(this.$anchor){var e=this.$anchor.attr(this.options["attribute.item"]),o=this.$el.children(":visible");e&&(o=o.filter(e)),o.length&&(index=o.index(o.filter(":focus")),t.keyCode==i&&index--,t.keyCode==n&&index++,0>index||index>=o.length?this.$anchor.focus():o.length>index&&o.eq(index).focus())}}},c=function(e,o){this.$el=t(e),this.$parent=this.$el.parent(),this.$anchor=null,this.customize(o)};c.prototype.customize=function(t){return this.options=e.extend({},u.defaults,t),this.options["offset.x"]=parseInt(this.options["offset.x"],10),this.options["offset.y"]=parseInt(this.options["offset.y"],10),this},c.prototype.get=function(){return this.$el},c.prototype.open=function(o){var i=this,n=t(o);if(!this.$anchor||this.$anchor[0]!=n[0]){var s=n.position();this.$anchor=n,this.$anchor.parent().append(this.$el),this.$anchor.attr("aria-expanded","true"),i.options.resize&&this.$el.width(this.$anchor.outerWidth()),i.options.width&&this.$el.css("width",i.options.width),this.trigger("opening",this.$anchor),this.options.direction&&"sw"!=this.options.direction?"se"==this.options.direction?this.move(s.left+n.outerWidth()+this.options["offset.x"]-this.$el.outerWidth(),s.top+n.outerHeight()+this.options["offset.y"]):"ne"==this.options.direction?this.move(s.left+n.outerWidth()+this.options["offset.x"]-this.$el.outerWidth(),s.top-this.$el.outerHeight()-this.options["offset.y"]):"s"==this.options.direction?this.move(s.left+n.outerWidth()/2+this.options["offset.x"]-this.$el.outerWidth()/2,s.top+n.outerHeight()+this.options["offset.y"]):"n"==this.options.direction?this.move(s.left+n.outerWidth()/2+this.options["offset.x"]-this.$el.outerWidth()/2,s.top-this.$el.outerHeight()+this.options["offset.y"]):"w"==this.options.direction&&this.move(s.left+this.options["offset.x"]-this.$el.outerWidth(),s.top+this.options["offset.y"]):this.move(s.left+this.options["offset.x"],s.top+n.outerHeight()+this.options["offset.y"]),this.$el.show(),window.setTimeout(function(){u.closeOlderPopups(),n.addClass("popup-opened").focus(),i.trigger("opened",i.$anchor),i.state=p,u.prevPopup=i,i.$el.on(i.options["bind.cancel.popup"]+".popup",e.bind(u.monitorActions,i)),i.$anchor.on(i.options["bind.cancel.popup"]+".popup",e.bind(u.monitorActions,i)),i.$el.on(i.options["bind.uncancel.popup"]+".popup",e.bind(u.monitorActions,i)),i.$anchor.on(i.options["bind.uncancel.popup"]+".popup",e.bind(u.monitorActions,i)),t(document).on(i.options["bind.cancel.document"]+".popup",e.bind(u.monitorActions,i)).on(i.options["bind.keydown"]+".popup",e.bind(u.monitorKeys,i)),i.options["attribute.close"]&&i.$el.on(i.options["bind.close"]+".popup","["+i.options["attribute.close"]+"]",function(e){"disabled"!=t(e.currentTarget).attr("disabled")&&i.close()})},0)}return this},c.prototype.move=function(t,e,o){return this.$el.css({left:t,top:e,"z-index":o||1e4,position:this.options.position}),this},c.prototype.close=function(){return t(document).off(".popup"),this.$anchor.attr("aria-expanded","false"),this.$anchor.removeClass("popup-opened"),this.trigger("closing",this.$anchor),this.$el.off(".popup").hide(),this.$anchor.off(".popup"),this.$parent.append(this.$el),this.trigger("closed",this.$anchor),this.$anchor=null,this.state=a,window.clearTimeout(this.timeout),u.prevPopup=null,this},c.prototype.isOpen=function(){return this.$el.is(":visible")},e.extend(c.prototype,o.Events);var l=function(){return u.getPopup.apply(null,arguments)||u.makePopup.apply(this,arguments)};return l.start=function(o,r){function p(t,e){t.isOpen()||t.open(e)}var a=t(o),c=e.extend({},u.defaults,r);a.on("click.popup mouseenter.popup keydown.popup","["+c["attribute.open"]+"]",function(o){var a=t(this),c=a.attr("data-popup-bind-open");if("disabled"!=a.attr("disabled")){var l=u.getPopupForAnchor(a,r);"keydown"==o.type&&e.contains([i,n,s],o.keyCode)&&(o.preventDefault(),o.stopPropagation(),o.keyCode==n||o.keyCode==s?(l.isOpen()||p(l,a),u.changeFocus.call(l,o)):o.keyCode==i&&l.isOpen()&&l.close()),(o.type==c||!c&&"click"==o.type||u.isTouch&&"click"==o.type)&&("mouseover"==o.type||"mouseenter"==o.type?u.intentOpen(o,l,a):p(l,a))}})},l.stop=function(e){var o=t(e);o.off(".popup"),u.closeOlderPopups()},l.start("body"),l};"function"==typeof define&&define.amd?define('js/lib/popups',["jquery","underscore","backbone"],function(t,o,i){return e(t,o,i)}):t.Popup=e(t.$,t._,t.Backbone)})(window);
define('pages/forum/views/ThreadHeaderView',["backbone","jquery","underscore","pages/forum/app","pages/forum/views/ThreadHeaderView.html","pages/forum/views/ThreadTitleEditView.html","pages/forum/views/PingView.html","js/lib/popups","js/lib/modals"],function(e,t,o,r,i,n,s,a,u){var c="Forum Thread",l=["title","stickied","approved","unresolved","locked","deleted","is_spam","_viewer_subscription","_viewer_can_delete","_viewer_can_edit_title","_viewer_can_resolve","triageStatus"],d=e.View.extend({defaults:{},events:{"click .course-forum-thread-action-link":"onThreadActionClick","click .course-forum-thread-controls-toggle .icon-cog":"onGearClick","click .course-forum-thread-subscribe-link":"onThreadSubscribeClick","click .course-forum-thread-unsubscribe-link":"onThreadUnsubscribeClick","click .course-forum-thread-edit-title-link":"onThreadEditTitleClick","click .course-forum-thread-title button":"onThreadEditTitleSave","click .course-forum-thread-title a":"onThreadEditTitleCancel","click .course-forum-thread-ping-coursera":"onThreadPingCourseraClick","click .course-forum-ping-coursera-send":"onThreadPingCourseraSend"},initialize:function(){this.thread=this.model,this.thread.bind("change",this.render,this)},render:function(){var e=this.thread.changedAttributes();return(!this.$(".course-forum-thread-controls").length||e&&o.intersection(o.keys(e),l).length>0)&&this.renderViewMode(),this},renderViewMode:function(){this.$el.html(i({config:r.config,user:r.user,thread:this.thread})),this.$title=this.$(".course-forum-thread-title")},onGearClick:function(){r.multitracker.push([c,"Controls Open"])},onThreadActionClick:function(e){var o=this,i=t(e.target),n=i.attr("data-property"),s=i.attr("data-value"),a={};a[n]=s,this.thread.update(a,{message:{waiting:"Processing...",success:"Processed!"}}).done(function(e){o.thread.set(e)}),r.multitracker.push([c,"Action "+n+" "+s])},onThreadEditTitleClick:function(){var e=this,t=e.$title.height();e.$title.html(n({user:r.user,thread:this.thread})),e.$title.find("form").height(t).focus(),e.$title.find("input").focus(),e.$title.find(".course-forum-thread-title button").attr("disabled",null),r.multitracker.push([c,"Title Edit Start"])},onThreadEditTitleSave:function(e){e.preventDefault();var t=this;t.thread.update({title:t.$("input").val()},{message:{waiting:"Saving title...",success:"Saved title!"}}).done(function(e){t.thread.set(e)}),t.$title.find(".course-forum-thread-title button").attr("disabled","disabled"),r.multitracker.push([c,"Title Edit Save"])},onThreadEditTitleCancel:function(e){e.preventDefault(),this.renderViewMode(),r.multitracker.push([c,"Title Edit Cancel"])},onThreadSubscribeClick:function(){var e=this;r.api.post(this.model.subscriptionsUrl(),{message:{waiting:"Subscribing...",success:"Subscribed!"}}).done(function(t){e.thread.set({_viewer_subscription:t})})},onThreadUnsubscribeClick:function(){var e=this;r.api["delete"](this.model.subscriptionsUrl(),{message:{waiting:"Unsubscribing...",success:"Unsubscribed!"}}).done(function(t){e.thread.set({_viewer_subscription:t})})},onThreadPingCourseraClick:function(){this.pingModal||(this.$el.append(s()),this.pingModal=new u(this.$(".course-forum-ping-modal"))),this.pingModal.open()},onThreadPingCourseraSend:function(){var e=this;r.api.post(e.model.triagePingUrl(),{message:{waiting:"Sending...",success:"Sent!"},data:{priority:e.$(".course-forum-ping-priority").val(),notes:e.$(".course-forum-ping-notes").val()}}).done(function(){e.thread.getTriageStatus(),e.$(".course-forum-ping-modal-status").text(""),e.pingModal.close()}).fail(function(t){e.$(".course-forum-ping-modal-status").css("color","red"),e.$(".course-forum-ping-modal-status").text("Error: "+t.responseText)}),e.$(".course-forum-ping-modal-status").css("color","black"),e.$(".course-forum-ping-modal-status").text("Sending...")}});return d});
(function(wndw){var jadify=function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{}){var interp;buf.push("<link"),buf.push(attrs({href:config.url.assets+"pages/home/account/select2.css",rel:"stylesheet",type:"text/css"},{href:!0,rel:!0,type:!0})),buf.push('/><h5 style="display:inline-block;"> <span class="hidden">Tags </span><i class="icon-tags"></i>&nbsp;</h5>'),thread.get("tags").length?(buf.push('<ul style="display:inline-block;" class="unstyled">'),function(){if("number"==typeof thread.get("tags").length)for(var e=0,t=thread.get("tags").length;t>e;e++){var n=thread.get("tags")[e];buf.push('<li class="course-forum-thread-tag"><a'),buf.push(attrs({href:n.link},{href:!0})),buf.push(">"+escape(null==(interp=n.tag_name)?"":interp)+"</a>&nbsp;<a"),buf.push(attrs({"data-tag":n.tag_name,href:"javascript:void(0)","class":"course-forum-thread-tag-delete"},{"data-tag":!0,href:!0})),buf.push('><span class="hidden">Delete Tag</span>Ã</a></li>')}else{var t=0;for(var e in thread.get("tags")){t++;var n=thread.get("tags")[e];buf.push('<li class="course-forum-thread-tag"><a'),buf.push(attrs({href:n.link},{href:!0})),buf.push(">"+escape(null==(interp=n.tag_name)?"":interp)+"</a>&nbsp;<a"),buf.push(attrs({"data-tag":n.tag_name,href:"javascript:void(0)","class":"course-forum-thread-tag-delete"},{"data-tag":!0,href:!0})),buf.push('><span class="hidden">Delete Tag</span>Ã</a></li>')}}}.call(this),buf.push("</ul>")):buf.push("<span>No tags yet.</span>"),buf.push('&nbsp;<a href="javascript:void(0)" class="course-forum-thread-tags-link">+ Add Tag</a><form class="course-forum-thread-tags-form form-inline hide"><label>Please try to use existing tags.   &nbsp;</label><input type="text" name="tags" style="margin-left:10px" class="input-medium"/><button type="button" style="margin-left:10px" disabled="disabled" class="btn">Save</button><a href="javascript:void(0)" role="button" style="margin-left:10px">Cancel</a></form>')}return buf.join("")}};"function"==typeof define&&define.amd?define('pages/forum/views/ThreadTagsView.html',["js/lib/jade"],function(e){return jadify(e)}):wndw.jade.templates.ThreadTagsView=jadify(wndw.jade.helpers)})(window);
(function(){var t=function(t){function e(t){return t&&"string"==typeof t?t.replace(/&/g,"&amp;"):t}function n(t,e){var n,r=0,i=e.length;if(t===void 0)return-1;if(t.constructor===String){for(;i>r;r+=1)if(0===t.localeCompare(e[r]))return r}else for(;i>r;r+=1)if(n=e[r],n.constructor===String){if(0===n.localeCompare(t))return r}else if(n===t)return r;return-1}function r(t,e){return t===e?!0:void 0===t||void 0===e?!1:null===t||null===e?!1:t.constructor===String?0===t.localeCompare(e):e.constructor===String?0===e.localeCompare(t):!1}function i(e,n){var r,i,o;if(null===e||1>e.length)return[];for(r=e.split(n),i=0,o=r.length;o>i;i+=1)r[i]=t.trim(r[i]);return r}function o(t){return t.outerWidth()-t.width()}function a(e){var n="keyup-change-value";e.bind("keydown",function(){void 0===t.data(e,n)&&t.data(e,n,e.val())}),e.bind("keyup",function(){var r=t.data(e,n);void 0!==r&&e.val()!==r&&(t.removeData(e,n),e.trigger("keyup-change"))})}function s(e){e.bind("mousemove",function(e){var n=t.data(document,"select2-lastpos");(void 0===n||n.x!==e.pageX||n.y!==e.pageY)&&t(e.target).trigger("mousemove-filtered",e)})}function l(t,e){var n;return function(){window.clearTimeout(n),n=window.setTimeout(e,t)}}function u(t){var e,n=!1;return function(){return n===!1&&(e=t(),n=!0),e}}function c(t,e){var r=l(t,function(t){e.trigger("scroll-debounced",t)});e.bind("scroll",function(t){n(t.target,e.get())>=0&&r(t)})}function d(t){t.preventDefault(),t.stopPropagation()}function h(e){if(!T){var n=e[0].currentStyle||window.getComputedStyle(e[0],null);T=t("<div></div>").css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:n.fontSize,fontFamily:n.fontFamily,fontStyle:n.fontStyle,fontWeight:n.fontWeight,letterSpacing:n.letterSpacing,textTransform:n.textTransform,whiteSpace:"nowrap"}),t("body").append(T)}return T.text(e.val()),T.width()}function f(t,e,n){var r=t.toUpperCase().indexOf(e.toUpperCase()),i=e.length;return 0>r?(n.push(t),void 0):(n.push(t.substring(0,r)),n.push("<span class='select2-match'>"),n.push(t.substring(r,r+i)),n.push("</span>"),n.push(t.substring(r+i,t.length)),void 0)}function p(e){var n,r=0,i=null,o=e.quietMillis||100;return function(a){window.clearTimeout(n),n=window.setTimeout(function(){r+=1;var n=r,o=e.data,s=e.transport||t.ajax,l=e.traditional||!1,u=e.type||"GET";o=o.call(this,a.term,a.page,a.context),null!==i&&i.abort(),i=s.call(null,{url:e.url,dataType:e.dataType,data:o,type:u,traditional:l,success:function(t){if(!(r>n)){var i=e.results(t,a.page);a.callback(i)}}})},o)}}function g(e){var n,r=e,i=function(t){return""+t.text};return t.isArray(r)||(i=r.text,t.isFunction(i)||(n=r.text,i=function(t){return t[n]}),r=r.results),function(e){var n=e.term,o={};return""===n?(e.callback({results:r}),void 0):(o.results=t(r).filter(function(){return e.matcher(n,i(this))}).get(),e.callback(o),void 0)}}function m(e){return t.isFunction(e)?e:function(n){var r=n.term,i={results:[]};t(e).each(function(){var t=void 0!==this.text,e=t?this.text:this;(""===r||n.matcher(r,e))&&i.results.push(t?this:{id:this,text:this})}),n.callback(i)}}function v(e){if(t.isFunction(e))return!0;if(!e)return!1;throw Error("formatterName must be a function or a falsy value")}function y(e){return t.isFunction(e)?e():e}function b(e){var n=0;return t.each(e,function(t,e){e.children?n+=b(e.children):n++}),n}function w(t,e,n,i){var o,a,s,l,u,c=t,d=!1;if(!i.createSearchChoice||!i.tokenSeparators||1>i.tokenSeparators.length)return void 0;for(;;){for(a=-1,s=0,l=i.tokenSeparators.length;l>s&&(u=i.tokenSeparators[s],a=t.indexOf(u),!(a>=0));s++);if(0>a)break;if(o=t.substring(0,a),t=t.substring(a+u.length),o.length>0&&(o=i.createSearchChoice(o,e),void 0!==o&&null!==o&&void 0!==i.id(o)&&null!==i.id(o))){for(d=!1,s=0,l=e.length;l>s;s++)if(r(i.id(o),i.id(e[s]))){d=!0;break}d||n(o)}}return 0!=c.localeCompare(t)?t:void 0}function x(e,n){var r=function(){};return r.prototype=new e,r.prototype.constructor=r,r.prototype.parent=e.prototype,r.prototype=t.extend(r.prototype,n),r}if(t.fn.each2===void 0&&t.fn.extend({each2:function(e){for(var n=t([0]),r=-1,i=this.length;i>++r&&(n.context=n[0]=this[r])&&e.call(n[0],r,n)!==!1;);return this}}),void 0===window.Select2){var C,k,A,E,S,T;C={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(t){switch(t=t.which?t.which:t){case C.LEFT:case C.RIGHT:case C.UP:case C.DOWN:return!0}return!1},isControl:function(t){var e=t.which;switch(e){case C.SHIFT:case C.CTRL:case C.ALT:return!0}return t.metaKey?!0:!1},isFunctionKey:function(t){return t=t.which?t.which:t,t>=112&&123>=t}},S=function(){var t=1;return function(){return t++}}(),t(document).delegate("*","mousemove",function(e){t.data(document,"select2-lastpos",{x:e.pageX,y:e.pageY})}),t(document).ready(function(){t(document).delegate("*","mousedown touchend",function(e){var n,r=t(e.target).closest("div.select2-container").get(0);r?t(document).find("div.select2-container-active").each(function(){this!==r&&t(this).data("select2").blur()}):(r=t(e.target).closest("div.select2-drop").get(0),t(document).find("div.select2-drop-active").each(function(){this!==r&&t(this).data("select2").blur()})),r=t(e.target),n=r.attr("for"),"LABEL"===e.target.tagName&&n&&n.length>0&&(r=t("#"+n),r=r.data("select2"),void 0!==r&&(r.focus(),e.preventDefault()))})}),k=x(Object,{bind:function(t){var e=this;return function(){t.apply(e,arguments)}},init:function(e){var n,r,i=".select2-results";this.opts=e=this.prepareOpts(e),this.id=e.id,void 0!==e.element.data("select2")&&null!==e.element.data("select2")&&this.destroy(),this.enabled=!0,this.container=this.createContainer(),this.containerId="s2id"+S(),this.container.attr("id",this.containerId),this.body=u(function(){return e.element.closest("body")}),void 0!==e.element.attr("class")&&this.container.addClass(e.element.attr("class")),this.container.css(y(e.containerCss)),this.container.addClass(y(e.containerCssClass)),this.opts.element.data("select2",this).hide().before(this.container),this.container.data("select2",this),this.dropdown=this.container.find(".select2-drop"),this.dropdown.addClass(y(e.dropdownCssClass)),this.dropdown.data("select2",this),this.results=n=this.container.find(i),this.search=r=this.container.find("input.select2-input"),r.attr("tabIndex",this.opts.element.attr("tabIndex")),this.resultsPage=0,this.context=null,this.initContainer(),this.initContainerWidth(),s(this.results),this.dropdown.delegate(i,"mousemove-filtered",this.bind(this.highlightUnderEvent)),c(80,this.results),this.dropdown.delegate(i,"scroll-debounced",this.bind(this.loadMoreIfNeeded)),t.fn.mousewheel&&n.mousewheel(function(t,e,r,i){var o=n.scrollTop();i>0&&0>=o-i?(n.scrollTop(0),d(t)):0>i&&n.get(0).scrollHeight-n.scrollTop()+i<=n.height()&&(n.scrollTop(n.get(0).scrollHeight-n.height()),d(t))}),a(r),r.bind("keyup-change",this.bind(this.updateResults)),r.bind("focus",function(){r.addClass("select2-focused")," "===r.val()&&r.val("")}),r.bind("blur",function(){r.removeClass("select2-focused")}),this.dropdown.delegate(i,"mouseup",this.bind(function(e){t(e.target).closest(".select2-result-selectable:not(.select2-disabled)").length>0?(this.highlightUnderEvent(e),this.selectHighlighted(e)):this.focusSearch(),d(e)})),this.dropdown.bind("click mouseup mousedown",function(t){t.stopPropagation()}),t.isFunction(this.opts.initSelection)&&(this.initSelection(),this.monitorSource()),(e.element.is(":disabled")||e.element.is("[readonly='readonly']"))&&this.disable()},destroy:function(){var t=this.opts.element.data("select2");void 0!==t&&void 0!==t.opts&&(t.container.remove(),t.dropdown.remove(),t.opts.element.removeData("select2").unbind(".select2").show())},prepareOpts:function(n){var o,a,s,l;if(o=n.element,"select"===o.get(0).tagName.toLowerCase()&&(this.select=a=n.element),a&&t.each(["id","multiple","ajax","query","createSearchChoice","initSelection","data","tags"],function(){if(this in n)throw Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.")}),n=t.extend({},{populateResults:function(r,i,o){var a,s=this.opts.id,l=this;a=function(r,i,u){var c,d,h,f,p,g,m,v,y;for(c=0,d=r.length;d>c;c+=1)h=r[c],f=void 0!==s(h),p="children"in h&&h.children.length>0,g=t("<li></li>"),g.addClass("select2-results-dept-"+u),g.addClass("select2-result"),g.addClass(f?"select2-result-selectable":"select2-result-unselectable"),p&&g.addClass("select2-result-with-children"),g.addClass(l.opts.formatResultCssClass(h)),m=t("<div></div>"),m.addClass("select2-result-label"),y=n.formatResult(h,m,o),void 0!==y&&m.html(e(y)),g.append(m),p&&(v=t("<ul></ul>"),v.addClass("select2-result-sub"),a(h.children,v,u+1),g.append(v)),g.data("select2-data",h),i.append(g)},a(i,r,0)}},t.fn.select2.defaults,n),"function"!=typeof n.id&&(s=n.id,n.id=function(t){return t[s]}),a?(n.query=this.bind(function(e){var n,r,i,a={results:[],more:!1},s=e.term;i=function(t,n){var r;t.is("option")?e.matcher(s,t.text(),t)&&n.push({id:t.attr("value"),text:t.text(),element:t.get(),css:t.attr("class")}):t.is("optgroup")&&(r={text:t.attr("label"),children:[],element:t.get(),css:t.attr("class")},t.children().each2(function(t,e){i(e,r.children)}),r.children.length>0&&n.push(r))},n=o.children(),void 0!==this.getPlaceholder()&&n.length>0&&(r=n[0],""===t(r).text()&&(n=n.not(r))),n.each2(function(t,e){i(e,a.results)}),e.callback(a)}),n.id=function(t){return t.id},n.formatResultCssClass=function(t){return t.css}):"query"in n||("ajax"in n?(l=n.element.data("ajax-url"),l&&l.length>0&&(n.ajax.url=l),n.query=p(n.ajax)):"data"in n?n.query=g(n.data):"tags"in n&&(n.query=m(n.tags),n.createSearchChoice=function(t){return{id:t,text:t}},n.initSelection=function(e,o){var a=[];t(i(e.val(),n.separator)).each(function(){var e=this,i=this,o=n.tags;t.isFunction(o)&&(o=o()),t(o).each(function(){return r(this.id,e)?(i=this.text,!1):void 0}),a.push({id:e,text:i})}),o(a)})),"function"!=typeof n.query)throw"query function not defined for Select2 "+n.element.attr("id");return n},monitorSource:function(){this.opts.element.bind("change.select2",this.bind(function(){this.opts.element.data("select2-change-triggered")!==!0&&this.initSelection()}))},triggerChange:function(e){e=e||{},e=t.extend({},e,{type:"change",val:this.val()}),this.opts.element.data("select2-change-triggered",!0),this.opts.element.trigger(e),this.opts.element.data("select2-change-triggered",!1),this.opts.element.click()},enable:function(){this.enabled||(this.enabled=!0,this.container.removeClass("select2-container-disabled"))},disable:function(){this.enabled&&(this.close(),this.enabled=!1,this.container.addClass("select2-container-disabled"))},opened:function(){return this.container.hasClass("select2-dropdown-open")},positionDropdown:function(){var e,n,r=this.container.offset(),i=this.container.outerHeight(),o=this.container.outerWidth(),a=this.dropdown.outerHeight(),s=t(window).scrollTop()+document.documentElement.clientHeight,l=r.top+i,u=s>=l+a,c=r.top-a>=this.body().scrollTop(),d=this.dropdown.hasClass("select2-drop-above");d?(e=!0,!c&&u&&(e=!1)):(e=!1,!u&&c&&(e=!0)),e?(l=r.top-a,this.container.addClass("select2-drop-above"),this.dropdown.addClass("select2-drop-above")):(this.container.removeClass("select2-drop-above"),this.dropdown.removeClass("select2-drop-above")),n={top:l,left:r.left,width:o},this.dropdown.css(n)},shouldOpen:function(){var t;return this.opened()?!1:(t=jQuery.Event("open"),this.opts.element.trigger(t),!t.isDefaultPrevented())},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above"),this.dropdown.removeClass("select2-drop-above")},open:function(){return this.shouldOpen()?(window.setTimeout(this.bind(this.opening),1),!0):!1},opening:function(){var e=this.containerId,n="#"+e,r="scroll."+e,i="resize."+e;this.container.parents().each(function(){t(this).bind(r,function(){var e=t(n);0==e.length&&t(this).unbind(r),e.select2("close")})}),t(window).bind(i,function(){var e=t(n);0==e.length&&t(window).unbind(i),e.select2("close")}),this.clearDropdownAlignmentPreference()," "===this.search.val()&&this.search.val(""),this.dropdown.css(y(this.opts.dropdownCss)),this.dropdown.addClass("select2-drop-active"),this.container.addClass("select2-dropdown-open").addClass("select2-container-active"),this.updateResults(!0),this.dropdown[0]!==this.body().children().last()[0]&&this.dropdown.detach().appendTo(this.body()),this.dropdown.show(),this.ensureHighlightVisible(),this.positionDropdown(),this.focusSearch()},close:function(){if(this.opened()){var e=this;this.container.parents().each(function(){t(this).unbind("scroll."+e.containerId)}),t(window).unbind("resize."+this.containerId),this.clearDropdownAlignmentPreference(),this.dropdown.hide(),this.container.removeClass("select2-dropdown-open").removeClass("select2-container-active"),this.results.empty(),this.clearSearch(),this.opts.element.trigger(jQuery.Event("close"))}},clearSearch:function(){},ensureHighlightVisible:function(){var e,n,r,i,o,a,s,l=this.results;if(n=this.highlight(),!(0>n)){if(0==n)return l.scrollTop(0),void 0;e=l.find(".select2-result-selectable"),r=t(e[n]),i=r.offset().top+r.outerHeight(),n===e.length-1&&(s=l.find("li.select2-more-results"),s.length>0&&(i=s.offset().top+s.outerHeight())),o=l.offset().top+l.outerHeight(),i>o&&l.scrollTop(l.scrollTop()+(i-o)),a=r.offset().top-l.offset().top,0>a&&l.scrollTop(l.scrollTop()+a)}},moveHighlight:function(e){for(var n=this.results.find(".select2-result-selectable"),r=this.highlight();r>-1&&n.length>r;){r+=e;var i=t(n[r]);if(i.hasClass("select2-result-selectable")&&!i.hasClass("select2-disabled")){this.highlight(r);break}}},highlight:function(e){var r=this.results.find(".select2-result-selectable").not(".select2-disabled");return 0===arguments.length?n(r.filter(".select2-highlighted")[0],r.get()):(e>=r.length&&(e=r.length-1),0>e&&(e=0),r.removeClass("select2-highlighted"),t(r[e]).addClass("select2-highlighted"),this.ensureHighlightVisible(),void 0)},countSelectableResults:function(){return this.results.find(".select2-result-selectable").not(".select2-disabled").length},highlightUnderEvent:function(e){var n=t(e.target).closest(".select2-result-selectable");if(n.length>0&&!n.is(".select2-highlighted")){var r=this.results.find(".select2-result-selectable");this.highlight(r.index(n))}else 0==n.length&&this.results.find(".select2-highlighted").removeClass("select2-highlighted")},loadMoreIfNeeded:function(){var t,e=this.results,n=e.find("li.select2-more-results"),r=this.resultsPage+1,i=this,o=this.search.val(),a=this.context;0!==n.length&&(t=n.offset().top-e.offset().top-e.height(),0>=t&&(n.addClass("select2-active"),this.opts.query({term:o,page:r,context:a,matcher:this.opts.matcher,callback:this.bind(function(t){i.opts.populateResults.call(this,e,t.results,{term:o,page:r,context:a}),t.more===!0?(n.detach().appendTo(e).text(i.opts.formatLoadMore(r+1)),window.setTimeout(function(){i.loadMoreIfNeeded()},10)):n.remove(),i.positionDropdown(),i.resultsPage=r})})))},tokenize:function(){},updateResults:function(n){function i(){u.scrollTop(0),l.removeClass("select2-active"),d.positionDropdown()}function o(t){u.html(e(t)),i()}var a,s,l=this.search,u=this.results,c=this.opts,d=this;if(n===!0||this.showSearchInput!==!1&&this.opened()){if(l.addClass("select2-active"),c.maximumSelectionSize>=1&&(a=this.data(),t.isArray(a)&&a.length>=c.maximumSelectionSize&&v(c.formatSelectionTooBig,"formatSelectionTooBig")))return o("<li class='select2-selection-limit'>"+c.formatSelectionTooBig(c.maximumSelectionSize)+"</li>"),void 0;if(l.val().length<c.minimumInputLength&&v(c.formatInputTooShort,"formatInputTooShort"))return o("<li class='select2-no-results'>"+c.formatInputTooShort(l.val(),c.minimumInputLength)+"</li>"),void 0;o("<li class='select2-searching'>"+c.formatSearching()+"</li>"),s=this.tokenize(),void 0!=s&&null!=s&&l.val(s),this.resultsPage=1,c.query({term:l.val(),page:this.resultsPage,context:null,matcher:c.matcher,callback:this.bind(function(a){var s;return this.context=void 0===a.context?null:a.context,this.opts.createSearchChoice&&""!==l.val()&&(s=this.opts.createSearchChoice.call(null,l.val(),a.results),void 0!==s&&null!==s&&void 0!==d.id(s)&&null!==d.id(s)&&0===t(a.results).filter(function(){return r(d.id(this),d.id(s))}).length&&a.results.unshift(s)),0===a.results.length&&v(c.formatNoMatches,"formatNoMatches")?(o("<li class='select2-no-results'>"+c.formatNoMatches(l.val())+"</li>"),void 0):(u.empty(),d.opts.populateResults.call(this,u,a.results,{term:l.val(),page:this.resultsPage,context:null}),a.more===!0&&v(c.formatLoadMore,"formatLoadMore")&&(u.append("<li class='select2-more-results'>"+e(c.formatLoadMore(this.resultsPage))+"</li>"),window.setTimeout(function(){d.loadMoreIfNeeded()},10)),this.postprocessResults(a,n),i(),void 0)})})}},cancel:function(){this.close()},blur:function(){this.close(),this.container.removeClass("select2-container-active"),this.dropdown.removeClass("select2-drop-active"),this.search[0]===document.activeElement&&this.search.blur(),this.clearSearch(),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")},focusSearch:function(){window.setTimeout(this.bind(function(){this.search.focus(),this.search.val(this.search.val())}),10)},selectHighlighted:function(){var t=this.highlight(),e=this.results.find(".select2-highlighted").not(".select2-disabled"),n=e.closest(".select2-result-selectable").data("select2-data");n&&(e.addClass("select2-disabled"),this.highlight(t),this.onSelect(n))},getPlaceholder:function(){return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder},initContainerWidth:function(){function e(){var e,n,r,i,o;if("off"===this.opts.width)return null;if("element"===this.opts.width)return 0===this.opts.element.outerWidth()?"auto":this.opts.element.outerWidth()+"px";if("copy"===this.opts.width||"resolve"===this.opts.width){if(e=this.opts.element.attr("style"),void 0!==e)for(n=e.split(";"),i=0,o=n.length;o>i;i+=1)if(r=n[i].replace(/\s/g,"").match(/width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/),null!==r&&r.length>=1)return r[1];return"resolve"===this.opts.width?(e=this.opts.element.css("width"),e.indexOf("%")>0?e:0===this.opts.element.outerWidth()?"auto":this.opts.element.outerWidth()+"px"):null}return t.isFunction(this.opts.width)?this.opts.width():this.opts.width}var n=e.call(this);null!==n&&this.container.attr("style","width: "+n)}}),A=x(k,{createContainer:function(){var e=t("<div></div>",{"class":"select2-container"}).html(["    <a href='javascript:void(0)' class='select2-choice'>","   <span></span><abbr class='select2-search-choice-close' style='display:none;'></abbr>","   <div><b></b></div>","</a>","    <div class='select2-drop select2-offscreen'>","   <div class='select2-search'>","       <input type='text' autocomplete='off' class='select2-input'/>","   </div>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return e},opening:function(){this.search.show(),this.parent.opening.apply(this,arguments),this.dropdown.removeClass("select2-offscreen")},close:function(){this.opened()&&(this.parent.close.apply(this,arguments),this.dropdown.removeAttr("style").addClass("select2-offscreen").insertAfter(this.selection).show())},focus:function(){this.close(),this.selection.focus()},isFocused:function(){return this.selection[0]===document.activeElement},cancel:function(){this.parent.cancel.apply(this,arguments),this.selection.focus()},initContainer:function(){var t,e=this.container,n=this.dropdown,r=!1;this.selection=t=e.find(".select2-choice"),this.search.bind("keydown",this.bind(function(t){if(this.enabled){if(t.which===C.PAGE_UP||t.which===C.PAGE_DOWN)return d(t),void 0;if(this.opened())switch(t.which){case C.UP:case C.DOWN:return this.moveHighlight(t.which===C.UP?-1:1),d(t),void 0;case C.TAB:case C.ENTER:return this.selectHighlighted(),d(t),void 0;case C.ESC:return this.cancel(t),d(t),void 0}else{if(t.which===C.TAB||C.isControl(t)||C.isFunctionKey(t)||t.which===C.ESC)return;if(this.opts.openOnEnter===!1&&t.which===C.ENTER)return;if(this.open(),t.which===C.ENTER)return}}})),this.search.bind("focus",this.bind(function(){this.selection.attr("tabIndex","-1")})),this.search.bind("blur",this.bind(function(){this.opened()||this.container.removeClass("select2-container-active"),window.setTimeout(this.bind(function(){this.selection.attr("tabIndex",this.opts.element.attr("tabIndex"))}),10)})),t.bind("mousedown",this.bind(function(){r=!0,this.opened()?(this.close(),this.selection.focus()):this.enabled&&this.open(),r=!1})),n.bind("mousedown",this.bind(function(){this.search.focus()})),t.bind("focus",this.bind(function(){this.container.addClass("select2-container-active"),this.search.attr("tabIndex","-1")})),t.bind("blur",this.bind(function(){this.opened()||this.container.removeClass("select2-container-active"),window.setTimeout(this.bind(function(){this.search.attr("tabIndex",this.opts.element.attr("tabIndex"))}),10)})),t.bind("keydown",this.bind(function(t){if(this.enabled){if(t.which===C.PAGE_UP||t.which===C.PAGE_DOWN)return d(t),void 0;if(!(t.which===C.TAB||C.isControl(t)||C.isFunctionKey(t)||t.which===C.ESC||this.opts.openOnEnter===!1&&t.which===C.ENTER)){if(t.which==C.DELETE)return this.opts.allowClear&&this.clear(),void 0;if(this.open(),t.which===C.ENTER)return d(t),void 0;if(48>t.which)return d(t),void 0;var e=String.fromCharCode(t.which).toLowerCase();t.shiftKey&&(e=e.toUpperCase()),this.search.focus(),this.search.val(e),d(t)}}})),t.delegate("abbr","mousedown",this.bind(function(t){this.enabled&&(this.clear(),d(t),this.close(),this.triggerChange(),this.selection.focus())})),this.setPlaceholder(),this.search.bind("focus",this.bind(function(){this.container.addClass("select2-container-active")}))},clear:function(){this.opts.element.val(""),this.selection.find("span").empty(),this.selection.removeData("select2-data"),this.setPlaceholder()},initSelection:function(){if(""===this.opts.element.val()&&""===this.opts.element.text())this.close(),this.setPlaceholder();else{var t=this;this.opts.initSelection.call(null,this.opts.element,function(e){void 0!==e&&null!==e&&(t.updateSelection(e),t.close(),t.setPlaceholder())})}},prepareOpts:function(){var e=this.parent.prepareOpts.apply(this,arguments);return"select"===e.element.get(0).tagName.toLowerCase()&&(e.initSelection=function(e,n){var r=e.find(":selected");t.isFunction(n)&&n({id:r.attr("value"),text:r.text()})}),e},setPlaceholder:function(){var t=this.getPlaceholder();if(""===this.opts.element.val()&&void 0!==t){if(this.select&&""!==this.select.find("option:first").text())return;this.selection.find("span").html(e(t)),this.selection.addClass("select2-default"),this.selection.find("abbr").hide()}},postprocessResults:function(e,n){var i=0,o=this,a=!0;this.results.find(".select2-result-selectable").each2(function(t,e){return r(o.id(e.data("select2-data")),o.opts.element.val())?(i=t,!1):void 0}),this.highlight(i),n===!0&&(a=this.showSearchInput=b(e.results)>=this.opts.minimumResultsForSearch,this.dropdown.find(".select2-search")[a?"removeClass":"addClass"]("select2-search-hidden"),t(this.dropdown,this.container)[a?"addClass":"removeClass"]("select2-with-searchbox"))},onSelect:function(t){var e=this.opts.element.val();this.opts.element.val(this.id(t)),this.updateSelection(t),this.close(),this.selection.focus(),r(e,this.id(t))||this.triggerChange()},updateSelection:function(t){var n,r=this.selection.find("span");this.selection.data("select2-data",t),r.empty(),n=this.opts.formatSelection(t,r),void 0!==n&&r.append(e(n)),this.selection.removeClass("select2-default"),this.opts.allowClear&&void 0!==this.getPlaceholder()&&this.selection.find("abbr").show()},val:function(){var t,e=null,n=this;if(0===arguments.length)return this.opts.element.val();if(t=arguments[0],this.select)this.select.val(t).find(":selected").each2(function(t,n){return e={id:n.attr("value"),text:n.text()},!1}),this.updateSelection(e),this.setPlaceholder();else{if(void 0===this.opts.initSelection)throw Error("cannot call val() if initSelection() is not defined");if(!t)return this.clear(),void 0;this.opts.initSelection(this.opts.element,function(t){n.opts.element.val(t?n.id(t):""),n.updateSelection(t),n.setPlaceholder()})}},clearSearch:function(){this.search.val("")},data:function(t){var e;return 0===arguments.length?(e=this.selection.data("select2-data"),void 0==e&&(e=null),e):(t&&""!==t?(this.opts.element.val(t?this.id(t):""),this.updateSelection(t)):this.clear(),void 0)}}),E=x(k,{createContainer:function(){var e=t("<div></div>",{"class":"select2-container select2-container-multi"}).html(["    <ul class='select2-choices'>","  <li class='select2-search-field'>","    <input type='text' autocomplete='off' class='select2-input'>","  </li>","</ul>","<div class='select2-drop select2-drop-multi' style='display:none;'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return e},prepareOpts:function(){var e=this.parent.prepareOpts.apply(this,arguments);return"select"===e.element.get(0).tagName.toLowerCase()&&(e.initSelection=function(e,n){var r=[];e.find(":selected").each2(function(t,e){r.push({id:e.attr("value"),text:e.text()})}),t.isFunction(n)&&n(r)}),e},initContainer:function(){var t,e=".select2-choices";this.searchContainer=this.container.find(".select2-search-field"),this.selection=t=this.container.find(e),this.search.bind("keydown",this.bind(function(e){if(this.enabled){if(e.which===C.BACKSPACE&&""===this.search.val()){this.close();var n,r=t.find(".select2-search-choice-focus");if(r.length>0)return this.unselect(r.first()),this.search.width(10),d(e),void 0;n=t.find(".select2-search-choice"),n.length>0&&n.last().addClass("select2-search-choice-focus")}else t.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus");if(this.opened())switch(e.which){case C.UP:case C.DOWN:return this.moveHighlight(e.which===C.UP?-1:1),d(e),void 0;case C.ENTER:case C.TAB:return this.selectHighlighted(),d(e),void 0;case C.ESC:return this.cancel(e),d(e),void 0}e.which===C.TAB||C.isControl(e)||C.isFunctionKey(e)||e.which===C.BACKSPACE||e.which===C.ESC||(this.opts.openOnEnter!==!1||e.which!==C.ENTER)&&(this.open(),(e.which===C.PAGE_UP||e.which===C.PAGE_DOWN)&&d(e))}})),this.search.bind("keyup",this.bind(this.resizeSearch)),this.search.bind("blur",this.bind(function(){this.container.removeClass("select2-container-active")})),this.container.delegate(e,"mousedown",this.bind(function(t){this.enabled&&(this.clearPlaceholder(),this.open(),this.focusSearch(),t.preventDefault())})),this.container.delegate(e,"focus",this.bind(function(){this.enabled&&(this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"),this.clearPlaceholder())})),this.clearSearch()},enable:function(){this.enabled||(this.parent.enable.apply(this,arguments),this.search.removeAttr("disabled"))},disable:function(){this.enabled&&(this.parent.disable.apply(this,arguments),this.search.attr("disabled",!0))},initSelection:function(){if(""===this.opts.element.val()&&""===this.opts.element.text()&&(this.updateSelection([]),this.close(),this.clearSearch()),this.select||""!==this.opts.element.val()){var t=this;this.opts.initSelection.call(null,this.opts.element,function(e){void 0!==e&&null!==e&&(t.updateSelection(e),t.close(),t.clearSearch())})}},clearSearch:function(){var t=this.getPlaceholder();void 0!==t&&0===this.getVal().length&&this.search.hasClass("select2-focused")===!1?(this.search.val(t).addClass("select2-default"),this.resizeSearch()):this.search.val(" ").width(10)},clearPlaceholder:function(){this.search.hasClass("select2-default")?this.search.val("").removeClass("select2-default"):" "===this.search.val()&&this.search.val("")},opening:function(){this.parent.opening.apply(this,arguments),this.clearPlaceholder(),this.resizeSearch(),this.focusSearch()},close:function(){this.opened()&&this.parent.close.apply(this,arguments)},focus:function(){this.close(),this.search.focus()},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(e){var r=[],i=[],o=this;t(e).each(function(){0>n(o.id(this),r)&&(r.push(o.id(this)),i.push(this))}),e=i,this.selection.find(".select2-search-choice").remove(),t(e).each(function(){o.addSelectedChoice(this)}),o.postprocessResults()},tokenize:function(){var t=this.search.val();t=this.opts.tokenizer(t,this.data(),this.bind(this.onSelect),this.opts),null!=t&&void 0!=t&&(this.search.val(t),t.length>0&&this.open())},onSelect:function(t){this.addSelectedChoice(t),this.select&&this.postprocessResults(),this.opts.closeOnSelect?(this.close(),this.search.width(10)):this.countSelectableResults()>0?(this.search.width(10),this.resizeSearch(),this.positionDropdown()):this.close(),this.triggerChange({added:t}),this.focusSearch()},cancel:function(){this.close(),this.focusSearch()},addSelectedChoice:function(n){var r,i=t("<li class='select2-search-choice'>    <div></div>    <a href='javascript:void(0)' class='select2-search-choice-close' tabindex='-1'></a></li>"),o=this.id(n),a=this.getVal();r=this.opts.formatSelection(n,i),i.find("div").replaceWith("<div>"+e(r)+"</div>"),i.find(".select2-search-choice-close").bind("mousedown",d).bind("click dblclick",this.bind(function(e){this.enabled&&(t(e.target).closest(".select2-search-choice").fadeOut("fast").animate({width:"hide"},50,this.bind(function(){this.unselect(t(e.target)),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus"),this.close(),this.focusSearch()})).dequeue(),d(e))})).bind("focus",this.bind(function(){this.enabled&&(this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"))})),i.data("select2-data",n),i.insertBefore(this.searchContainer),a.push(o),this.setVal(a)},unselect:function(t){var e,r,i=this.getVal();if(t=t.closest(".select2-search-choice"),0===t.length)throw"Invalid argument: "+t+". Must be .select2-search-choice";e=t.data("select2-data"),r=n(this.id(e),i),r>=0&&(i.splice(r,1),this.setVal(i),this.select&&this.postprocessResults()),t.remove(),this.triggerChange({removed:e})},postprocessResults:function(){var t=this.getVal(),e=this.results.find(".select2-result-selectable"),r=this.results.find(".select2-result-with-children"),i=this;e.each2(function(e,r){var o=i.id(r.data("select2-data"));n(o,t)>=0?r.addClass("select2-disabled").removeClass("select2-result-selectable"):r.removeClass("select2-disabled").addClass("select2-result-selectable")}),r.each2(function(t,e){0==e.find(".select2-result-selectable").length?e.addClass("select2-disabled"):e.removeClass("select2-disabled")}),e.each2(function(t,e){return!e.hasClass("select2-disabled")&&e.hasClass("select2-result-selectable")?(i.highlight(0),!1):void 0})},resizeSearch:function(){var t,e,n,r,i,a=o(this.search);t=h(this.search)+10,e=this.search.offset().left,n=this.selection.width(),r=this.selection.offset().left,i=n-(e-r)-a,t>i&&(i=n-a),40>i&&(i=n-a),this.search.width(i)},getVal:function(){var t;return this.select?(t=this.select.val(),null===t?[]:t):(t=this.opts.element.val(),i(t,this.opts.separator))},setVal:function(e){var r;this.select?this.select.val(e):(r=[],t(e).each(function(){0>n(this,r)&&r.push(this)}),this.opts.element.val(0===r.length?"":r.join(this.opts.separator)))},val:function(){var e,n=[],r=this;if(0===arguments.length)return this.getVal();if(e=arguments[0],!e)return this.opts.element.val(""),this.updateSelection([]),this.clearSearch(),void 0;if(this.setVal(e),this.select)this.select.find(":selected").each(function(){n.push({id:t(this).attr("value"),text:t(this).text()})}),this.updateSelection(n);else{if(void 0===this.opts.initSelection)throw Error("val() cannot be called if initSelection() is not defined");this.opts.initSelection(this.opts.element,function(e){var n=t(e).map(r.id);r.setVal(n),r.updateSelection(e),r.clearSearch()})}this.clearSearch()},onSortStart:function(){if(this.select)throw Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.");
this.search.width(0),this.searchContainer.hide()},onSortEnd:function(){var e=[],n=this;this.searchContainer.show(),this.searchContainer.appendTo(this.searchContainer.parent()),this.resizeSearch(),this.selection.find(".select2-search-choice").each(function(){e.push(n.opts.id(t(this).data("select2-data")))}),this.setVal(e),this.triggerChange()},data:function(e){var n,r=this;return 0===arguments.length?this.selection.find(".select2-search-choice").map(function(){return t(this).data("select2-data")}).get():(e||(e=[]),n=t.map(e,function(t){return r.opts.id(t)}),this.setVal(n),this.updateSelection(e),this.clearSearch(),void 0)}}),t.fn.select2=function(){var e,r,i,o,a=Array.prototype.slice.call(arguments,0),s=["val","destroy","opened","open","close","focus","isFocused","container","onSortStart","onSortEnd","enable","disable","positionDropdown","data"];return this.each(function(){if(0===a.length||"object"==typeof a[0])e=0===a.length?{}:t.extend({},a[0]),e.element=t(this),"select"===e.element.get(0).tagName.toLowerCase()?o=e.element.attr("multiple"):(o=e.multiple||!1,"tags"in e&&(e.multiple=o=!0)),r=o?new E:new A,r.init(e);else{if("string"!=typeof a[0])throw"Invalid arguments to select2 plugin: "+a;if(0>n(a[0],s))throw"Unknown method: "+a[0];if(i=void 0,r=t(this).data("select2"),void 0===r)return;if(i="container"===a[0]?r.container:r[a[0]].apply(r,a.slice(1)),void 0!==i)return!1}}),void 0===i?this:i},t.fn.select2.defaults={width:"copy",closeOnSelect:!0,openOnEnter:!0,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",formatResult:function(t,e,n){var r=[];return f(t.text,n.term,r),r.join("")},formatSelection:function(t){return t.text},formatResultCssClass:function(){return void 0},formatNoMatches:function(){return"No matches found"},formatInputTooShort:function(t,e){return"Please enter "+(e-t.length)+" more characters"},formatSelectionTooBig:function(t){return"You can only select "+t+" items"},formatLoadMore:function(){return"Loading more results..."},formatSearching:function(){return"Searching..."},minimumResultsForSearch:0,minimumInputLength:0,maximumSelectionSize:0,id:function(t){return t.id},matcher:function(t,e){return e.toUpperCase().indexOf(t.toUpperCase())>=0},separator:",",tokenSeparators:[],tokenizer:w}}};if("function"==typeof define&&define.amd)define('js/lib/select2',["jquery"],function(e){return t(e)});else if("undefined"!=typeof window&&"undefined"==typeof ender)return t(window.jQuery)})();
define('pages/forum/views/ThreadTagsView',["backbone","jquery","underscore","pages/forum/app","pages/forum/views/ThreadTagsView.html","js/lib/select2"],function(e,t,o,n,r){var i="Forum Thread",s=e.View.extend({defaults:{},events:{"click .course-forum-thread-tags-link":"onThreadTagsClick","click .course-forum-thread-tags-form button":"onThreadTagsSave","click .course-forum-thread-tags-form a":"onThreadTagsCancel","click .course-forum-thread-tag-delete":"onThreadTagDelete"},initialize:function(){this.thread=this.model,this.thread.bind("change",this.render,this)},render:function(){var e=this.thread.changedAttributes();return(!this.$(".course-forum-thread-tags-form").length||e&&o.intersection(o.keys(e),["tags"]).length>0)&&(this.$el.html(r({config:n.config,thread:this.thread})),this.$form=this.$(".course-forum-thread-tags-form")),this},onThreadTagsClick:function(e){e.preventDefault();var t=this;t.$form.show(),n.api.get("forum/tags",{message:{waiting:"Fetching tags..."}}).done(function(e){var n=o.pluck(t.thread.get("tags"),"tag_name"),r=o.pluck(e,"tag_name"),i=o.without(r,n);t.$form.find("input").select2({width:"400px",tags:i}),t.$form.find("button").attr("disabled",null)})},onThreadTagsSave:function(e){e.preventDefault();var t=this,r=t.$("input[name=tags]").val().split(","),s=o.map(o.uniq(r),function(e){return{tag_name:e}});n.api.post(this.thread.tagsUrl(),{data:s,message:{waiting:"Saving tags...",success:"Saved tags!"}}).done(function(e){t.thread.set({tags:e})}),t.$form.find("button").attr("disabled","disabled"),n.multitracker.push([i,"Tags Save"])},onThreadTagsCancel:function(e){var t=this;e.preventDefault(),t.$form[0].reset(),t.$form.hide(),n.multitracker.push([i,"Tags Cancel"])},onThreadTagDelete:function(e){e.preventDefault();var o=this,r=[{tag_name:t(e.target).attr("data-tag")}];n.api["delete"](this.thread.tagsUrl(),{data:r,message:{waiting:"Deleting tag...",success:"Deleted tag"}}).done(function(e){o.thread.set({tags:e})}),n.multitracker.push([i,"Tag Delete"])}});return s});
(function(wndw){var jadify=function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{})buf.push('<div class="course-forum-post-container"><div class="course-forum-post-top-container"></div>'),post.isNew()||(buf.push('<ul class="course-forum-comments-container"></ul>'),post.get("original")||buf.push('<div class="course-forum-new-comment-container"></div><div class="course-forum-new-comment-link-container"><a href="javascript:void(0);" class="course-forum-new-comment-link">+ Comment</a></div>')),buf.push("</div>");return buf.join("")}};"function"==typeof define&&define.amd?define('pages/forum/views/PostContainerView.html',["js/lib/jade"],function(e){return jadify(e)}):wndw.jade.templates.PostContainerView=jadify(wndw.jade.helpers)})(window);
(function(wndw){var jadify=function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{}){var interp;if(entry.get("deleted")&&!user.canModerateForum())buf.push('<small class="course-forum-delete-indicator"><span class="icon-trash"></span>A post was deleted</small>');else{buf.push("<div"),buf.push(attrs({"data-permalink":entry.getPermalinkHash(),"class":"course-forum-post-view-container "+(1==entry.get("deleted")?"course-forum-post-deleted":"")},{"class":!0,"data-permalink":!0})),buf.push('><div class="course-forum-post-header"><div class="course-forum-post-controls">'),1==entry.get("stickied")&&buf.push('<span title="Post was stickied by staff." class="course-forum-post-indicator course-forum-indicator-good"><i class="icon-pushpin"></i>Pinned</span>'),1==entry.get("approved")&&buf.push('<span title="Post was approved by staff." class="course-forum-post-indicator course-forum-indicator-good"><i class="icon-star"></i>Approved</span>'),1==entry.get("is_spam")&&buf.push('<span title="Post was marked as spam." class="course-forum-post-indicator course-forum-indicator-bad"><i class="icon-trash"></i>Spam</span>');var popupId="course-forum-post-controls-"+entry.get("id");(entry.get("_viewer_can_edit")||user.canAccessAdmin()||user.canModerateForum())&&(buf.push("<a"),buf.push(attrs({title:"Controls",tabindex:"0",role:"button","aria-haspopup":"true","aria-expanded":"false","aria-owns":popupId,"data-popup":"#"+popupId,"data-popup-direction":"se","class":"course-forum-post-controls-toggle"},{title:!0,tabindex:!0,role:!0,"aria-haspopup":!0,"aria-expanded":!0,"aria-owns":!0,"data-popup":!0,"data-popup-direction":!0})),buf.push('><i class="icon-cog"><span class="hidden">Controls</span></i></a><div'),buf.push(attrs({id:popupId,"class":"course-forum-post-controls-popup hide"},{id:!0})),buf.push(">"),user.canModerateForum()&&buf.push('<a href="javascript:void(0)" class="course-forum-post-admin-details-link">Show Admin Details</a>'),buf.push("<!-- If you have editing rights, you can edit or delete-->"),entry.get("_viewer_can_edit")&&(buf.push('<a href="javascript:void(0)" class="course-forum-post-edit-link">Edit</a>'),0==entry.get("deleted")?buf.push('<a href="javascript:void(0)" data-property="deleted" data-value="1" class="course-forum-post-action-link">Delete</a>'):buf.push('<a href="javascript:void(0)" data-property="deleted" data-value="0" class="course-forum-post-action-link">Un-delete</a>')),buf.push("<!-- Only forum moderators -->"),user.canModerateForum()&&"post"==entry.entryType&&(0==entry.get("stickied")?buf.push('<a href="javascript:void(0)" data-property="stickied" data-value="1" class="course-forum-post-action-link">Pin</a>'):buf.push('<a href="javascript:void(0)" data-property="stickied" data-value="0" class="course-forum-post-action-link">Un-pin</a>'),0==entry.get("approved")?buf.push('<a href="javascript:void(0)" data-property="approved" data-value="1" class="course-forum-post-action-link">Approve</a>'):buf.push('<a href="javascript:void(0)" data-property="approved" data-value="0" class="course-forum-post-action-link">Un-approve</a>')),user.canModerateForum()&&(0==entry.get("is_spam")?buf.push('<a href="javascript:void(0)" data-property="is_spam" data-value="1" class="course-forum-post-action-link">Spam</a>'):buf.push('<a href="javascript:void(0)" data-property="is_spam" data-value="0" class="course-forum-post-action-link">Not spam</a>')),buf.push("</div>")),buf.push('</div><h5 class="course-forum-post-byline"></h5></div><div class="course-forum-post-text">'+(null==(interp=entry.getMessageHtml())?"":interp)+"</div>"),user.canModerateForum()&&(buf.push('<div class="course-forum-post-admin-container"><span>'+escape(null==(interp=entry.get("user_id"))?"":interp)+"</span> &middot; &nbsp;<span>"+escape(null==(interp=entry.get("_user_full_name"))?"":interp)+"</span> &middot; &nbsp;"),entry.get("_user_email_address")&&buf.push("<span>"+escape(null==(interp=entry.get("_user_email_address"))?"":interp)+"</span> &middot; &nbsp;"),buf.push("<a"),buf.push(attrs({target:"_blank",href:entry.get("_user_search_link")},{target:!0,href:!0})),buf.push('><span class="icon-comments"></span> All Posts</a> &middot; &nbsp;'),user.canAccessAdmin()&&(buf.push("<a"),buf.push(attrs({target:"_blank",href:entry.get("_user_details_link")},{target:!0,href:!0})),buf.push('><span class="icon-tasks"></span> More Student Details</a>')),buf.push("<br/>"),entry.get("user_agent")&&(buf.push("<a"),buf.push(attrs({target:"_blank",href:"http://user-agent-string.info/?Fuas="+entry.get("user_agent")},{target:!0,href:!0})),buf.push(">"+escape(null==(interp=entry.get("user_agent"))?"":interp)+"</a>")),buf.push("</div>"));var voteClass="";entry.get("votes")>0&&(voteClass="course-forum-votes-positive"),0>entry.get("votes")&&(voteClass="course-forum-votes-negative");var votePopupId="course-forum-post-vote-hint-"+entry.get("id"),flagPopupId="course-forum-post-flag-hint-"+entry.get("id");buf.push("<div"),buf.push(attrs({tabindex:"0",role:"button","aria-haspopup":"true","aria-expanded":"false","aria-owns":votePopupId,"data-popup":"#"+votePopupId,"data-popup-direction":"sw","data-popup-bind-open":"mouseenter","class":"course-forum-post-vote-controls"},{tabindex:!0,role:!0,"aria-haspopup":!0,"aria-expanded":!0,"aria-owns":!0,"data-popup":!0,"data-popup-direction":!0,"data-popup-bind-open":!0})),buf.push("><div"),buf.push(attrs({tabindex:"0","aria-label":"Vote this post up","data-direction-value":"1",role:"button","class":"course-forum-post-vote-button course-forum-post-vote-up "+("1"==entry.get("_viewer_vote")?"course-forum-vote-active":"course-forum-vote-inactive")},{"class":!0,tabindex:!0,"aria-label":!0,"data-direction-value":!0,role:!0})),buf.push('><i class="icon-arrow-up"></i></div><span'),buf.push(attrs({"class":"course-forum-post-vote-count "+voteClass},{"class":!0})),buf.push(">"+escape(null==(interp=entry.get("votes"))?"":interp)+"</span><div"),buf.push(attrs({tabindex:"0","aria-label":"Vote this post down","data-direction-value":"-1",role:"button","class":"course-forum-post-vote-button course-forum-post-vote-down "+("-1"==entry.get("_viewer_vote")?"course-forum-vote-active":"course-forum-vote-inactive")},{"class":!0,tabindex:!0,"aria-label":!0,"data-direction-value":!0,role:!0})),buf.push('><i class="icon-arrow-down"></i></div></div>'),entry.get("_viewer_can_vote")&&(buf.push("<div"),buf.push(attrs({id:votePopupId,"class":"course-forum-post-vote-hint help-block hide"},{id:!0})),buf.push("> Please use votes to bring attention to thoughtful, helpful posts. <br>\n (Even if you personally disagree with the post - we like a diversity of opinions here.) Thanks! <br></div>")),buf.push("<div"),buf.push(attrs({tabindex:"0",role:"button","aria-haspopup":"true","aria-expanded":"false","aria-owns":flagPopupId,"data-popup":"#"+flagPopupId,"data-popup-direction":"sw","data-popup-bind-open":"mouseenter","class":"course-forum-post-controls-report"},{tabindex:!0,role:!0,"aria-haspopup":!0,"aria-expanded":!0,"aria-owns":!0,"data-popup":!0,"data-popup-direction":!0,"data-popup-bind-open":!0})),buf.push(">&middot;\nflag</div><div"),buf.push(attrs({id:flagPopupId,"class":"course-forum-post-vote-hint help-block hide"},{id:!0})),buf.push("> Please flag this if you think this "+escape(null==(interp=entry.entryType)?"":interp)+' is inappropriate or a violation of the honor code.</div><div style="clear: both; height: 3px;"></div></div>')}}return buf.join("")}};"function"==typeof define&&define.amd?define('pages/forum/views/EntryView.html',["js/lib/jade"],function(e){return jadify(e)}):wndw.jade.templates.EntryView=jadify(wndw.jade.helpers)})(window);
(function(wndw){var jadify=function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{}){var interp;entry.get("anonymous")?buf.push("<span>Anonymous</span>"):(buf.push("<a"),buf.push(attrs({href:entry.get("_user_profile_link")},{href:!0})),buf.push(">"),entry.get("_user_profile")?(entry.get("_user_profile").photo_24&&(buf.push("<img"),buf.push(attrs({src:entry.get("_user_profile").photo_24},{src:!0})),buf.push("/>")),buf.push(""+escape(null==(interp=entry.get("_user_profile").display_name)?"":interp))):buf.push(""+escape(null==(interp=entry.get("_user_full_name"))?"":interp)),buf.push("</a>")),entry.get("anonymous")||(entry.get("_user_title")&&"Student"!=entry.get("_user_title")?buf.push('<span class="course-forum-profile-badge">'+escape(null==(interp=entry.get("_user_title"))?"":interp)+"</span>"):entry.get("_show_signature_track_label")&&(buf.push("<a"),buf.push(attrs({style:"text-decoration: none;",href:config.url.base+"signature/course/"+spark_class_short_name+"/"+spark_class_id,target:"_blank"},{style:!0,href:!0,target:!0})),buf.push('><span class="course-forum-profile-badge-signaturetrack">Signature Track</span></a>'))),buf.push('<span style="vertical-align: middle; margin-left: 5px;" class="course-forum-profile-badgeville"></span><span style="vertical-align:middle">Â· </span><a'),buf.push(attrs({href:entry.getPermalink(),name:entry.getPermalinkHash(),style:"vertical-align:middle"},{href:!0,name:!0,style:!0})),buf.push("> <time"),buf.push(attrs({datetime:entry.get("post_time")},{datetime:!0})),buf.push(">"+escape(null==(interp=entry.get("post_time"))?"":interp)+'</time>&nbsp;<span class="icon-link"></span></a>')}return buf.join("")}};"function"==typeof define&&define.amd?define('pages/forum/views/EntryBylineView.html',["js/lib/jade"],function(e){return jadify(e)}):wndw.jade.templates.EntryBylineView=jadify(wndw.jade.helpers)})(window);
(function(wndw){var jadify=function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{}){var interp;buf.push('<div class="course-forum-post-edit-container"><div class="course-forum-post-header">'),entry.isNew()?buf.push("New "+escape(null==(interp=entry.entryType)?"":interp)):buf.push("Editing "+escape(null==(interp=entry.entryType)?"":interp)+"..."),buf.push('</div><form class="course-forum-post-edit-form"><p class="help-block">Please be considerate and constructive when talking to your fellow students.<br>\n<span class="icon-thumbs-down"> Bad</span>: âYouâre wrong and youâre an idiot.â <br>\n<span class="icon-thumbs-up"> Good</span>: âHmm. I think this is not necessarily true because...â<br></p><input type="hidden" name="text_type" value="html"/><div class="control-group"><label class="hidden">Message</label><textarea'),buf.push(attrs({name:entry.textProp,style:"width:100%; min-height: 100px;"},{name:!0,style:!0})),buf.push(">"+(null==(interp=entry.getEditableHtml())?"":interp)+"</textarea></div>"),entry.isNew()&&buf.push('<div class="controls"><label class="checkbox"><input type="checkbox" name="anonymous" value="1"/>Make this post anonymous to other students</label></div><div class="controls"><label class="checkbox"><input type="checkbox" name="subscribe" value="1" checked="checked"/>Subscribe to this thread at the same time</label></div>'),buf.push('<div class="control-group"><button type="submit" class="btn course-forum-post-edit-save">'),entry.isNew()?buf.push("Add "+escape(null==(interp=entry.entryType)?"":interp)):buf.push("Update "+escape(null==(interp=entry.entryType)?"":interp)),buf.push('</button><span>&nbsp; &nbsp;</span><a href="javascript:void(0)" role="Button" class="course-forum-post-edit-cancel">Cancel</a></div></form></div>')}return buf.join("")}};"function"==typeof define&&define.amd?define('pages/forum/views/EntryEditView.html',["js/lib/jade"],function(e){return jadify(e)}):wndw.jade.templates.EntryEditView=jadify(wndw.jade.helpers)})(window);
(function(wndw){var jadify=function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{})buf.push('<div data-modal-overlay-class="course-modal-overlay-light" class="modal hide course-forum-report-modal"><div class="modal-header"><a href="javascript:void(0)" data-modal-close="data-modal-close" class="close">Ã</a><h3>Report this post</h3></div><div class="modal-body"><p>Please report posts that are abusive/offensive, that infringe on copyright, or that are otherwise in violation of our Honor Code.</p><div class="control-group"><label class="control-label">Description</label><div class="controls"><textarea style="height: 100px; width:90%;" name="description"></textarea></div></div><div class="control-group"><div class="controls"><button type="submit" value="value" data-modal-close="data-modal-close" class="btn">Send Report</button></div></div></div></div>');return buf.join("")}};"function"==typeof define&&define.amd?define('pages/forum/views/EntryReportView.html',["js/lib/jade"],function(e){return jadify(e)}):wndw.jade.templates.EntryReportView=jadify(wndw.jade.helpers)})(window);
(function(e){var t=function(){var t=e.document,n={version:"0.4.0pre",commands:{},dom:{},quirks:{},toolbar:{},lang:{},selection:{},views:{},INVISIBLE_SPACE:"ï»¿",EMPTY_FUNCTION:function(){},ELEMENT_NODE:1,TEXT_NODE:3,BACKSPACE_KEY:8,ENTER_KEY:13,ESCAPE_KEY:27,SPACE_KEY:32,DELETE_KEY:46},r=function(){function n(e,t){var n=typeof e[t];return n==f||!(n!=h||!e[t])||"unknown"==n}function r(e,t){return!(typeof e[t]!=h||!e[t])}function o(e,t){return typeof e[t]!=p}function i(e){return function(t,n){for(var r=n.length;r--;)if(!e(t,n[r]))return!1;return!0}}function a(e){return e&&b(e,y)&&C(e,v)}function s(t){e.alert("Rangy not supported in your browser. Reason: "+t),x.initialized=!0,x.supported=!1}function c(t){var n="Rangy warning: "+t;x.config.alertOnWarn?e.alert(n):typeof e.console!=p&&typeof window.console.log!=p&&e.console.log(n)}function l(){if(!x.initialized){var o,i=!1,c=!1;n(t,"createRange")&&(o=t.createRange(),b(o,g)&&C(o,m)&&(i=!0),o.detach());var l=r(t,"body")?t.body:t.getElementsByTagName("body")[0];l&&n(l,"createTextRange")&&(o=l.createTextRange(),a(o)&&(c=!0)),i||c||s("Neither Range nor TextRange are implemented"),x.initialized=!0,x.features={implementsDomRange:i,implementsTextRange:c};for(var u=E.concat(N),d=0,h=u.length;h>d;++d)try{u[d](x)}catch(f){r(e,"console")&&n(window.console,"log")&&e.console.log("Init listener threw an exception. Continuing.",f)}}}function u(t){t=t||e,l();for(var n=0,r=S.length;r>n;++n)S[n](t)}function d(e){this.name=e,this.initialized=!1,this.supported=!1}var h="object",f="function",p="undefined",m=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer","START_TO_START","START_TO_END","END_TO_START","END_TO_END"],g=["setStart","setStartBefore","setStartAfter","setEnd","setEndBefore","setEndAfter","collapse","selectNode","selectNodeContents","compareBoundaryPoints","deleteContents","extractContents","cloneContents","insertNode","surroundContents","cloneRange","toString","detach"],v=["boundingHeight","boundingLeft","boundingTop","boundingWidth","htmlText","text"],y=["collapse","compareEndPoints","duplicate","getBookmark","moveToBookmark","moveToElementText","parentElement","pasteHTML","select","setEndPoint","getBoundingClientRect"],b=i(n),w=i(r),C=i(o),x={version:"1.2.2",initialized:!1,supported:!0,util:{isHostMethod:n,isHostObject:r,isHostProperty:o,areHostMethods:b,areHostObjects:w,areHostProperties:C,isTextRange:a},features:{},modules:{},config:{alertOnWarn:!1,preferTextRange:!1}};x.fail=s,x.warn=c,{}.hasOwnProperty?x.util.extend=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}:s("hasOwnProperty not supported");var N=[],E=[];x.init=l,x.addInitListener=function(e){x.initialized?e(x):N.push(e)};var S=[];x.addCreateMissingNativeApiListener=function(e){S.push(e)},x.createMissingNativeApi=u,d.prototype.fail=function(e){throw this.initialized=!0,this.supported=!1,Error("Module '"+this.name+"' failed to load: "+e)},d.prototype.warn=function(e){x.warn("Module "+this.name+": "+e)},d.prototype.createError=function(e){return Error("Error in Rangy "+this.name+" module: "+e)},x.createModule=function(e,t){var n=new d(e);x.modules[e]=n,E.push(function(e){t(e,n),n.initialized=!0,n.supported=!0})},x.requireModules=function(e){for(var t,n,r=0,o=e.length;o>r;++r){if(n=e[r],t=x.modules[n],!(t&&t instanceof d))throw Error("Module '"+n+"' not found");if(!t.supported)throw Error("Module '"+n+"' not supported")}};var _=!1,T=function(){_||(_=!0,x.initialized||l())};return typeof e==p?(s("No window found"),void 0):typeof t==p?(s("No document found"),void 0):(n(t,"addEventListener")&&t.addEventListener("DOMContentLoaded",T,!1),n(e,"addEventListener")?e.addEventListener("load",T,!1):n(e,"attachEvent")?e.attachEvent("onload",T):s("Window does not have required addEventListener or attachEvent method"),x)}();r.createModule("DomUtil",function(e,n){function r(e){var t;return typeof e.namespaceURI==_||null===(t=e.namespaceURI)||"http://www.w3.org/1999/xhtml"==t}function o(e){var t=e.parentNode;return 1==t.nodeType?t:null}function i(e){for(var t=0;e=e.previousSibling;)t++;return t}function a(e){var t;return u(e)?e.length:(t=e.childNodes)?t.length:0}function s(e,t){var n,r=[];for(n=e;n;n=n.parentNode)r.push(n);for(n=t;n;n=n.parentNode)if(k(r,n))return n;return null}function c(e,t,n){for(var r=n?t:t.parentNode;r;){if(r===e)return!0;r=r.parentNode}return!1}function l(e,t,n){for(var r,o=n?e:e.parentNode;o;){if(r=o.parentNode,r===t)return o;o=r}return null}function u(e){var t=e.nodeType;return 3==t||4==t||8==t}function d(e,t){var n=t.nextSibling,r=t.parentNode;return n?r.insertBefore(e,n):r.appendChild(e),e}function h(e,t){var n=e.cloneNode(!1);return n.deleteData(0,t),e.deleteData(t,e.length-t),d(n,e),n}function f(e){if(9==e.nodeType)return e;if(typeof e.ownerDocument!=_)return e.ownerDocument;if(typeof e.document!=_)return e.document;if(e.parentNode)return f(e.parentNode);throw Error("getDocument: no document found for node")}function p(e){var t=f(e);if(typeof t.defaultView!=_)return t.defaultView;if(typeof t.parentWindow!=_)return t.parentWindow;throw Error("Cannot get a window object for node")}function m(e){if(typeof e.contentDocument!=_)return e.contentDocument;if(typeof e.contentWindow!=_)return e.contentWindow.document;throw Error("getIframeWindow: No Document object found for iframe element")}function g(e){if(typeof e.contentWindow!=_)return e.contentWindow;if(typeof e.contentDocument!=_)return e.contentDocument.defaultView;throw Error("getIframeWindow: No Window object found for iframe element")}function v(e){return T.isHostObject(e,"body")?e.body:e.getElementsByTagName("body")[0]}function y(e){for(var t;t=e.parentNode;)e=t;return e}function b(e,t,n,r){var o,a,c,u,d;if(e==n)return t===r?0:r>t?-1:1;if(o=l(n,e,!0))return i(o)>=t?-1:1;if(o=l(e,n,!0))return r>i(o)?-1:1;if(a=s(e,n),c=e===a?a:l(e,a,!0),u=n===a?a:l(n,a,!0),c===u)throw Error("comparePoints got to case 4 and childA and childB are the same!");for(d=a.firstChild;d;){if(d===c)return-1;if(d===u)return 1;d=d.nextSibling}throw Error("Should not be here!")}function w(e){for(var t,n=f(e).createDocumentFragment();t=e.firstChild;)n.appendChild(t);return n}function C(e){if(!e)return"[No node]";if(u(e))return'"'+e.data+'"';if(1==e.nodeType){var t=e.id?' id="'+e.id+'"':"";return"<"+e.nodeName+t+">["+e.childNodes.length+"]"}return e.nodeName}function x(e){this.root=e,this._next=e}function N(e){return new x(e)}function E(e,t){this.node=e,this.offset=t}function S(e){this.code=this[e],this.codeName=e,this.message="DOMException: "+this.codeName}var _="undefined",T=e.util;T.areHostMethods(t,["createDocumentFragment","createElement","createTextNode"])||n.fail("document missing a Node creation method"),T.isHostMethod(t,"getElementsByTagName")||n.fail("document missing getElementsByTagName method");var R=t.createElement("div");T.areHostMethods(R,["insertBefore","appendChild","cloneNode"]||!T.areHostObjects(R,["previousSibling","nextSibling","childNodes","parentNode"]))||n.fail("Incomplete Element implementation"),T.isHostProperty(R,"innerHTML")||n.fail("Element is missing innerHTML property");var A=t.createTextNode("test");T.areHostMethods(A,["splitText","deleteData","insertData","appendData","cloneNode"]||!T.areHostObjects(R,["previousSibling","nextSibling","childNodes","parentNode"])||!T.areHostProperties(A,["data"]))||n.fail("Incomplete Text Node implementation");var k=function(e,t){for(var n=e.length;n--;)if(e[n]===t)return!0;return!1};x.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){var e,t,n=this._current=this._next;if(this._current)if(e=n.firstChild)this._next=e;else{for(t=null;n!==this.root&&!(t=n.nextSibling);)n=n.parentNode;this._next=t}return this._current},detach:function(){this._current=this._next=this.root=null}},E.prototype={equals:function(e){return this.node===e.node&this.offset==e.offset},inspect:function(){return"[DomPosition("+C(this.node)+":"+this.offset+")]"}},S.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11},S.prototype.toString=function(){return this.message},e.dom={arrayContains:k,isHtmlNamespace:r,parentElement:o,getNodeIndex:i,getNodeLength:a,getCommonAncestor:s,isAncestorOf:c,getClosestAncestorIn:l,isCharacterDataNode:u,insertAfter:d,splitDataNode:h,getDocument:f,getWindow:p,getIframeWindow:g,getIframeDocument:m,getBody:v,getRootContainer:y,comparePoints:b,inspectNode:C,fragmentFromNodeChildren:w,createIterator:N,DomPosition:E},e.DOMException=S}),r.createModule("DomRange",function(e){function n(e,t){return 3!=e.nodeType&&(H.isAncestorOf(e,t.startContainer,!0)||H.isAncestorOf(e,t.endContainer,!0))}function r(e){return H.getDocument(e.startContainer)}function o(e,t,n){var r=e._listeners[t];if(r)for(var o=0,i=r.length;i>o;++o)r[o].call(e,{target:e,args:n})}function i(e){return new B(e.parentNode,H.getNodeIndex(e))}function a(e){return new B(e.parentNode,H.getNodeIndex(e)+1)}function s(e,t,n){var r=11==e.nodeType?e.firstChild:e;return H.isCharacterDataNode(t)?n==t.length?H.insertAfter(e,t):t.parentNode.insertBefore(e,0===n?t:H.splitDataNode(t,n)):n>=t.childNodes.length?t.appendChild(e):t.insertBefore(e,t.childNodes[n]),r}function c(e){for(var t,n,o,i=r(e.range).createDocumentFragment();n=e.next();){if(t=e.isPartiallySelectedSubtree(),n=n.cloneNode(!t),t&&(o=e.getSubtreeIterator(),n.appendChild(c(o)),o.detach(!0)),10==n.nodeType)throw new j("HIERARCHY_REQUEST_ERR");i.appendChild(n)}return i}function l(e,t,n){var r,o;n=n||{stop:!1};for(var i,a;i=e.next();)if(e.isPartiallySelectedSubtree()){if(t(i)===!1)return n.stop=!0,void 0;if(a=e.getSubtreeIterator(),l(a,t,n),a.detach(!0),n.stop)return}else for(r=H.createIterator(i);o=r.next();)if(t(o)===!1)return n.stop=!0,void 0}function u(e){for(var t;e.next();)e.isPartiallySelectedSubtree()?(t=e.getSubtreeIterator(),u(t),t.detach(!0)):e.remove()}function d(e){for(var t,n,o=r(e.range).createDocumentFragment();t=e.next();){if(e.isPartiallySelectedSubtree()?(t=t.cloneNode(!1),n=e.getSubtreeIterator(),t.appendChild(d(n)),n.detach(!0)):e.remove(),10==t.nodeType)throw new j("HIERARCHY_REQUEST_ERR");o.appendChild(t)}return o}function h(e,t,n){var r,o=!(!t||!t.length),i=!!n;o&&(r=RegExp("^("+t.join("|")+")$"));var a=[];return l(new p(e,!1),function(e){o&&!r.test(e.nodeType)||i&&!n(e)||a.push(e)}),a}function f(e){var t=e.getName===void 0?"Range":e.getName();return"["+t+"("+H.inspectNode(e.startContainer)+":"+e.startOffset+", "+H.inspectNode(e.endContainer)+":"+e.endOffset+")]"}function p(e,t){if(this.range=e,this.clonePartiallySelectedTextNodes=t,!e.collapsed){this.sc=e.startContainer,this.so=e.startOffset,this.ec=e.endContainer,this.eo=e.endOffset;var n=e.commonAncestorContainer;this.sc===this.ec&&H.isCharacterDataNode(this.sc)?(this.isSingleCharacterDataNode=!0,this._first=this._last=this._next=this.sc):(this._first=this._next=this.sc!==n||H.isCharacterDataNode(this.sc)?H.getClosestAncestorIn(this.sc,n,!0):this.sc.childNodes[this.so],this._last=this.ec!==n||H.isCharacterDataNode(this.ec)?H.getClosestAncestorIn(this.ec,n,!0):this.ec.childNodes[this.eo-1])}}function m(e){this.code=this[e],this.codeName=e,this.message="RangeException: "+this.codeName}function g(e,t,n){this.nodes=h(e,t,n),this._next=this.nodes[0],this._position=0}function v(e){return function(t,n){for(var r,o=n?t:t.parentNode;o;){if(r=o.nodeType,H.arrayContains(e,r))return o;o=o.parentNode}return null}}function y(e,t){if(G(e,t))throw new m("INVALID_NODE_TYPE_ERR")}function b(e){if(!e.startContainer)throw new j("INVALID_STATE_ERR")}function w(e,t){if(!H.arrayContains(t,e.nodeType))throw new m("INVALID_NODE_TYPE_ERR")}function C(e,t){if(0>t||t>(H.isCharacterDataNode(e)?e.length:e.childNodes.length))throw new j("INDEX_SIZE_ERR")}function x(e,t){if(Y(e,!0)!==Y(t,!0))throw new j("WRONG_DOCUMENT_ERR")}function N(e){if(K(e,!0))throw new j("NO_MODIFICATION_ALLOWED_ERR")}function E(e,t){if(!e)throw new j(t)}function S(e){return!H.arrayContains(V,e.nodeType)&&!Y(e,!0)}function _(e,t){return(H.isCharacterDataNode(e)?e.length:e.childNodes.length)>=t}function T(e){if(b(e),S(e.startContainer)||S(e.endContainer)||!_(e.startContainer,e.startOffset)||!_(e.endContainer,e.endOffset))throw Error("Range error: Range is no longer valid after DOM mutation ("+e.inspect()+")")}function R(){}function A(e){e.START_TO_START=et,e.START_TO_END=tt,e.END_TO_END=nt,e.END_TO_START=rt,e.NODE_BEFORE=ot,e.NODE_AFTER=it,e.NODE_BEFORE_AND_AFTER=at,e.NODE_INSIDE=st}function k(e){A(e),A(e.prototype)}function D(e,t){return function(){T(this);var n,r,o=this.startContainer,i=this.startOffset,s=this.commonAncestorContainer,c=new p(this,!0);o!==s&&(n=H.getClosestAncestorIn(o,s,!0),r=a(n),o=r.node,i=r.offset),l(c,N),c.reset();var u=e(c);return c.detach(),t(this,o,i,o,i),u}}function O(t,r,o){function s(e,t){return function(n){b(this),w(n,z),w(F(n),V);var r=(e?i:a)(n);(t?c:l)(this,r.node,r.offset)}}function c(e,t,n){var o=e.endContainer,i=e.endOffset;(t!==e.startContainer||n!==e.startOffset)&&((F(t)!=F(o)||1==H.comparePoints(t,n,o,i))&&(o=t,i=n),r(e,t,n,o,i))}function l(e,t,n){var o=e.startContainer,i=e.startOffset;(t!==e.endContainer||n!==e.endOffset)&&((F(t)!=F(o)||-1==H.comparePoints(t,n,o,i))&&(o=t,i=n),r(e,o,i,t,n))}function h(e,t,n){(t!==e.startContainer||n!==e.startOffset||t!==e.endContainer||n!==e.endOffset)&&r(e,t,n,t,n)}t.prototype=new R,e.util.extend(t.prototype,{setStart:function(e,t){b(this),y(e,!0),C(e,t),c(this,e,t)},setEnd:function(e,t){b(this),y(e,!0),C(e,t),l(this,e,t)},setStartBefore:s(!0,!0),setStartAfter:s(!1,!0),setEndBefore:s(!0,!1),setEndAfter:s(!1,!1),collapse:function(e){T(this),e?r(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset):r(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(e){b(this),y(e,!0),r(this,e,0,e,H.getNodeLength(e))},selectNode:function(e){b(this),y(e,!1),w(e,z);var t=i(e),n=a(e);r(this,t.node,t.offset,n.node,n.offset)},extractContents:D(d,r),deleteContents:D(u,r),canSurroundContents:function(){T(this),N(this.startContainer),N(this.endContainer);var e=new p(this,!0),t=e._first&&n(e._first,this)||e._last&&n(e._last,this);return e.detach(),!t},detach:function(){o(this)},splitBoundaries:function(){T(this);var e=this.startContainer,t=this.startOffset,n=this.endContainer,o=this.endOffset,i=e===n;H.isCharacterDataNode(n)&&o>0&&n.length>o&&H.splitDataNode(n,o),H.isCharacterDataNode(e)&&t>0&&e.length>t&&(e=H.splitDataNode(e,t),i?(o-=t,n=e):n==e.parentNode&&o>=H.getNodeIndex(e)&&o++,t=0),r(this,e,t,n,o)},normalizeBoundaries:function(){T(this);var e=this.startContainer,t=this.startOffset,n=this.endContainer,o=this.endOffset,i=function(e){var t=e.nextSibling;t&&t.nodeType==e.nodeType&&(n=e,o=e.length,e.appendData(t.data),t.parentNode.removeChild(t))},a=function(r){var i=r.previousSibling;if(i&&i.nodeType==r.nodeType){e=r;var a=r.length;if(t=i.length,r.insertData(0,i.data),i.parentNode.removeChild(i),e==n)o+=t,n=e;else if(n==r.parentNode){var s=H.getNodeIndex(r);o==s?(n=r,o=a):o>s&&o--}}},s=!0;if(H.isCharacterDataNode(n))n.length==o&&i(n);else{if(o>0){var c=n.childNodes[o-1];c&&H.isCharacterDataNode(c)&&i(c)}s=!this.collapsed}if(s){if(H.isCharacterDataNode(e))0===t&&a(e);else if(e.childNodes.length>t){var l=e.childNodes[t];l&&H.isCharacterDataNode(l)&&a(l)}}else e=n,t=o;r(this,e,t,n,o)},collapseToPoint:function(e,t){b(this),y(e,!0),C(e,t),h(this,e,t)}}),k(t)}function I(e){e.collapsed=e.startContainer===e.endContainer&&e.startOffset===e.endOffset,e.commonAncestorContainer=e.collapsed?e.startContainer:H.getCommonAncestor(e.startContainer,e.endContainer)}function L(e,t,n,r,i){var a=e.startContainer!==t||e.startOffset!==n,s=e.endContainer!==r||e.endOffset!==i;e.startContainer=t,e.startOffset=n,e.endContainer=r,e.endOffset=i,I(e),o(e,"boundarychange",{startMoved:a,endMoved:s})}function P(e){b(e),e.startContainer=e.startOffset=e.endContainer=e.endOffset=null,e.collapsed=e.commonAncestorContainer=null,o(e,"detach",null),e._listeners=null}function M(e){this.startContainer=e,this.startOffset=0,this.endContainer=e,this.endOffset=0,this._listeners={boundarychange:[],detach:[]},I(this)}e.requireModules(["DomUtil"]);var H=e.dom,B=H.DomPosition,j=e.DOMException;p.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:!1,reset:function(){this._current=null,this._next=this._first},hasNext:function(){return!!this._next},next:function(){var e=this._current=this._next;return e&&(this._next=e!==this._last?e.nextSibling:null,H.isCharacterDataNode(e)&&this.clonePartiallySelectedTextNodes&&(e===this.ec&&(e=e.cloneNode(!0)).deleteData(this.eo,e.length-this.eo),this._current===this.sc&&(e=e.cloneNode(!0)).deleteData(0,this.so))),e},remove:function(){var e,t,n=this._current;!H.isCharacterDataNode(n)||n!==this.sc&&n!==this.ec?n.parentNode&&n.parentNode.removeChild(n):(e=n===this.sc?this.so:0,t=n===this.ec?this.eo:n.length,e!=t&&n.deleteData(e,t-e))},isPartiallySelectedSubtree:function(){var e=this._current;return n(e,this.range)},getSubtreeIterator:function(){var e;if(this.isSingleCharacterDataNode)e=this.range.cloneRange(),e.collapse();else{e=new M(r(this.range));var t=this._current,n=t,o=0,i=t,a=H.getNodeLength(t);H.isAncestorOf(t,this.sc,!0)&&(n=this.sc,o=this.so),H.isAncestorOf(t,this.ec,!0)&&(i=this.ec,a=this.eo),L(e,n,o,i,a)}return new p(e,this.clonePartiallySelectedTextNodes)},detach:function(e){e&&this.range.detach(),this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}},m.prototype={BAD_BOUNDARYPOINTS_ERR:1,INVALID_NODE_TYPE_ERR:2},m.prototype.toString=function(){return this.message},g.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){return this._current=this._next,this._next=this.nodes[++this._position],this._current},detach:function(){this._current=this._next=this.nodes=null}};var z=[1,3,4,5,7,8,10],V=[2,9,11],W=[5,6,10,12],q=[1,3,4,5,7,8,10,11],U=[1,3,4,5,7,8],F=H.getRootContainer,Y=v([9,11]),K=v(W),G=v([6,10,12]),X=t.createElement("style"),$=!1;try{X.innerHTML="<b>x</b>",$=3==X.firstChild.nodeType}catch(J){}e.features.htmlParsingConforms=$;var Q=$?function(e){var t=this.startContainer,n=H.getDocument(t);if(!t)throw new j("INVALID_STATE_ERR");var r=null;return 1==t.nodeType?r=t:H.isCharacterDataNode(t)&&(r=H.parentElement(t)),r=null===r||"HTML"==r.nodeName&&H.isHtmlNamespace(H.getDocument(r).documentElement)&&H.isHtmlNamespace(r)?n.createElement("body"):r.cloneNode(!1),r.innerHTML=e,H.fragmentFromNodeChildren(r)}:function(e){b(this);var t=r(this),n=t.createElement("body");return n.innerHTML=e,H.fragmentFromNodeChildren(n)},Z=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],et=0,tt=1,nt=2,rt=3,ot=0,it=1,at=2,st=3;R.prototype={attachListener:function(e,t){this._listeners[e].push(t)},compareBoundaryPoints:function(e,t){T(this),x(this.startContainer,t.startContainer);var n,r,o,i,a=e==rt||e==et?"start":"end",s=e==tt||e==et?"start":"end";return n=this[a+"Container"],r=this[a+"Offset"],o=t[s+"Container"],i=t[s+"Offset"],H.comparePoints(n,r,o,i)},insertNode:function(e){if(T(this),w(e,q),N(this.startContainer),H.isAncestorOf(e,this.startContainer,!0))throw new j("HIERARCHY_REQUEST_ERR");var t=s(e,this.startContainer,this.startOffset);this.setStartBefore(t)},cloneContents:function(){T(this);var e,t;if(this.collapsed)return r(this).createDocumentFragment();if(this.startContainer===this.endContainer&&H.isCharacterDataNode(this.startContainer))return e=this.startContainer.cloneNode(!0),e.data=e.data.slice(this.startOffset,this.endOffset),t=r(this).createDocumentFragment(),t.appendChild(e),t;var n=new p(this,!0);return e=c(n),n.detach(),e},canSurroundContents:function(){T(this),N(this.startContainer),N(this.endContainer);var e=new p(this,!0),t=e._first&&n(e._first,this)||e._last&&n(e._last,this);return e.detach(),!t},surroundContents:function(e){if(w(e,U),!this.canSurroundContents())throw new m("BAD_BOUNDARYPOINTS_ERR");var t=this.extractContents();if(e.hasChildNodes())for(;e.lastChild;)e.removeChild(e.lastChild);s(e,this.startContainer,this.startOffset),e.appendChild(t),this.selectNode(e)},cloneRange:function(){T(this);for(var e,t=new M(r(this)),n=Z.length;n--;)e=Z[n],t[e]=this[e];return t},toString:function(){T(this);var e=this.startContainer;if(e===this.endContainer&&H.isCharacterDataNode(e))return 3==e.nodeType||4==e.nodeType?e.data.slice(this.startOffset,this.endOffset):"";var t=[],n=new p(this,!0);return l(n,function(e){(3==e.nodeType||4==e.nodeType)&&t.push(e.data)}),n.detach(),t.join("")},compareNode:function(e){T(this);var t=e.parentNode,n=H.getNodeIndex(e);if(!t)throw new j("NOT_FOUND_ERR");var r=this.comparePoint(t,n),o=this.comparePoint(t,n+1);return 0>r?o>0?at:ot:o>0?it:st},comparePoint:function(e,t){return T(this),E(e,"HIERARCHY_REQUEST_ERR"),x(e,this.startContainer),0>H.comparePoints(e,t,this.startContainer,this.startOffset)?-1:H.comparePoints(e,t,this.endContainer,this.endOffset)>0?1:0},createContextualFragment:Q,toHtml:function(){T(this);var e=r(this).createElement("div");return e.appendChild(this.cloneContents()),e.innerHTML},intersectsNode:function(e,t){if(T(this),E(e,"NOT_FOUND_ERR"),H.getDocument(e)!==r(this))return!1;var n=e.parentNode,o=H.getNodeIndex(e);E(n,"NOT_FOUND_ERR");var i=H.comparePoints(n,o,this.endContainer,this.endOffset),a=H.comparePoints(n,o+1,this.startContainer,this.startOffset);return t?0>=i&&a>=0:0>i&&a>0},isPointInRange:function(e,t){return T(this),E(e,"HIERARCHY_REQUEST_ERR"),x(e,this.startContainer),H.comparePoints(e,t,this.startContainer,this.startOffset)>=0&&0>=H.comparePoints(e,t,this.endContainer,this.endOffset)},intersectsRange:function(e,t){if(T(this),r(e)!=r(this))throw new j("WRONG_DOCUMENT_ERR");var n=H.comparePoints(this.startContainer,this.startOffset,e.endContainer,e.endOffset),o=H.comparePoints(this.endContainer,this.endOffset,e.startContainer,e.startOffset);return t?0>=n&&o>=0:0>n&&o>0},intersection:function(e){if(this.intersectsRange(e)){var t=H.comparePoints(this.startContainer,this.startOffset,e.startContainer,e.startOffset),n=H.comparePoints(this.endContainer,this.endOffset,e.endContainer,e.endOffset),r=this.cloneRange();return-1==t&&r.setStart(e.startContainer,e.startOffset),1==n&&r.setEnd(e.endContainer,e.endOffset),r}return null},union:function(e){if(this.intersectsRange(e,!0)){var t=this.cloneRange();return-1==H.comparePoints(e.startContainer,e.startOffset,this.startContainer,this.startOffset)&&t.setStart(e.startContainer,e.startOffset),1==H.comparePoints(e.endContainer,e.endOffset,this.endContainer,this.endOffset)&&t.setEnd(e.endContainer,e.endOffset),t}throw new m("Ranges do not intersect")},containsNode:function(e,t){return t?this.intersectsNode(e,!1):this.compareNode(e)==st},containsNodeContents:function(e){return this.comparePoint(e,0)>=0&&0>=this.comparePoint(e,H.getNodeLength(e))},containsRange:function(e){return this.intersection(e).equals(e)},containsNodeText:function(e){var t=this.cloneRange();t.selectNode(e);var n=t.getNodes([3]);if(n.length>0){t.setStart(n[0],0);var r=n.pop();t.setEnd(r,r.length);var o=this.containsRange(t);return t.detach(),o}return this.containsNodeContents(e)},createNodeIterator:function(e,t){return T(this),new g(this,e,t)},getNodes:function(e,t){return T(this),h(this,e,t)},getDocument:function(){return r(this)},collapseBefore:function(e){b(this),this.setEndBefore(e),this.collapse(!1)},collapseAfter:function(e){b(this),this.setStartAfter(e),this.collapse(!0)},getName:function(){return"DomRange"},equals:function(e){return M.rangesEqual(this,e)},inspect:function(){return f(this)}},O(M,L,P),e.rangePrototype=R.prototype,M.rangeProperties=Z,M.RangeIterator=p,M.copyComparisonConstants=k,M.createPrototypeRange=O,M.inspect=f,M.getRangeDocument=r,M.rangesEqual=function(e,t){return e.startContainer===t.startContainer&&e.startOffset===t.startOffset&&e.endContainer===t.endContainer&&e.endOffset===t.endOffset},e.DomRange=M,e.RangeException=m}),r.createModule("WrappedRange",function(e){function n(e){var t=e.parentElement(),n=e.duplicate();n.collapse(!0);var r=n.parentElement();n=e.duplicate(),n.collapse(!1);var o=n.parentElement(),i=r==o?r:s.getCommonAncestor(r,o);return i==t?i:s.getCommonAncestor(t,i)}function r(e){return 0===e.compareEndPoints("StartToEnd",e)}function o(e,t,n,r){var o=e.duplicate();o.collapse(n);var i=o.parentElement();if(s.isAncestorOf(t,i,!0)||(i=t),!i.canHaveHTML)return new c(i.parentNode,s.getNodeIndex(i));var a,l,u,d,h,f=s.getDocument(i).createElement("span"),p=n?"StartToStart":"StartToEnd";do i.insertBefore(f,f.previousSibling),o.moveToElementText(f);while((a=o.compareEndPoints(p,e))>0&&f.previousSibling);if(h=f.nextSibling,-1==a&&h&&s.isCharacterDataNode(h)){o.setEndPoint(n?"EndToStart":"EndToEnd",e);var m;if(/[\r\n]/.test(h.data)){var g=o.duplicate(),v=g.text.replace(/\r\n/g,"\r").length;for(m=g.moveStart("character",v);-1==(a=g.compareEndPoints("StartToEnd",g));)m++,g.moveStart("character",1)}else m=o.text.length;d=new c(h,m)}else l=(r||!n)&&f.previousSibling,u=(r||n)&&f.nextSibling,d=u&&s.isCharacterDataNode(u)?new c(u,0):l&&s.isCharacterDataNode(l)?new c(l,l.length):new c(i,s.getNodeIndex(f));return f.parentNode.removeChild(f),d}function i(e,t){var n,r,o,i,a=e.offset,c=s.getDocument(e.node),l=c.body.createTextRange(),u=s.isCharacterDataNode(e.node);return u?(n=e.node,r=n.parentNode):(i=e.node.childNodes,n=i.length>a?i[a]:null,r=e.node),o=c.createElement("span"),o.innerHTML="&#feff;",n?r.insertBefore(o,n):r.appendChild(o),l.moveToElementText(o),l.collapse(!t),r.removeChild(o),u&&l[t?"moveStart":"moveEnd"]("character",a),l}e.requireModules(["DomUtil","DomRange"]);var a,s=e.dom,c=s.DomPosition,l=e.DomRange;if(!e.features.implementsDomRange||e.features.implementsTextRange&&e.config.preferTextRange){if(e.features.implementsTextRange){a=function(e){this.textRange=e,this.refresh()},a.prototype=new l(t),a.prototype.refresh=function(){var e,t,i=n(this.textRange);r(this.textRange)?t=e=o(this.textRange,i,!0,!0):(e=o(this.textRange,i,!0,!1),t=o(this.textRange,i,!1,!1)),this.setStart(e.node,e.offset),this.setEnd(t.node,t.offset)},l.copyComparisonConstants(a);var u=function(){return this}();u.Range===void 0&&(u.Range=a),e.createNativeRange=function(e){return e=e||t,e.body.createTextRange()}}}else(function(){function n(e){for(var t,n=d.length;n--;)t=d[n],e[t]=e.nativeRange[t]}function r(e,t,n,r,o){var i=e.startContainer!==t||e.startOffset!=n,a=e.endContainer!==r||e.endOffset!=o;(i||a)&&(e.setEnd(r,o),e.setStart(t,n))}function o(e){e.nativeRange.detach(),e.detached=!0;for(var t,n=d.length;n--;)t=d[n],e[t]=null}var i,c,u,d=l.rangeProperties;a=function(e){if(!e)throw Error("Range must be specified");this.nativeRange=e,n(this)},l.createPrototypeRange(a,r,o),i=a.prototype,i.selectNode=function(e){this.nativeRange.selectNode(e),n(this)},i.deleteContents=function(){this.nativeRange.deleteContents(),n(this)},i.extractContents=function(){var e=this.nativeRange.extractContents();return n(this),e},i.cloneContents=function(){return this.nativeRange.cloneContents()},i.surroundContents=function(e){this.nativeRange.surroundContents(e),n(this)},i.collapse=function(e){this.nativeRange.collapse(e),n(this)},i.cloneRange=function(){return new a(this.nativeRange.cloneRange())},i.refresh=function(){n(this)},i.toString=function(){return""+this.nativeRange};var h=t.createTextNode("test");s.getBody(t).appendChild(h);var f=t.createRange();f.setStart(h,0),f.setEnd(h,0);try{f.setStart(h,1),c=!0,i.setStart=function(e,t){this.nativeRange.setStart(e,t),n(this)},i.setEnd=function(e,t){this.nativeRange.setEnd(e,t),n(this)},u=function(e){return function(t){this.nativeRange[e](t),n(this)}}}catch(p){c=!1,i.setStart=function(e,t){try{this.nativeRange.setStart(e,t)}catch(r){this.nativeRange.setEnd(e,t),this.nativeRange.setStart(e,t)}n(this)},i.setEnd=function(e,t){try{this.nativeRange.setEnd(e,t)}catch(r){this.nativeRange.setStart(e,t),this.nativeRange.setEnd(e,t)}n(this)},u=function(e,t){return function(r){try{this.nativeRange[e](r)}catch(o){this.nativeRange[t](r),this.nativeRange[e](r)}n(this)}}}i.setStartBefore=u("setStartBefore","setEndBefore"),i.setStartAfter=u("setStartAfter","setEndAfter"),i.setEndBefore=u("setEndBefore","setStartBefore"),i.setEndAfter=u("setEndAfter","setStartAfter"),f.selectNodeContents(h),i.selectNodeContents=f.startContainer==h&&f.endContainer==h&&0===f.startOffset&&f.endOffset==h.length?function(e){this.nativeRange.selectNodeContents(e),n(this)}:function(e){this.setStart(e,0),this.setEnd(e,l.getEndOffset(e))},f.selectNodeContents(h),f.setEnd(h,3);var m=t.createRange();m.selectNodeContents(h),m.setEnd(h,4),m.setStart(h,2),i.compareBoundaryPoints=-1==f.compareBoundaryPoints(f.START_TO_END,m)&1==f.compareBoundaryPoints(f.END_TO_START,m)?function(e,t){return t=t.nativeRange||t,e==t.START_TO_END?e=t.END_TO_START:e==t.END_TO_START&&(e=t.START_TO_END),this.nativeRange.compareBoundaryPoints(e,t)}:function(e,t){return this.nativeRange.compareBoundaryPoints(e,t.nativeRange||t)},e.util.isHostMethod(f,"createContextualFragment")&&(i.createContextualFragment=function(e){return this.nativeRange.createContextualFragment(e)}),s.getBody(t).removeChild(h),f.detach(),m.detach()})(),e.createNativeRange=function(e){return e=e||t,e.createRange()};e.features.implementsTextRange&&(a.rangeToTextRange=function(e){if(e.collapsed){var t=i(new c(e.startContainer,e.startOffset),!0);return t}var n=i(new c(e.startContainer,e.startOffset),!0),r=i(new c(e.endContainer,e.endOffset),!1),o=s.getDocument(e.startContainer).body.createTextRange();return o.setEndPoint("StartToStart",n),o.setEndPoint("EndToEnd",r),o}),a.prototype.getName=function(){return"WrappedRange"},e.WrappedRange=a,e.createRange=function(n){return n=n||t,new a(e.createNativeRange(n))},e.createRangyRange=function(e){return e=e||t,new l(e)},e.createIframeRange=function(t){return e.createRange(s.getIframeDocument(t))},e.createIframeRangyRange=function(t){return e.createRangyRange(s.getIframeDocument(t))},e.addCreateMissingNativeApiListener(function(t){var n=t.document;n.createRange===void 0&&(n.createRange=function(){return e.createRange(this)}),n=t=null})}),r.createModule("WrappedSelection",function(n,r){function o(t){return(t||e).getSelection()}function i(t){return(t||e).document.selection}function a(e,t,n){var r=n?"end":"start",o=n?"start":"end";e.anchorNode=t[r+"Container"],e.anchorOffset=t[r+"Offset"],e.focusNode=t[o+"Container"],e.focusOffset=t[o+"Offset"]}function s(e){var t=e.nativeSelection;e.anchorNode=t.anchorNode,e.anchorOffset=t.anchorOffset,e.focusNode=t.focusNode,e.focusOffset=t.focusOffset}function c(e){e.anchorNode=e.focusNode=null,e.anchorOffset=e.focusOffset=0,e.rangeCount=0,e.isCollapsed=!0,e._ranges.length=0}function l(e){var t;return e instanceof _?(t=e._selectionNativeRange,t||(t=n.createNativeRange(E.getDocument(e.startContainer)),t.setEnd(e.endContainer,e.endOffset),t.setStart(e.startContainer,e.startOffset),e._selectionNativeRange=t,e.attachListener("detach",function(){this._selectionNativeRange=null}))):e instanceof T?t=e.nativeRange:n.features.implementsDomRange&&e instanceof E.getWindow(e.startContainer).Range&&(t=e),t}function u(e){if(!e.length||1!=e[0].nodeType)return!1;for(var t=1,n=e.length;n>t;++t)if(!E.isAncestorOf(e[0],e[t]))return!1;return!0}function d(e){var t=e.getNodes();if(!u(t))throw Error("getSingleElementFromRange: range "+e.inspect()+" did not consist of a single element");return t[0]}function h(e){return!!e&&e.text!==void 0}function f(e,t){var n=new T(t);e._ranges=[n],a(e,n,!1),e.rangeCount=1,e.isCollapsed=n.collapsed}function p(e){if(e._ranges.length=0,"None"==e.docSelection.type)c(e);else{var t=e.docSelection.createRange();if(h(t))f(e,t);else{e.rangeCount=t.length;for(var r,o=E.getDocument(t.item(0)),i=0;e.rangeCount>i;++i)r=n.createRange(o),r.selectNode(t.item(i)),e._ranges.push(r);e.isCollapsed=1==e.rangeCount&&e._ranges[0].collapsed,a(e,e._ranges[e.rangeCount-1],!1)}}}function m(e,t){for(var n=e.docSelection.createRange(),r=d(t),o=E.getDocument(n.item(0)),i=E.getBody(o).createControlRange(),a=0,s=n.length;s>a;++a)i.add(n.item(a));
try{i.add(r)}catch(c){throw Error("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)")}i.select(),p(e)}function g(e,t,n){this.nativeSelection=e,this.docSelection=t,this._ranges=[],this.win=n,this.refresh()}function v(e,t){for(var n,r=E.getDocument(t[0].startContainer),o=E.getBody(r).createControlRange(),i=0;rangeCount>i;++i){n=d(t[i]);try{o.add(n)}catch(a){throw Error("setRanges(): Element within the one of the specified Ranges could not be added to control selection (does it have layout?)")}}o.select(),p(e)}function y(e,t){if(e.anchorNode&&E.getDocument(e.anchorNode)!==E.getDocument(t))throw new R("WRONG_DOCUMENT_ERR")}function b(e){var t=[],n=new A(e.anchorNode,e.anchorOffset),r=new A(e.focusNode,e.focusOffset),o="function"==typeof e.getName?e.getName():"Selection";if(e.rangeCount!==void 0)for(var i=0,a=e.rangeCount;a>i;++i)t[i]=_.inspect(e.getRangeAt(i));return"["+o+"(Ranges: "+t.join(", ")+")(anchor: "+n.inspect()+", focus: "+r.inspect()+"]"}n.requireModules(["DomUtil","DomRange","WrappedRange"]),n.config.checkSelectionRanges=!0;var w,C,x="boolean",N="_rangySelection",E=n.dom,S=n.util,_=n.DomRange,T=n.WrappedRange,R=n.DOMException,A=E.DomPosition,k="Control",D=n.util.isHostMethod(e,"getSelection"),O=n.util.isHostObject(t,"selection"),I=O&&(!D||n.config.preferTextRange);I?(w=i,n.isSelectionValid=function(t){var n=(t||e).document,r=n.selection;return"None"!=r.type||E.getDocument(r.createRange().parentElement())==n}):D?(w=o,n.isSelectionValid=function(){return!0}):r.fail("Neither document.selection or window.getSelection() detected."),n.getNativeSelection=w;var L=w(),P=n.createNativeRange(t),M=E.getBody(t),H=S.areHostObjects(L,["anchorNode","focusNode"]&&S.areHostProperties(L,["anchorOffset","focusOffset"]));n.features.selectionHasAnchorAndFocus=H;var B=S.isHostMethod(L,"extend");n.features.selectionHasExtend=B;var j="number"==typeof L.rangeCount;n.features.selectionHasRangeCount=j;var z=!1,V=!0;S.areHostMethods(L,["addRange","getRangeAt","removeAllRanges"])&&"number"==typeof L.rangeCount&&n.features.implementsDomRange&&function(){var e=t.createElement("iframe");M.appendChild(e);var n=E.getIframeDocument(e);n.open(),n.write("<html><head></head><body>12</body></html>"),n.close();var r=E.getIframeWindow(e).getSelection(),o=n.documentElement,i=o.lastChild,a=i.firstChild,s=n.createRange();s.setStart(a,1),s.collapse(!0),r.addRange(s),V=1==r.rangeCount,r.removeAllRanges();var c=s.cloneRange();s.setStart(a,0),c.setEnd(a,2),r.addRange(s),r.addRange(c),z=2==r.rangeCount,s.detach(),c.detach(),M.removeChild(e)}(),n.features.selectionSupportsMultipleRanges=z,n.features.collapsedNonEditableSelectionsSupported=V;var W,q=!1;M&&S.isHostMethod(M,"createControlRange")&&(W=M.createControlRange(),S.areHostProperties(W,["item","add"])&&(q=!0)),n.features.implementsControlRange=q,C=H?function(e){return e.anchorNode===e.focusNode&&e.anchorOffset===e.focusOffset}:function(e){return e.rangeCount?e.getRangeAt(e.rangeCount-1).collapsed:!1};var U;S.isHostMethod(L,"getRangeAt")?U=function(e,t){try{return e.getRangeAt(t)}catch(n){return null}}:H&&(U=function(e){var t=E.getDocument(e.anchorNode),r=n.createRange(t);return r.setStart(e.anchorNode,e.anchorOffset),r.setEnd(e.focusNode,e.focusOffset),r.collapsed!==this.isCollapsed&&(r.setStart(e.focusNode,e.focusOffset),r.setEnd(e.anchorNode,e.anchorOffset)),r}),n.getSelection=function(t){t=t||e;var n=t[N],r=w(t),o=O?i(t):null;return n?(n.nativeSelection=r,n.docSelection=o,n.refresh(t)):(n=new g(r,o,t),t[N]=n),n},n.getIframeSelection=function(e){return n.getSelection(E.getIframeWindow(e))};var F=g.prototype;if(!I&&H&&S.areHostMethods(L,["removeAllRanges","addRange"])){F.removeAllRanges=function(){this.nativeSelection.removeAllRanges(),c(this)};var Y=function(e,t){var r=_.getRangeDocument(t),o=n.createRange(r);o.collapseToPoint(t.endContainer,t.endOffset),e.nativeSelection.addRange(l(o)),e.nativeSelection.extend(t.startContainer,t.startOffset),e.refresh()};F.addRange=j?function(e,t){if(q&&O&&this.docSelection.type==k)m(this,e);else if(t&&B)Y(this,e);else{var r;if(z?r=this.rangeCount:(this.removeAllRanges(),r=0),this.nativeSelection.addRange(l(e)),this.rangeCount=this.nativeSelection.rangeCount,this.rangeCount==r+1){if(n.config.checkSelectionRanges){var o=U(this.nativeSelection,this.rangeCount-1);o&&!_.rangesEqual(o,e)&&(e=new T(o))}this._ranges[this.rangeCount-1]=e,a(this,e,X(this.nativeSelection)),this.isCollapsed=C(this)}else this.refresh()}}:function(e,t){t&&B?Y(this,e):(this.nativeSelection.addRange(l(e)),this.refresh())},F.setRanges=function(e){if(q&&e.length>1)v(this,e);else{this.removeAllRanges();for(var t=0,n=e.length;n>t;++t)this.addRange(e[t])}}}else{if(!(S.isHostMethod(L,"empty")&&S.isHostMethod(P,"select")&&q&&I))return r.fail("No means of selecting a Range or TextRange was found"),!1;F.removeAllRanges=function(){try{if(this.docSelection.empty(),"None"!=this.docSelection.type){var e;if(this.anchorNode)e=E.getDocument(this.anchorNode);else if(this.docSelection.type==k){var t=this.docSelection.createRange();t.length&&(e=E.getDocument(t.item(0)).body.createTextRange())}if(e){var n=e.body.createTextRange();n.select(),this.docSelection.empty()}}}catch(r){}c(this)},F.addRange=function(e){this.docSelection.type==k?m(this,e):(T.rangeToTextRange(e).select(),this._ranges[0]=e,this.rangeCount=1,this.isCollapsed=this._ranges[0].collapsed,a(this,e,!1))},F.setRanges=function(e){this.removeAllRanges();var t=e.length;t>1?v(this,e):t&&this.addRange(e[0])}}F.getRangeAt=function(e){if(0>e||e>=this.rangeCount)throw new R("INDEX_SIZE_ERR");return this._ranges[e]};var K;if(I)K=function(e){var t;n.isSelectionValid(e.win)?t=e.docSelection.createRange():(t=E.getBody(e.win.document).createTextRange(),t.collapse(!0)),e.docSelection.type==k?p(e):h(t)?f(e,t):c(e)};else if(S.isHostMethod(L,"getRangeAt")&&"number"==typeof L.rangeCount)K=function(e){if(q&&O&&e.docSelection.type==k)p(e);else if(e&&e.nativeSelection&&(e._ranges.length=e.rangeCount=e.nativeSelection.rangeCount),e.rangeCount){for(var t=0,r=e.rangeCount;r>t;++t)e._ranges[t]=new n.WrappedRange(e.nativeSelection.getRangeAt(t));a(e,e._ranges[e.rangeCount-1],X(e.nativeSelection)),e.isCollapsed=C(e)}else c(e)};else{if(!H||typeof L.isCollapsed!=x||typeof P.collapsed!=x||!n.features.implementsDomRange)return r.fail("No means of obtaining a Range or TextRange from the user's selection was found"),!1;K=function(e){var t,n=e.nativeSelection;n.anchorNode?(t=U(n,0),e._ranges=[t],e.rangeCount=1,s(e),e.isCollapsed=C(e)):c(e)}}F.refresh=function(e){var t=e?this._ranges.slice(0):null;if(K(this),e){var n=t.length;if(n!=this._ranges.length)return!1;for(;n--;)if(!_.rangesEqual(t[n],this._ranges[n]))return!1;return!0}};var G=function(e,t){var n=e.getAllRanges(),r=!1;e.removeAllRanges();for(var o=0,i=n.length;i>o;++o)r||t!==n[o]?e.addRange(n[o]):r=!0;e.rangeCount||c(e)};F.removeRange=q?function(e){if(this.docSelection.type==k){for(var t,n=this.docSelection.createRange(),r=d(e),o=E.getDocument(n.item(0)),i=E.getBody(o).createControlRange(),a=!1,s=0,c=n.length;c>s;++s)t=n.item(s),t!==r||a?i.add(n.item(s)):a=!0;i.select(),p(this)}else G(this,e)}:function(e){G(this,e)};var X;!I&&H&&n.features.implementsDomRange?(X=function(e){var t=!1;return e.anchorNode&&(t=1==E.comparePoints(e.anchorNode,e.anchorOffset,e.focusNode,e.focusOffset)),t},F.isBackwards=function(){return X(this)}):X=F.isBackwards=function(){return!1},F.toString=function(){for(var e=[],t=0,n=this.rangeCount;n>t;++t)e[t]=""+this._ranges[t];return e.join("")},F.collapse=function(e,t){y(this,e);var r=n.createRange(E.getDocument(e));r.collapseToPoint(e,t),this.removeAllRanges(),this.addRange(r),this.isCollapsed=!0},F.collapseToStart=function(){if(!this.rangeCount)throw new R("INVALID_STATE_ERR");var e=this._ranges[0];this.collapse(e.startContainer,e.startOffset)},F.collapseToEnd=function(){if(!this.rangeCount)throw new R("INVALID_STATE_ERR");var e=this._ranges[this.rangeCount-1];this.collapse(e.endContainer,e.endOffset)},F.selectAllChildren=function(e){y(this,e);var t=n.createRange(E.getDocument(e));t.selectNodeContents(e),this.removeAllRanges(),this.addRange(t)},F.deleteFromDocument=function(){if(q&&O&&this.docSelection.type==k){for(var e,t=this.docSelection.createRange();t.length;)e=t.item(0),t.remove(e),e.parentNode.removeChild(e);this.refresh()}else if(this.rangeCount){var n=this.getAllRanges();this.removeAllRanges();for(var r=0,o=n.length;o>r;++r)n[r].deleteContents();this.addRange(n[o-1])}},F.getAllRanges=function(){return this._ranges.slice(0)},F.setSingleRange=function(e){this.setRanges([e])},F.containsNode=function(e,t){for(var n=0,r=this._ranges.length;r>n;++n)if(this._ranges[n].containsNode(e,t))return!0;return!1},F.toHtml=function(){var e="";if(this.rangeCount){for(var t=_.getRangeDocument(this._ranges[0]).createElement("div"),n=0,r=this._ranges.length;r>n;++n)t.appendChild(this._ranges[n].cloneContents());e=t.innerHTML}return e},F.getName=function(){return"WrappedSelection"},F.inspect=function(){return b(this)},F.detach=function(){this.win[N]=null,this.win=this.anchorNode=this.focusNode=null},g.inspect=b,n.Selection=g,n.selectionPrototype=F,n.addCreateMissingNativeApiListener(function(e){e.getSelection===void 0&&(e.getSelection=function(){return n.getSelection(this)}),e=null})});var o=function(){};return o.extend=function(e,t){var n=o.prototype.extend;o._prototyping=!0;var r=new this;n.call(r,e),r.base=function(){},delete o._prototyping;var i=r.constructor,a=r.constructor=function(){if(!o._prototyping)if(this._constructing||this.constructor==a)this._constructing=!0,i.apply(this,arguments),delete this._constructing;else if(null!=arguments[0])return(arguments[0].extend||n).call(arguments[0],r)};return a.ancestor=this,a.extend=this.extend,a.forEach=this.forEach,a.implement=this.implement,a.prototype=r,a.toString=this.toString,a.valueOf=function(e){return"object"==e?a:i.valueOf()},n.call(a,t),"function"==typeof a.init&&a.init(),a},o.prototype={extend:function(e,t){if(arguments.length>1){var n=this[e];if(n&&"function"==typeof t&&(!n.valueOf||n.valueOf()!=t.valueOf())&&/\bbase\b/.test(t)){var r=t.valueOf();t=function(){var e=this.base||o.prototype.base;this.base=n;var t=r.apply(this,arguments);return this.base=e,t},t.valueOf=function(e){return"object"==e?t:r},t.toString=o.toString}this[e]=t}else if(e){var i=o.prototype.extend;o._prototyping||"function"==typeof this||(i=this.extend||i);for(var a={toSource:null},s=["constructor","toString","valueOf"],c=o._prototyping?0:1;l=s[c++];)e[l]!=a[l]&&i.call(this,l,e[l]);for(var l in e)a[l]||i.call(this,l,e[l])}return this}},o=o.extend({constructor:function(){this.extend(arguments[0])}},{ancestor:Object,version:"1.1",forEach:function(e,t,n){for(var r in e)void 0===this.prototype[r]&&t.call(n,e[r],r,e)},implement:function(){for(var e=0;arguments.length>e;e++)"function"==typeof arguments[e]?arguments[e](this.prototype):this.prototype.extend(arguments[e]);return this},toString:function(){return this.valueOf()+""}}),n.browser=function(){function n(e){return+(/ipad|iphone|ipod/.test(e)&&e.match(/ os (\d+).+? like mac os x/)||[,0])[1]}function r(e){return+(e.match(/android (\d+)/)||[,0])[1]}var o=navigator.userAgent,i=t.createElement("div"),a=-1!==o.indexOf("MSIE")&&-1===o.indexOf("Opera"),s=-1!==o.indexOf("Gecko")&&-1===o.indexOf("KHTML"),c=-1!==o.indexOf("AppleWebKit/"),l=-1!==o.indexOf("Chrome/"),u=-1!==o.indexOf("Opera/");return{USER_AGENT:o,supported:function(){var e=this.USER_AGENT.toLowerCase(),o="contentEditable"in i,a=t.execCommand&&t.queryCommandSupported&&t.queryCommandState,s=t.querySelector&&t.querySelectorAll,c=this.isIos()&&5>n(e)||this.isAndroid()&&4>r(e)||-1!==e.indexOf("opera mobi")||-1!==e.indexOf("hpwos/");return o&&a&&s&&!c},isTouchDevice:function(){return this.supportsEvent("touchmove")},isIos:function(){return/ipad|iphone|ipod/i.test(this.USER_AGENT)},isAndroid:function(){return-1!==this.USER_AGENT.indexOf("Android")},supportsSandboxedIframes:function(){return a},throwsMixedContentWarningWhenIframeSrcIsEmpty:function(){return!("querySelector"in t)},displaysCaretInEmptyContentEditableCorrectly:function(){return a},hasCurrentStyleProperty:function(){return"currentStyle"in i},hasHistoryIssue:function(){return s},insertsLineBreaksOnReturn:function(){return s},supportsPlaceholderAttributeOn:function(e){return"placeholder"in e},supportsEvent:function(e){return"on"+e in i||function(){return i.setAttribute("on"+e,"return;"),"function"==typeof i["on"+e]}()},supportsEventsInIframeCorrectly:function(){return!u},supportsHTML5Tags:function(e){var t=e.createElement("div"),n="<article>foo</article>";return t.innerHTML=n,t.innerHTML.toLowerCase()===n},supportsCommand:function(){var e={formatBlock:a,insertUnorderedList:a||c,insertOrderedList:a||c},t={insertHTML:s};return function(n,r){var o=e[r];if(!o){try{return n.queryCommandSupported(r)}catch(i){}try{return n.queryCommandEnabled(r)}catch(a){return!!t[r]}}return!1}}(),doesAutoLinkingInContentEditable:function(){return a},canDisableAutoLinking:function(){return this.supportsCommand(t,"AutoUrlDetect")},clearsContentEditableCorrectly:function(){return s||u||c},supportsGetAttributeCorrectly:function(){var e=t.createElement("td");return"1"!=e.getAttribute("rowspan")},canSelectImagesInContentEditable:function(){return s||a||u},autoScrollsToCaret:function(){return!c},autoClosesUnclosedTags:function(){var e,t,n=i.cloneNode(!1);return n.innerHTML="<p><div></div>",t=n.innerHTML.toLowerCase(),e="<p></p><div></div>"===t||"<p><div></div></p>"===t,this.autoClosesUnclosedTags=function(){return e},e},supportsNativeGetElementsByClassName:function(){return-1!==(t.getElementsByClassName+"").indexOf("[native code]")},supportsSelectionModify:function(){return"getSelection"in e&&"modify"in window.getSelection()},needsSpaceAfterLineBreak:function(){return u},supportsSpeechApiOn:function(e){var t=o.match(/Chrome\/(\d+)/)||[,0];return t[1]>=11&&("onwebkitspeechchange"in e||"speech"in e)},crashesWhenDefineProperty:function(e){return a&&("XMLHttpRequest"===e||"XDomainRequest"===e)},doesAsyncFocus:function(){return a},hasProblemsSettingCaretAfterImg:function(){return a},hasUndoInContextMenu:function(){return s||l||u},hasInsertNodeIssue:function(){return u},hasIframeFocusIssue:function(){return a}}}(),n.lang.array=function(e){return{contains:function(t){if(e.indexOf)return-1!==e.indexOf(t);for(var n=0,r=e.length;r>n;n++)if(e[n]===t)return!0;return!1},without:function(t){t=n.lang.array(t);for(var r=[],o=0,i=e.length;i>o;o++)t.contains(e[o])||r.push(e[o]);return r},get:function(){for(var t=0,n=e.length,r=[];n>t;t++)r.push(e[t]);return r}}},n.lang.Dispatcher=o.extend({on:function(e,t){return this.events=this.events||{},this.events[e]=this.events[e]||[],this.events[e].push(t),this},off:function(e,t){this.events=this.events||{};var n,r,o=0;if(e){for(n=this.events[e]||[],r=[];n.length>o;o++)n[o]!==t&&t&&r.push(n[o]);this.events[e]=r}else this.events={};return this},fire:function(e,t,n){this.events=this.events||{};for(var r=this.events[e]||[],o=0;r.length>o;o++)r[o].call(this,t,n);return this},observe:function(){return this.on.apply(this,arguments)},stopObserving:function(){return this.off.apply(this,arguments)}}),n.lang.object=function(e){return{merge:function(t){for(var n in t)e[n]=t[n];return this},get:function(){return e},clone:function(){var t,n={};for(t in e)n[t]=e[t];return n},isArray:function(){return"[object Array]"===Object.prototype.toString.call(e)}}},function(){var e=/^\s+/,t=/\s+$/;n.lang.string=function(n){return n+="",{trim:function(){return n.replace(e,"").replace(t,"")},interpolate:function(e){for(var t in e)n=this.replace("#{"+t+"}").by(e[t]);return n},replace:function(e){return{by:function(t){return n.split(e).join(t)}}}}}}(),function(e){function t(e){return i(e)?e:(e===e.ownerDocument.documentElement&&(e=e.ownerDocument.body),a(e))}function n(e){return e.replace(c,function(e,t){var n=(t.match(l)||[])[1]||"",r=d[n];t=t.replace(l,""),t.split(r).length>t.split(n).length&&(t+=n,n="");var o=t,i=t;return t.length>u&&(i=i.substr(0,u)+"..."),"www."===o.substr(0,4)&&(o="http://"+o),'<a href="'+o+'">'+i+"</a>"+n})}function r(e){var t=e._wysihtml5_tempElement;return t||(t=e._wysihtml5_tempElement=e.createElement("div")),t}function o(e){var t=e.parentNode,o=r(t.ownerDocument);for(o.innerHTML="<span></span>"+n(e.data),o.removeChild(o.firstChild);o.firstChild;)t.insertBefore(o.firstChild,e);t.removeChild(e)}function i(e){for(var t;e.parentNode;){if(e=e.parentNode,t=e.nodeName,s.contains(t))return!0;if("body"===t)return!1}return!1}function a(t){if(!s.contains(t.nodeName)){if(t.nodeType===e.TEXT_NODE&&t.data.match(c))return o(t),void 0;for(var n=e.lang.array(t.childNodes).get(),r=n.length,i=0;r>i;i++)a(n[i]);return t}}var s=e.lang.array(["CODE","PRE","A","SCRIPT","HEAD","TITLE","STYLE"]),c=/((https?:\/\/|www\.)[^\s<]{3,})/gi,l=/([^\w\/\-](,?))$/i,u=100,d={")":"(","]":"[","}":"{"};e.dom.autoLink=t,e.dom.autoLink.URL_REG_EXP=c}(n),function(e){var t=e.dom;t.addClass=function(e,n){var r=e.classList;return r?r.add(n):(t.hasClass(e,n)||(e.className+=" "+n),void 0)},t.removeClass=function(e,t){var n=e.classList;return n?n.remove(t):(e.className=e.className.replace(RegExp("(^|\\s+)"+t+"(\\s+|$)")," "),void 0)},t.hasClass=function(e,t){var n=e.classList;if(n)return n.contains(t);var r=e.className;return r.length>0&&(r==t||RegExp("(^|\\s)"+t+"(\\s|$)").test(r))}}(n),n.dom.contains=function(){var e=t.documentElement;return e.contains?function(e,t){return t.nodeType!==n.ELEMENT_NODE&&(t=t.parentNode),e!==t&&e.contains(t)}:e.compareDocumentPosition?function(e,t){return!!(16&e.compareDocumentPosition(t))}:void 0}(),n.dom.convertToList=function(){function e(e,t){var n=e.createElement("li");return t.appendChild(n),n}function t(e,t){return e.createElement(t)}function r(r,o){if("UL"===r.nodeName||"OL"===r.nodeName||"MENU"===r.nodeName)return r;var i,a,s,c,l,u,d,h,f,p=r.ownerDocument,m=t(p,o),g=r.querySelectorAll("br"),v=g.length;for(f=0;v>f;f++)for(c=g[f];(l=c.parentNode)&&l!==r&&l.lastChild===c;){if("block"===n.dom.getStyle("display").from(l)){l.removeChild(c);break}n.dom.insert(c).after(c.parentNode)}for(i=n.lang.array(r.childNodes).get(),a=i.length,f=0;a>f;f++)h=h||e(p,m),s=i[f],u="block"===n.dom.getStyle("display").from(s),d="BR"===s.nodeName,u?(h=h.firstChild?e(p,m):h,h.appendChild(s),h=null):d?h=h.firstChild?null:h:h.appendChild(s);return 0===i.length&&e(p,m),r.parentNode.replaceChild(m,r),m}return r}(),n.dom.copyAttributes=function(e){return{from:function(t){return{to:function(n){for(var r,o=0,i=e.length;i>o;o++)r=e[o],t[r]!==void 0&&""!==t[r]&&(n[r]=t[r]);return{andTo:arguments.callee}}}}}},function(e){var t=["-webkit-box-sizing","-moz-box-sizing","-ms-box-sizing","box-sizing"],r=function(t){return o(t)?parseInt(e.getStyle("width").from(t),10)<t.offsetWidth:!1},o=function(n){for(var r=0,o=t.length;o>r;r++)if("border-box"===e.getStyle(t[r]).from(n))return t[r]};e.copyStyles=function(o){return{from:function(i){r(i)&&(o=n.lang.array(o).without(t));for(var a,s="",c=o.length,l=0;c>l;l++)a=o[l],s+=a+":"+e.getStyle(a).from(i)+";";return{to:function(t){return e.setStyles(s).on(t),{andTo:arguments.callee}}}}}}}(n.dom),function(e){e.dom.delegate=function(t,n,r,o){return e.dom.observe(t,r,function(r){for(var i=r.target,a=e.lang.array(t.querySelectorAll(n));i&&i!==t;){if(a.contains(i)){o.call(i,r);break}i=i.parentNode}})}}(n),n.dom.getAsDom=function(){var e=function(e,t){var n=t.createElement("div");n.style.display="none",t.body.appendChild(n);try{n.innerHTML=e}catch(r){}return t.body.removeChild(n),n},r=function(e){if(!e._wysihtml5_supportsHTML5Tags){for(var t=0,n=o.length;n>t;t++)e.createElement(o[t]);e._wysihtml5_supportsHTML5Tags=!0}},o=["abbr","article","aside","audio","bdi","canvas","command","datalist","details","figcaption","figure","footer","header","hgroup","keygen","mark","meter","nav","output","progress","rp","rt","ruby","svg","section","source","summary","time","track","video","wbr"];return function(o,i){i=i||t;var a;return"object"==typeof o&&o.nodeType?(a=i.createElement("div"),a.appendChild(o)):n.browser.supportsHTML5Tags(i)?(a=i.createElement("div"),a.innerHTML=o):(r(i),a=e(o,i)),a}}(),n.dom.getParentElement=function(){function e(e,t){return t&&t.length?"string"==typeof t?e===t:n.lang.array(t).contains(e):!0}function t(e){return e.nodeType===n.ELEMENT_NODE}function r(e,t,n){var r=(e.className||"").match(n)||[];return t?r[r.length-1]===t:!!r.length}function o(t,n,r){for(;r--&&t&&"BODY"!==t.nodeName;){if(e(t.nodeName,n))return t;t=t.parentNode}return null}function i(n,o,i,a,s){for(;s--&&n&&"BODY"!==n.nodeName;){if(t(n)&&e(n.nodeName,o)&&r(n,i,a))return n;n=n.parentNode}return null}return function(e,t,n){return n=n||50,t.className||t.classRegExp?i(e,t.nodeName,t.className,t.classRegExp,n):o(e,t.nodeName,n)}}(),n.dom.getStyle=function(){function e(e){return e.replace(o,function(e){return e.charAt(1).toUpperCase()})}var r={"float":"styleFloat"in t.createElement("div").style?"styleFloat":"cssFloat"},o=/\-[a-z]/g;return function(t){return{from:function(o){if(o.nodeType===n.ELEMENT_NODE){var i=o.ownerDocument,a=r[t]||e(t),s=o.style,c=o.currentStyle,l=s[a];if(l)return l;if(c)try{return c[a]}catch(u){}var d,h,f=i.defaultView||i.parentWindow,p=("height"===t||"width"===t)&&"TEXTAREA"===o.nodeName;return f.getComputedStyle?(p&&(d=s.overflow,s.overflow="hidden"),h=f.getComputedStyle(o,null).getPropertyValue(t),0===t.indexOf("border")&&(h=Math.round(parseFloat(h))+"px"),p&&(s.overflow=d||""),h):void 0}}}}}(),n.dom.hasElementWithTagName=function(){function e(e){return e._wysihtml5_identifier||(e._wysihtml5_identifier=n++)}var t={},n=1;return function(n,r){var o=e(n)+":"+r,i=t[o];return i||(i=t[o]=n.getElementsByTagName(r)),i.length>0}}(),function(e){function t(e){return e._wysihtml5_identifier||(e._wysihtml5_identifier=r++)}var n={},r=1;e.dom.hasElementWithClassName=function(r,o){if(!e.browser.supportsNativeGetElementsByClassName())return!!r.querySelector("."+o);var i=t(r)+":"+o,a=n[i];return a||(a=n[i]=r.getElementsByClassName(o)),a.length>0}}(n),n.dom.insert=function(e){return{after:function(t){t.parentNode.insertBefore(e,t.nextSibling)},before:function(t){t.parentNode.insertBefore(e,t)},into:function(t){t.appendChild(e)}}},n.dom.insertCSS=function(e){return e=e.join("\n"),{into:function(t){var n=t.createElement("style");n.type="text/css",n.styleSheet?n.styleSheet.cssText=e:n.appendChild(t.createTextNode(e));var r=t.querySelector("head link");if(r)return r.parentNode.insertBefore(n,r),void 0;var o=t.querySelector("head");o&&o.appendChild(n)}}},n.dom.observe=function(e,t,n){t="string"==typeof t?[t]:t;for(var r,o,i=0,a=t.length;a>i;i++)if(o=t[i],e.addEventListener)if("DOMNodeRemoved"==o){var s=function(){var e=window.MutationObserver||window.WebKitMutationObserver,t=window.addEventListener;return function(n,r){if(e){var o=new e(function(e){e[0].removedNodes.length&&r()});o.observe(n,{childList:!0,subtree:!0})}else t&&n.addEventListener("DOMNodeRemoved",r,!1)}}();s(e,n)}else e.addEventListener(o,n,!1);else r=function(t){"target"in t||(t.target=t.srcElement),t.preventDefault=t.preventDefault||function(){this.returnValue=!1},t.stopPropagation=t.stopPropagation||function(){this.cancelBubble=!0},n.call(e,t)},e.attachEvent("on"+o,r);return{stop:function(){for(var o,i=0,a=t.length;a>i;i++)o=t[i],e.removeEventListener?e.removeEventListener(o,n,!1):e.detachEvent("on"+o,r)}}},n.dom.parse=function(){function e(e,o,i,a){n.lang.object(f).merge(h).merge(o).get(),i=i||e.ownerDocument||t;var s,c,l,u=i.createDocumentFragment(),d="string"==typeof e;for(s=d?n.dom.getAsDom(e,i):e;s.firstChild;)l=s.firstChild,s.removeChild(l),c=f.disable?l:r(l,a),c&&u.appendChild(c);return s.innerHTML="",s.appendChild(u),d?n.quirks.getCorrectInnerHTML(s):s}function r(e,t){var n,o,i=e.nodeType,a=e.childNodes,s=a.length,c=l[i],d=0;if(n=c&&c(e),!n)return null;for(d=0;s>d;d++)o=r(a[d],t),o&&n.appendChild(o);return t&&1>=n.childNodes.length&&n.nodeName.toLowerCase()===u&&!n.attributes.length?n.firstChild:n}function o(e){var t,r,o=f.tags,a=e.nodeName.toLowerCase(),s=e.scopeName;if(e._wysihtml5)return null;if(e._wysihtml5=1,"wysihtml5-temp"===e.className)return null;if(s&&"HTML"!=s&&(a=s+":"+a),"outerHTML"in e&&(n.browser.autoClosesUnclosedTags()||"P"!==e.nodeName||"</p>"===e.outerHTML.slice(-4).toLowerCase()||(a="div")),f.disable)r=e.ownerDocument.createElement(a),i(e,r,{disable:!0});else{if(a in o){if(t=o[a],!t||t.remove)return null;t="string"==typeof t?{rename_tag:t}:t}else{if(!e.firstChild)return null;t={rename_tag:u}}r=e.ownerDocument.createElement(t.rename_tag||a),i(e,r,t)}return e=null,r}function i(e,t,r){var o,i,s,c,l,u,h,p={},v=r.set_class,y=r.add_class,b=r.set_attributes,w=r.check_attributes,C=f.classes,x=0,N=[],E=[],S=[],_=[];if(b&&(p=n.lang.object(b).clone()),w&&!r.disable)for(l in w)h=m[w[l]],h&&(u=h(a(e,l)),"string"==typeof u&&(p[l]=u));else if(r.disable){var T=e.attributes,R=T.length;for(x=0;R>x;x++)u=T[x].value,"string"==typeof u&&(p[T[x].name]=u)}if(v&&N.push(v),y)for(l in y)h=g[y[l]],h&&(c=h(a(e,l)),"string"==typeof c&&N.push(c));for(C["_wysihtml5-temp-placeholder"]=1,_=e.getAttribute("class"),_&&(N=N.concat(_.split(d))),o=N.length,x=0;o>x;x++)s=N[x],C[s]&&E.push(s);for(i=E.length;i--;)s=E[i],n.lang.array(S).contains(s)||S.unshift(s);S.length&&(p["class"]=S.join(" "));for(l in p)try{t.setAttribute(l,p[l])}catch(A){}p.src&&(p.width!==void 0&&t.setAttribute("width",p.width),p.height!==void 0&&t.setAttribute("height",p.height))}function a(e,t){t=t.toLowerCase();var n=e.nodeName;if("IMG"==n&&"src"==t&&s(e)===!0)return e.src;if(p&&"outerHTML"in e){var r=e.outerHTML.toLowerCase(),o=-1!=r.indexOf(" "+t+"=");return o?e.getAttribute(t):null}return e.getAttribute(t)}function s(e){try{return e.complete&&!e.mozMatchesSelector(":-moz-broken")}catch(t){if(e.complete&&"complete"===e.readyState)return!0}}function c(e){return e.ownerDocument.createTextNode(e.data)}var l={1:o,3:c},u="span",d=/\s+/,h={tags:{},classes:{}},f={},p=!n.browser.supportsGetAttributeCorrectly(),m={url:function(){var e=/^https?:\/\//i;return function(t){return t&&t.match(e)?t.replace(e,function(e){return e.toLowerCase()}):null}}(),src:function(){var e=/^(\/|https?:\/\/)/i;return function(t){return t&&t.match(e)?t.replace(e,function(e){return e.toLowerCase()}):null}}(),href:function(){var e=/^(\/|https?:\/\/|mailto:)/i;return function(t){return t&&t.match(e)?t.replace(e,function(e){return e.toLowerCase()}):null}}(),allow:function(){return function(e){return e}}(),alt:function(){var e=/[^ a-z0-9_\-]/gi;return function(t){return t?t.replace(e,""):""}}(),numbers:function(){var e=/\D/g;return function(t){return t=(t||"").replace(e,""),t||null}}()},g={align_img:function(){var e={left:"wysiwyg-float-left",right:"wysiwyg-float-right"};return function(t){return e[(t+"").toLowerCase()]}}(),align_text:function(){var e={left:"wysiwyg-text-align-left",right:"wysiwyg-text-align-right",center:"wysiwyg-text-align-center",justify:"wysiwyg-text-align-justify"};return function(t){return e[(t+"").toLowerCase()]}}(),clear_br:function(){var e={left:"wysiwyg-clear-left",right:"wysiwyg-clear-right",both:"wysiwyg-clear-both",all:"wysiwyg-clear-both"};return function(t){return e[(t+"").toLowerCase()]}}(),size_font:function(){var e={1:"wysiwyg-font-size-xx-small",2:"wysiwyg-font-size-small",3:"wysiwyg-font-size-medium",4:"wysiwyg-font-size-large",5:"wysiwyg-font-size-x-large",6:"wysiwyg-font-size-xx-large",7:"wysiwyg-font-size-xx-large","-":"wysiwyg-font-size-smaller","+":"wysiwyg-font-size-larger"};return function(t){return e[(t+"").charAt(0)]}}()};return e}(),n.dom.removeEmptyTextNodes=function(e){for(var t,r=n.lang.array(e.childNodes).get(),o=r.length,i=0;o>i;i++)t=r[i],t.nodeType===n.TEXT_NODE&&""===t.data&&t.parentNode.removeChild(t)},n.dom.renameElement=function(e,t){for(var r,o=e.ownerDocument.createElement(t);r=e.firstChild;)o.appendChild(r);return n.dom.copyAttributes(["align","className"]).from(e).to(o),e.parentNode.replaceChild(o,e),o},n.dom.replaceWithChildNodes=function(e){if(e.parentNode){if(!e.firstChild)return e.parentNode.removeChild(e),void 0;for(var t=e.ownerDocument.createDocumentFragment();e.firstChild;)t.appendChild(e.firstChild);e.parentNode.replaceChild(t,e),e=t=null}},function(e){function t(t){return"block"===e.getStyle("display").from(t)}function n(e){return"BR"===e.nodeName}function r(e){var t=e.ownerDocument.createElement("br");e.appendChild(t)}function o(e,o){if(e.nodeName.match(/^(MENU|UL|OL)$/)){var i,a,s,c,l,u,d=e.ownerDocument,h=d.createDocumentFragment(),f=e.previousElementSibling||e.previousSibling;if(o)for(f&&!t(f)&&r(h);u=e.firstElementChild||e.firstChild;){for(a=u.lastChild;i=u.firstChild;)s=i===a,c=s&&!t(i)&&!n(i),h.appendChild(i),c&&r(h);u.parentNode.removeChild(u)}else for(;u=e.firstElementChild||e.firstChild;){if(u.querySelector&&u.querySelector("div, p, ul, ol, menu, blockquote, h1, h2, h3, h4, h5, h6"))for(;i=u.firstChild;)h.appendChild(i);else{for(l=d.createElement("p");i=u.firstChild;)l.appendChild(i);h.appendChild(l)}u.parentNode.removeChild(u)}e.parentNode.replaceChild(h,e)}}e.resolveList=o}(n.dom),function(e){var n=t,r=["parent","top","opener","frameElement","frames","localStorage","globalStorage","sessionStorage","indexedDB"],i=["open","close","openDialog","showModalDialog","alert","confirm","prompt","openDatabase","postMessage","XMLHttpRequest","XDomainRequest"],a=["referrer","write","open","close"];e.dom.Sandbox=o.extend({constructor:function(t,n){this.callback=t||e.EMPTY_FUNCTION,this.config=e.lang.object({}).merge(n).get(),this.iframe=this._createIframe()},insertInto:function(e){"string"==typeof e&&(e=n.getElementById(e)),e.appendChild(this.iframe)},getIframe:function(){return this.iframe},getWindow:function(){this._readyError()},getDocument:function(){this._readyError()},destroy:function(){var e=this.getIframe();e.parentNode.removeChild(e)},_readyError:function(){throw Error("wysihtml5.Sandbox: Sandbox iframe isn't loaded yet")},_createIframe:function(){var t=this,r=n.createElement("iframe");return r.className="wysihtml5-sandbox",e.dom.setAttributes({security:"restricted",allowtransparency:"true",frameborder:0,width:0,height:0,marginwidth:0,marginheight:0}).on(r),e.browser.throwsMixedContentWarningWhenIframeSrcIsEmpty()&&(r.src="javascript:'<html></html>'"),r.onload=function(){r.onreadystatechange=r.onload=null,t._onLoadIframe(r)},r.onreadystatechange=function(){/loaded|complete/.test(r.readyState)&&(r.onreadystatechange=r.onload=null,t._onLoadIframe(r))},r},_onLoadIframe:function(t){if(e.dom.contains(n.documentElement,t)){var o=this,s=t.contentWindow,c=t.contentWindow.document,l=n.characterSet||n.charset||"utf-8",u=this._getHtml({charset:l,stylesheets:this.config.stylesheets});if(c.open("text/html","replace"),c.write(u),c.close(),this.getWindow=function(){return t.contentWindow},this.getDocument=function(){return t.contentWindow.document},s.onerror=function(e,t,n){throw Error("wysihtml5.Sandbox: "+e,t,n)},!e.browser.supportsSandboxedIframes()){var d,h;for(d=0,h=r.length;h>d;d++)this._unset(s,r[d]);for(d=0,h=i.length;h>d;d++)this._unset(s,i[d],e.EMPTY_FUNCTION);for(d=0,h=a.length;h>d;d++)this._unset(c,a[d]);this._unset(c,"cookie","",!0)}this.loaded=!0,setTimeout(function(){o.callback(o)},0)}},_getHtml:function(t){var n,r=t.stylesheets,o="",i=0;if(r="string"==typeof r?[r]:r)for(n=r.length;n>i;i++)o+='<link rel="stylesheet" href="'+r[i]+'">';return t.stylesheets=o,e.lang.string('<!DOCTYPE html><html><head><meta charset="#{charset}">#{stylesheets}</head><body></body></html>').interpolate(t)},_unset:function(t,n,r,o){try{t[n]=r}catch(i){}try{t.__defineGetter__(n,function(){return r})}catch(i){}if(o)try{t.__defineSetter__(n,function(){})}catch(i){}if(!e.browser.crashesWhenDefineProperty(n))try{var a={get:function(){return r}};o&&(a.set=function(){}),Object.defineProperty(t,n,a)}catch(i){}}})}(n),function(){var e={className:"class"};n.dom.setAttributes=function(t){return{on:function(n){for(var r in t)n.setAttribute(e[r]||r,t[r])}}}}(),n.dom.setStyles=function(e){return{on:function(t){var n=t.style;
if("string"==typeof e)return n.cssText+=";"+e,void 0;for(var r in e)"float"===r?(n.cssFloat=e[r],n.styleFloat=e[r]):n[r]=e[r]}}},function(e){e.simulatePlaceholder=function(t,n,r){var o="placeholder",i=function(){n.hasPlaceholderSet()&&n.clear(),n.placeholderSet=!1,e.removeClass(n.element,o)},a=function(){n.isEmpty()&&(n.placeholderSet=!0,n.setValue(r),e.addClass(n.element,o))};t.on("set_placeholder",a).on("unset_placeholder",i).on("focus:composer",i).on("paste:composer",i).on("blur:composer",a),a()}}(n.dom),function(e){var n=t.documentElement;"textContent"in n?(e.setTextContent=function(e,t){e.textContent=t},e.getTextContent=function(e){return e.textContent}):"innerText"in n?(e.setTextContent=function(e,t){e.innerText=t},e.getTextContent=function(e){return e.innerText}):(e.setTextContent=function(e,t){e.nodeValue=t},e.getTextContent=function(e){return e.nodeValue})}(n.dom),n.quirks.cleanPastedHTML=function(){function e(e,o,i){o=o||r,i=i||e.ownerDocument||t;var a,s,c,l,u,d="string"==typeof e,h=0;a=d?n.dom.getAsDom(e,i):e;for(u in o)for(c=a.querySelectorAll(u),s=o[u],l=c.length;l>h;h++)s(c[h]);return c=e=o=null,d?a.innerHTML:a}var r={"a u":n.dom.replaceWithChildNodes};return e}(),n.quirks.ensureProperClearing=function(){var e=function(){var e=this;setTimeout(function(){var t=e.innerHTML.toLowerCase();("<p>&nbsp;</p>"==t||"<p>&nbsp;</p><p>&nbsp;</p>"==t)&&(e.innerHTML="")},0)};return function(t){n.dom.observe(t.element,["cut","keydown"],e)}}(),function(e){var t="%7E";e.quirks.getCorrectInnerHTML=function(n){var r=n.innerHTML;if(-1===r.indexOf(t))return r;var o,i,a,s,c=n.querySelectorAll("[href*='~'], [src*='~']");for(s=0,a=c.length;a>s;s++)o=c[s].href||c[s].src,i=e.lang.string(o).replace("~").by(t),r=e.lang.string(r).replace(i).by(o);return r}}(n),function(e){var t="wysihtml5-quirks-redraw";e.quirks.redraw=function(n){e.dom.addClass(n,t),e.dom.removeClass(n,t);try{var r=n.ownerDocument;r.execCommand("italic",!1,null),r.execCommand("italic",!1,null)}catch(o){}}}(n),function(e){function t(e){var t=0;if(e.parentNode)do t+=e.offsetTop||0,e=e.offsetParent;while(e);return t}var n=e.dom;e.Selection=o.extend({constructor:function(e){r.init(),this.editor=e,this.composer=e.composer,this.doc=this.composer.doc},getBookmark:function(){var e=this.getRange();return e&&e.cloneRange()},setBookmark:function(e){e&&this.setSelection(e)},setBefore:function(e){var t=r.createRange(this.doc);return t.setStartBefore(e),t.setEndBefore(e),this.setSelection(t)},setAfter:function(e){var t=r.createRange(this.doc);return t.setStartAfter(e),t.setEndAfter(e),this.setSelection(t)},selectNode:function(t,o){var i=r.createRange(this.doc),a=t.nodeType===e.ELEMENT_NODE,s="canHaveHTML"in t?t.canHaveHTML:"IMG"!==t.nodeName,c=a?t.innerHTML:t.data,l=""===c||c===e.INVISIBLE_SPACE,u=n.getStyle("display").from(t),d="block"===u||"list-item"===u;if(l&&a&&s&&!o)try{t.innerHTML=e.INVISIBLE_SPACE}catch(h){}s?i.selectNodeContents(t):i.selectNode(t),s&&l&&a?i.collapse(d):s&&l&&(i.setStartAfter(t),i.setEndAfter(t)),this.setSelection(i)},getSelectedNode:function(e){var t,n;return e&&this.doc.selection&&"Control"===this.doc.selection.type&&(n=this.doc.selection.createRange(),n&&n.length)?n.item(0):(t=this.getSelection(this.doc),t.focusNode===t.anchorNode?t.focusNode:(n=this.getRange(this.doc),n?n.commonAncestorContainer:this.doc.body))},executeAndRestore:function(t,o){var i,a,s,c,l,u=this.doc.body,d=o&&u.scrollTop,h=o&&u.scrollLeft,f="_wysihtml5-temp-placeholder",p='<span class="'+f+'">'+e.INVISIBLE_SPACE+"</span>",m=this.getRange(this.doc);if(!m)return t(u,u),void 0;e.browser.hasInsertNodeIssue()?this.doc.execCommand("insertHTML",!1,p):(c=m.createContextualFragment(p),m.insertNode(c));try{t(m.startContainer,m.endContainer)}catch(g){setTimeout(function(){throw g},0)}i=this.doc.querySelector("."+f),i?(l=r.createRange(this.doc),s=i.nextSibling,e.browser.hasInsertNodeIssue()&&s&&"BR"===s.nodeName?(a=this.doc.createTextNode(e.INVISIBLE_SPACE),n.insert(a).after(i),l.setStartBefore(a),l.setEndBefore(a)):(l.selectNode(i),l.deleteContents()),this.setSelection(l)):u.focus(),o&&(u.scrollTop=d,u.scrollLeft=h);try{i.parentNode.removeChild(i)}catch(v){}},executeAndRestoreSimple:function(e){var t,n,o,i,a,s=this.getRange(),c=this.doc.body;if(!s)return e(c,c),void 0;i=s.getNodes([3]),n=i[0]||s.startContainer,o=i[i.length-1]||s.endContainer,a={collapsed:s.collapsed,startContainer:n,startOffset:n===s.startContainer?s.startOffset:0,endContainer:o,endOffset:o===s.endContainer?s.endOffset:o.length};try{e(s.startContainer,s.endContainer)}catch(l){setTimeout(function(){throw l},0)}t=r.createRange(this.doc);try{t.setStart(a.startContainer,a.startOffset)}catch(u){}try{t.setEnd(a.endContainer,a.endOffset)}catch(d){}try{this.setSelection(t)}catch(h){}},set:function(e,t){var n=r.createRange(this.doc);n.setStart(e,t||0),this.setSelection(n)},insertHTML:function(e){var t=r.createRange(this.doc),n=t.createContextualFragment(e),o=n.lastChild;this.insertNode(n),o&&this.setAfter(o)},insertNode:function(e){var t=this.getRange();t&&t.insertNode(e)},surround:function(e){var t=this.getRange();if(t)try{t.surroundContents(e),this.selectNode(e)}catch(n){e.appendChild(t.extractContents()),t.insertNode(e)}},scrollIntoView:function(){var n,r=this.doc,o=5,i=r.documentElement.scrollHeight>r.documentElement.offsetHeight,a=r._wysihtml5ScrollIntoViewElement=r._wysihtml5ScrollIntoViewElement||function(){var t=r.createElement("span");return t.innerHTML=e.INVISIBLE_SPACE,t}();i&&(this.insertNode(a),n=t(a),a.parentNode.removeChild(a),n>=r.body.scrollTop+r.documentElement.offsetHeight-o&&(r.body.scrollTop=n))},selectLine:function(){e.browser.supportsSelectionModify()?this._selectLine_W3C():this.doc.selection&&this._selectLine_MSIE()},_selectLine_W3C:function(){var e=this.doc.defaultView,t=e.getSelection();t.modify("extend","left","lineboundary"),t.modify("extend","right","lineboundary")},_selectLine_MSIE:function(){var e,t,n,r,o,i=this.doc.selection.createRange(),a=i.boundingTop,s=this.doc.body.scrollWidth;if(i.moveToPoint){for(0===a&&(n=this.doc.createElement("span"),this.insertNode(n),a=n.offsetTop,n.parentNode.removeChild(n)),a+=1,r=-10;s>r;r+=2)try{i.moveToPoint(r,a);break}catch(c){}for(e=a,t=this.doc.selection.createRange(),o=s;o>=0;o--)try{t.moveToPoint(o,e);break}catch(l){}i.setEndPoint("EndToEnd",t),i.select()}},getText:function(){var e=this.getSelection();return e?""+e:""},getNodes:function(e,t){var n=this.getRange();return n?n.getNodes([e],t):[]},getRange:function(){var e=this.getSelection();return e&&e.rangeCount&&e.getRangeAt(0)},getSelection:function(){return r.getSelection(this.doc.defaultView||this.doc.parentWindow)},setSelection:function(e){var t=this.doc.defaultView||this.doc.parentWindow,n=r.getSelection(t);return n.setSingleRange(e)}})}(n),function(e,t){function n(e,t,n){if(!e.className)return!1;var r=e.className.match(n)||[];return r[r.length-1]===t}function r(e,t,n){e.className?(o(e,n),e.className+=" "+t):e.className=t}function o(e,t){e.className&&(e.className=e.className.replace(t,""))}function i(e,t){return e.className.replace(f," ")==t.className.replace(f," ")}function a(e){for(var t=e.parentNode;e.firstChild;)t.insertBefore(e.firstChild,e);t.removeChild(e)}function s(e,t){if(e.attributes.length!=t.attributes.length)return!1;for(var n,r,o,i=0,a=e.attributes.length;a>i;++i)if(n=e.attributes[i],o=n.name,"class"!=o){if(r=t.attributes.getNamedItem(o),n.specified!=r.specified)return!1;if(n.specified&&n.nodeValue!==r.nodeValue)return!1}return!0}function c(e,n){return t.dom.isCharacterDataNode(e)?0===n?!!e.previousSibling:n==e.length?!!e.nextSibling:!0:n>0&&e.childNodes.length>n}function l(e,n,r){var o;if(t.dom.isCharacterDataNode(n)&&(0===r?(r=t.dom.getNodeIndex(n),n=n.parentNode):r==n.length?(r=t.dom.getNodeIndex(n)+1,n=n.parentNode):o=t.dom.splitDataNode(n,r)),!o){o=n.cloneNode(!1),o.id&&o.removeAttribute("id");for(var i;i=n.childNodes[r];)o.appendChild(i);t.dom.insertAfter(o,n)}return n==e?o:l(e,o.parentNode,t.dom.getNodeIndex(o))}function u(t){this.isElementMerge=t.nodeType==e.ELEMENT_NODE,this.firstTextNode=this.isElementMerge?t.lastChild:t,this.textNodes=[this.firstTextNode]}function d(e,t,n,r){this.tagNames=e||[h],this.cssClass=t||"",this.similarClassRegExp=n,this.normalize=r,this.applyToAnyTagName=!1}var h="span",f=/\s+/g;u.prototype={doMerge:function(){for(var e,t,n,r=[],o=0,i=this.textNodes.length;i>o;++o)e=this.textNodes[o],t=e.parentNode,r[o]=e.data,o&&(t.removeChild(e),t.hasChildNodes()||t.parentNode.removeChild(t));return this.firstTextNode.data=n=r.join(""),n},getLength:function(){for(var e=this.textNodes.length,t=0;e--;)t+=this.textNodes[e].length;return t},toString:function(){for(var e=[],t=0,n=this.textNodes.length;n>t;++t)e[t]="'"+this.textNodes[t].data+"'";return"[Merge("+e.join(",")+")]"}},d.prototype={getAncestorWithClass:function(r){for(var o;r;){if(o=this.cssClass?n(r,this.cssClass,this.similarClassRegExp):!0,r.nodeType==e.ELEMENT_NODE&&t.dom.arrayContains(this.tagNames,r.tagName.toLowerCase())&&o)return r;r=r.parentNode}return!1},postApply:function(e,t){for(var n,r,o,i=e[0],a=e[e.length-1],s=[],c=i,l=a,d=0,h=a.length,f=0,p=e.length;p>f;++f)r=e[f],o=this.getAdjacentMergeableTextNode(r.parentNode,!1),o?(n||(n=new u(o),s.push(n)),n.textNodes.push(r),r===i&&(c=n.firstTextNode,d=c.length),r===a&&(l=n.firstTextNode,h=n.getLength())):n=null;var m=this.getAdjacentMergeableTextNode(a.parentNode,!0);if(m&&(n||(n=new u(a),s.push(n)),n.textNodes.push(m)),s.length){for(f=0,p=s.length;p>f;++f)s[f].doMerge();t.setStart(c,d),t.setEnd(l,h)}},getAdjacentMergeableTextNode:function(t,n){var r,o=t.nodeType==e.TEXT_NODE,i=o?t.parentNode:t,a=n?"nextSibling":"previousSibling";if(o){if(r=t[a],r&&r.nodeType==e.TEXT_NODE)return r}else if(r=i[a],r&&this.areElementsMergeable(t,r))return r[n?"firstChild":"lastChild"];return null},areElementsMergeable:function(e,n){return t.dom.arrayContains(this.tagNames,(e.tagName||"").toLowerCase())&&t.dom.arrayContains(this.tagNames,(n.tagName||"").toLowerCase())&&i(e,n)&&s(e,n)},createContainer:function(e){var t=e.createElement(this.tagNames[0]);return this.cssClass&&(t.className=this.cssClass),t},applyToTextNode:function(e){var n=e.parentNode;if(1==n.childNodes.length&&t.dom.arrayContains(this.tagNames,n.tagName.toLowerCase()))this.cssClass&&r(n,this.cssClass,this.similarClassRegExp);else{var o=this.createContainer(t.dom.getDocument(e));e.parentNode.insertBefore(o,e),o.appendChild(e)}},isRemovable:function(n){return t.dom.arrayContains(this.tagNames,n.tagName.toLowerCase())&&e.lang.string(n.className).trim()==this.cssClass},undoToTextNode:function(e,t,n){if(!t.containsNode(n)){var r=t.cloneRange();r.selectNode(n),r.isPointInRange(t.endContainer,t.endOffset)&&c(t.endContainer,t.endOffset)&&(l(n,t.endContainer,t.endOffset),t.setEndAfter(n)),r.isPointInRange(t.startContainer,t.startOffset)&&c(t.startContainer,t.startOffset)&&(n=l(n,t.startContainer,t.startOffset))}this.similarClassRegExp&&o(n,this.similarClassRegExp),this.isRemovable(n)&&a(n)},applyToRange:function(t){var n=t.getNodes([e.TEXT_NODE]);if(!n.length)try{var r=this.createContainer(t.endContainer.ownerDocument);return t.surroundContents(r),this.selectNode(t,r),void 0}catch(o){}if(t.splitBoundaries(),n=t.getNodes([e.TEXT_NODE]),n.length){for(var i,a=0,s=n.length;s>a;++a)i=n[a],this.getAncestorWithClass(i)||this.applyToTextNode(i);t.setStart(n[0],0),i=n[n.length-1],t.setEnd(i,i.length),this.normalize&&this.postApply(n,t)}},undoToRange:function(t){var n,r,o=t.getNodes([e.TEXT_NODE]);if(o.length)t.splitBoundaries(),o=t.getNodes([e.TEXT_NODE]);else{var i=t.endContainer.ownerDocument,a=i.createTextNode(e.INVISIBLE_SPACE);t.insertNode(a),t.selectNode(a),o=[a]}for(var s=0,c=o.length;c>s;++s)n=o[s],r=this.getAncestorWithClass(n),r&&this.undoToTextNode(n,t,r);1==c?this.selectNode(t,o[0]):(t.setStart(o[0],0),n=o[o.length-1],t.setEnd(n,n.length),this.normalize&&this.postApply(o,t))},selectNode:function(t,n){var r=n.nodeType===e.ELEMENT_NODE,o="canHaveHTML"in n?n.canHaveHTML:!0,i=r?n.innerHTML:n.data,a=""===i||i===e.INVISIBLE_SPACE;if(a&&r&&o)try{n.innerHTML=e.INVISIBLE_SPACE}catch(s){}t.selectNodeContents(n),a&&r?t.collapse(!1):a&&(t.setStartAfter(n),t.setEndAfter(n))},getTextSelectedByRange:function(e,t){var n=t.cloneRange();n.selectNodeContents(e);var r=n.intersection(t),o=r?""+r:"";return n.detach(),o},isAppliedToRange:function(t){var n,r=[],o=t.getNodes([e.TEXT_NODE]);if(!o.length)return n=this.getAncestorWithClass(t.startContainer),n?[n]:!1;for(var i,a=0,s=o.length;s>a;++a){if(i=this.getTextSelectedByRange(o[a],t),n=this.getAncestorWithClass(o[a]),""!==i&&!n)return!1;r.push(n)}return r},toggleRange:function(e){this.isAppliedToRange(e)?this.undoToRange(e):this.applyToRange(e)}},e.selection.HTMLApplier=d}(n,r),n.Commands=o.extend({constructor:function(e){this.editor=e,this.composer=e.composer,this.doc=this.composer.doc},support:function(e){return n.browser.supportsCommand(this.doc,e)},exec:function(e,t){var r=n.commands[e],o=n.lang.array(arguments).get(),i=r&&r.exec,a=null;if(this.editor.fire("beforecommand:composer"),i)o.unshift(this.composer),a=i.apply(r,o);else try{a=this.doc.execCommand(e,!1,t)}catch(s){}return this.editor.fire("aftercommand:composer"),a},state:function(e){var t=n.commands[e],r=n.lang.array(arguments).get(),o=t&&t.state;if(o)return r.unshift(this.composer),o.apply(t,r);try{return this.doc.queryCommandState(e)}catch(i){return!1}}}),n.commands.bold={exec:function(e,t){return n.commands.formatInline.exec(e,t,"b")},state:function(e,t){return n.commands.formatInline.state(e,t,"b")}},function(e){function t(e,t){for(var n,r,o,a=t.length,s=0;a>s;s++)n=t[s],r=i.getParentElement(n,{nodeName:"code"}),o=i.getTextContent(n),o.match(i.autoLink.URL_REG_EXP)&&!r?r=i.renameElement(n,"code"):i.replaceWithChildNodes(n)}function n(t,n){var a,s,c,l,u,d,h,f,p,m=t.doc,g="_wysihtml5-temp-"+ +new Date,v=/non-matching-class/g,y=0;for(e.commands.formatInline.exec(t,r,o,g,v),s=m.querySelectorAll(o+"."+g),a=s.length;a>y;y++){c=s[y],c.removeAttribute("class");for(p in n)c.setAttribute(p,n[p])}d=c,1===a&&(h=i.getTextContent(c),l=!!c.querySelector("*"),u=""===h||h===e.INVISIBLE_SPACE,!l&&u&&(i.setTextContent(c,n.text||c.href),f=m.createTextNode(" "),t.selection.setAfter(c),i.insert(f).after(c),d=f)),t.selection.setAfter(d)}var r,o="A",i=e.dom;e.commands.createLink={exec:function(e,r,o){var i=this.state(e,r);i?e.selection.executeAndRestore(function(){t(e,i)}):(o="object"==typeof o?o:{href:o},n(e,o))},state:function(t,n){return e.commands.formatInline.state(t,n,"A")}}}(n),function(e){var t,n=/wysiwyg-font-size-[0-9a-z\-]+/g;e.commands.fontSize={exec:function(t,r,o){return e.commands.formatInline.exec(t,r,"span","wysiwyg-font-size-"+o,n)},state:function(t,r,o){return e.commands.formatInline.state(t,r,"span","wysiwyg-font-size-"+o,n)},value:function(){return t}}}(n),function(e){var t=/wysiwyg-color-[0-9a-z]+/g;e.commands.foreColor={exec:function(n,r,o){return e.commands.formatInline.exec(n,r,"span","wysiwyg-color-"+o,t)},state:function(n,r,o){return e.commands.formatInline.state(n,r,"span","wysiwyg-color-"+o,t)}}}(n),function(e){function t(e,t,r){e.className?(n(e,r),e.className+=" "+t):e.className=t}function n(e,t){e.className=e.className.replace(t,"")}function r(t){return t.nodeType===e.TEXT_NODE&&!e.lang.string(t.data).trim()}function o(e){for(var t=e.previousSibling;t&&r(t);)t=t.previousSibling;return t}function i(e){for(var t=e.nextSibling;t&&r(t);)t=t.nextSibling;return t}function a(e){var t=e.ownerDocument,n=i(e),r=o(e);n&&!u(n)&&e.parentNode.insertBefore(t.createElement("br"),n),r&&!u(r)&&e.parentNode.insertBefore(t.createElement("br"),e)}function s(e){var t=i(e),n=o(e);t&&l(t)&&t.parentNode.removeChild(t),n&&l(n)&&n.parentNode.removeChild(n)}function c(e){var t=e.lastChild;t&&l(t)&&t.parentNode.removeChild(t)}function l(e){return"BR"===e.nodeName}function u(e){return l(e)?!0:"block"===p.getStyle("display").from(e)?!0:!1}function d(t,n,r,o){var i;o&&(i=p.observe(t,"DOMNodeInserted",function(t){var n,r=t.target;r.nodeType===e.ELEMENT_NODE&&(n=p.getStyle("display").from(r),"inline"!==n.substr(0,6)&&(r.className+=" "+o))})),t.execCommand(n,!1,r),i&&i.stop()}function h(t,n){t.selection.selectLine(),t.selection.surround(n),s(n),c(n),t.selection.selectNode(n,e.browser.displaysCaretInEmptyContentEditableCorrectly())}function f(t){return!!e.lang.string(t.className).trim()}var p=e.dom,m=["H1","H2","H3","H4","H5","H6","P","BLOCKQUOTE","DIV"];e.commands.formatBlock={exec:function(r,o,i,s,c){var l,u=r.doc,g=this.state(r,o,i,s,c),v=r.config.useLineBreaks,y=v?"DIV":"P";return i="string"==typeof i?i.toUpperCase():i,g?(r.selection.executeAndRestoreSimple(function(){c&&n(g,c);var e=f(g);e||!v&&"P"!==i?p.renameElement(g,"P"===i?"DIV":y):(a(g),p.replaceWithChildNodes(g))}),void 0):(null===i||e.lang.array(m).contains(i))&&(l=r.selection.getSelectedNode(),g=p.getParentElement(l,{nodeName:m}))?(r.selection.executeAndRestore(function(){i&&(g=p.renameElement(g,i)),s&&t(g,s,c)}),void 0):r.commands.support(o)?(d(u,o,i||y,s),void 0):(g=u.createElement(i||y),s&&(g.className=s),h(r,g),void 0)},state:function(e,t,n,r,o){n="string"==typeof n?n.toUpperCase():n;var i=e.selection.getSelectedNode();return p.getParentElement(i,{nodeName:n,className:r,classRegExp:o})}}}(n),function(e){function t(e){var t=r[e];return t?[e.toLowerCase(),t.toLowerCase()]:[e.toLowerCase()]}function n(n,r,i){var a=n+":"+r;return o[a]||(o[a]=new e.selection.HTMLApplier(t(n),r,i,!0)),o[a]}var r={strong:"b",em:"i",b:"strong",i:"em"},o={};e.commands.formatInline={exec:function(e,t,r,o,i){var a=e.selection.getRange();return a?(n(r,o,i).toggleRange(a),e.selection.setSelection(a),void 0):!1},state:function(t,o,i,a,s){var c,l=t.doc,u=r[i]||i;return e.dom.hasElementWithTagName(l,i)||e.dom.hasElementWithTagName(l,u)?a&&!e.dom.hasElementWithClassName(l,a)?!1:(c=t.selection.getRange(),c?n(i,a,s).isAppliedToRange(c):!1):!1}}}(n),n.commands.insertHTML={exec:function(e,t,n){e.commands.support(t)?e.doc.execCommand(t,!1,n):e.selection.insertHTML(n)},state:function(){return!1}},function(e){var t="IMG";e.commands.insertImage={exec:function(n,r,o){o="object"==typeof o?o:{src:o};var i,a,s,c=n.doc,l=this.state(n);if(l)return n.selection.setBefore(l),s=l.parentNode,s.removeChild(l),e.dom.removeEmptyTextNodes(s),"A"!==s.nodeName||s.firstChild||(n.selection.setAfter(s),s.parentNode.removeChild(s)),e.quirks.redraw(n.element),void 0;l=c.createElement(t);for(a in o)"className"===a&&(a="class"),l.setAttribute(a,o[a]);n.selection.insertNode(l),e.browser.hasProblemsSettingCaretAfterImg()?(i=c.createTextNode(e.INVISIBLE_SPACE),n.selection.insertNode(i),n.selection.setAfter(i)):n.selection.setAfter(l)},state:function(n){var r,o,i,a=n.doc;return e.dom.hasElementWithTagName(a,t)?(r=n.selection.getSelectedNode())?r.nodeName===t?r:r.nodeType!==e.ELEMENT_NODE?!1:(o=n.selection.getText(),(o=e.lang.string(o).trim())?!1:(i=n.selection.getNodes(e.ELEMENT_NODE,function(e){return"IMG"===e.nodeName}),1!==i.length?!1:i[0])):!1:!1}}}(n),function(e){var t="<br>"+(e.browser.needsSpaceAfterLineBreak()?" ":"");e.commands.insertLineBreak={exec:function(n,r){n.commands.support(r)?(n.doc.execCommand(r,!1,null),e.browser.autoScrollsToCaret()||n.selection.scrollIntoView()):n.commands.exec("insertHTML",t)},state:function(){return!1}}}(n),n.commands.insertOrderedList={exec:function(e,t){var r,o,i=e.doc,a=e.selection.getSelectedNode(),s=n.dom.getParentElement(a,{nodeName:"OL"}),c=n.dom.getParentElement(a,{nodeName:"UL"}),l="_wysihtml5-temp-"+(new Date).getTime();return s||c||!e.commands.support(t)?(s?e.selection.executeAndRestore(function(){n.dom.resolveList(s,e.config.useLineBreaks)}):c?e.selection.executeAndRestore(function(){n.dom.renameElement(c,"ol")}):(e.commands.exec("formatBlock","div",l),o=i.querySelector("."+l),r=""===o.innerHTML||o.innerHTML===n.INVISIBLE_SPACE||"<br>"===o.innerHTML,e.selection.executeAndRestore(function(){s=n.dom.convertToList(o,"ol")}),r&&e.selection.selectNode(s.querySelector("li"),!0)),void 0):(i.execCommand(t,!1,null),void 0)},state:function(e){var t=e.selection.getSelectedNode();return n.dom.getParentElement(t,{nodeName:"OL"})}},n.commands.insertUnorderedList={exec:function(e,t){var r,o,i=e.doc,a=e.selection.getSelectedNode(),s=n.dom.getParentElement(a,{nodeName:"UL"}),c=n.dom.getParentElement(a,{nodeName:"OL"}),l="_wysihtml5-temp-"+(new Date).getTime();return s||c||!e.commands.support(t)?(s?e.selection.executeAndRestore(function(){n.dom.resolveList(s,e.config.useLineBreaks)}):c?e.selection.executeAndRestore(function(){n.dom.renameElement(c,"ul")}):(e.commands.exec("formatBlock","div",l),o=i.querySelector("."+l),r=""===o.innerHTML||o.innerHTML===n.INVISIBLE_SPACE||"<br>"===o.innerHTML,e.selection.executeAndRestore(function(){s=n.dom.convertToList(o,"ul")}),r&&e.selection.selectNode(s.querySelector("li"),!0)),void 0):(i.execCommand(t,!1,null),void 0)},state:function(e){var t=e.selection.getSelectedNode();return n.dom.getParentElement(t,{nodeName:"UL"})}},n.commands.italic={exec:function(e,t){return n.commands.formatInline.exec(e,t,"i")},state:function(e,t){return n.commands.formatInline.state(e,t,"i")}},function(e){var t="wysiwyg-text-align-center",n=/wysiwyg-text-align-[0-9a-z]+/g;e.commands.justifyCenter={exec:function(r){return e.commands.formatBlock.exec(r,"formatBlock",null,t,n)},state:function(r){return e.commands.formatBlock.state(r,"formatBlock",null,t,n)}}}(n),function(e){var t="wysiwyg-text-align-left",n=/wysiwyg-text-align-[0-9a-z]+/g;e.commands.justifyLeft={exec:function(r){return e.commands.formatBlock.exec(r,"formatBlock",null,t,n)},state:function(r){return e.commands.formatBlock.state(r,"formatBlock",null,t,n)}}}(n),function(e){var t="wysiwyg-text-align-right",n=/wysiwyg-text-align-[0-9a-z]+/g;e.commands.justifyRight={exec:function(r){return e.commands.formatBlock.exec(r,"formatBlock",null,t,n)},state:function(r){return e.commands.formatBlock.state(r,"formatBlock",null,t,n)}}}(n),function(e){var t="wysiwyg-text-align-justify",n=/wysiwyg-text-align-[0-9a-z]+/g;e.commands.justifyFull={exec:function(r){return e.commands.formatBlock.exec(r,"formatBlock",null,t,n)},state:function(r){return e.commands.formatBlock.state(r,"formatBlock",null,t,n)}}}(n),n.commands.redo={exec:function(e){return e.undoManager.redo()},state:function(){return!1}},n.commands.underline={exec:function(e,t){return n.commands.formatInline.exec(e,t,"u")},state:function(e,t){return n.commands.formatInline.state(e,t,"u")}},n.commands.undo={exec:function(e){return e.undoManager.undo()},state:function(){return!1}},function(e){function n(e){for(var t;t=e.querySelector("._wysihtml5-temp");)t.parentNode.removeChild(t)}var r=90,o=89,i=8,a=46,s=25,c="data-wysihtml5-selection-node",l="data-wysihtml5-selection-offset",u='<span id="_wysihtml5-undo" class="_wysihtml5-temp">'+e.INVISIBLE_SPACE+"</span>",d='<span id="_wysihtml5-redo" class="_wysihtml5-temp">'+e.INVISIBLE_SPACE+"</span>",h=e.dom;e.UndoManager=e.lang.Dispatcher.extend({constructor:function(e){this.editor=e,this.composer=e.composer,this.element=this.composer.element,this.position=0,this.historyStr=[],this.historyDom=[],this.transact(),this._observe()},_observe:function(){var s,c=this,l=this.composer.sandbox.getDocument();if(h.observe(this.element,"keydown",function(e){if(!e.altKey&&(e.ctrlKey||e.metaKey)){var t=e.keyCode,n=t===r&&!e.shiftKey,i=t===r&&e.shiftKey||t===o;n?(c.undo(),e.preventDefault()):i&&(c.redo(),e.preventDefault())}}),h.observe(this.element,"keydown",function(e){var t=e.keyCode;t!==s&&(s=t,(t===i||t===a)&&c.transact())}),e.browser.hasUndoInContextMenu()){var f,p,m=function(){n(l),clearInterval(f)};h.observe(this.element,"contextmenu",function(){m(),c.composer.selection.executeAndRestoreSimple(function(){c.element.lastChild&&c.composer.selection.setAfter(c.element.lastChild),l.execCommand("insertHTML",!1,u),l.execCommand("insertHTML",!1,d),l.execCommand("undo",!1,null)}),f=setInterval(function(){l.getElementById("_wysihtml5-redo")?(m(),c.redo()):l.getElementById("_wysihtml5-undo")||(m(),c.undo())},400),p||(p=!0,h.observe(t,"mousedown",m),h.observe(l,["mousedown","paste","cut","copy"],m))})}this.editor.on("newword:composer",function(){c.transact()}).on("beforecommand:composer",function(){c.transact()})},transact:function(){var t=this.historyStr[this.position-1],n=this.composer.getValue();if(n!==t){var r=this.historyStr.length=this.historyDom.length=this.position;r>s&&(this.historyStr.shift(),this.historyDom.shift(),this.position--),this.position++;var o,i,a=this.composer.selection.getRange(),u=a.startContainer||this.element,d=a.startOffset||0;u.nodeType===e.ELEMENT_NODE?o=u:(o=u.parentNode,i=this.getChildNodeIndex(o,u)),o.setAttribute(l,d),i!==void 0&&o.setAttribute(c,i);var h=this.element.cloneNode(!!n);this.historyDom.push(h),this.historyStr.push(n),o.removeAttribute(l),o.removeAttribute(c)}},undo:function(){this.transact(),this.undoPossible()&&(this.set(this.historyDom[--this.position-1]),this.editor.fire("undo:composer"))},redo:function(){this.redoPossible()&&(this.set(this.historyDom[++this.position-1]),this.editor.fire("redo:composer"))},undoPossible:function(){return this.position>1},redoPossible:function(){return this.position<this.historyStr.length},set:function(e){this.element.innerHTML="";for(var t=0,n=e.childNodes,r=e.childNodes.length;r>t;t++)this.element.appendChild(n[t].cloneNode(!0));var o,i,a;e.hasAttribute(l)?(o=e.getAttribute(l),a=e.getAttribute(c),i=this.element):(i=this.element.querySelector("["+l+"]")||this.element,o=i.getAttribute(l),a=i.getAttribute(c),i.removeAttribute(l),i.removeAttribute(c)),null!==a&&(i=this.getChildNodeByIndex(i,+a)),this.composer.selection.set(i,o)},getChildNodeIndex:function(e,t){for(var n=0,r=e.childNodes,o=r.length;o>n;n++)if(r[n]===t)return n},getChildNodeByIndex:function(e,t){return e.childNodes[t]}})}(n),n.views.View=o.extend({constructor:function(e,t,n){this.parent=e,this.element=t,this.config=n,this._observeViewChange()},_observeViewChange:function(){var e=this;this.parent.on("beforeload",function(){e.parent.on("change_view",function(t,n){t===e.name?(e.parent.currentView=e,e.show(),n&&setTimeout(function(){e.focus()},0)):e.hide()})})},focus:function(){if(this.element.ownerDocument.querySelector(":focus")!==this.element)try{this.element.focus()}catch(e){}},hide:function(){this.element.style.display="none"},show:function(){this.element.style.display=""},disable:function(){this.element.setAttribute("disabled","disabled")},enable:function(){this.element.removeAttribute("disabled")}}),function(e){var n=e.dom,r=e.browser;e.views.Composer=e.views.View.extend({name:"composer",CARET_HACK:"<br>",constructor:function(e,t,n){this.base(e,t,n),this.textarea=this.parent.textarea,this._initSandbox()},clear:function(){this.element.innerHTML=r.displaysCaretInEmptyContentEditableCorrectly()?"":this.CARET_HACK},getValue:function(t){var n=this.isEmpty()?"":e.quirks.getCorrectInnerHTML(this.element);return t&&(n=this.parent.parse(n)),n=e.lang.string(n).replace(e.INVISIBLE_SPACE).by("")},setValue:function(e,t){t&&(e=this.parent.parse(e));try{this.element.innerHTML=e}catch(n){this.element.innerText=e}},show:function(){this.iframe.style.display=this._displayStyle||"",this.textarea.element.disabled||(this.disable(),this.enable())},hide:function(){this._displayStyle=n.getStyle("display").from(this.iframe),"none"===this._displayStyle&&(this._displayStyle=null),this.iframe.style.display="none"},disable:function(){this.parent.fire("disable:composer"),this.element.removeAttribute("contentEditable")},enable:function(){this.parent.fire("enable:composer"),this.element.setAttribute("contentEditable","true")},focus:function(t){e.browser.doesAsyncFocus()&&this.hasPlaceholderSet()&&this.clear(),this.base();var n=this.element.lastChild;t&&n&&("BR"===n.nodeName?this.selection.setBefore(this.element.lastChild):this.selection.setAfter(this.element.lastChild))},getTextContent:function(){return n.getTextContent(this.element)},hasPlaceholderSet:function(){return this.getTextContent()==this.textarea.element.getAttribute("placeholder")&&this.placeholderSet},isEmpty:function(){var e=this.element.innerHTML.toLowerCase();return""===e||"<br>"===e||"<p></p>"===e||"<p><br></p>"===e||this.hasPlaceholderSet()},_initSandbox:function(){var e=this;this.sandbox=new n.Sandbox(function(){e._create()},{stylesheets:this.config.stylesheets}),this.iframe=this.sandbox.getIframe();var r=this.textarea.element;if(n.insert(this.iframe).after(r),r.form){var o=t.createElement("input");o.type="hidden",o.name="_wysihtml5_mode",o.value=1,n.insert(o).after(r)}},_create:function(){var o=this;this.doc=this.sandbox.getDocument(),this.element=this.doc.body,this.textarea=this.parent.textarea,this.element.innerHTML=this.textarea.getValue(!0),this.selection=new e.Selection(this.parent),this.commands=new e.Commands(this.parent),n.copyAttributes(["className","spellcheck","title","lang","dir","accessKey"]).from(this.textarea.element).to(this.element),n.addClass(this.element,this.config.composerClassName),this.config.style&&this.style(),this.observe();var i=this.config.name;i&&(n.addClass(this.element,i),n.addClass(this.iframe,i)),this.enable(),this.textarea.element.disabled&&this.disable();var a="string"==typeof this.config.placeholder?this.config.placeholder:this.textarea.element.getAttribute("placeholder");a&&n.simulatePlaceholder(this.parent,this,a),this.commands.exec("styleWithCSS",!1),this._initAutoLinking(),this._initObjectResizing(),this._initUndoManager(),this._initLineBreaking(),!this.textarea.element.hasAttribute("autofocus")&&t.querySelector(":focus")!=this.textarea.element||r.isIos()||setTimeout(function(){o.focus(!0)},100),r.clearsContentEditableCorrectly()||e.quirks.ensureProperClearing(this),this.initSync&&this.config.sync&&this.initSync(),this.textarea.hide(),this.parent.fire("beforeload").fire("load")},_initAutoLinking:function(){var t=this,o=r.canDisableAutoLinking(),i=r.doesAutoLinkingInContentEditable();if(o&&this.commands.exec("autoUrlDetect",!1),this.config.autoLink){(!i||i&&o)&&(this.parent.on("newword:composer",function(){n.getTextContent(t.element).match(n.autoLink.URL_REG_EXP)&&t.selection.executeAndRestore(function(e,t){n.autoLink(t.parentNode)})}),n.observe(this.element,"blur",function(){n.autoLink(t.element)}));var a=this.sandbox.getDocument().getElementsByTagName("a"),s=n.autoLink.URL_REG_EXP,c=function(t){var r=e.lang.string(n.getTextContent(t)).trim();return"www."===r.substr(0,4)&&(r="http://"+r),r};n.observe(this.element,"keydown",function(e){if(a.length){var r,o=t.selection.getSelectedNode(e.target.ownerDocument),i=n.getParentElement(o,{nodeName:"A"},4);i&&(r=c(i),setTimeout(function(){var e=c(i);e!==r&&e.match(s)&&i.setAttribute("href",e)},0))}})}},_initObjectResizing:function(){if(this.commands.exec("enableObjectResizing",!0),r.supportsEvent("resizeend")){var t=["width","height"],o=t.length,i=this.element;n.observe(i,"resizeend",function(n){var r,a=n.target||n.srcElement,s=a.style,c=0;if("IMG"===a.nodeName){for(;o>c;c++)r=t[c],s[r]&&(a.setAttribute(r,parseInt(s[r],10)),s[r]="");e.quirks.redraw(i)}})}},_initUndoManager:function(){this.undoManager=new e.UndoManager(this.parent)},_initLineBreaking:function(){function t(e){var t=n.getParentElement(e,{nodeName:["P","DIV"]},2);t&&o.selection.executeAndRestore(function(){o.config.useLineBreaks?n.replaceWithChildNodes(t):"P"!==t.nodeName&&n.renameElement(t,"p")})}var o=this,i=["LI","P","H1","H2","H3","H4","H5","H6"],a=["UL","OL","MENU"];this.config.useLineBreaks||n.observe(this.element,["focus","keydown"],function(){if(o.isEmpty()){var e=o.doc.createElement("P");o.element.innerHTML="",o.element.appendChild(e),r.displaysCaretInEmptyContentEditableCorrectly()?o.selection.selectNode(e,!0):(e.innerHTML="<br>",o.selection.setBefore(e.firstChild))}}),n.observe(this.doc,"keydown",function(r){var s=r.keyCode;if(!r.shiftKey&&(s===e.ENTER_KEY||s===e.BACKSPACE_KEY)){var c=n.getParentElement(o.selection.getSelectedNode(),{nodeName:i},4);return c?(setTimeout(function(){var r,i=o.selection.getSelectedNode();
if("LI"===c.nodeName){if(!i)return;r=n.getParentElement(i,{nodeName:a},2),r||t(i)}s===e.ENTER_KEY&&c.nodeName.match(/^H[1-6]$/)&&t(i)},0),void 0):(o.config.useLineBreaks&&s===e.ENTER_KEY&&!e.browser.insertsLineBreaksOnReturn()&&(o.commands.exec("insertLineBreak"),r.preventDefault()),void 0)}})}})}(n),function(n){var r=n.dom,o=t,i=e,a=o.createElement("div"),s=["background-color","color","cursor","font-family","font-size","font-style","font-variant","font-weight","line-height","letter-spacing","text-align","text-decoration","text-indent","text-rendering","word-break","word-wrap","word-spacing"],c=["background-color","border-collapse","border-bottom-color","border-bottom-style","border-bottom-width","border-left-color","border-left-style","border-left-width","border-right-color","border-right-style","border-right-width","border-top-color","border-top-style","border-top-width","clear","display","float","margin-bottom","margin-left","margin-right","margin-top","outline-color","outline-offset","outline-width","outline-style","padding-left","padding-right","padding-top","padding-bottom","position","top","left","right","bottom","z-index","vertical-align","text-align","-webkit-box-sizing","-moz-box-sizing","-ms-box-sizing","box-sizing","-webkit-box-shadow","-moz-box-shadow","-ms-box-shadow","box-shadow","-webkit-border-top-right-radius","-moz-border-radius-topright","border-top-right-radius","-webkit-border-bottom-right-radius","-moz-border-radius-bottomright","border-bottom-right-radius","-webkit-border-bottom-left-radius","-moz-border-radius-bottomleft","border-bottom-left-radius","-webkit-border-top-left-radius","-moz-border-radius-topleft","border-top-left-radius","width","min-width","min-height","max-width","max-height"],l=["html                 { height: 100%; }","body                 { height: 100%; padding: 1px 0 0 0; margin: -1px 0 0 0; }","body > p:first-child { margin-top: 0; }","._wysihtml5-temp     { display: none; }",n.browser.isGecko?"body.placeholder { color: graytext !important; }":"body.placeholder { color: #a9a9a9 !important; }","img:-moz-broken      { -moz-force-broken-image-icon: 1; height: 24px; width: 24px; }"],u=function(e){if(e.setActive)try{e.setActive()}catch(t){}else{var n=e.style,a=o.documentElement.scrollTop||o.body.scrollTop,s=o.documentElement.scrollLeft||o.body.scrollLeft,c={position:n.position,top:n.top,left:n.left,WebkitUserSelect:n.WebkitUserSelect};r.setStyles({position:"absolute",top:"-99999px",left:"-99999px",WebkitUserSelect:"none"}).on(e),e.focus(),r.setStyles(c).on(e),i.scrollTo&&i.scrollTo(s,a)}};n.views.Composer.prototype.style=function(){var e,t=this,i=o.querySelector(":focus"),d=this.textarea.element,h=d.hasAttribute("placeholder"),f=h&&d.getAttribute("placeholder"),p=d.style.display,m=d.disabled;this.focusStylesHost=a.cloneNode(!1),this.blurStylesHost=a.cloneNode(!1),this.disabledStylesHost=a.cloneNode(!1),h&&d.removeAttribute("placeholder"),d===i&&d.blur(),d.disabled=!1,d.style.display=e="none",(d.getAttribute("rows")&&"auto"===r.getStyle("height").from(d)||d.getAttribute("cols")&&"auto"===r.getStyle("width").from(d))&&(d.style.display=e=p),r.copyStyles(c).from(d).to(this.iframe).andTo(this.blurStylesHost),r.copyStyles(s).from(d).to(this.element).andTo(this.blurStylesHost),r.insertCSS(l).into(this.element.ownerDocument),d.disabled=!0,r.copyStyles(c).from(d).to(this.disabledStylesHost),r.copyStyles(s).from(d).to(this.disabledStylesHost),d.disabled=m,d.style.display=p,u(d),d.style.display=e,r.copyStyles(c).from(d).to(this.focusStylesHost),r.copyStyles(s).from(d).to(this.focusStylesHost),d.style.display=p,r.copyStyles(["display"]).from(d).to(this.iframe);var g=n.lang.array(c).without(["display"]);return i?i.focus():d.blur(),h&&d.setAttribute("placeholder",f),this.parent.on("focus:composer",function(){r.copyStyles(g).from(t.focusStylesHost).to(t.iframe),r.copyStyles(s).from(t.focusStylesHost).to(t.element)}),this.parent.on("blur:composer",function(){r.copyStyles(g).from(t.blurStylesHost).to(t.iframe),r.copyStyles(s).from(t.blurStylesHost).to(t.element)}),this.parent.observe("disable:composer",function(){r.copyStyles(g).from(t.disabledStylesHost).to(t.iframe),r.copyStyles(s).from(t.disabledStylesHost).to(t.element)}),this.parent.observe("enable:composer",function(){r.copyStyles(g).from(t.blurStylesHost).to(t.iframe),r.copyStyles(s).from(t.blurStylesHost).to(t.element)}),this}}(n),function(e){var n=e.dom,r=e.browser,o={66:"bold",73:"italic",85:"underline"};e.views.Composer.prototype.observe=function(){var i=this,a=this.getValue(),s=this.sandbox.getIframe(),c=this.element,l=r.supportsEventsInIframeCorrectly()?c:this.sandbox.getWindow(),u=["drop","paste"];n.observe(s,"DOMNodeRemoved",function(){clearInterval(d),i.parent.fire("destroy:composer")});var d=setInterval(function(){n.contains(t.documentElement,s)||(clearInterval(d),i.parent.fire("destroy:composer"))},250);n.observe(l,"focus",function(){i.parent.fire("focus").fire("focus:composer"),setTimeout(function(){a=i.getValue()},0)}),n.observe(l,"blur",function(){a!==i.getValue()&&i.parent.fire("change").fire("change:composer"),i.parent.fire("blur").fire("blur:composer")}),n.observe(c,"dragenter",function(){i.parent.fire("unset_placeholder")}),n.observe(c,u,function(){setTimeout(function(){i.parent.fire("paste").fire("paste:composer")},0)}),n.observe(c,"keyup",function(t){var n=t.keyCode;(n===e.SPACE_KEY||n===e.ENTER_KEY)&&i.parent.fire("newword:composer")}),this.parent.on("paste:composer",function(){setTimeout(function(){i.parent.fire("newword:composer")},0)}),r.canSelectImagesInContentEditable()||n.observe(c,"mousedown",function(e){var t=e.target;"IMG"===t.nodeName&&(i.selection.selectNode(t),e.preventDefault())}),r.hasHistoryIssue()&&r.supportsSelectionModify()&&n.observe(c,"keydown",function(e){if(e.metaKey||e.ctrlKey){var t=e.keyCode,n=c.ownerDocument.defaultView,r=n.getSelection();(37===t||39===t)&&(37===t&&(r.modify("extend","left","lineboundary"),e.shiftKey||r.collapseToStart()),39===t&&(r.modify("extend","right","lineboundary"),e.shiftKey||r.collapseToEnd()),e.preventDefault())}}),n.observe(c,"keydown",function(e){var t=e.keyCode,n=o[t];(e.ctrlKey||e.metaKey)&&!e.altKey&&n&&(i.commands.exec(n),e.preventDefault())}),n.observe(c,"keydown",function(t){var n,r=i.selection.getSelectedNode(!0),o=t.keyCode;!r||"IMG"!==r.nodeName||o!==e.BACKSPACE_KEY&&o!==e.DELETE_KEY||(n=r.parentNode,n.removeChild(r),"A"!==n.nodeName||n.firstChild||n.parentNode.removeChild(n),setTimeout(function(){e.quirks.redraw(c)},0),t.preventDefault())}),r.hasIframeFocusIssue()&&(n.observe(this.iframe,"focus",function(){setTimeout(function(){i.doc.querySelector(":focus")!==i.element&&i.focus()},0)}),n.observe(this.element,"blur",function(){setTimeout(function(){i.selection.getSelection().removeAllRanges()},0)}));var h={IMG:"Image: ",A:"Link: "};n.observe(c,"mouseover",function(e){var t,n=e.target,r=n.nodeName;if("A"===r||"IMG"===r){var o=n.hasAttribute("title");o||(t=h[r]+(n.getAttribute("href")||n.getAttribute("src")),n.setAttribute("title",t))}})}}(n),function(e){var t=400;e.views.Synchronizer=o.extend({constructor:function(e,t,n){this.editor=e,this.textarea=t,this.composer=n,this._observe()},fromComposerToTextarea:function(t){this.textarea.setValue(e.lang.string(this.composer.getValue()).trim(),t)},fromTextareaToComposer:function(e){var t=this.textarea.getValue();t?this.composer.setValue(t,e):(this.composer.clear(),this.editor.fire("set_placeholder"))},sync:function(e){"textarea"===this.editor.currentView.name?this.fromTextareaToComposer(e):this.fromComposerToTextarea(e)},_observe:function(){var n,r=this,o=this.textarea.element.form,i=function(){n=setInterval(function(){r.fromComposerToTextarea()},t)},a=function(){clearInterval(n),n=null};i(),o&&(e.dom.observe(o,"submit",function(){r.sync(!0)}),e.dom.observe(o,"reset",function(){setTimeout(function(){r.fromTextareaToComposer()},0)})),this.editor.on("change_view",function(e){"composer"!==e||n?"textarea"===e&&(r.fromComposerToTextarea(!0),a()):(r.fromTextareaToComposer(!0),i())}),this.editor.on("destroy:composer",a)}})}(n),n.views.Textarea=n.views.View.extend({name:"textarea",constructor:function(e,t,n){this.base(e,t,n),this._observe()},clear:function(){this.element.value=""},getValue:function(e){var t=this.isEmpty()?"":this.element.value;return e&&(t=this.parent.parse(t)),t},setValue:function(e,t){t&&(e=this.parent.parse(e)),this.element.value=e},hasPlaceholderSet:function(){var e=n.browser.supportsPlaceholderAttributeOn(this.element),t=this.element.getAttribute("placeholder")||null,r=this.element.value,o=!r;return e&&o||r===t},isEmpty:function(){return!n.lang.string(this.element.value).trim()||this.hasPlaceholderSet()},_observe:function(){var e=this.element,t=this.parent,r={focusin:"focus",focusout:"blur"},o=n.browser.supportsEvent("focusin")?["focusin","focusout","change"]:["focus","blur","change"];t.on("beforeload",function(){n.dom.observe(e,o,function(e){var n=r[e.type]||e.type;t.fire(n).fire(n+":textarea")}),n.dom.observe(e,["paste","drop"],function(){setTimeout(function(){t.fire("paste").fire("paste:textarea")},0)})})}}),function(e){var n=e.dom,r="wysihtml5-command-dialog-opened",o="input, select, textarea",i="[data-wysihtml5-dialog-field]",a="data-wysihtml5-dialog-field";e.toolbar.Dialog=e.lang.Dispatcher.extend({constructor:function(e,t){this.link=e,this.container=t},_observe:function(){if(!this._observed){var t=this,i=function(e){var n=t._serialize();n==t.elementToChange?t.fire("edit",n):t.fire("save",n),t.hide(),e.preventDefault(),e.stopPropagation()};n.observe(t.link,"click",function(){n.hasClass(t.link,r)&&setTimeout(function(){t.hide()},0)}),n.observe(this.container,"keydown",function(n){var r=n.keyCode;r===e.ENTER_KEY&&i(n),r===e.ESCAPE_KEY&&t.hide()}),n.delegate(this.container,"[data-wysihtml5-dialog-action=save]","click",i),n.delegate(this.container,"[data-wysihtml5-dialog-action=cancel]","click",function(e){t.fire("cancel"),t.hide(),e.preventDefault(),e.stopPropagation()});for(var a=this.container.querySelectorAll(o),s=0,c=a.length,l=function(){clearInterval(t.interval)};c>s;s++)n.observe(a[s],"change",l);this._observed=!0}},_serialize:function(){for(var e=this.elementToChange||{},t=this.container.querySelectorAll(i),n=t.length,r=0;n>r;r++)e[t[r].getAttribute(a)]=t[r].value;return e},_interpolate:function(e){for(var n,r,o,s=t.querySelector(":focus"),c=this.container.querySelectorAll(i),l=c.length,u=0;l>u;u++)n=c[u],n!==s&&(e&&"hidden"===n.type||(r=n.getAttribute(a),o=this.elementToChange?this.elementToChange[r]||"":n.defaultValue,n.value=o))},show:function(e){if(!n.hasClass(this.link,r)){var t=this,i=this.container.querySelector(o);if(this.elementToChange=e,this._observe(),this._interpolate(),e&&(this.interval=setInterval(function(){t._interpolate(!0)},500)),n.addClass(this.link,r),this.container.style.display="",this.fire("show"),i&&!e)try{i.focus()}catch(a){}}},hide:function(){clearInterval(this.interval),this.elementToChange=null,n.removeClass(this.link,r),this.container.style.display="none",this.fire("hide")}})}(n),function(e){var n=e.dom,r={position:"relative"},o={left:0,margin:0,opacity:0,overflow:"hidden",padding:0,position:"absolute",top:0,zIndex:1},i={cursor:"inherit",fontSize:"50px",height:"50px",marginTop:"-25px",outline:0,padding:0,position:"absolute",right:"-4px",top:"50%"},a={"x-webkit-speech":"",speech:""};e.toolbar.Speech=function(s,c){var l=t.createElement("input");if(!e.browser.supportsSpeechApiOn(l))return c.style.display="none",void 0;var u=s.editor.textarea.element.getAttribute("lang");u&&(a.lang=u);var d=t.createElement("div");e.lang.object(o).merge({width:c.offsetWidth+"px",height:c.offsetHeight+"px"}),n.insert(l).into(d),n.insert(d).into(c),n.setStyles(i).on(l),n.setAttributes(a).on(l),n.setStyles(o).on(d),n.setStyles(r).on(c);var h="onwebkitspeechchange"in l?"webkitspeechchange":"speechchange";n.observe(l,h,function(){s.execCommand("insertText",l.value),l.value=""}),n.observe(l,"click",function(e){n.hasClass(c,"wysihtml5-command-disabled")&&e.preventDefault(),e.stopPropagation()})}}(n),function(e){var n="wysihtml5-command-disabled",r="wysihtml5-commands-disabled",i="wysihtml5-command-active",a="wysihtml5-action-active",s=e.dom;e.toolbar.Toolbar=o.extend({constructor:function(n,r){this.editor=n,this.container="string"==typeof r?t.getElementById(r):r,this.composer=n.composer,this._getLinks("command"),this._getLinks("action"),this._observe(),this.show();for(var o=this.container.querySelectorAll("[data-wysihtml5-command=insertSpeech]"),i=o.length,a=0;i>a;a++)new e.toolbar.Speech(this,o[a])},_getLinks:function(t){for(var n,r,o,i,a,s=this[t+"Links"]=e.lang.array(this.container.querySelectorAll("[data-wysihtml5-"+t+"]")).get(),c=s.length,l=0,u=this[t+"Mapping"]={};c>l;l++)n=s[l],o=n.getAttribute("data-wysihtml5-"+t),i=n.getAttribute("data-wysihtml5-"+t+"-value"),r=this.container.querySelector("[data-wysihtml5-"+t+"-group='"+o+"']"),a=this._getDialog(n,o),u[o+":"+i]={link:n,group:r,name:o,value:i,dialog:a,state:!1}},_getDialog:function(t,n){var r,o,i=this,a=this.container.querySelector("[data-wysihtml5-dialog='"+n+"']");return a&&(r=new e.toolbar.Dialog(t,a),r.on("show",function(){o=i.composer.selection.getBookmark(),i.editor.fire("show:dialog",{command:n,dialogContainer:a,commandLink:t})}),r.on("save",function(e){o&&i.composer.selection.setBookmark(o),i._execCommand(n,e),i.editor.fire("save:dialog",{command:n,dialogContainer:a,commandLink:t})}),r.on("cancel",function(){i.editor.focus(!1),i.editor.fire("cancel:dialog",{command:n,dialogContainer:a,commandLink:t})})),r},execCommand:function(e,t){if(!this.commandsDisabled){var n=this.commandMapping[e+":"+t];n&&n.dialog&&!n.state?n.dialog.show():this._execCommand(e,t)}},_execCommand:function(e,t){this.editor.focus(!1),this.composer.commands.exec(e,t),this._updateLinkStates()},execAction:function(e){var t=this.editor;"change_view"===e&&(t.currentView===t.textarea?t.fire("change_view","composer"):t.fire("change_view","textarea"))},_observe:function(){for(var e=this,t=this.editor,n=this.container,o=this.commandLinks.concat(this.actionLinks),i=o.length,a=0;i>a;a++)s.setAttributes({href:"javascript:;",unselectable:"on"}).on(o[a]);s.delegate(n,"[data-wysihtml5-command], [data-wysihtml5-action]","mousedown",function(e){e.preventDefault()}),s.delegate(n,"[data-wysihtml5-command]","click",function(t){var n=this,r=n.getAttribute("data-wysihtml5-command"),o=n.getAttribute("data-wysihtml5-command-value");e.execCommand(r,o),t.preventDefault()}),s.delegate(n,"[data-wysihtml5-action]","click",function(t){var n=this.getAttribute("data-wysihtml5-action");e.execAction(n),t.preventDefault()}),t.on("focus:composer",function(){e.bookmark=null,clearInterval(e.interval),e.interval=setInterval(function(){e._updateLinkStates()},500)}),t.on("blur:composer",function(){clearInterval(e.interval)}),t.on("destroy:composer",function(){clearInterval(e.interval)}),t.on("change_view",function(t){setTimeout(function(){e.commandsDisabled="composer"!==t,e._updateLinkStates(),e.commandsDisabled?s.addClass(n,r):s.removeClass(n,r)},0)})},_updateLinkStates:function(){var t,r,o,c,l=this.commandMapping,u=this.actionMapping;for(t in l)c=l[t],this.commandsDisabled?(r=!1,s.removeClass(c.link,i),c.group&&s.removeClass(c.group,i),c.dialog&&c.dialog.hide()):(r=this.composer.commands.state(c.name,c.value),e.lang.object(r).isArray()&&(r=1===r.length?r[0]:!0),s.removeClass(c.link,n),c.group&&s.removeClass(c.group,n)),c.state!==r&&(c.state=r,r?(s.addClass(c.link,i),c.group&&s.addClass(c.group,i),c.dialog&&("object"==typeof r?c.dialog.show(r):c.dialog.hide())):(s.removeClass(c.link,i),c.group&&s.removeClass(c.group,i),c.dialog&&c.dialog.hide()));for(t in u)o=u[t],"change_view"===o.name&&(o.state=this.editor.currentView===this.editor.textarea,o.state?s.addClass(o.link,a):s.removeClass(o.link,a))},show:function(){this.container.style.display=""},hide:function(){this.container.style.display="none"}})}(n),function(e){var n,r={name:n,style:!0,toolbar:n,autoLink:!0,parserRules:{tags:{br:{},span:{},div:{},p:{}},classes:{}},parser:e.dom.parse,composerClassName:"wysihtml5-editor",bodyClassName:"wysihtml5-supported",useLineBreaks:!0,stylesheets:[],placeholderText:n,supportTouchDevices:!0};e.Editor=e.lang.Dispatcher.extend({constructor:function(n,o){if(this.textareaElement="string"==typeof n?t.getElementById(n):n,this.config=e.lang.object({}).merge(r).merge(o).get(),this.textarea=new e.views.Textarea(this,this.textareaElement,this.config),this.currentView=this.textarea,this._isCompatible=e.browser.supported(),!this._isCompatible||!this.config.supportTouchDevices&&e.browser.isTouchDevice()){var i=this;return setTimeout(function(){i.fire("beforeload").fire("load")},0),void 0}e.dom.addClass(t.body,this.config.bodyClassName),this.composer=new e.views.Composer(this,this.textareaElement,this.config),this.currentView=this.composer,"function"==typeof this.config.parser&&this._initParser(),this.on("beforeload",function(){this.synchronizer=new e.views.Synchronizer(this,this.textarea,this.composer),this.config.toolbar&&(this.toolbar=new e.toolbar.Toolbar(this,this.config.toolbar))})},isCompatible:function(){return this._isCompatible},clear:function(){return this.currentView.clear(),this},getValue:function(e){return this.currentView.getValue(e)},setValue:function(e,t){return this.fire("unset_placeholder"),e?(this.currentView.setValue(e,t),this):this.clear()},focus:function(e){return this.currentView.focus(e),this},disable:function(){return this.currentView.disable(),this},enable:function(){return this.currentView.enable(),this},isEmpty:function(){return this.currentView.isEmpty()},hasPlaceholderSet:function(){return this.currentView.hasPlaceholderSet()},parse:function(t){var n=this.config.parser(t,this.config.parserRules,this.composer.sandbox.getDocument(),!0);return"object"==typeof t&&e.quirks.redraw(t),n},_initParser:function(){this.on("paste:composer",function(){var t=!0,n=this;n.composer.selection.executeAndRestore(function(){e.quirks.cleanPastedHTML(n.composer.element),n.parse(n.composer.element)},t)})}})}(n),n};"function"==typeof define&&define.amd?define('bundles/wysihtml5/wysihtml5-0.4.0pre',[],function(){return t()}):window.wysihtml5=t()})(window);
(function(wndw){var jadify=function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{})buf.push("<div"),buf.push(attrs({style:"display:none;position:relative;",role:"toolbar",tabindex:"0",title:"HTML editing toolbar","class":prefix+"-toolbar"},{"class":!0,style:!0,role:!0,tabindex:!0,title:!0})),buf.push('><div style="overflow:auto;"><div'),buf.push(attrs({style:"float:left;","class":"left "+(prefix+"-commands")},{"class":!0,style:!0})),buf.push("><span data-wysihtml5-order='0' class=\"hide\"></span><button"),buf.push(attrs({"data-wysihtml5-order":1,"data-wysihtml5-command":"bold",style:"font-weight:bold; width: 30px;",type:"button",title:"Make text bold","class":prefix+"-toolbar-item"},{"class":!0,"data-wysihtml5-order":!0,"data-wysihtml5-command":!0,style:!0,type:!0,title:!0})),buf.push(">B</button><button"),buf.push(attrs({"data-wysihtml5-order":2,"data-wysihtml5-command":"italic",style:"font-style:italic; font-family: serif; width: 30px;",type:"button",title:"Make text italic","class":prefix+"-toolbar-item"},{"class":!0,"data-wysihtml5-order":!0,"data-wysihtml5-command":!0,style:!0,type:!0,title:!0})),buf.push(">I</button><button"),buf.push(attrs({"data-wysihtml5-order":3,"data-wysihtml5-command":"insertUnOrderedList",type:"button",title:"Insert bullets",style:"width:30px;","class":prefix+"-toolbar-item"},{"class":!0,"data-wysihtml5-order":!0,"data-wysihtml5-command":!0,type:!0,title:!0,style:!0})),buf.push('> <span class="icon-list-ul"></span></button><button'),buf.push(attrs({"data-wysihtml5-order":4,"data-wysihtml5-command":"insertOrderedList",type:"button",title:"Insert numbered bullets",style:"width:30px;","class":prefix+"-toolbar-item"},{"class":!0,"data-wysihtml5-order":!0,"data-wysihtml5-command":!0,type:!0,title:!0,style:!0})),buf.push('> <span class="icon-list-ol"></span></button></div><div'),buf.push(attrs({style:"float:right;","class":"right "+(prefix+"-command-view")},{"class":!0,style:!0})),buf.push("><span data-wysihtml5-order='0' class=\"hide\"></span></div></div><div"),buf.push(attrs({"class":prefix+"-toolbar-modals"},{"class":!0})),buf.push("></div></div>");return buf.join("")}};"function"==typeof define&&define.amd?define('bundles/wysihtml5/toolbar.html',["js/lib/jade"],function(e){return jadify(e)}):wndw.jade.templates.toolbar=jadify(wndw.jade.helpers)})(window);
(function(){var e=function(e,t,a,r,s){var i={"prefix.css":"","prefix.data":"data-wysihtml5","composer.class":"wysihtml5","composer.stylesheet":"editor.css","toolbar.enabled":!0,parserRules:{tags:{b:1,i:1,p:1,ul:1,li:1,ol:1,u:1,br:1,a:{check_attributes:{href:"url",target:"allow"}}}}},o=function(e){var t=function(){var t=parseInt(e.css("height"),10)||0,a=parseInt(e.css("min-height"),10)||0,r=parseInt(e.css("max-height"),10)||0,s=parseInt(e.css("padding-top"),10)||0,i=parseInt(e.css("padding-bottom"),10)||0,o=parseInt(e.css("border-top"),10)||0,n=parseInt(e.css("border-bottom"),10)||0,l=function(e){var l=a?Math.max(parseInt(e,10)+o+n+s+i||0,a):t+o+n+s+i;return r?Math.min(l,r):Math.max(l,e+o+n+s+i)},u=e.get(0).scrollHeight-s-i,c=l(u);e.css({height:c}),u>c?e.css({"overflow-y":"auto"}):e.css({"overflow-y":"hidden"})};e.on("keyup focus",t),t()},n=function(t){var a=e(t.textareaElement);t.on("load",function(){if(t.composer){var r=e(t.composer.iframe),s=e(r[0].contentWindow.document),i=s.find("html").css({height:"100%",width:"100%",margin:0,padding:0}).find("body").css({height:"auto",width:"100%",margin:0,padding:0}),o=parseInt(a.css("height"),10)||0,n=parseInt(a.css("min-height"),10)||0,l=parseInt(a.css("max-height"),10)||0,u=parseInt(r.css("padding-top"),10)||0,c=parseInt(r.css("padding-bottom"),10)||0,d=parseInt(r.css("border-top"),10)||0,p=parseInt(r.css("border-bottom"),10)||0,h=function(e){var t=n?Math.max(parseInt(e,10)+d+p+u+c||0,n):o+d+p+u+c;return l?Math.min(t,l):Math.max(t,e+d+p+u+c)},g=function(){var t=r;if(e(r).is(":visible")){t.css({height:h(i.height())});var a=i.children(),s=a.length&&1==a.get(0).nodeType?a.get(0).offsetTop:0;t.css({height:h(i.get(0).scrollHeight+s)}),i.height()<parseInt(i.css("line-height"),10)&&t.css({height:h(i.css("line-height"))})}};r.css({height:a.css("height")}),e(t.composer.element).on("keyup",g),t.on("aftercommand:composer",g),t.on("change_view",g),g()}})},l=function(e,t){var a={};for(var r in d.defaults)a[r]=t[r]!==void 0?t[r]:d.defaults[r];return s.parse(e,a,d.defaults["prefix.data"]+"-")},u={},c=function(s,i){var c=e(s),d=l(c,i||{}),p=e(r({prefix:d["prefix.css"]})).insertBefore(c[0]);"100%"!=c[0].style.width&&p.css("width",c[0].style.width);var h=e("<div>").addClass(d["prefix.css"]+"-footer");c.after(h);var g=new a.Editor(c[0],{toolbar:d["toolbar.enabled"]===!0?p[0]:!1,parserRules:d.parserRules,composerClassName:d["composer.class"],stylesheets:t.isArray(d["composer.stylesheet"])?d["composer.stylesheet"]:[d["composer.stylesheet"]]});g.on("change",function(){c.trigger("change")}),n(g),o(e(g.textareaElement).addClass(d["prefix.css"]+"-rich-editor"));for(var f in u)"function"==typeof u[f]&&u[f](g,p,h,d);return g},d=function(e,t){return new c(e,t)};return d.defaults=i,d.setupSecondaryTextarea=function(e,t){a.dom.copyStyles(["overflow-y","width"]).from(e.textareaElement).to(t[0]),o(t)},d.insertIntoLeftToolbar=function(t,a,r){var s=t.find(".left").find("[data-wysihtml5-order]");s.each(function(t){var i=e(this);i.attr("data-wysihtml5-order")>r?a.insertBefore(i).attr({"data-wysihtml5-order":r}):s.length==t+1&&a.insertAfter(i).attr({"data-wysihtml5-order":r})})},d.insertIntoRightToolbar=function(t,a,r){var s=t.find(".right").find("[data-wysihtml5-order]");s.each(function(t){var i=e(this);i.attr("data-wysihtml5-order")>r?a.insertBefore(i).attr({"data-wysihtml5-order":r}):s.length==t+1&&a.insertAfter(i).attr({"data-wysihtml5-order":r})})},d.updateFooter=function(e,t){e.html(t)},d.plugin=function(e,t){u[e]=t},d};"function"==typeof define&&define.amd?define('bundles/wysihtml5/editor',["jquery","underscore","bundles/wysihtml5/wysihtml5-0.4.0pre","bundles/wysihtml5/toolbar.html","js/lib/data.attributes"],function(t,a,r,s,i){return e(t,a,r,s,i)}):window.wysiEditor=e(window.$,window._,window.wysihtml5,window.jade.templates["bundles.wysihtml5.toolbar"],window.DataAttributes)})(window);
(function(wndw){var jadify=function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{})buf.push("<button"),buf.push(attrs({"data-wysihtml5-command":"code","data-wysihtml5-order":6,type:"button","class":prefix+"-toolbar-item"},{"class":!0,"data-wysihtml5-command":!0,"data-wysihtml5-order":!0,type:!0})),buf.push(">&lt;code&gt;</button>");return buf.join("")}};"function"==typeof define&&define.amd?define('bundles/wysihtml5/toolbar-code.html',["js/lib/jade"],function(e){return jadify(e)}):wndw.jade.templates["toolbar-code"]=jadify(wndw.jade.helpers)})(window);
(function(){var e=function(e,t,r,s){return t.commands.code={exec:function(r){var s=this.state(r);if(s)r.selection.executeAndRestore(function(){var e=s.querySelector("code");t.dom.replaceWithChildNodes(s),e&&t.dom.replaceWithChildNodes(e)});else{var o=r.selection.getRange(),a=o.extractContents(),i=r.doc.createElement("code");s=r.doc.createElement("pre"),s.appendChild(i),i.appendChild(a),o.insertNode(s),r.selection.selectNode(s);var n=document.createElement("br");e(n).insertAfter(s)}},state:function(e){var r=e.selection.getSelectedNode();return t.dom.getParentElement(r,{nodeName:"CODE"})&&t.dom.getParentElement(r,{nodeName:"PRE"})}},r.defaults=e.extend(r.defaults,{"toolbar.code":!0}),r.plugin("code",function(t,o,a,i){if(i["toolbar.code"]){var n=e(s({prefix:i["prefix.css"]}));r.insertIntoLeftToolbar(o,n,6)}}),r};"function"==typeof define&&define.amd?define('bundles/wysihtml5/code',["jquery","bundles/wysihtml5/wysihtml5-0.4.0pre","bundles/wysihtml5/editor","bundles/wysihtml5/toolbar-code.html"],function(t,r,s,o){return e(t,r,s,o)}):e(window.$,window.wysihtml5,window.wysiEditor,window.jade.templates["bundles.wysihtml5.toolbar-code"])})(window);
(function(wndw){var jadify=function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{})buf.push("<button"),buf.push(attrs({"data-wysihtml5-custom-command":"link",type:"button",unselectable:"on",title:"Insert link","class":prefix+"-toolbar-item"},{"class":!0,"data-wysihtml5-custom-command":!0,type:!0,unselectable:!0,title:!0})),buf.push('><span class="icon-link"></span> Link</button>');return buf.join("")}};"function"==typeof define&&define.amd?define('bundles/wysihtml5/toolbar-link.html',["js/lib/jade"],function(e){return jadify(e)}):wndw.jade.templates["toolbar-link"]=jadify(wndw.jade.helpers)})(window);
(function(wndw){var jadify=function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{})buf.push("<div"),buf.push(attrs({"data-wysihtml5-modal-link":!0,"data-modal-overlay-class":prefix+"-overlay",role:"dialog","aria-label":"Create a link","class":"modal hide"},{"data-modal-overlay-class":!0,role:!0,"aria-label":!0})),buf.push('><form><div class="modal-body"><label style="display:inline-block;margin-right:15px;"><span>URL &nbsp;&nbsp;</span><input'),buf.push(attrs({name:"url",placeholder:"http://",style:"width:350px;","class":prefix+"-modal-url"},{"class":!0,name:!0,placeholder:!0,style:!0})),buf.push('/></label></div><div class="modal-footer"><button'),buf.push(attrs({type:"submit","data-modal-close":!0,style:"margin-right:10px;","class":"btn "+(prefix+"-modal-link-submit")},{"class":!0,type:!0,"data-modal-close":!0,style:!0})),buf.push('>Create</button><a data-modal-close="data-modal-close" href="javascript:;">Cancel</a></div></form></div>');return buf.join("")}};"function"==typeof define&&define.amd?define('bundles/wysihtml5/toolbar-modal-link.html',["js/lib/jade"],function(e){return jadify(e)}):wndw.jade.templates["toolbar-modal-link"]=jadify(wndw.jade.helpers)})(window);
(function(){var e=function(e,t,n,r,o){return n.defaults=e.extend(n.defaults,{"toolbar.link":!0}),n.plugin("link",function(i,s,a,c){if(c["toolbar.link"]){var l=e(r({prefix:c["prefix.css"]}));n.insertIntoLeftToolbar(s,l,5),s.find("."+c["prefix.css"]+"-toolbar-modals").append(o({prefix:c["prefix.css"]}));var u,d=s.find("[data-wysihtml5-modal-link]"),h=t(d),p=d.find("[name=url]");h.on("open",function(){p.focus()}),h.on("close",function(){i.currentView.element.focus()}),d.find("form").on("submit",function(e){e.preventDefault(),e.stopPropagation(),i.currentView.element.focus(),(void 0!==u||null!==u)&&(i.composer.selection.setBookmark(u),u=null);var t=i.currentView.selection.getSelection();t.focusNode&&t.focusNode.parentNode&&"A"==t.focusNode.parentNode.nodeName?(t.focusNode.parentNode.title=null,t.focusNode.parentNode.href=p.val()):i.composer.commands.exec("createLink",{href:p.val(),target:"_blank"}),i.fire("change").fire("change:composer")}),s.find("[data-wysihtml5-custom-command=link]").on("click",function(){if(!e(this).hasClass("wysihtml5-command-active")&&!s.hasClass("wysihtml5-commands-disabled")){var t=i.currentView.selection&&i.currentView.selection.getSelection();t&&t.focusNode&&t.focusNode.parentNode&&"A"==t.focusNode.parentNode.nodeName?p.val(t.focusNode.parentNode.href):p.val(""),u=i.composer&&i.composer.selection.getBookmark(),h.open()}})}}),n};"function"==typeof define&&define.amd?define('bundles/wysihtml5/link',["jquery","js/lib/modals","bundles/wysihtml5/editor","bundles/wysihtml5/toolbar-link.html","bundles/wysihtml5/toolbar-modal-link.html"],function(t,n,r,o,i){return e(t,n,r,o,i)}):e(window.$,window.Modal,window.wysiEditor,window.jade.templates["bundles.wysihtml5.toolbar-link"],window.jade.templates["bundles.wysihtml5.toolbar-modal-link"])})(window);
(function(wndw){var jadify=function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{})buf.push("<div"),buf.push(attrs({"class":prefix+"-toolbar-modes"},{"class":!0})),buf.push(">"),mode.html&&(buf.push("<button"),buf.push(attrs({"data-wysihtml5-custom-command":"change-editor",type:"button",title:"Change editing mode to HTML","class":prefix+"-toolbar-item "+prefix+"-toolbar-item-right "+prefix+"-toolbar-source"},{"class":!0,"data-wysihtml5-custom-command":!0,type:!0,title:!0})),buf.push("><span>&lt;HTML&gt;</span></button>")),mode.markdown&&(buf.push("<button"),buf.push(attrs({"data-wysihtml5-custom-command":"change-editor",type:"button",title:"Change editing mode to Markdown","class":prefix+"-toolbar-item "+prefix+"-toolbar-item-right "+prefix+"-toolbar-markdown"},{"class":!0,"data-wysihtml5-custom-command":!0,type:!0,title:!0})),buf.push("> <span>`MD`</span></button>")),mode.rich&&(buf.push("<button"),buf.push(attrs({"data-wysihtml5-custom-command":"change-editor",type:"button",title:"Change editing mode to rich editor",style:"display:none;","class":prefix+"-toolbar-item "+prefix+"-toolbar-item-right "+prefix+"-toolbar-wysi"},{"class":!0,"data-wysihtml5-custom-command":!0,type:!0,title:!0,style:!0})),buf.push("><span>Rich</span></button>")),buf.push("</div>");return buf.join("")}};"function"==typeof define&&define.amd?define('bundles/wysihtml5/toolbar-modes.html',["js/lib/jade"],function(e){return jadify(e)}):wndw.jade.templates["toolbar-modes"]=jadify(wndw.jade.helpers)})(window);
(function(wndw){var jadify=function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{})buf.push("<div"),buf.push(attrs({"class":prefix+"-footer-html"},{"class":!0})),buf.push('><div style="float:left;">Allowed tags: <span style="font-family:monospace">&lt;b&gt; &lt;i&gt;, &lt;a&gt;, &lt;p&gt;, &lt;br&gt;, &lt;ul&gt;, &lt;ol&gt;, &lt;li&gt;</span>&nbsp;&nbsp;<a href="javascript:void();">Help</a></div><div style="float:right;"><label'),buf.push(attrs({"class":prefix+"-default-mode checkbox"},{"class":!0})),buf.push('><input type="checkbox" name="default-mode"/>Default Editor</label></div><div'),buf.push(attrs({"data-wysihtml5-modal-image":!0,"data-modal-overlay-class":prefix+"-overlay",role:"dialog","aria-label":"Learn HTML",tabindex:"-1","class":"modal hide"},{"data-modal-overlay-class":!0,role:!0,"aria-label":!0,tabindex:!0})),buf.push('><div class="modal-body"><p>HTML is the markup language that all webpages are written in.\nYou can either use the rich editor or the HTML editor here, whichever you prefer.</p><p>To use it, you write your content and surround parts of it in "tags" that\ntell the browser what it is. For example:</p><table style="margin-bottom:0px;" class="table table-bordered"><thead><tr><th>HTML</th><th>Output</th></tr></thead><tbody><tr><td>The dugong (&lt;i&gt;Dugong dugon&lt;/i&gt;) is a &lt;b&gt;large&lt;/b&gt; marine mammal</td><td>The dugong (<i>Dugong dugon</i>) is a <b>large</b> marine mammal</td></tr><tr><td>Imagine all the unicorns &lt;br&gt; Living life in peace</td><td>Imagine all the unicorns <br>Living life in peace</td></tr><tr><td>&lt;ul&gt;\n<br>&lt;li&gt;pineapples&lt;/li&gt;\n<br>&lt;li&gt;peanutbutter&lt;/li&gt;\n<br>&lt;/ul&gt;</td><td><ul><li>pineapples</li><li>peanut butter</li></ul></td></tr></tbody></table></div><div class="modal-footer"><button type="button" data-modal-close="data-modal-close" style="margin-right:10px;" class="btn">Got it, thanks!</button></div></div></div>');return buf.join("")}};"function"==typeof define&&define.amd?define('bundles/wysihtml5/footer-source.html',["js/lib/jade"],function(e){return jadify(e)}):wndw.jade.templates["footer-source"]=jadify(wndw.jade.helpers)})(window);
(function(wndw){var jadify=function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{})buf.push("<div"),buf.push(attrs({"class":prefix+"-footer-markdown"},{"class":!0})),buf.push('><div style="float:left;">Now in <a href="http://daringfireball.net/projects/markdown/syntax" target="_blank">Markdown</a> mode.</div><div style="float:right;"><label'),buf.push(attrs({"class":prefix+"-default-mode checkbox"},{"class":!0})),buf.push('><input type="checkbox" name="default-mode"/>Default Editor</label></div></div>');return buf.join("")}};"function"==typeof define&&define.amd?define('bundles/wysihtml5/footer-markdown.html',["js/lib/jade"],function(e){return jadify(e)}):wndw.jade.templates["footer-markdown"]=jadify(wndw.jade.helpers)})(window);
(function(wndw){var jadify=function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{})buf.push("<div"),buf.push(attrs({"class":prefix+"-footer-rich"},{"class":!0})),buf.push('><div style="float:left;"></div><div style="float:right;"><label'),buf.push(attrs({"class":prefix+"-default-mode checkbox"},{"class":!0})),buf.push('><input type="checkbox" name="default-mode"/>Default Editor</label></div></div>');return buf.join("")}};"function"==typeof define&&define.amd?define('bundles/wysihtml5/footer-rich.html',["js/lib/jade"],function(e){return jadify(e)}):wndw.jade.templates["footer-rich"]=jadify(wndw.jade.helpers)})(window);
(function(){var t=function(t,e){function n(){return this.pos=0,this.token="",this.current_mode="CONTENT",this.tags={parent:"parent1",parentcount:1,parent1:""},this.tag_type="",this.token_text=this.last_token=this.last_text=this.token_type="",this.Utils={whitespace:"\n\r	 ".split(""),single_token:"br,input,link,meta,!doctype,basefont,base,area,hr,wbr,param,img,isindex,?xml,embed,?php,?,?=".split(","),extra_liners:"head,body,/html".split(","),in_array:function(t,e){for(var n=0;e.length>n;n++)if(t===e[n])return!0;return!1}},this.get_content=function(){for(var t="",e=[],n=!1;"<"!==this.input.charAt(this.pos);){if(this.pos>=this.input.length)return e.length?e.join(""):["","TK_EOF"];if(t=this.input.charAt(this.pos),this.pos++,this.line_char_count++,this.Utils.in_array(t,this.Utils.whitespace))e.length&&(n=!0),this.line_char_count--;else{if(n){if(this.line_char_count>=this.max_char){e.push("\n");for(var r=0;this.indent_level>r;r++)e.push(this.indent_string);this.line_char_count=0}else e.push(" "),this.line_char_count++;n=!1}e.push(t)}}return e.length?e.join(""):""},this.get_contents_to=function(t){if(this.pos==this.input.length)return["","TK_EOF"];var e="",n=RegExp("\\</"+t+"\\s*\\>","igm");n.lastIndex=this.pos;var r=n.exec(this.input),i=r?r.index:this.input.length;return i>this.pos&&(e=this.input.substring(this.pos,i),this.pos=i),e},this.record_tag=function(t){this.tags[t+"count"]?(this.tags[t+"count"]++,this.tags[t+this.tags[t+"count"]]=this.indent_level):(this.tags[t+"count"]=1,this.tags[t+this.tags[t+"count"]]=this.indent_level),this.tags[t+this.tags[t+"count"]+"parent"]=this.tags.parent,this.tags.parent=t+this.tags[t+"count"]},this.retrieve_tag=function(t){if(this.tags[t+"count"]){for(var e=this.tags.parent;e&&t+this.tags[t+"count"]!==e;)e=this.tags[e+"parent"];e&&(this.indent_level=this.tags[t+this.tags[t+"count"]],this.tags.parent=this.tags[e+"parent"]),delete this.tags[t+this.tags[t+"count"]+"parent"],delete this.tags[t+this.tags[t+"count"]],1==this.tags[t+"count"]?delete this.tags[t+"count"]:this.tags[t+"count"]--}},this.get_tag=function(t){var e,n,r="",i=[],o=!1,t=t!==void 0?t:!1,a=this.pos,s=this.line_char_count;do{if(this.pos>=this.input.length)return t&&(this.pos=a,this.line_char_count=s),i.length?i.join(""):["","TK_EOF"];r=this.input.charAt(this.pos),this.pos++,this.line_char_count++,this.Utils.in_array(r,this.Utils.whitespace)?(o=!0,this.line_char_count--):(("'"===r||'"'===r)&&(i[1]&&"!"===i[1]||(r+=this.get_unformatted(r),o=!0)),"="===r&&(o=!1),i.length&&"="!==i[i.length-1]&&">"!==r&&o&&(this.line_char_count>=this.max_char?(this.print_newline(!1,i),this.line_char_count=0):(i.push(" "),this.line_char_count++),o=!1),"<"===r&&(e=this.pos-1),i.push(r))}while(">"!==r);var u,c=i.join("");u=-1!=c.indexOf(" ")?c.indexOf(" "):c.indexOf(">");var f=c.substring(1,u).toLowerCase();if("/"===c.charAt(c.length-2)||this.Utils.in_array(f,this.Utils.single_token))t||(this.tag_type="SINGLE");else if("script"===f)t||(this.record_tag(f),this.tag_type="SCRIPT");else if("style"===f)t||(this.record_tag(f),this.tag_type="STYLE");else if(this.is_unformatted(f,l)){var h=this.get_unformatted("</"+f+">",c);i.push(h),e>0&&this.Utils.in_array(this.input.charAt(e-1),this.Utils.whitespace)&&i.splice(0,0,this.input.charAt(e-1)),n=this.pos-1,this.Utils.in_array(this.input.charAt(n+1),this.Utils.whitespace)&&i.push(this.input.charAt(n+1)),this.tag_type="SINGLE"}else if("!"===f.charAt(0))if(-1!=f.indexOf("[if")){if(-1!=c.indexOf("!IE")){var h=this.get_unformatted("-->",c);i.push(h)}t||(this.tag_type="START")}else if(-1!=f.indexOf("[endif"))this.tag_type="END",this.unindent();else if(-1!=f.indexOf("[cdata[")){var h=this.get_unformatted("]]>",c);i.push(h),t||(this.tag_type="SINGLE")}else{var h=this.get_unformatted("-->",c);i.push(h),this.tag_type="SINGLE"}else t||("/"===f.charAt(0)?(this.retrieve_tag(f.substring(1)),this.tag_type="END"):(this.record_tag(f),this.tag_type="START"),this.Utils.in_array(f,this.Utils.extra_liners)&&this.print_newline(!0,this.output));return t&&(this.pos=a,this.line_char_count=s),i.join("")},this.get_unformatted=function(t,e){if(e&&-1!=e.toLowerCase().indexOf(t))return"";var n="",r="",i=!0;do{if(this.pos>=this.input.length)return r;if(n=this.input.charAt(this.pos),this.pos++,this.Utils.in_array(n,this.Utils.whitespace)){if(!i){this.line_char_count--;continue}if("\n"===n||"\r"===n){r+="\n",this.line_char_count=0;continue}}r+=n,this.line_char_count++,i=!0}while(-1==r.toLowerCase().indexOf(t));return r},this.get_token=function(){var t;if("TK_TAG_SCRIPT"===this.last_token||"TK_TAG_STYLE"===this.last_token){var e=this.last_token.substr(7);return t=this.get_contents_to(e),"string"!=typeof t?t:[t,"TK_"+e]}if("CONTENT"===this.current_mode)return t=this.get_content(),"string"!=typeof t?t:[t,"TK_CONTENT"];if("TAG"===this.current_mode){if(t=this.get_tag(),"string"!=typeof t)return t;var n="TK_TAG_"+this.tag_type;return[t,n]}},this.get_full_indent=function(t){return t=this.indent_level+t||0,1>t?"":Array(t+1).join(this.indent_string)},this.is_unformatted=function(t,e){if(!this.Utils.in_array(t,e))return!1;if("a"!==t.toLowerCase()||!this.Utils.in_array("a",e))return!0;var n=this.get_tag(!0),r=(n||"").match(/^\s*<\s*\/?([a-z]*)\s*[^>]*>\s*$/);return!r||this.Utils.in_array(r,e)?!0:!1},this.printer=function(t,e,n,r,i){this.input=t||"",this.output=[],this.indent_character=e,this.indent_string="",this.indent_size=n,this.brace_style=i,this.indent_level=0,this.max_char=r,this.line_char_count=0;for(var o=0;this.indent_size>o;o++)this.indent_string+=this.indent_character;this.print_newline=function(t,e){if(this.line_char_count=0,e&&e.length){if(!t)for(;this.Utils.in_array(e[e.length-1],this.Utils.whitespace);)e.pop();e.push("\n");for(var n=0;this.indent_level>n;n++)e.push(this.indent_string)}},this.print_token=function(t){this.output.push(t)},this.indent=function(){this.indent_level++},this.unindent=function(){this.indent_level>0&&this.indent_level--}},this}var r,i,o,a,s,l;for(e=e||{},i=e.indent_size||4,o=e.indent_char||" ",s=e.brace_style||"collapse",a=0===e.max_char?1/0:e.max_char||70,l=e.unformatted||["a","span","bdo","em","strong","dfn","code","samp","kbd","var","cite","abbr","acronym","q","sub","sup","tt","i","b","big","small","u","s","strike","font","ins","del","pre","address","dt","h1","h2","h3","h4","h5","h6"],r=new n,r.printer(t,o,i,a,s);;){var u=r.get_token();if(r.token_text=u[0],r.token_type=u[1],"TK_EOF"===r.token_type)break;switch(r.token_type){case"TK_TAG_START":r.print_newline(!1,r.output),r.print_token(r.token_text),r.indent(),r.current_mode="CONTENT";break;case"TK_TAG_STYLE":case"TK_TAG_SCRIPT":r.print_newline(!1,r.output),r.print_token(r.token_text),r.current_mode="CONTENT";break;case"TK_TAG_END":if("TK_CONTENT"===r.last_token&&""===r.last_text){var c=r.token_text.match(/\w+/)[0],f=r.output[r.output.length-1].match(/<\s*(\w+)/);(null===f||f[1]!==c)&&r.print_newline(!0,r.output)}r.print_token(r.token_text),r.current_mode="CONTENT";break;case"TK_TAG_SINGLE":var h=r.token_text.match(/^\s*<([a-z]+)/i);h&&r.Utils.in_array(h[1],l)||r.print_newline(!1,r.output),r.print_token(r.token_text),r.current_mode="CONTENT";break;case"TK_CONTENT":""!==r.token_text&&r.print_token(r.token_text),r.current_mode="TAG";break;case"TK_STYLE":case"TK_SCRIPT":if(""!==r.token_text){r.output.push("\n");var d=r.token_text;if("TK_SCRIPT"==r.token_type)var p="function"==typeof js_beautify&&js_beautify;else if("TK_STYLE"==r.token_type)var p="function"==typeof css_beautify&&css_beautify;if("keep"==e.indent_scripts)var g=0;else if("separate"==e.indent_scripts)var g=-r.indent_level;else var g=1;var m=r.get_full_indent(g);if(p)d=p(d.replace(/^\s*/,m),e);else{var v=d.match(/^\s*/)[0],y=v.match(/[^\n\r]*$/)[0].split(r.indent_string).length-1,b=r.get_full_indent(g-y);d=d.replace(/^\s*/,m).replace(/\r\n|\r|\n/g,"\n"+b).replace(/\s*$/,"")}d&&(r.print_token(d),r.print_newline(!0,r.output))}r.current_mode="TAG"}r.last_token=r.token_type,r.last_text=r.token_text}return r.output.join("")};"function"==typeof define&&define.amd?define('js/lib/beautify-html',[],function(){return t}):"undefined"!=typeof window&&"undefined"==typeof ender&&(window.beautify_html=t)})(window);
(function(){function t(t){if("title"==t.nodeName.toLowerCase())return!1;if(window.getComputedStyle){try{var e=window.getComputedStyle(t,null);if(e.getPropertyValue&&"none"==e.getPropertyValue("display"))return!0}catch(n){}return!1}}var e=function(n,r,i){i=i||{};for(var o=i.nodesToIgnore||[],a=i.parseHiddenNodes||"false",u=n.childNodes,s=0;u.length>s;s++)try{for(var l=!1,c=0;o.length>c;c++)if(u[s].nodeName.toLowerCase()==o[c]){l=!0;break}if(l||!a&&t(u[s]))continue;if("#text"!=u[s].nodeName.toLowerCase()&&"#comment"!=u[s].nodeName.toLowerCase()){var f=[];if(u[s].hasAttributes())for(var h=u[s].attributes,d=0;h.length>d;d++){var p=h.item(d);f.push({name:p.nodeName,value:p.nodeValue})}if(r.start)if(u[s].hasChildNodes()){if(r.start(u[s].nodeName,f,!1),"iframe"==u[s].nodeName.toLowerCase()||"frame"==u[s].nodeName.toLowerCase()){if(u[s].contentDocument&&u[s].contentDocument.documentElement)return e(u[s].contentDocument.documentElement,r,i)}else u[s].hasChildNodes()&&e(u[s],r,i);r.end&&r.end(u[s].nodeName)}else r.start(u[s].nodeName,f,!0)}else"#text"==u[s].nodeName.toLowerCase()?r.chars&&r.chars(u[s].nodeValue):"#comment"==u[s].nodeName.toLowerCase()&&r.comment&&r.comment(u[s].nodeValue)}catch(g){console.error(g),console.log("error while parsing node: "+u[s].nodeName.toLowerCase())}};Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"),"function"==typeof define&&define.amd?define('js/lib/htmlparser',[],function(){return e}):window.HTMLParser=e})();
(function(){var t=function(t){function n(t){var n,e=location.href,r=e.replace(/\/[^\/]*$/,"/"),a=e.replace(/#[^\/#]*$/,"");return/^[a-zA-Z]([a-zA-Z0-9 -.])*:/.test(t)?n=t:/^\x2f/.test(t)?(n=""!==location.protocol?location.protocol+"//":"",n+=location.hostname,"80"!=location.port&&(n+=":"+location.port),n+=t):n=/^#/.test(t)?a+t:r+t,encodeURI(n)}var e=function(t,n){return 0===t.indexOf(n)},r=function(t,n){return t.match(n+"$")==n};return function(a,i){function o(){var t="";if(m)for(var n=0;m.length-1>n;n++)t+="  ";return t+=s(m)}function u(t){var n={};for(var e in t){var r=t[e];n[r.name]=r}return n}function s(t){return t&&t.length>0?t.slice(-1)[0]:""}function l(t){if(!t)return"";for(var n=t.length-1;n>=0;n--)if(""!==t[n])return t[n];return""}function c(t){var n=!1;if(t==l(p)){for(;s(p)!=t;)p.pop();p.pop(),n=!0}return n}function f(t){for(var n=[];p.length>0&&s(p)!=t;){var e=p.pop();n.unshift(e)}return n.join("")}function h(t){var n=p.pop();if(n)if(t)p.push(n),r(n,"\n")||p.push("\n\n");else{var e;/\s*\n\n\s*$/.test(n)?(n=n.replace(/\s*\n\n\s*$/,"\n\n"),e=""):/\s*\n\s*$/.test(n)?(n=n.replace(/\s*\n\s*$/,"\n"),e="\n"):e=/\s+$/.test(n)?"\n\n":"\n\n",p.push(n),p.push(e)}}function d(){if(p.length>0){var t=s(p);r(t,"\n")||p.push("\n")}else p.push("\n")}var g=!1,p=[],m=[],v=[],y=[],b=[],x=[];i=i||{};var M=i.inlineStyle||!1,_={hr:"- - -\n\n",br:"  \n",title:"# ",h1:"# ",h2:"## ",h3:"### ",h4:"#### ",h5:"##### ",h6:"###### ",b:"**",strong:"**",i:"_",em:"_",dfn:"_","var":"_",cite:"_",span:" ",ul:"* ",ol:"1. ",dl:"- ",blockquote:"> "};try{var w,k=document.createElement("div");if(k.innerHTML=a||"",w=k,t(w,{start:function(t,r,a){var i;if(t=t.toLowerCase(),g&&console.log("start: "+t),!a||"br"==t||"hr"==t||"img"==t)switch(t){case"br":p.push(_[t]);break;case"hr":h(),p.push(_[t]);break;case"title":case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":h(),p.push(_[t]);break;case"b":case"strong":case"i":case"em":case"dfn":case"var":case"cite":p.push(_[t]);break;case"code":case"span":if(b.length>0)break;/\s+$/.test(s(p))||p.push(_[t]);break;case"p":case"div":h();break;case"ul":case"ol":case"dl":m.push(_[t]),m.length>1?d():h();break;case"li":case"dt":var c=o();p.push(c);break;case"a":i=u(r),v.push(i),p.push("[");break;case"img":i=u(r);var f,w,k;if(k=i.src?n(i.src.value):"",!k)break;if(f=i.alt?i.alt.value.trim():"",w=i.title?i.title.value.trim():"",M||e(l(p),"["))e(l(p),"[")||h(),p.push("!["+f+"]("+k+(w?' "'+w+'"':"")+")"),e(l(p),"[")||h(!0);else{var A=x.indexOf(k);-1==A&&(x.push(k),A=x.length-1),h(),p.push("!["),""!==f?p.push(f):null!=w&&p.push(w),p.push("]["+A+"]"),h()}break;case"blockquote":h(),y.push(_[t]);break;case"pre":h(),b.push(!0),p.push("    ");break;case"table":p.push("<table>");break;case"thead":p.push("<thead>");break;case"tbody":p.push("<tbody>");break;case"tr":p.push("<tr>");break;case"td":p.push("<td>")}},chars:function(t){if(b.length>0)t=t.replace(/\n/g,"\n    ");else{if(""===t.trim())return p.push(""),void 0;t=t.replace(/\s+/g," ");var n=l(p);/\s+$/.test(n)&&(t=t.replace(/^\s+/g,""))}g&&console.log("text: "+t),y.length>0&&p.push(y.join("")),p.push(t)},end:function(t){switch(t=t.toLowerCase(),g&&console.log("end: "+t),t){case"title":case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":c(_[t])||h(!0);break;case"p":case"div":for(;p.length>0&&""===s(p).trim();)p.pop();h(!0);break;case"b":case"strong":case"i":case"em":case"dfn":case"var":case"cite":c(_[t])||(p.push(f(_[t]).trim()),p.push(_[t]));break;case"a":var r=f("[");if(r=r.replace(/\s+/g," "),r=r.trim(),""===r){p.pop();break}var a,i=v.pop();if(a=i.href&&""!==i.href.value?n(i.href.value):"",""===a){p.pop(),p.push(r);break}if(p.push(r),M||e(s(p),"!")){e(s(p),"!")&&(r=p.pop(),r=p.pop()+r,h(),p.push(r));var u=i.title;p.push("]("+a+(u?' "'+u.value.trim().replace(/\s+/g," ")+'"':"")+")"),e(s(p),"!")&&h(!0)}else{var l=x.indexOf(a);-1==l&&(x.push(a),l=x.length-1),p.push("]["+l+"]")}break;case"ul":case"ol":case"dl":d(),m.pop();break;case"li":case"dt":var w=o();c(w)||(r=f(w).trim(),e(r,"[![")?(p.pop(),h(),p.push(r),h(!0)):(p.push(r),d()));break;case"blockquote":y.pop();break;case"pre":h(!0),b.pop();break;case"code":case"span":if(b.length>0)break;""===s(p).trim()?(p.pop(),p.push(_[t])):(r=p.pop(),p.push(r.trim()),p.push(_[t]));break;case"table":p.push("</table>");break;case"thead":p.push("</thead>");break;case"tbody":p.push("</tbody>");break;case"tr":p.push("</tr>");break;case"td":p.push("</td>");break;case"br":case"hr":case"img":}}},{nodesToIgnore:["script","noscript","object","iframe","frame","head","style","label"]}),!M)for(var A=0;x.length>A;A++)if(0===A){var S=p.pop();p.push(S.replace(/\s+$/g,"")),p.push("\n\n["+A+"]: "+x[A])}else p.push("\n["+A+"]: "+x[A])}catch(N){console.log(N.stack),console.trace()}return p.join("")}};"function"==typeof define&&define.amd?define('js/lib/html2markdown',["js/lib/htmlparser"],function(n){return t(n)}):window.HTML2Markdown=t(window.HTMLParser)})();
(function(){var e=function(e,t,a,r,s,i,o,n,l,u,c){return t.defaults=e.extend(t.defaults,{"toolbar.modes":!0,"toolbar.mode.html":!0,"toolbar.mode.markdown":!1,"toolbar.mode.rich":!0,"composer.default":"rich","composer.group":"wysihtml5"}),t.plugin("modes",function(d,p,h,g){if(g["toolbar.modes"]){var f=g["prefix.css"]+"-toolbar-source",m=g["prefix.css"]+"-toolbar-wysi",b=g["prefix.css"]+"-toolbar-markdown",v=g["prefix.data"].replace(/-/g,".")+"default.mode."+g["composer.group"],y=e(a({prefix:g["prefix.css"],mode:{html:g["toolbar.mode.html"],markdown:g["toolbar.mode.markdown"],rich:g["toolbar.mode.rich"]}}));t.insertIntoRightToolbar(p,y,100);var w=m,x=null,k=function(t,a){t.find('input[name="default-mode"]').on("change",function(){e(this).is(":checked")?n.set(v,a,{expires:36500}):n.clear(v)}),g["toolbar.modes"]&&(g["toolbar.mode.html"]||g["toolbar.mode.markdown"]||g["toolbar.mode.rich"])?n.get(v)==a&&t.find('input[name="default-mode"]').attr("checked","checked"):t.find("label."+g["prefix.css"]+"-default-mode").hide()},_=function(a){d.fire("change_view","composer",a),w=m;var r=e(i({prefix:g["prefix.css"]}));k(r,"rich"),t.updateFooter(h,r)},j=function(a){w!=b&&d.fire("change_view","textarea",a),w=f,d.setValue(l(d.getValue()));var s=e(r({prefix:g["prefix.css"]}));s.find("a").on("click",function(e){e.preventDefault(),o(s.find(".modal")).open()}),k(s,"html"),t.updateFooter(h,s),e(d.textareaElement).show()},S=function(a){var r=!1;w!=f&&d.fire("change_view","textarea"),e(d.textareaElement).hide(),w=b,x||(r=!0,x=e("<textarea></textarea>").addClass(g["prefix.css"]+"-markdown-editor"),e(d.textareaElement).after(x),t.setupSecondaryTextarea(d,x)),x.val(c(d.getValue(),{inlineStyle:!0})),x.on("keyup",function(){d.setValue(u(e(this).val()))}),r&&t.setupSecondaryTextarea(d,x);var i=e(s({prefix:g["prefix.css"]}));k(i,"markdown"),t.updateFooter(h,i),a&&setTimeout(function(){x.show().focus()},0)};p.find("[data-wysihtml5-custom-command=change-editor]").on("click",function(){var a=e(this);a.hasClass("wysihtml5-command-active")||(p.find("[data-wysihtml5-custom-command=change-editor]").show().removeClass("wysihtml5-command-active"),a.addClass("wysihtml5-command-active"),t.updateFooter(h,""),x&&x.hide(),a.hasClass(m)?_(!0):a.hasClass(f)?j(!0):a.hasClass(b)&&S(!0))}),d.on("load",function(){var a=n.get(v);if("markdown"==g["composer.default"]&&!a||"markdown"==a)p.find("[data-wysihtml5-custom-command=change-editor]").show().removeClass("wysihtml5-command-active"),p.find("."+b).addClass("wysihtml5-command-active"),S(!1);else if("html"==g["composer.default"]&&!a||"html"==a)p.find("[data-wysihtml5-custom-command=change-editor]").show().removeClass("wysihtml5-command-active"),p.find("."+f).addClass("wysihtml5-command-active"),j(!1);else{var r=e(i({prefix:g["prefix.css"]}));k(r,"rich"),t.updateFooter(h,r)}})}}),t};"function"==typeof define&&define.amd?define('bundles/wysihtml5/modes',["jquery","bundles/wysihtml5/editor","bundles/wysihtml5/toolbar-modes.html","bundles/wysihtml5/footer-source.html","bundles/wysihtml5/footer-markdown.html","bundles/wysihtml5/footer-rich.html","js/lib/modals","js/lib/cookie","js/lib/beautify-html","js/lib/marked","js/lib/html2markdown"],function(t,a,r,s,i,o,n,l,u,c,d){return e(t,a,r,s,i,o,n,l,u,c,d)}):e(window.$,window.wysiEditor,window.jade.templates["bundles.wysihtml5.toolbar-modes"],window.jade.templates["bundles.wysihtml5.footer-source"],window.jade.templates["bundles.wysihtml5.footer-markdown"],window.jade.templates["bundles.wysihtml5.footer-rich"],window.Modal,window.Cookie,window.beautify_html,window.marked,window.HTML2Markdown)})(window);
(function(wndw){var jadify=function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{})buf.push("<button"),buf.push(attrs({"data-wysihtml5-custom-command":"image","data-wysihtml5-order":7,type:"button",unselectable:"on",title:"Insert image","class":prefix+"-toolbar-item"},{"class":!0,"data-wysihtml5-custom-command":!0,"data-wysihtml5-order":!0,type:!0,unselectable:!0,title:!0})),buf.push('><span class="icon-picture"></span> Pic</button>');return buf.join("")}};"function"==typeof define&&define.amd?define('bundles/wysihtml5/toolbar-transloadit.html',["js/lib/jade"],function(e){return jadify(e)}):wndw.jade.templates["toolbar-transloadit"]=jadify(wndw.jade.helpers)})(window);
(function(wndw){var jadify=function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{})buf.push("<div"),buf.push(attrs({"data-wysihtml5-modal-image":!0,"data-modal-overlay-class":prefix+"-overlay",role:"dialog","aria-label":"Create Image",tabindex:"-1","class":"modal hide"},{"data-modal-overlay-class":!0,role:!0,"aria-label":!0,tabindex:!0})),buf.push('><form><div class="modal-body"><div class="control-group bootstrap-wysihtml5-upload-image"><div style="text-align:center;" class="uploader-controls transloadit-uploader"><div class="uploader-preview"><div><img src=""/></div><div style="margin-top:10px;"> <span>What size would you like to embed it at? </span><input type="text" style="width:50px;margin-left: 5px; margin-right:5px;" class="uploader-input-width"/><span>x</span><input type="text" style="width:50px;margin-left:5px;" class="uploader-input-height"/></div></div><div class="uploader-side"><button type="button" class="btn uploader-button">Pick File</button><div class="uploader-file-input"><input type="file" name="my_file" accept="image/png,image/jpeg,image/gif,image/jpg"/></div><div style="display:none;" class="progress progress-striped active uploader-progress"><div style="width:0%" class="bar"></div></div><div class="uploader-input hide"><input type="text" value="" name="result" class="uploader-input-url"/></div></div></div></div></div><div class="modal-footer"><button'),buf.push(attrs({type:"submit","data-modal-close":!0,style:"margin-right:10px;","class":"btn hide "+(prefix+"-modal-image-submit")},{"class":!0,type:!0,"data-modal-close":!0,style:!0})),buf.push('>Insert</button><a data-modal-close="data-modal-close" href="javascript:;">Cancel</a></div></form></div>');return buf.join("")}};"function"==typeof define&&define.amd?define('bundles/wysihtml5/toolbar-modal-transloadit.html',["js/lib/jade"],function(e){return jadify(e)}):wndw.jade.templates["toolbar-modal-transloadit"]=jadify(wndw.jade.helpers)})(window);
define('js/lib/jquery.easing',["jquery"],function(t){t.easing.jswing=t.easing.swing,t.extend(t.easing,{def:"easeOutQuad",swing:function(e,n,i,r,o){return t.easing[t.easing.def](e,n,i,r,o)},easeInQuad:function(t,e,n,i,r){return i*(e/=r)*e+n},easeOutQuad:function(t,e,n,i,r){return-i*(e/=r)*(e-2)+n},easeInOutQuad:function(t,e,n,i,r){return 1>(e/=r/2)?i/2*e*e+n:-i/2*(--e*(e-2)-1)+n},easeInCubic:function(t,e,n,i,r){return i*(e/=r)*e*e+n},easeOutCubic:function(t,e,n,i,r){return i*((e=e/r-1)*e*e+1)+n},easeInOutCubic:function(t,e,n,i,r){return 1>(e/=r/2)?i/2*e*e*e+n:i/2*((e-=2)*e*e+2)+n},easeInQuart:function(t,e,n,i,r){return i*(e/=r)*e*e*e+n},easeOutQuart:function(t,e,n,i,r){return-i*((e=e/r-1)*e*e*e-1)+n},easeInOutQuart:function(t,e,n,i,r){return 1>(e/=r/2)?i/2*e*e*e*e+n:-i/2*((e-=2)*e*e*e-2)+n},easeInQuint:function(t,e,n,i,r){return i*(e/=r)*e*e*e*e+n},easeOutQuint:function(t,e,n,i,r){return i*((e=e/r-1)*e*e*e*e+1)+n},easeInOutQuint:function(t,e,n,i,r){return 1>(e/=r/2)?i/2*e*e*e*e*e+n:i/2*((e-=2)*e*e*e*e+2)+n},easeInSine:function(t,e,n,i,r){return-i*Math.cos(e/r*(Math.PI/2))+i+n},easeOutSine:function(t,e,n,i,r){return i*Math.sin(e/r*(Math.PI/2))+n},easeInOutSine:function(t,e,n,i,r){return-i/2*(Math.cos(Math.PI*e/r)-1)+n},easeInExpo:function(t,e,n,i,r){return 0==e?n:i*Math.pow(2,10*(e/r-1))+n},easeOutExpo:function(t,e,n,i,r){return e==r?n+i:i*(-Math.pow(2,-10*e/r)+1)+n},easeInOutExpo:function(t,e,n,i,r){return 0==e?n:e==r?n+i:1>(e/=r/2)?i/2*Math.pow(2,10*(e-1))+n:i/2*(-Math.pow(2,-10*--e)+2)+n},easeInCirc:function(t,e,n,i,r){return-i*(Math.sqrt(1-(e/=r)*e)-1)+n},easeOutCirc:function(t,e,n,i,r){return i*Math.sqrt(1-(e=e/r-1)*e)+n},easeInOutCirc:function(t,e,n,i,r){return 1>(e/=r/2)?-i/2*(Math.sqrt(1-e*e)-1)+n:i/2*(Math.sqrt(1-(e-=2)*e)+1)+n},easeInElastic:function(t,e,n,i,r){var o=1.70158,a=0,s=i;if(0==e)return n;if(1==(e/=r))return n+i;if(a||(a=.3*r),Math.abs(i)>s){s=i;var o=a/4}else var o=a/(2*Math.PI)*Math.asin(i/s);return-(s*Math.pow(2,10*(e-=1))*Math.sin((e*r-o)*2*Math.PI/a))+n},easeOutElastic:function(t,e,n,i,r){var o=1.70158,a=0,s=i;if(0==e)return n;if(1==(e/=r))return n+i;if(a||(a=.3*r),Math.abs(i)>s){s=i;var o=a/4}else var o=a/(2*Math.PI)*Math.asin(i/s);return s*Math.pow(2,-10*e)*Math.sin((e*r-o)*2*Math.PI/a)+i+n},easeInOutElastic:function(t,e,n,i,r){var o=1.70158,a=0,s=i;if(0==e)return n;if(2==(e/=r/2))return n+i;if(a||(a=r*.3*1.5),Math.abs(i)>s){s=i;var o=a/4}else var o=a/(2*Math.PI)*Math.asin(i/s);return 1>e?-.5*s*Math.pow(2,10*(e-=1))*Math.sin((e*r-o)*2*Math.PI/a)+n:.5*s*Math.pow(2,-10*(e-=1))*Math.sin((e*r-o)*2*Math.PI/a)+i+n},easeInBack:function(t,e,n,i,r,o){return void 0==o&&(o=1.70158),i*(e/=r)*e*((o+1)*e-o)+n},easeOutBack:function(t,e,n,i,r,o){return void 0==o&&(o=1.70158),i*((e=e/r-1)*e*((o+1)*e+o)+1)+n},easeInOutBack:function(t,e,n,i,r,o){return void 0==o&&(o=1.70158),1>(e/=r/2)?i/2*e*e*(((o*=1.525)+1)*e-o)+n:i/2*((e-=2)*e*(((o*=1.525)+1)*e+o)+2)+n},easeInBounce:function(e,n,i,r,o){return r-t.easing.easeOutBounce(e,o-n,0,r,o)+i},easeOutBounce:function(t,e,n,i,r){return 1/2.75>(e/=r)?i*7.5625*e*e+n:2/2.75>e?i*(7.5625*(e-=1.5/2.75)*e+.75)+n:2.5/2.75>e?i*(7.5625*(e-=2.25/2.75)*e+.9375)+n:i*(7.5625*(e-=2.625/2.75)*e+.984375)+n},easeInOutBounce:function(e,n,i,r,o){return o/2>n?.5*t.easing.easeInBounce(e,2*n,0,r,o)+i:.5*t.easing.easeOutBounce(e,2*n-o,0,r,o)+.5*r+i}})});
define('js/lib/jquery.jsonp',["jquery"],function(t){function e(){}function n(t){s=[t]}function i(t){E.insertBefore(t,E.firstChild)}function r(t,e,n){return t&&t.apply(e.context||e,n)}function o(t){return/\?/.test(t)?"&":"?"}function a(a){function h(t){!H++&&setTimeout(function(){z(),I&&(A[B]={s:[t]}),M&&(t=M.apply(a,[t])),r(a.success,a,[t,w]),r(k,a,[a,w])},0)}function T(t){!H++&&setTimeout(function(){z(),I&&t!=x&&(A[B]=t),r(a.error,a,[a,t]),r(k,a,[a,t])},0)}a=t.extend({},S,a);var N,k=a.complete,M=a.dataFilter,R=a.callbackParameter,O=a.callback,D=a.cache,I=a.pageCache,P=a.charset,B=a.url,F=a.data,L=a.timeout,H=0,z=e;return a.abort=function(){!H++&&z()},r(a.beforeSend,a,[a])===!1||H?a:(B=B||c,F=F?"string"==typeof F?F:t.param(F,a.traditional):c,B+=F?o(B)+F:c,R&&(B+=o(B)+escape(R)+"=?"),!D&&!I&&(B+=o(B)+"_"+(new Date).getTime()+"="),B=B.replace(/=\?(&|$)/,"="+O+"$1"),I&&(N=A[B])?N.s?h(N.s[0]):T(N):setTimeout(function(r,o,a){function c(t){(r[p]||e)(),t=s,s=void 0,t?h(t[0]):T(d)}H||(a=L>0&&setTimeout(function(){T(x)},L),z=function(){a&&clearTimeout(a),r[v]=r[p]=r[g]=r[m]=null,E[y](r),o&&E[y](o)},window[O]=n,r=t(b)[0],r.id=f+_++,P&&(r[l]=P),C.msie?(r.event=p,r.htmlFor=r.id,r[v]=function(){"loaded"==r.readyState&&c()}):(r[m]=r[g]=c,C.opera?(o=t(b)[0]).text="jQuery('#"+r.id+"')[0]."+m+"()":r[u]=u),r.src=B,i(r),o&&i(o))},0),a)}var s,u="async",l="charset",c="",d="error",f="_jqjsp",h="on",p=h+"click",m=h+d,g=h+"load",v=h+"readystatechange",y="removeChild",b="<script/>",w="success",x="timeout",C=t.browser,E=t("head")[0]||document.documentElement,A={},_=0,S={callback:f,url:location.href};a.setup=function(e){t.extend(S,e)},t.jsonp=a});
define('js/lib/jquery.transloadit2',["jquery","js/lib/jquery.easing","js/lib/jquery.jsonp","js/lib/json2"],function(t){function e(){this.assemblyId=null,this.instance=null,this.documentTitle=null,this.timer=null,this._options={},this.uploads=[],this.results={},this.ended=null,this.pollStarted=null,this.pollRetries=0,this.seq=0,this.started=!1,this.assembly=null,this.params=null,this.bytesReceivedBefore=0,this.lastPoll=0,this.$params=null,this.$form=null,this.$files=null,this.$fileClones=null,this.$iframe=null,this.$modal=null}var n="https:"==document.location.protocol?"https://":"http://",r={service:n+"api2.transloadit.com/",assets:n+"assets.transloadit.com/",onPick:function(){},onStart:function(){},onProgress:function(){},onUpload:function(){},onResult:function(){},onCancel:function(){},onError:function(){},onSuccess:function(){},interval:2500,pollTimeout:8e3,poll404Retries:15,pollConnectionRetries:3,wait:!1,processZeroFiles:!0,autoSubmit:!0,modal:!0,exclude:"",fields:!1,params:null,debug:!0},i=!1;t.fn.transloadit=function(){var t,n,r,i=Array.prototype.slice.call(arguments);if((1==i.length&&"object"==typeof i[0]||void 0===i[0])&&i.unshift("init"),t=i.shift(),"init"==t?(n=new e,i.unshift(this),this.data("transloadit.uploader",n)):n=this.data("transloadit.uploader"),!n)throw Error("Element is not initialized for transloadit!");return r=n[t].apply(n,i),void 0===r?this:r},e.prototype.init=function(e,n){this.$form=e,this.options(t.extend({},r,n||{}));var i=this;e.find('input[type="file"]').on("change",function(){return i.validate(),i.detectFileInputs(),i.checkFileTypes(),i._options.processZeroFiles||0!==i.$files.length?(i._options.onPick(),i.getBoredInstance()):i.submitForm(),!1}),this.includeCss()},e.prototype.getBoredInstance=function(){var e=this;this.instance=null,t.jsonp({url:this._options.service+"instances/bored",timeout:e._options.pollTimeout,callbackParameter:"callback",success:function(t){return t.error?(e.ended=!0,e.renderError(t),e._options.onError(t),void 0):(e.instance=t.api2_host,e.start(),void 0)},error:function(t,n){e.ended=!0;var r={error:"CONNECTION_ERROR",message:"There was a problem connecting to the upload server",reason:"JSONP request status: "+n};e.renderError(r),e._options.onError(r)}}),this._options.modal&&this.showModal()},e.prototype.start=function(){var e=this;this.started=!1,this.ended=!1,this.bytesReceivedBefore=0,this.pollRetries=0,this.seq=0,this.uploads=[],this.results={},this.assemblyId=this.uuid(),this.$fileClones=t().not(document),this.$files.each(function(){var n=t(this).clone(!0);e.$fileClones=e.$fileClones.add(n),n.insertAfter(this)}),this.$iframe=t('<iframe id="transloadit-'+this.assemblyId+'" name="transloadit-'+this.assemblyId+'"/>').appendTo("body").hide(),this.$uploadForm=t('<form enctype="multipart/form-data" />').attr("action",n+this.instance+"/assemblies/"+this.assemblyId+"?redirect=false").attr("target","transloadit-"+this.assemblyId).attr("method","POST").append(this.$files).appendTo("body").hide();var r="[name=params], [name=signature]";this._options.fields===!0?r="*":"string"==typeof this._options.fields&&(r+=", "+this._options.fields);var i=this.clone(this.$form.find(":input[type!=file]").filter(r));this._options.params&&!this.$params&&(i=i.add('<input name="params" value=\''+JSON.stringify(this._options.params)+"'>")),i.prependTo(this.$uploadForm),this.$uploadForm.submit(),this.lastPoll=+new Date,setTimeout(function(){e._poll()},300)},e.prototype.clone=function(e){for(var n=e.clone(),r=e.filter("textarea"),i=n.filter("textarea"),o=0,a=r.length;a>o;++o)t(i[o]).val(t(r[o]).val());return n},e.prototype.checkFileTypes=function(){var t=this,e=t.$files.attr("accept");return e?("video/*"==e&&(e="video/mp4,video/m4v,video/flv,video/avi,video/mpg,video/mov,video/wmv,video/h264,video/mkv"),"image/*"==e&&(e="image/png,image/jpeg,image/gif,image/jpg,image/ico"),e=e.split(","),t.$files=t.$files.filter(function(){for(var n=this.value.split(".").pop().toLowerCase(),r=0;e.length>r;r++)if(n==e[r].split("/")[1])return!0;return t._options.onError("Sorry, we don't accept "+n+" files."),!1}),void 0):!0},e.prototype.detectFileInputs=function(){var t=this.$form.find("input[type=file]").not(this._options.exclude);this._options.processZeroFiles||(t=t.filter(function(){return""!==this.value})),this.$files=t},e.prototype.validate=function(){if(this._options.params)this.params=this._options.params;else{var t=this.$form.find("input[name=params]");if(!t.length)return alert("Could not find input[name=params] in your form."),void 0;try{this.params=JSON.parse(t.val())}catch(e){return alert("Error: input[name=params] seems to contain invalid JSON."),void 0}}if(this.params.redirect_url)this.$form.attr("action",this.params.redirect_url);else if(this._options.autoSubmit&&this.$form.attr("action")==this._options.service+"assemblies")return alert("Error: input[name=params] does not include a redirect_url"),void 0;this.$params=t},e.prototype._poll=function(e){var r=this;this.ended||(t.browser.mozilla&&!this.documentTitle&&(this.documentTitle=document.title,document.title="Loading..."),this.pollStarted=+new Date,t.jsonp({url:n+this.instance+"/assemblies/"+this.assemblyId+(e||"?seq="+this.seq),timeout:r._options.pollTimeout,callbackParameter:"callback",success:function(t){if(!r.ended){if(r.assembly=t,"ASSEMBLY_NOT_FOUND"==t.error)return r.pollRetries++,r.pollRetries>r._options.poll404Retries?(document.title=r.documentTitle,r.ended=!0,r.renderError(t),r._options.onError(t),void 0):(setTimeout(function(){r._poll()},400),void 0);if(t.error)return r.ended=!0,r.renderError(t),document.title=r.documentTitle,r._options.onError(t),void 0;r.seq=t.last_seq,r.started||(r.started=!0,r._options.onStart(t)),r.pollRetries=0;var e=("ASSEMBLY_UPLOADING"==t.ok,"ASSEMBLY_EXECUTING"==t.ok),n="ASSEMBLY_CANCELED"==t.ok,i="ASSEMBLY_COMPLETED"==t.ok;r._options.onProgress(t.bytes_received,t.bytes_expected,t);for(var o=0;t.uploads.length>o;o++)r._options.onUpload(t.uploads[o],t),r.uploads.push(t.uploads[o]);for(var a in t.results){r.results[a]=r.results[a]||[];for(var o=0;t.results[a].length>o;o++)r._options.onResult(a,t.results[a][o],t),r.results[a].push(t.results[a][o])}if(n)return r.ended=!0,document.title=r.documentTitle,r._options.onCancel(t),void 0;if(r.renderProgress(t),i||!r._options.wait&&e)return r.ended=!0,document.title=r.documentTitle,t.uploads=r.uploads,t.results=r.results,r._options.onSuccess(t),r._options.modal&&r.cancel(),r.submitForm(),void 0;var s=r.pollStarted-+new Date,u=r._options.interval>s?r._options.interval:s;r.timer=setTimeout(function(){r._poll()},u),r.lastPoll=+new Date}},error:function(t,e){if(!r.ended){if(r.pollRetries++,r.pollRetries>r._options.pollConnectionRetries){document.title=r.documentTitle,r.ended=!0;var n={error:"CONNECTION_ERROR",message:"There was a problem connecting to the upload server",reason:"JSONP request status: "+e};return r.renderError(n),r._options.onError(n),void 0}setTimeout(function(){r._poll()},350)}}}))},e.prototype.stop=function(){document.title=this.documentTitle,this.ended=!0},e.prototype.cancel=function(){if(!this.ended){var e=this;this.$params&&this.$params.prependTo(this.$form),this.$fileClones.each(function(n){var r=t(e.$files[n]),i=t(this);r.insertAfter(i),i.remove()}),clearTimeout(e.timer),this._poll("?method=delete"),"Microsoft Internet Explorer"==navigator.appName&&this.$iframe[0].contentWindow.document.execCommand("Stop"),setTimeout(function(){e.$iframe.remove()},500)}this._options.modal&&(t.mask.close(),this.$modal.remove())},e.prototype.submitForm=function(){this.$fileClones,null!==this.assembly&&t("<textarea/>").attr("name","transloadit").text(JSON.stringify(this.assembly)).prependTo(this.$form).hide(),this._options.autoSubmit&&this.$form.unbind("submit.transloadit").submit()},e.prototype.showModal=function(){this.$modal=t('<div id="transloadit"><div class="content"><a href="#close" class="close"></a><p class="status"></p><div class="progress"><label>starting upload ...</label><span></span></div><p class="error"></p></div></div>').appendTo("body"),t.extend(this.$modal,{$status:this.$modal.find(".status"),$content:this.$modal.find(".content"),$close:this.$modal.find(".close"),$label:this.$modal.find("label"),$progress:this.$modal.find(".progress"),$progressSpan:this.$modal.find(".progress span"),$error:this.$modal.find(".error")});var e=this;this.$modal.$close.click(function(){e.cancel()}),this.$modal.$error.hide();var e=this;this.$modal.expose({api:!0,maskId:"transloadit_expose",opacity:.9,loadSpeed:250,closeOnEsc:!1,closeOnClick:!1}),this.$modal.$close.click(function(){return e.cancel(),!1})},e.prototype.renderError=function(t){if(this._options.modal){this.$modal.$content.addClass("content-error"),this.$modal.$progress.hide();var e=this._options.debug?t.error+": "+t.message+"<br><br>"+(t.reason||""):"There was an internal error, please try your upload again.";this.$modal.$error.html(e).show()}},e.prototype.renderProgress=function(t){if(this._options.modal){var e=t.bytes_received/t.bytes_expected,n=t.bytes_received-this.bytesReceivedBefore,r=+new Date-this.lastPoll,i=1==e?1e3:2*this._options.interval,o=1==e?"processing ...":(t.bytes_received/1024/1024).toFixed(2)+" MB / "+(t.bytes_expected/1024/1024).toFixed(2)+" MB "+"("+(n/1024/(r/1e3)).toFixed(1)+" kB / sec)";this.bytesReceivedBefore=t.bytes_received,this.$modal.$label.text(o),this.$modal.$progressSpan.stop().animate({width:100*e+"%"},i,"easeOutCubic")}},e.prototype.includeCss=function(){!i&&this._options.modal&&(i=!0,t('<link rel="stylesheet" type="text/css" href="'+this._options.assets+'css/transloadit2.css" />').appendTo("head"))},e.prototype.uuid=function(){var t,e="";for(t=0;32>t;t++)e+=Math.floor(16*Math.random()).toString(16);return e},e.prototype.options=function(e){return 0==arguments.length?this._options:(t.extend(this._options,e),void 0)},e.prototype.option=function(t,e){return 1==arguments.length?this._options[t]:(this._options[t]=e,void 0)}});
(function(){var e=function(e,t,n,r,o){var i=function(t,n){var r=this;this.modal=t,this.$element=this.modal.$el.find(".transloadit-uploader"),this.$preview=this.$element.find(".uploader-preview"),this.$button=this.$element.find(".uploader-button"),this.$progress=this.$element.find(".uploader-progress"),this.$input=this.$element.find(".uploader-input-url");var o={max_size:n["transloadit.max_size"]||1048576,auth:{key:n["transloadit.key"]},template_id:n["transloadit.template"],steps:{store:{}}};this.$element.transloadit({params:o,wait:!0,modal:!1,autoSubmit:!1,processZeroFiles:!1,onPick:function(){r.$element.find(".help-inline.errror").remove(),r.$progress.show(),r.$progress.find(".bar").css("width","0%")},onStart:function(){r.$button.hide()},onProgress:function(e,t){var n=(100*(e/t)).toFixed(2);n=Math.min(95,n),isNaN(n)||r.$progress.find(".bar").css("width",n+"%")},onSuccess:function(t){function n(e){return e.replace(/^http:\/\//i,"https://")}function o(e){var r=t.results[e][0];return r.value=n(r.url),"image"==r.type&&(r.image=r.value),r}r.$progress.fadeOut();var i,s=0;e.each(t.results,function(e){s++,i=e}),t.results[":original"]&&s>1&&(i=":original");var a=o(i);r.$input.val(a.value).trigger("change"),r.updatePreview(!0),r.$preview.show(),r.$element.find('input[name="uploader_file_input"]').val("")},onError:function(t){var n=e('<span class="help-inline error"></span>').append(t);r.$button.show(),r.$element.find(".uploader-side").append(n),r.$element.find('input[name="uploader_file_input"]').val("")}}),this.updatePreview()};return i.prototype.updatePreview=function(){var e=this;if(e.$width=e.$element.find(".uploader-input-width"),e.$height=e.$element.find(".uploader-input-height"),this.$input.val()){var t=this.$preview.find("img");t.attr("src",this.$input.val()).show(),this.$preview.show(),t.on("load",function(){e.$width.val(t.width()),e.$height.val(t.height()),e.modal.reposition(),e.$width.on("keyup",function(){var n=Math.round(t.height()/t.width()*e.$width.val());e.$height.val(n)}),e.$height.on("keyup",function(){var n=Math.round(t.width()/t.height()*e.$height.val());e.$width.val(n)})})}else this.$preview.hide(),this.modal.reposition()},i.prototype.reset=function(){this.$input.val(""),this.updatePreview(),this.$button.show()},t.defaults=e.extend(t.defaults,{"toolbar.image":!1,"transloadit.key":"","transloadit.template":""}),t.plugin("transloadit",function(s,a,c,l){if(l["toolbar.image"]){var u=e(r({prefix:l["prefix.css"]}));t.insertIntoLeftToolbar(a,u,7),a.find("."+l["prefix.css"]+"-toolbar-modals").append(o({prefix:l["prefix.css"]}));var d,h=a.find("[data-wysihtml5-modal-image]"),p=h.find("[type=submit]"),f=n(h),g=new i(f,l),m=h.find("[name=result]");f.on("close",function(){s.currentView.element.focus()}),m.bind("change input textinput blur",function(){m.val().indexOf("http")>-1&&p.removeAttr("disabled").show()}),h.find("form").on("submit",function(e){e.preventDefault(),e.stopPropagation(),s.currentView.element.focus(),(void 0!==d||null!==d)&&(s.composer.selection.setBookmark(d),d=null);var t=m.val();if(t){var n=h.find(".uploader-input-width").val(),r=h.find(".uploader-input-height").val(),o=r||n?"width:"+n+"px;height:"+r+"px;":"";s.composer.commands.exec("insertImage",{src:t,style:o}),s.fire("change").fire("change:composer")}}),a.find("[data-wysihtml5-custom-command=image]").on("click",function(){e(this).hasClass("wysihtml5-command-active")||a.hasClass("wysihtml5-commands-disabled")||(d=s.composer&&s.composer.selection.getBookmark(),g.reset(),p.attr("disabled","").hide(),f.open())})}}),t};"function"==typeof define&&define.amd?define('bundles/wysihtml5/transloadit',["jquery","bundles/wysihtml5/editor","js/lib/modals","bundles/wysihtml5/toolbar-transloadit.html","bundles/wysihtml5/toolbar-modal-transloadit.html","js/lib/jquery.transloadit2"],function(t,n,r,o,i,s){return e(t,n,r,o,i,s)}):e(window.$,window.wysiEditor,window.Modal,window.jade.templates["bundles.wysihtml5.toolbar-transloadit"],window.jade.templates["bundles.wysihtml5.toolbar-modal-transloadit"])})(window);
(function(e){var t=function(e){var t=!1,a=function(e){return function(){return t?e():(t=!0,MathJax.Hub.Config({config:["MMLorHTML.js"],styleSheets:[],styles:{},jax:["input/TeX"],extensions:["tex2jax.js"],preJax:null,postJax:null,preRemoveClass:"MathJax_Preview",showProcessingMessages:!0,messageStyle:"none",displayAlign:"center",displayIndent:"0em",delayStartupUntil:"none",skipStartupTypeset:!1,elements:[],tex2jax:{inlineMath:[["$$","$$"],["\\(","\\)"]],displayMath:[["\\[","\\]"]],skipTags:["script","noscript","style","textarea","pre","code"],ignoreClass:"tex2jax_ignore",processClass:"tex2jax_process",processEscapes:!1,processEnvironments:!0,preview:"TeX"},mml2jax:{preview:"alttext"},jsMath2jax:{preview:"TeX"},TeX:{TagSide:"right",TagIndent:".8em",MultLineWidth:"85%",Macros:{},extensions:["AMSmath.js","AMSsymbols.js"]},MathML:{useMathMLspacing:!1},"HTML-CSS":{scale:100,availableFonts:["STIX","TeX"],preferredFont:"TeX",webFont:"TeX",imageFont:"TeX",undefinedFamily:"STIXGeneral,'Arial Unicode MS',serif",showMathMenu:!0,styles:{},tooltip:{delayPost:600,delayClear:600,offsetX:10,offsetY:5}},NativeMML:{scale:100,showMathMenu:!0,showMathMenuMSIE:!0,styles:{}},MathMenu:{delay:400,helpURL:"http://www.mathjax.org/help/user/",showRenderer:!0,showFontMenu:!1,showContext:!1,windowSettings:{status:"no",toolbar:"no",locationbar:"no",menubar:"no",directories:"no",personalbar:"no",resizable:"yes",scrollbars:"yes",width:100,height:50},styles:{}},MMLorHTML:{prefer:{MSIE:"MML",Firefox:"MML",Opera:"HTML",other:"HTML"}}}),MathJax.Hub.Configured(),e())}};return{render:function(t,s){var n=a(function(){t?MathJax.Hub.Queue(["Typeset",MathJax.Hub,t],s):MathJax.Hub.Queue(["Typeset",MathJax.Hub],s)});e.ready("MathJax",n)}}};"function"==typeof define&&define.amd?define('js/lib/coursera.mathjax',["js/lib/third-parties"],function(e){return t(e)}):e.mathjax=t(window.thirdparties)})(window);
(function(wndw){var jadify=function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{})buf.push("<button"),buf.push(attrs({"data-wysihtml5-custom-command":"latex",type:"button",unselectable:"on",title:"Math Options","data-popup":"#"+prefix+"-toolbar-latex-popup","aria-haspopup":"true","aria-expanded":"false","aria-owns":prefix+"-toolbar-latex-popup","data-popup-close":!0,"data-popup-direction":"sw","class":prefix+"-toolbar-item"},{"class":!0,"data-wysihtml5-custom-command":!0,type:!0,unselectable:!0,title:!0,"data-popup":!0,"aria-haspopup":!0,"aria-expanded":!0,"aria-owns":!0,"data-popup-close":!0,"data-popup-direction":!0})),buf.push(">Math</button><div"),buf.push(attrs({id:prefix+"-toolbar-latex-popup",style:"display:none;"},{id:!0,style:!0})),buf.push("><a"),buf.push(attrs({"data-popup-close":!0,"class":prefix+"-toolbar-latex-popup-item "+prefix+"-toolbar-latex-popup-item-editor"},{"class":!0,"data-popup-close":!0})),buf.push(">Equation Builder</a><a"),buf.push(attrs({"data-popup-close":!0,"class":prefix+"-toolbar-latex-popup-item "+prefix+"-toolbar-latex-popup-item-preview"},{"class":!0,"data-popup-close":!0})),buf.push(">Full Preview</a></div>");return buf.join("")}};"function"==typeof define&&define.amd?define('bundles/wysihtml5/toolbar-latex.html',["js/lib/jade"],function(e){return jadify(e)}):wndw.jade.templates["toolbar-latex"]=jadify(wndw.jade.helpers)})(window);
(function(wndw){var jadify=function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{})buf.push("<button"),buf.push(attrs({type:"button",title:"Close Preview",style:"display:none;","class":prefix+"-toolbar-item "+prefix+"-toolbar-item-right "+prefix+"-toolbar-latex-preview"},{"class":!0,type:!0,title:!0,style:!0})),buf.push(">Close Math Preview</button>");return buf.join("")}};"function"==typeof define&&define.amd?define('bundles/wysihtml5/toolbar-right-latex.html',["js/lib/jade"],function(e){return jadify(e)}):wndw.jade.templates["toolbar-right-latex"]=jadify(wndw.jade.helpers)})(window);
(function(wndw){var jadify=function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{})buf.push("<div"),buf.push(attrs({"data-wysihtml5-modal-latex":!0,"data-modal-overlay-class":prefix+"-overlay","class":"modal hide"},{"data-modal-overlay-class":!0})),buf.push('><form style="margin:0px;padding:0px;"><div style="overflow:auto;"><div style="float:left;width:20%;"><label style="padding:10px;font-weight:bold;text-align:right;">LaTeX:</label></div><div style="float:right;width:80%;"><textarea'),buf.push(attrs({name:"latex",placeholder:"enter a latex equation","class":prefix+"-modal-latex-textarea"},{"class":!0,name:!0,placeholder:!0})),buf.push('></textarea></div></div><div class="coursera-wysihtml5-latex-preview-area"><div style="float:left;width:20%;"> <label style="padding:10px;font-weight:bold;text-align:right;">Preview:</label></div><div style="float:right;width:80%;"><div class="coursera-wysihtml5-latex-preview"></div></div></div><div class="modal-footer"><button'),buf.push(attrs({type:"submit","data-modal-close":!0,style:"margin-right:10px;","class":"btn "+(prefix+"-modal-link-submit")},{"class":!0,type:!0,"data-modal-close":!0,style:!0})),buf.push('>Create</button><a data-modal-close="data-modal-close" href="javascript:;">Cancel</a></div></form></div>');return buf.join("")}};"function"==typeof define&&define.amd?define('bundles/wysihtml5/toolbar-modal-latex.html',["js/lib/jade"],function(e){return jadify(e)}):wndw.jade.templates["toolbar-modal-latex"]=jadify(wndw.jade.helpers)})(window);
(function(){var e=function(e){for(var t=/\${2}/g,n=[],r={},o=t.exec(e);o;)r.start?(r.end=o.index,r.text=e.substring(r.start,r.end),n.push(r),r={}):r.start=o.index+"$$".length,o=t.exec(e);return n},t=function(e,t){for(var n,r=0;n=t[r];r++)if(e>=n.start&&n.end>=e)return n;return null},n=function(n,r,o,i,s,a,c,l){var u=function(n,r,o,i,s,a){o=[],i.val(""),s.html("");var c=n.composer.selection.getBookmark();if(c){if(3===c.startContainer.nodeType){o=e(c.startContainer.textContent);var l=t(c.startOffset,o);l&&(i.val(l.text),i.trigger("keyup"))}caretBookmark=c}a.open()},d=function(e,t,o){t.addClass("wysihtml5-commands-disabled"),t.find(".coursera-wysihtml5-toolbar-modes").hide(),n(e.textareaElement);var i=n(e.composer.iframe),s=i.clone().removeClass("wysihtml-sandbox"),a=n("<div>").hide().addClass(e.config.composeClassName).appendTo(t),c=["background-color","color","cursor","font-family","font-size","font-style","font-variant","font-weight","line-height","letter-spacing","text-align","text-decoration","text-indent","text-rendering","word-break","word-wrap","word-spacing"];s.css({position:"absolute",top:t.outerHeight(),left:0}).appendTo(t),s.ready(function(){window.setTimeout(function(){var l=s[0].contentWindow.document,u=i[0].contentWindow.document,d=n("body",u),h=n("body",l);r.each(c,function(e){h.css(e,d.css(e))});var p=n("head",l);r.each(e.config.stylesheets,function(e){n("<link>",l).attr({rel:"stylesheet",href:e}).appendTo(p)}),a.append(e.getValue(!0)),o.render(a[0],function(){a.remove().appendTo(h).show()}),t.find(".coursera-wysihtml5-toolbar-latex-preview").show().one("click",function(){a.remove(),s.remove(),t.removeClass("wysihtml5-commands-disabled"),t.find(".coursera-wysihtml5-toolbar-modes").show(),t.find(".coursera-wysihtml5-toolbar-latex-preview").hide()})},0)})},h=r.debounce(i.render,200);return s.defaults=n.extend(s.defaults,{"toolbar.latex":!1}),s.plugin("latex",function(e,r,p,f){if(f["toolbar.latex"]){var g=n(a({prefix:f["prefix.css"]})),m=n(c({prefix:f["prefix.css"]}));s.insertIntoLeftToolbar(r,g,100),s.insertIntoRightToolbar(r,m,200),r.find("."+f["prefix.css"]+"-toolbar-modals").append(l({prefix:f["prefix.css"]}));var v,b=r.find("[data-wysihtml5-modal-latex]"),y=o(b),w=b.find("[name=latex]"),C=b.find(".coursera-wysihtml5-latex-preview"),x=[];w.on("keyup",function(){C.html("$$"+w.val()+"$$"),h(C[0])}),w.trigger("keyup"),y.on("open",function(){w.focus()}),y.on("close",function(){e.currentView.element.focus()}),b.find("form").on("submit",function(n){n.preventDefault(),e.currentView.element.focus();var r,o,i,s,a,c,l;v||(v=e.composer.selection.getBookmark()),e.composer.selection.setBookmark(v);var u=t(v.startOffset,x);u?(o=u.start,i=u.end,r=!1):(o=v.startOffset,i=o,r=!0),s=w.val(),r&&(s="$$"+s+"$$"),3===v.startContainer.nodeType?(a=v.startContainer.textContent.substring(0,o),c=v.startContainer.textContent.substring(i),v.startContainer.textContent=a+s+c):(l=document.createTextNode(s),v.insertNode(l)),v=null,e.fire("change").fire("change:composer")}),r.find("."+f["prefix.css"]+"-toolbar-latex-popup-item-editor").on("click",function(){n(this).hasClass("wysihtml5-command-active")||r.hasClass("wysihtml5-commands-disabled")||u(e,r,x,w,C,y)}),r.find("."+f["prefix.css"]+"-toolbar-latex-popup-item-preview").on("click",function(){n(this).hasClass("wysihtml5-command-active")||r.hasClass("wysihtml5-commands-disabled")||d(e,r,i)})}}),s};"function"==typeof define&&define.amd?define('bundles/wysihtml5/latex',["jquery","underscore","js/lib/modals","js/lib/coursera.mathjax","bundles/wysihtml5/editor","bundles/wysihtml5/toolbar-latex.html","bundles/wysihtml5/toolbar-right-latex.html","bundles/wysihtml5/toolbar-modal-latex.html","js/lib/popups"],function(e,t,r,o,i,s,a,c,l){return n(e,t,r,o,i,s,a,c,l)}):n(window.$,window._,window.Modal,window.mathjax,window.wysiEditor,window.jade.templates["bundles.wysihtml5.toolbar-latex"],window.jade.templates["bundles.wysihtml5.toolbar-right-latex"],window.jade.templates["bundles.wysihtml5.toolbar-modal-latex"],window.Popup)})(window);
(function(wndw){var jadify=function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{})buf.push("<button"),buf.push(attrs({"data-wysihtml5-custom-command":"textbook","data-wysihtml5-order":13,type:"button","class":prefix+"-toolbar-item"},{"class":!0,"data-wysihtml5-custom-command":!0,"data-wysihtml5-order":!0,type:!0})),buf.push(">Textbook</button>");return buf.join("")}};"function"==typeof define&&define.amd?define('bundles/wysihtml5/toolbar-textbook.html',["js/lib/jade"],function(e){return jadify(e)}):wndw.jade.templates["toolbar-textbook"]=jadify(wndw.jade.helpers)})(window);
(function(wndw){var jadify=function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{})buf.push("<div"),buf.push(attrs({"data-wysihtml5-modal-textbook":!0,"data-modal-overlay-class":prefix+"-overlay",role:"dialog","aria-label":"Create a textbook link","class":"modal hide"},{"data-modal-overlay-class":!0,role:!0,"aria-label":!0})),buf.push('><form><div class="modal-body"><div><label style="display:inline-block;margin-right:15px;"><span>Make a textbook link!</span></label><select name="textbook-modal-options"></select></div><div><label style="display:inline-block;margin-right:15px;"><span>Select page number (optional)</span></label><input type="text" name="textbook-modal-options-page"/></div></div><div class="modal-footer"><button'),buf.push(attrs({type:"submit","data-modal-close":!0,style:"margin-right:10px;","class":"btn "+(prefix+"-modal-textbook-submit")},{"class":!0,type:!0,"data-modal-close":!0,style:!0})),buf.push('>Create</button><a data-modal-close="data-modal-close" href="javascript:;">Cancel</a></div></form></div>');return buf.join("")}};"function"==typeof define&&define.amd?define('bundles/wysihtml5/toolbar-modal-textbook.html',["js/lib/jade"],function(e){return jadify(e)}):wndw.jade.templates["toolbar-modal-textbook"]=jadify(wndw.jade.helpers)})(window);
(function(){var e=function(e,t,a,r,s){return a.defaults=e.extend(a.defaults,{"toolbar.textbook":!1}),a.plugin("textbook",function(i,o,n,l){if(window.spark_class_short_name&&l["toolbar.textbook"]){var u=e(r({prefix:l["prefix.css"]}));a.insertIntoLeftToolbar(o,u,13),o.find("."+l["prefix.css"]+"-toolbar-modals").append(s({prefix:l["prefix.css"]}));var c=o.find("[data-wysihtml5-modal-textbook]"),d=t(c),p=e(e(i.textarea.element)[0]).data("courseraWysihtml5ToolbarTextbookOptions"),h=c.find("[name=textbook-modal-options]"),g=c.find("[name=textbook-modal-options-page]");if(p){var m=p.split(",");for(var f in m){var b=m[f].split("="),y='<option value="'+b[1]+'">'+b[0]+"</option>";h.append(y)}}d.on("open",function(){g.val("")}),d.on("close",function(){i.currentView.element.focus()}),c.find("form").on("submit",function(e){e.preventDefault(),e.stopPropagation(),i.currentView.element.focus();var t=i.currentView.selection.getSelection(),a=g.val(),r="https://"+window.location.hostname+"/"+window.spark_class_short_name+"/textbook/api/"+h.val();a.length>0&&(r=r+"/"+a),t.focusNode&&t.focusNode.parentNode&&"A"==t.focusNode.parentNode.nodeName?(t.focusNode.parentNode.title=null,t.focusNode.parentNode.href=r):i.composer.commands.exec("createLink",{href:r,target:"_blank"}),i.fire("change").fire("change:composer")}),o.find("[data-wysihtml5-custom-command=textbook]").on("click",function(){e(this).hasClass("wysihtml5-command-active")||o.hasClass("wysihtml5-commands-disabled")||d.open()})}}),a};"function"==typeof define&&define.amd?define('bundles/wysihtml5/textbook',["jquery","js/lib/modals","bundles/wysihtml5/editor","bundles/wysihtml5/toolbar-textbook.html","bundles/wysihtml5/toolbar-modal-textbook.html"],function(t,a,r,s,i){return e(t,a,r,s,i)}):e(window.$,window.Modal,window.wysiEditor,window.jade.templates["bundles.wysihtml5.toolbar-textbook"],window.jade.templates["bundles.wysihtml5.toolbar-modal-textbook"])})(window);
(function(){var e=function(e,t,s){var a={"prefix.css":"coursera-wysihtml5","prefix.data":"data-coursera-wysihtml5","toolbar.modes":!0,"toolbar.image":!1,"composer.class":"coursera-wysihtml5","composer.default":"rich","composer.stylesheet":t.url.app_assets+"bundles/wysihtml5/editor.css","transloadit.key":"05912e90e83346abb96c261bf458b615","transloadit.template":"a295b36c8fd44fbdb89e8eab06980081",parserRules:{tags:{b:1,i:1,p:1,span:1,div:1,ul:1,li:1,ol:1,pre:1,code:1,u:1,br:1,table:1,tr:1,td:1,thead:1,tbody:1,h1:1,h2:1,h3:1,h4:1,h5:1,strong:{rename_tag:"b"},em:{rename_tag:"i"},img:{check_attributes:{src:"url",style:"allow",alt:"allow"}},a:{check_attributes:{href:"url",target:"alt"}}}}};return s.defaults=e.extend(s.defaults,a),s};"function"==typeof define&&define.amd?define('js/lib/coursera.wysihtml5',["underscore","js/core/config","bundles/wysihtml5/editor","bundles/wysihtml5/code","bundles/wysihtml5/link","bundles/wysihtml5/modes","bundles/wysihtml5/transloadit","bundles/wysihtml5/latex","bundles/wysihtml5/textbook"],function(t,s,a){return e(t,s,a)}):e(window._,window.configure,window.wysiEditor)})(window);
define('pages/forum/views/EditorUtil',["backbone","jquery","underscore","pages/forum/app","js/lib/coursera.wysihtml5","js/lib/util","js/lib/cookie"],function(r,e,t,a,s,n){function o(r){var e="rich";n.isIOS()&&(e="markdown");var t=s(r.find("textarea"),{"toolbar.image":!0,"toolbar.latex":!0,"toolbar.code":!0,"toolbar.mode.markdown":!0,"composer.default":e,"composer.group":"forums","composer.stylesheet":[a.config.url.app_assets+"css/spark.main.css",a.config.url.app_assets+"css/spark.forum.hg.css"]});return r.find("input[name=text_type]").val("html"),t}function i(r){var t={};return r.find("input,textarea,select").each(function(){t[e(this).attr("name")]="checkbox"==e(this).attr("type")?e(this).is(":checked")?e(this).val():0:e(this).val()}),t}return{makeEditor:o,getPropsFromForm:i}});
define('pages/forum/views/EntryView',["backbone","jquery","underscore","js/lib/moment","js/lib/util","pages/forum/app","pages/forum/views/EntryView.html","pages/forum/views/EntryBylineView.html","pages/forum/views/EntryEditView.html","pages/forum/views/EntryReportView.html","pages/forum/views/EditorUtil","js/lib/popups","js/lib/modals","js/lib/coursera.mathjax","js/lib/badgeville"],function(e,t,r,o,n,i,s,a,d,m,l,c,u,p,h){var f="Forum Entry",v=e.View.extend({template:s,tagName:"li",events:{"click .course-forum-post-admin-details-link":"onAdminDetailsClick","click .course-forum-post-action-link":"onEntryActionClick","click .course-forum-post-edit-link":"onEntryEditClick","click .course-forum-post-controls-toggle":"onGearClick","click .course-forum-post-edit-form button.course-forum-post-edit-save":"onEntryEditSave","click .course-forum-post-vote-button":"onVoteClick","click a.course-forum-post-edit-cancel":"onEntryEditCancel","click .course-forum-post-controls-report":"onReportClick","click .course-forum-report-modal button":"onReportSave"},initialize:function(){this.model.bind("sync",this.render,this),this.model.bind("change",this.renderBylineMaybe,this),this.model.bind("error",this.renderError,this)},render:function(){var e=this;return e.renderEntry(),e.model.isNew()?e.renderEditMode():p.render(e.el),e},renderEntry:function(){var e=this;e.$el.html(e.template({entry:this.model,user:i.user})),e.renderByline(),e.$viewContainer=e.$(".course-forum-post-view-container");var t=this.model.changedAttributes();return t&&(t[this.model.textProp]?e.$(".course-forum-post-text").animate({"margin-left":"-=5"},100).animate({"margin-left":"+=5"},100):t.votes&&e.$(".course-forum-post-vote-controls").animate({"margin-left":"-=5"},100).animate({"margin-left":"+=5"},100)),e.model.get("_viewer_can_vote")||e.$(".course-forum-post-vote-button").addClass("course-forum-post-vote-disabled"),e},renderBylineMaybe:function(){var e=this.model.changedAttributes();e&&e._user_profile&&this.renderByline()},renderByline:function(){var e=this;if(this.$(".course-forum-post-byline").html(a({entry:this.model,user:i.user,config:i.config})),n.prettifyTime(this.$(".course-forum-post-byline time")),h.isEnabled()&&(e.setupBadgevilleByline=!1,e.model.get("user_id")&&h.getUserBucket(i.user.get("id")).thread_byline)){var o=r.throttle(r.bind(e.renderBadgevilleBylineMaybe,e),300);t(window).on("scroll.badgevillebylines"+this.model.get("id"),o),window.setTimeout(function(){e.renderBadgevilleBylineMaybe()},1),window.setTimeout(function(){e.renderBadgevilleBylineMaybe()},500)}},renderBadgevilleBylineMaybe:function(){if(h.isAPILoaded()){var e=this,r=e.$(".course-forum-profile-badgeville");!e.setupBadgevilleByline&&e.$el.is(":visible")&&n.inView(r,200)&&(h.setupByline(e.model.get("user_id"),r),t(window).off("scroll.badgevillebylines"+e.model.get("id")),e.setupBadgevilleByline=!0)}},renderError:function(e,r){this.$(".course-forum-entry-error").remove(),this.$editContainer.find(".course-forum-post-edit-save").removeAttr("disabled");var o=t("<div>");o.append(r.responseText).addClass("alert alert-error course-forum-entry-error"),this.$el.append(o)},onGearClick:function(){i.multitracker.push([f,"Controls Open"])},onAdminDetailsClick:function(){this.$(".course-forum-post-admin-container").show(),i.multitracker.push([f,"Admin Details"])},onEntryEditCancel:function(){this.$editContainer.hide(),this.model.isNew()||this.$viewContainer.show()},onEntryEditClick:function(){var e=this;e.renderEditMode(),i.multitracker.push([f,"Edit"])},renderEditMode:function(){var e=this;if(!e.$editContainer||e.$editContainer&&!e.$editContainer.parent().length){e.$el.append(d({entry:this.model})),e.$editContainer=e.$(".course-forum-post-edit-container"),e.$viewContainer.hide(),e.$editContainer.show();var t=l.makeEditor(e.$editContainer.find("form"));"comment"==e.model.entryType&&t.on("load",function(){t.composer&&t.composer.element.focus()})}else e.$viewContainer.hide(),e.$editContainer.show();e.$editContainer.find(".course-forum-post-edit-save").removeAttr("disabled")},onEntryEditSave:function(e){var t=this;e.preventDefault();var r=l.getPropsFromForm(t.$editContainer.find("form")),o=t.model.isNew();return t.model.update(r,{message:{waiting:"Saving...",success:"Saved!"}}).done(function(){o&&1!=r.anonymous&&h.credit({verb:"created-entry",thread:t.model.get("thread_id"),entry:t.model.get("id"),week:h.getWeek()})}),t.$editContainer.find(".course-forum-post-edit-save").attr("disabled","disabled"),i.multitracker.push([f,"Edit Save"]),!1},onEntryActionClick:function(e){var r=t(e.target),o=r.attr("data-property"),n=r.attr("data-value"),s={};s[o]=n,this.model.update(s,{message:{waiting:"Processing...",success:"Processed!"}}),i.multitracker.push([f,"Action "+o+" "+n])},onVoteClick:function(e){var r=this;e.preventDefault(),e.stopPropagation();var o=t(e.target).closest(".course-forum-post-vote-button");if(!o.hasClass("course-forum-post-vote-disabled")){var n=r.model.get("_viewer_voted"),s=o.attr("data-direction-value");return i.api.post(this.model.votesUrl(),{data:{direction:s},message:{waiting:"Recording vote...",success:"Recorded vote!"}}).done(function(e){if(r.model.set(e),r.renderEntry(),h.isEnabled()&&!n&&(h.credit({verb:"voted",direction:s,thread:r.model.get("thread_id"),week:h.getWeek()}),1==s)){var t=r.model.get("thread_id"),o=r.model.get("thread_id")+r.model.entryType+r.model.get("id");h.creditOther(r.model.get("user_id"),{verb:"got-upvote-on-entry",thread:t,entry:o,num_votes:r.model.get("votes"),entry_type:r.model.get("original")?"original":"reply",week:h.getWeek()}),r.model.get("votes")>=3&&h.creditOther(r.model.get("user_id"),{verb:"got-3-upvotes-on-entry",thread:t,entry:o,num_votes:r.model.get("votes"),entry_type:r.model.get("original")?"original":"reply",week:h.getWeek()})}}),!1}},onReportClick:function(){var e=this;e.$el.append(m());var t=new u(e.$(".course-forum-report-modal"));t.open(),e.$(".course-forum-report-modal textarea").focus()},onReportSave:function(){var e=this,t=e.$(".course-forum-report-modal textarea").val();i.api.post(this.model.reportsUrl(),{data:{description:t},message:{waiting:"Sending report...",success:"Sent!"}}).done(function(){})}});return v});
define('pages/forum/views/PostView',["backbone","jquery","underscore","pages/forum/views/EntryView"],function(e,t,n,i){var r=i.extend({});return r});
define('pages/forum/views/CommentView',["backbone","jquery","underscore","pages/forum/views/EntryView"],function(e,t,n,i){var r=i.extend({});return r});
define('pages/forum/views/PostContainerView',["backbone","jquery","underscore","pages/forum/app","pages/forum/models/CommentModel","pages/forum/views/PostContainerView.html","pages/forum/views/PostView","pages/forum/views/CommentView"],function(e,t,n,o,r,s,i,m){var a="Forum Post Container",c=e.View.extend({template:s,events:{"click .course-forum-new-comment-link":"onNewCommentClick"},initialize:function(){this.post=this.model,this.post.bind("sync",this.hideCommentsMaybe,this),this.comments=this.options.comments,this.comments.bind("reset",this.renderComments,this),this.comments.bind("add",this.renderComments,this)},render:function(){var e=this;return e.$el.html(e.template({post:e.post})),e.$newCommentContainer=e.$el.find(".course-forum-new-comment-container"),e.renderPost(),e.renderComments(),e.hideCommentsMaybe(),e},renderPost:function(){var e=this;e.$el.find(".course-forum-post-top-container").empty();var t=new i({model:e.post});e.$el.find(".course-forum-post-top-container").append(t.render().$el)},hideCommentsMaybe:function(){this.post.get("deleted")?this.$(".course-forum-comments-container").hide():this.$(".course-forum-comments-container").show()},renderComments:function(){var e=this;e.$el.find(".course-forum-comments-container").empty(),e.comments.each(function(t){c=new m({model:t}),e.$el.find(".course-forum-comments-container").append(c.render().$el)})},initNewComment:function(){this.newComment=new r({thread:this.post.get("thread"),thread_id:this.post.get("thread").get("id"),post_id:this.post.get("id")}),this.newComment.bind("sync",this.saveNewCommentMaybe,this);var e=new m({model:this.newComment});this.$newCommentContainer.html(e.render().$el)},saveNewCommentMaybe:function(){this.newComment.isNew()||(this.comments.add(this.newComment),this.newComment.unbind("sync",this.saveNewCommentMaybe,this),this.newComment=null,this.$newCommentContainer.empty())},onNewCommentClick:function(){this.newComment||this.initNewComment(),this.$newCommentContainer.find(".course-forum-post-edit-container").show(),o.multitracker.push([a,"Click New Comment"])}});return c});
define('pages/forum/views/ThreadView',["backbone","jquery","underscore","js/lib/util","js/lib/cookie","pages/forum/app","pages/forum/views/ThreadView.html","pages/forum/views/ThreadSortView.html","pages/forum/views/ForumCrumbsView.html","pages/forum/views/ThreadHeaderView","pages/forum/views/ThreadTagsView","pages/forum/views/PostContainerView","pages/forum/models/ThreadModel","pages/forum/models/PostModel","js/lib/badgeville"],function(e,t,o,r,n,i,s,u,a,c,l,p,d,g,h){var f=o.throttle(function(e){e.model.getPostsBefore()},1500),m=o.throttle(function(e){e.model.getPostsAfter()},1500),b=function(e){e.position()&&t("html,body").scrollTop(e.position().top)},v="Forum Thread",E=e.View.extend({defaults:{},events:{"click .course-forum-thread-admin-details-link":"onAdminDetailsClick"},initialize:function(){this.hangoutsEnabled=o.isUndefined(this.options.hangoutsEnabled)?!1:this.options.hangoutsEnabled,this.thread=this.model,this.thread.bind("change",this.render,this),this.thread.bind("error",this.renderError,this),this.thread.read({data:{post_id:this.options.post,comment_id:this.options.comment,sort:this.thread.get("_sort_order")},message:{waiting:"Fetching thread information..."}},o.bind(this.thread.onFetchPosts,this.thread,null)),this.postContainers={},t(window).on("scroll",o.bind(this.onScroll,this))},renderError:function(e,o){this.$(".course-forum-thread-error").remove();var r=t("<div>");r.append(o.responseText).addClass("alert alert-error course-forum-thread-error"),this.$el.append(r)},updatePageMeta:function(){"page"==this.options.mode&&(document.title=this.thread.get("title"),r.setMetaTag("property","og:title",this.thread.get("title")),r.setMetaTag("property","og:url",this.thread.get("link")))},render:function(){var e=this,t=e.thread.changedAttributes();if(e.updatePageMeta(),e.$(".course-forum-thread-posts-container").length||(e.$el.html(s({config:i.config,thread:e.thread})),e.$(".course-forum-thread-crumbs").html(a({_:o,crumbs:this.thread.get("crumbs")})),e.$(".course-forum-thread-tags").html(new l({model:this.thread}).render().el),e.$(".course-forum-thread-header-wrapper").html(new c({model:this.thread}).render().el),this.thread.getTriageStatus(),this.thread.get("user_id")!=i.user.get("id")&&window.setTimeout(function(){h.credit({verb:"viewed",thread:e.thread.get("id")})},7e3)),e.$(".course-forum-thread-posts-container").is(":empty")||t&&o.intersection(o.keys(t),["locked","start_range","end_range","num_posts"]).length>0){e.$(".course-forum-thread-sort").html(u({user:i.user,thread:this.thread}));var r=null;e.$(".course-forum-thread-sort ul li").each(function(t,o){var n=e.$(o);n.attr("data-sort-name")===e.thread.get("sort")&&(n.addClass("active"),r=n)}),r||e.$(".course-forum-thread-sort ul li").eq(1).addClass("active"),e.renderPosts(),e.scrollToPermalinkMaybe(),e.maybeShowHangoutPopup()}return 1==e.thread.get("deleted")?e.$el.addClass("course-forum-thread-deleted"):e.$el.removeClass("course-forum-thread-deleted"),1==e.thread.get("locked")?(e.$(".course-forum-thread-new-post").hide(),e.$(".course-forum-new-comment-link-container").hide()):(e.$(".course-forum-thread-new-post").show(),e.$(".course-forum-new-comment-link-container").show()),e},saveNewPostMaybe:function(){var e=this;this.newPost.isNew()||(this.model.get("posts").add(this.newPost),this.initNewPost(),e.renderPosts())},scrollToPermalinkMaybe:function(){var e=this;if(!e.hasScrolled){e.hasScrolled=!0;var t,o=this.options.post,r=this.options.comment;o?t=e.$('[data-permalink="post-'+o+'"]'):r&&(t=e.$('[data-permalink="comment-'+r+'"]')),t&&(t.addClass("course-forum-permalink"),b(t),e.thread.getPostsBefore(function(){b(t)}))}},initNewPost:function(){var e=this;this.newPost&&this.newPost.unbind("sync",this.saveNewPostMaybe,this),this.newPost=new g({thread_id:this.thread.get("id"),thread:this.thread}),this.newPost.bind("sync",this.saveNewPostMaybe,this);var t=new p({model:this.newPost,comments:this.thread.getCommentsForPost(this.newPost)});e.$el.find(".course-forum-thread-new-post").html(t.render().$el)},renderPosts:function(){var e=this;e.model.get("posts").each(function(t){if(!o.has(e.postContainers,t.get("id"))&&t.get("post_text")){var r=new p({model:t,thread:e.thread,comments:e.thread.getCommentsForPost(t)}),n=e.thread.get("posts").find(function(o){return o.get("order")>t.get("order")&&e.postContainers[o.get("id")]}),i=o.find(e.thread.get("posts").toArray().reverse(),function(o){return o.get("order")<t.get("order")&&e.postContainers[o.get("id")]});if(n){var s=e.postContainers[n.get("id")];s.$el.before(r.render().$el)}else if(i){var u=e.postContainers[i.get("id")];u.$el.after(r.render().$el)}else e.$el.find(".course-forum-thread-posts-container").append(r.render().$el);e.postContainers[t.get("id")]=r}}),e.thread.get("end_range")===e.thread.get("posts").length&&(e.hideBottomScrollIndicator(),e.initNewPost()),1===e.thread.get("start_range")&&e.$el.find(".course-forum-top-scroll-indicator").hide()},hideBottomScrollIndicator:function(){this.$el.find(".course-forum-bottom-scroll-indicator").hide(),this.$el.find(".course-forum-thread-new-post")},onScroll:function(){var e=this;e.hasScrolled=!0;var o=t(window),r=400;o.scrollTop()+o.height()+r>t(document).height()&&m(e),100>o.scrollTop()&&f(e)},onAdminDetailsClick:function(){this.$(".course-forum-post-admin-container").show(),i.multitracker.push([v,"Admin Details"])},maybeShowHangoutPopup:function(){var e="course.forum.hangouts.disabled",o=this.$(".course-forum-hangouts-popup");this.hangoutsEnabled&&!o.is(":visible")&&window.outerWidth>1200&&this.thread.userContributed(i.user.get("id"))&&this.thread.getTotalVotes()>=2&&this.thread.get("posts").size()+this.thread.get("comments").size()>=3&&!n.get(e)&&(this.$("[data-action=start]").on("click",function(){t(this).next("p").show(),i.multitracker.push([v,"Hangout Popup Start Click"]),t(this).off("click")}),this.$("[data-action=join]").on("click",function(){t(this).next("p").show(),i.multitracker.push([v,"Hangout Popup Join Click"]),t(this).off("click")}),this.$("[data-action=hide]").on("click",function(){o.hide(),i.multitracker.push([v,"Hangout Popup Close Click"]),t(this).off("click")}),this.$("[data-action=nothanks]").on("click",function(){o.hide(),i.multitracker.push([v,"Hangout Popup NoThanks Click"]),n.set(e,"true"),t(this).off("click")}),o.show(),i.multitracker.push([v,"Hangout Popup Show"]))}});return E});
define('pages/forum/models/ForumCollection',["backbone","pages/forum/models/ForumModel"],function(e,t){var n=e.Collection.extend({model:t,comparator:function(e){return e.getFullName()}});return n});
(function(wndw){var jadify=function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{})buf.push("<link"),buf.push(attrs({href:config.url.assets+"pages/home/account/select2.css",rel:"stylesheet",type:"text/css"},{href:!0,rel:!0,type:!0})),buf.push('/><div class="course-forum-thread-new"><h2>New Thread</h2><p>Thanks for contributing to our forums! We love thriving, active discussions. Please make sure you search\nbefore you post, to see if any of your classmates have already posted on the topic.</p><form class="form-horizontal course-forum-thread-new-form"><input type="hidden" name="text_type" value="html"/><div class="control-group"><div class="controls"><label class="checkbox"><input type="checkbox" name="is_bug_report"/>Is this a bug report?</label><span class="help-inline">Please check if your problem or question has been addressed <a href="http://help.coursera.org">here</a>.</span></div></div><div class="control-group hide course-forum-thread-new-platform"><div class="controls"><label class="checkbox"><input type="checkbox" name="is_coursera_bug_report"/>This is a Coursera-platform bug report.</label><span class="help-inline">(e.g. video playback issues, 404 errors, issues encountered when submitting homeworks).</span></div></div><div class="control-group hide course-forum-thread-new-materials"><div class="controls"><label class="checkbox"><input type="checkbox" name="is_course_material_report"/>This is a report on a course material issue.</label><span class="help-inline">(e.g. typos and potential errors in the lectures, assignments/grading, and other course materials).</span></div></div><div class="control-group"><label for="course-forum-thread-new-title-input" class="control-label">Title</label><div class="controls"><input type="text" name="title" id="course-forum-thread-new-title-input"/><p class="help-block">Give your post a good, informative title.<br/><span class="icon-thumbs-down"> Bad</span>: "I have a question regarding assignments." <br/><span class="icon-thumbs-up"> Good</span>: "When is assignment 1 due?"</p><div style="padding-top:15px;display:none" aria-atomic="true" aria-live="polite" class="course-forum-new-suggestions"><p>Some of these other threads may be of interest:<div class="course-forum-new-suggestions-list"></div></p></div></div></div><div class="control-group"><label for="course-forum-thread-new-content-input" class="control-label">Content</label><div class="controls"><textarea name="text" style="min-height: 200px;" id="course-forum-thread-new-content-input"></textarea></div></div><div class="control-group"><label for="course-forum-thread-new-tags-input" class="control-label">Tags</label><div class="controls"><input type="text" name="tags" style="width:475px;" id="course-forum-thread-new-tags-input" class="input-medium"/><br/><span class="help-inline">Try to use existing tags.</span></div></div><div class="control-group"><label for="course-forum-thread-new-forum-input" class="control-label">Forum:</label><div class="controls"><select name="forum_id" id="course-forum-thread-new-forum-input" class="course-forum-thread-new-subforums"></select><p class="help-block">Post in the appropriate sub-forum so that you reach an audience\nthat cares the most about your thread. Every class is different, so please first browse to see how\nyour class forums are organized. </p></div></div><div class="control-group"><div class="controls"><label class="checkbox"><input type="checkbox" name="anonymous" value="1"/>Make this post anonymous to other students</label></div></div><div class="control-group"><div class="controls"><label class="checkbox"><input type="checkbox" name="_user_is_subscribed" value="1" checked="checked"/>Subscribe to this thread at the same time</label></div></div><div class="control-group"><div class="controls"><button type="submit" class="btn btn-primary">Create new thread</button><span class="help-inline error course-forum-thread-new-error"></span></div></div></form></div>');return buf.join("")}};"function"==typeof define&&define.amd?define('pages/forum/views/ThreadNewView.html',["js/lib/jade"],function(e){return jadify(e)}):wndw.jade.templates.ThreadNewView=jadify(wndw.jade.helpers)})(window);
define('pages/forum/views/ThreadNewView',["backbone","jquery","underscore","pages/forum/app","pages/forum/models/ForumCollection","pages/forum/views/ThreadNewView.html","pages/forum/views/EditorUtil","pages/forum/models/ThreadModel","js/lib/select2","js/lib/badgeville"],function(e,u,t,r,a,s,o,n,i,d){var l="BugInPlatform",c="BugInCourseMaterial",h="BugReport",g="technical",f="course material",E=e.View.extend({defaults:{},events:{"submit .course-forum-thread-new-form":"onThreadSave","change input[name=is_bug_report]":"onBugChange","change input[name=is_coursera_bug_report]":"onBugTypeChange","change input[name=is_course_material_report]":"onBugTypeChange","blur input[name=title]":"onTitleChange"},initialize:function(){this.thread=this.model,this.render()},render:function(){var e=this;e.$el.html(s({config:r.config,thread:e.thread})),e.$form=e.$(".course-forum-thread-new-form"),e.$bugCheckbox=e.$('input[name="is_bug_report"]'),e.$techCheckbox=e.$('input[name="is_coursera_bug_report"]'),e.$materialsCheckbox=e.$('input[name="is_course_material_report"]'),e.bugFields=[e.$techCheckbox,e.$materialsCheckbox],e.$tagsInput=e.$('input[name="tags"]'),e.$titleInput=e.$("input[name=title]"),e.$forumsDropdown=e.$(".course-forum-thread-new-subforums"),e.editor=o.makeEditor(e.$form),r.api.get("forum/forums").done(function(r){var s=t.sortBy(r,function(e){return e.name}),o=new a(s);o.each(function(t){var r=u("<option>");r.attr("value",t.id),r.text(t.getFullName()),t.id==e.thread.get("forum_id")&&(r.attr("selected","selected"),e.forum=t),e.$forumsDropdown.append(r)}),e.forums=s,e.setupBugFields()}),r.api.get("forum/tags").done(function(u){var r=t.map(u,function(e){return e.tag_name});e.$tagsInput.select2({tags:r}),e.options.tagName&&e.addTag(e.options.tagName)})},setupBugFields:function(){var e=this;if(e.forum){var u=e.forum.get("name").toLowerCase().indexOf(g)>-1,t=e.forum.get("name").toLowerCase().indexOf(f)>-1;(u||t)&&e.$bugCheckbox.attr("checked","checked"),u&&e.$techCheckbox.attr("checked","checked"),t&&e.$materialsCheckbox.attr("checked","checked"),e.onBugChange(),e.onBugTypeChange()}},onBugChange:function(){var e=this;if(e.$bugCheckbox.is(":checked")){u.each(e.bugFields,function(e,u){u.parents(".control-group").show()});var t=e.$("textarea[name=text]");if(""===t.val()){var r="The problem summary:<br><br>Steps to reproduce:<ol><li></li></ol><br>Screenshot:<br><br>";e.editor.setValue(r)}e.addTag(h)}else u.each(e.bugFields,function(e,u){u.parents(".control-group").hide()}),e.removeTag(h)},updateTags:function(e){var u=this;u.$tagsInput.val(t.uniq(e)),u.$tagsInput.select2("val",t.uniq(e))},addTag:function(e){var u=this,t=[];""!==u.$tagsInput.val()&&(t=u.$tagsInput.val().split(",")),t.push(e),u.updateTags(t)},removeTag:function(e){var u=this,r=[];""!==u.$tagsInput.val()&&(r=u.$tagsInput.val().split(",")),r=t.without(r,e),u.updateTags(r)},onBugTypeChange:function(){var e=this;e.$techCheckbox.is(":checked")?(e.addTag(l),e.$forumsDropdown.find("option").each(function(){u(this).text().toLowerCase().indexOf(g)>-1&&u(this).attr("selected","selected")})):e.removeTag(l),e.$materialsCheckbox.is(":checked")?(e.addTag(c),e.$forumsDropdown.find("option").each(function(){u(this).text().toLowerCase().indexOf(f)>-1&&u(this).attr("selected","selected")})):e.removeTag(c)},onTitleChange:function(){var e=this;e.$titleInput.blur(function(){var t=e.$titleInput.val();if(t){var r="search?autocomplete=json&forum_id="+e.thread.get("forum_id")+"&q="+encodeURI(t);u.get(r,null,function(u){u.length>5&&(e.$(".course-forum-new-suggestions-list").html(u),e.$(".course-forum-new-suggestions").show("slow"))},"html")}})},redirectToThread:function(e){var u=window.location.pathname.substr(0,window.location.pathname.lastIndexOf("/")+1);window.location.href=u+"thread?thread_id="+e},onThreadSave:function(e){function u(e){r.$(".course-forum-thread-new-error").closest(".control-group").addClass("error"),r.$(".course-forum-thread-new-error").html("Error: "+e),r.$form.find("button").attr("disabled",null)}e.preventDefault();var r=this;r.$form.find("button").attr("disabled","disabled");var a=o.getPropsFromForm(r.$form);a.tags=t.map(a.tags.split(","),function(e){return{tag_name:e}}),r.thread.update(a,{message:{waiting:"Creating thread...",success:"Created thread!"}}).done(function(e){e.id?1!=a.anonymous&&d.isEnabled()?d.credit({verb:"created-thread",week:d.getWeek()},function(){r.redirectToThread(e.id)}):r.redirectToThread(e.id):u("Could not create thread.")}).fail(function(e){u(e.responseText)})}});return E});
(function(wndw){var jadify=function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{})buf.push('<h5 style="font-weight:normal">Forum activity for:</h5><div class="coursera-profile-basics"></div><div style="display:none; overflow:hidden; border-top: 1px solid #ccc; margin:15px 0px; padding-top: 6px;" class="coursera-profile-badgeville-missions"><a href="https://class.coursera.org/ml-003/wiki/view?page=CourseBadges" style="float: right;">Learn more about badges</a><div class="coursera-profile-badgeville-missions-list"><span>Loading...</span></div></div><div style="display:none; overflow:hidden; border-top: 1px solid #ccc; margin:15px 0px;" class="coursera-profile-forum-activities"></div><div style="display:none; clear: both; width: 100%; text-align: center; margin-top: 30px;" class="course-forum-profile-search"><a style="display:none; border: 1px solid #CCC; padding: 10px;">Find all activities</a></div>');return buf.join("")}};"function"==typeof define&&define.amd?define('pages/forum/views/UserProfileView.html',["js/lib/jade"],function(e){return jadify(e)}):wndw.jade.templates.UserProfileView=jadify(wndw.jade.helpers)})(window);
(function(wndw){var jadify=function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{}){var interp;buf.push('<div class="span3"><h5>'),total>threads.length?buf.push("Last "+escape(null==(interp=threads.length)?"":interp)+" threads (of "+escape(null==(interp=total)?"":interp)+")"):buf.push(""+escape(null==(interp=threads.length)?"":interp)+" "+escape(null==(interp=1==threads.length?"thread":"threads")?"":interp)),buf.push("</h5><ul>"),function(){if("number"==typeof threads.length)for(var e=0,t=threads.length;t>e;e++){var n=threads[e];buf.push("<li><a"),buf.push(attrs({href:n.link},{href:!0})),buf.push(">"+escape(null==(interp=n.title)?"":interp)+"</a></li>")}else{var t=0;for(var e in threads){t++;var n=threads[e];buf.push("<li><a"),buf.push(attrs({href:n.link},{href:!0})),buf.push(">"+escape(null==(interp=n.title)?"":interp)+"</a></li>")}}}.call(this),buf.push("</ul></div>")}return buf.join("")}};"function"==typeof define&&define.amd?define('pages/forum/views/UserProfileThreadLink.html',["js/lib/jade"],function(e){return jadify(e)}):wndw.jade.templates.UserProfileThreadLink=jadify(wndw.jade.helpers)})(window);
(function(wndw){var jadify=function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{}){var interp;buf.push('<div class="span4"><h5>'),total>entries.length?buf.push("Last "+escape(null==(interp=entries.length)?"":interp)+" "+escape(null==(interp=header)?"":interp)+"s (of "+escape(null==(interp=total)?"":interp)+")"):buf.push(""+escape(null==(interp=entries.length)?"":interp)+" "+escape(null==(interp=1==entries.length?header:header+"s")?"":interp)),buf.push("</h5><ul>"),function(){if("number"==typeof entries.length)for(var e=0,t=entries.length;t>e;e++){var n=entries[e];buf.push("<li><span>In <a"),buf.push(attrs({href:n.link},{href:!0})),buf.push(">"+escape(null==(interp=n.thread_title)?"":interp)+': </a></span><span>"'+escape(null==(interp=n.snippet)?"":interp)+'"</span></li>')}else{var t=0;for(var e in entries){t++;var n=entries[e];buf.push("<li><span>In <a"),buf.push(attrs({href:n.link},{href:!0})),buf.push(">"+escape(null==(interp=n.thread_title)?"":interp)+': </a></span><span>"'+escape(null==(interp=n.snippet)?"":interp)+'"</span></li>')}}}.call(this),buf.push("</ul></div>")}return buf.join("")}};"function"==typeof define&&define.amd?define('pages/forum/views/UserProfileEntryLink.html',["js/lib/jade"],function(e){return jadify(e)}):wndw.jade.templates.UserProfileEntryLink=jadify(wndw.jade.helpers)})(window);
(function(wndw){var jadify=function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{}){var interp;buf.push('<div style="overflow:hidden; position:relative;">'),user.fullProfileUrl()&&(buf.push("<a"),buf.push(attrs({href:user.fullProfileUrl(),style:"float:right;"},{href:!0,style:!0})),buf.push('><span class="icon-user"> </span> View Coursera profile</a>')),buf.push("<img"),buf.push(attrs({style:"width:60px;height:60px;float:left;border:1px solid #ccc; margin-bottom: 10px;",src:user.get("photo_120")||config.url.assets+"images/icons/avatar.jpg"},{style:!0,src:!0})),buf.push('/><div style="float:left; margin-left: 10px;"><h4 style="margin-top:0px;">'+escape(null==(interp=user.displayName())?"":interp)),"Student"!=user.get("forum_title")?buf.push('<span class="course-forum-profile-badge">'+escape(null==(interp=user.get("forum_title"))?"":interp)+"</span>"):user.get("in_signature_track")&&(buf.push("<a"),buf.push(attrs({style:"text-decoration: none; font-weight: normal;",href:config.url.base+"signature/course/"+spark_class_short_name+"/"+spark_class_id,target:"_blank"},{style:!0,href:!0,target:!0})),buf.push('><span class="course-forum-profile-badge-signaturetrack">Signature Track</span></a>')),buf.push("</h4></div>"),user.get("bio")&&buf.push('<p style="clear:left;">'+escape(null==(interp=user.get("bio"))?"":interp)+"</p>"),buf.push('<div style="position: absolute; bottom: 0px; right: 0px; text-align: right;"></div></div>')}return buf.join("")}};"function"==typeof define&&define.amd?define('pages/forum/views/UserProfileBasics.html',["js/lib/jade"],function(e){return jadify(e)}):wndw.jade.templates.UserProfileBasics=jadify(wndw.jade.helpers)})(window);
define('pages/forum/views/UserProfileView',["backbone","jquery","underscore","pages/forum/app","pages/forum/views/UserProfileView.html","pages/forum/views/UserProfileThreadLink.html","pages/forum/views/UserProfileEntryLink.html","pages/forum/views/UserProfileBasics.html","js/lib/badgeville"],function(e,i,a,r,n,t,s,d,l){var o=e.View.extend({defaults:{},events:{},initialize:function(){var e=this;this.user=this.model,this.user.bind("change",this.renderBasics,this),this.user.read(),this.setupBadgevilleMissions=!1,this.user.getFullProfile(),r.api.get(this.model.activitiesUrl()).done(function(i){e.renderActivities(i)}),this.render()},render:function(){var e=this;e.$(".coursera-profile-basics").length||e.$el.html(n())},renderBasics:function(){var e=this;e.$(".coursera-profile-basics").html(d({config:r.config,user:this.user})),l.isEnabled()&&(e.renderBadgevilleTimeout=window.setTimeout(function(){e.renderBadgevilleMissions()},200)),e.user.get("search_link")&&e.$(".course-forum-profile-search a").attr("href",this.user.get("search_link")).show()},renderBadgevilleMissions:function(){var e=this;l.isEnabled()&&(e.$(".coursera-profile-badgeville-missions").show(),l.setupMissionsDisplay(e.user.get("id"),e.$(".coursera-profile-badgeville-missions-list"),l.getUserBucket(r.user.get("id")).badge_ladder,r.user.get("id")==e.user.get("id")?"you":"they"),window.clearTimeout(e.renderBadgevilleTimeout))},renderActivities:function(e){var i=this;if(e&&(e.threads.length||e.posts.length||e.comments.length)){var a=i.$(".coursera-profile-forum-activities");e.totals.threads>0&&a.append(t({threads:e.threads,total:e.totals.threads})),e.totals.posts>0&&a.append(s({entries:e.posts,header:"post",total:e.totals.posts})),e.totals.comments>0&&a.append(s({entries:e.comments,header:"comment",total:e.totals.comments})),(e.totals.threads>e.threads.length||e.totals.posts>e.posts.length||e.totals.comments>e.comments.length)&&i.$(".course-forum-profile-search").show(),a.show()}}});return o});
(function(wndw){var jadify=function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{}){var interp;buf.push('<div class="course-forum-crumbs"></div><div class="course-forum-header-wrapper"></div><form'),buf.push(attrs({method:"get",action:forum.get("_search_link"),"class":"form-search pull-right"},{method:!0,action:!0})),buf.push('><label for="course-forum-search-input" class="hidden">Search </label><input id="course-forum-search-input" type="text" name="q" class="input-medium search-query"/><span>&nbsp;</span><button type="submit" class="btn">Search</button></form><h2 class="hidden">'+escape(null==(interp=forum.get("name"))?"":interp)),-1!=forum.get("parent_id")&&buf.push('<a href="list?forum_id=parent_id"> <i class="icon-arrow-up">Go to parent forum</i></a>'),buf.push('</h2><p class="course-forum-description">'+escape(null==(interp=forum.get("description"))?"":interp)+'</p><div class="course-forum-subforums-listing-wrapper"></div><div style="clear:right; margin-top: 10px;" class="course-forum-your-threads-listing-wrapper"></div><div style="clear:right; margin-top:30px;" class="course-forum-threads-listing-wrapper"></div><div style="margin-top: 10px;" class="course-forum-reputations-link"><a'),buf.push(attrs({href:forum.get("_reputation_link")},{href:!0})),buf.push('> <i class="icon-star"></i> See top forum posters</a></div>')}return buf.join("")}};"function"==typeof define&&define.amd?define('pages/forum/views/ForumView.html',["js/lib/jade"],function(e){return jadify(e)}):wndw.jade.templates.ForumView=jadify(wndw.jade.helpers)})(window);
(function(wndw){var jadify=function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{}){var interp;buf.push('<div class="course-forum-title"><h2>'+escape(null==(interp=forum.get("name"))?"":interp)+'</h2></div><div class="course-forum-header"><div class="course-forum-controls">');var popupId="course-forum-controls-popup-"+forum.get("id");buf.push("<a"),buf.push(attrs({title:"Forum controls",tabindex:"0",role:"button","aria-haspopup":"true","aria-expanded":"false","aria-owns":popupId,"data-popup":"#"+popupId,"data-popup-direction":"se","class":"course-forum-controls-toggle"},{title:!0,tabindex:!0,role:!0,"aria-haspopup":!0,"aria-expanded":!0,"aria-owns":!0,"data-popup":!0,"data-popup-direction":!0})),buf.push('><i class="icon-cog"><span class="hidden">Forum controls</span></i></a><div'),buf.push(attrs({id:popupId,"class":"course-forum-controls-popup hide"},{id:!0})),buf.push('><a href="javascript:void(0)">Mark all as read</a></div></div><div style="margin-right:10px; display:inline-block;">'),0==forum.get("id")&&(buf.push("<a"),buf.push(attrs({href:forum.get("_profile_link")},{href:!0})),buf.push('><span class="icon-comments"></span> View your latest activity</a>&nbsp; | &nbsp;')),forum.get("_viewer_subscription")?buf.push('<i class="icon-envelope"></i> You are subscribed.  <a href="javascript:void(0);" class="course-forum-unsubscribe-link">Unsubscribe</a>'):buf.push('<a href="javascript:void(0);" class="course-forum-subscribe-link">Subscribe for email updates.</a>'),buf.push("</div></div>")}return buf.join("")}};"function"==typeof define&&define.amd?define('pages/forum/views/ForumHeaderView.html',["js/lib/jade"],function(e){return jadify(e)}):wndw.jade.templates.ForumHeaderView=jadify(wndw.jade.helpers)})(window);
define('pages/forum/views/ForumHeaderView',["backbone","jquery","underscore","js/lib/util","pages/forum/app","pages/forum/views/ForumHeaderView.html"],function(e,t,r,s,a,i){var o=e.View.extend({events:{"click .course-forum-subscribe-link":"onSubscribeClick","click .course-forum-unsubscribe-link":"onUnsubscribeClick","click .course-forum-controls-popup a":"onMarkReadClick"},initialize:function(){this.forum=this.model,this.forum.bind("change",this.render,this)},render:function(){var e=["_viewer_subscription"],t=this.forum.changedAttributes();return(!this.$(".course-forum-controls").length||t&&r.intersection(r.keys(t),e).length>0)&&this.$el.html(i({config:a.config,user:a.user,forum:this.forum})),this},onSubscribeClick:function(){var e=this;a.api.post(this.model.subscriptionsUrl(),{message:{waiting:"Subscribing...",success:"Subscribed!"}}).done(function(t){e.forum.set({_viewer_subscription:t})})},onUnsubscribeClick:function(){var e=this;a.api["delete"](this.model.subscriptionsUrl(),{message:{waiting:"Unsubscribing...",success:"Unsubscribed!"}}).done(function(t){e.forum.set({_viewer_subscription:t})})},onMarkReadClick:function(){var e=this;a.api.post(this.model.readRecordsUrl(),{message:{waiting:"Marking as read...",success:"Done!"}}).done(function(){e.forum.set({_marked_as_read:(new Date).getTime()})})}});return o});
(function(wndw){var jadify=function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{}){var interp;forum.get("subforums")&&forum.get("subforums").length>0&&(buf.push('<h3 class="hidden">Sub-forums</h3><table style="margin-bottom:25px;" class="table course-forum-forums-listing"><caption class="hidden"> <h4>Sub-forums</h4></caption><thead><tr><th>Sub-forum</th><th width="30%">Latest Activity</th></tr></thead><tbody>'),function(){if("number"==typeof forum.get("subforums").length)for(var e=0,t=forum.get("subforums").length;t>e;e++){var r=forum.get("subforums")[e];"course-forum-forums-subforum-"+r.id,buf.push('<tr><td><h5 style="margin:0px;"><a'),buf.push(attrs({href:r.link,style:"display:inline;"},{href:!0,style:!0})),buf.push(">"+escape(null==(interp=r.name)?"":interp)+"</a></h5><span>"+escape(null==(interp=r.description)?"":interp)+'</span></td><td style="vertical-align:middle;">'),r.last_updated_time>-1?(buf.push("<a"),buf.push(attrs({href:r.last_updated_link},{href:!0})),buf.push(">"+escape(null==(interp=util.truncateText(r.last_updated_title,40))?"":interp)+" </a>(<time"),buf.push(attrs({datetime:r.last_updated_time},{datetime:!0})),buf.push("></time>)")):buf.push("None"),buf.push("</td></tr>")}else{var t=0;for(var e in forum.get("subforums")){t++;var r=forum.get("subforums")[e];"course-forum-forums-subforum-"+r.id,buf.push('<tr><td><h5 style="margin:0px;"><a'),buf.push(attrs({href:r.link,style:"display:inline;"},{href:!0,style:!0})),buf.push(">"+escape(null==(interp=r.name)?"":interp)+"</a></h5><span>"+escape(null==(interp=r.description)?"":interp)+'</span></td><td style="vertical-align:middle;">'),r.last_updated_time>-1?(buf.push("<a"),buf.push(attrs({href:r.last_updated_link},{href:!0})),buf.push(">"+escape(null==(interp=util.truncateText(r.last_updated_title,40))?"":interp)+" </a>(<time"),buf.push(attrs({datetime:r.last_updated_time},{datetime:!0})),buf.push("></time>)")):buf.push("None"),buf.push("</td></tr>")}}}.call(this),buf.push("</tbody></table>"))}return buf.join("")}};"function"==typeof define&&define.amd?define('pages/forum/views/ForumListView.html',["js/lib/jade"],function(e){return jadify(e)}):wndw.jade.templates.ForumListView=jadify(wndw.jade.helpers)})(window);
define('pages/forum/views/ForumListView',["backbone","jquery","underscore","js/lib/util","pages/forum/app","pages/forum/views/ForumListView.html"],function(e,t,n,i,r,o){var a=e.View.extend({className:"course-forum-subforums-listing",events:{},initialize:function(){this.forum=this.model,this.forum.bind("sync",this.render,this)},render:function(){return this.$el.html(o({config:r.config,util:i,forum:this.forum})),this.$el.find("time").each(function(){i.prettifyTime(t(this))}),this}});return a});
(function(){var e=function(e,n,i){"$:nomunge";function a(e){return e=e||n[d][s],e.replace(/^[^#]*#?(.*)$/,"$1")}var t,r=e.event.special,d="location",o="hashchange",s="href",l=e.browser,p=document.documentMode,c=l.msie&&(p===i||8>p),f="on"+o in n&&!c;e[o+"Delay"]=100,r[o]=e.extend(r[o],{setup:function(){return f?!1:(e(t.start),i)},teardown:function(){return f?!1:(e(t.stop),i)}}),t=function(){function i(){l=p=function(e){return e},c&&(r=e('<iframe src="javascript:0"/>').hide().insertAfter("body")[0].contentWindow,p=function(){return a(r.document[d][s])},l=function(e,n){if(e!==n){var i=r.document;i.open().close(),i[d].hash="#"+e}},l(a()))}var t,r,l,p,f={};return f.start=function(){if(!t){var r=a();l||i(),function c(){var i=a(),f=p(r);i!==r?(l(r=i,f),e(n).trigger(o)):f!==r&&(n[d][s]=n[d][s].replace(/#.*/,"")+"#"+f),t=setTimeout(c,e[o+"Delay"])}()}},f.stop=function(){r||(t&&clearTimeout(t),t=0)},f}()};"function"==typeof define&&define.amd?define('js/lib/jquery.hashchange',["jquery"],function(){return e}):window.HashChangeEvent=e(window.jQuery)})();
(function(){var e=function(e,n){"$:nomunge";function t(e){return"string"==typeof e}function r(e){var n=y.call(arguments,1);return function(){return e.apply(this,n.concat(y.call(arguments)))}}function a(e){return e.replace(/^[^#]*#?(.*)$/,"$1")}function o(e){return e.replace(/(?:^[^?#]*\?([^#]*).*$)?.*/,"$1")}function i(r,a,o,i,c){var u,l,p,h,d;return i!==f?(p=o.match(r?/^([^#]*)\#?(.*)$/:/^([^#?]*)\??([^#]*)(#?.*)/),d=p[3]||"",2===c&&t(i)?l=i.replace(r?R:E,""):(h=s(p[2]),i=t(i)?s[r?x:q](i):i,l=2===c?i:1===c?e.extend({},i,h):e.extend({},h,i),l=b(l),r&&(l=l.replace(m,v))),u=p[1]+(r?"#":l||!p[1]?"?":"")+l+d):u=a(o!==f?o:n[A][S]),u}function c(e,n,r){return n===f||"boolean"==typeof n?(r=n,n=b[e?x:q]()):n=t(n)?n.replace(e?R:E,""):n,s(n,r)}function u(n,r,a,o){return t(a)||"object"==typeof a||(o=a,a=r,r=f),this.each(function(){var t=e(this),i=r||g()[(this.nodeName||"").toLowerCase()]||"",c=i&&t.attr(i)||"";t.attr(i,b[n](c,a,o))})}var f,l,s,p,h,d,g,m,y=Array.prototype.slice,v=decodeURIComponent,b=e.param,$=e.bbq=e.bbq||{},w=e.event.special,j="hashchange",q="querystring",x="fragment",N="elemUrlAttr",A="location",S="href",C="src",E=/^.*\?|#.*$/g,R=/^.*\#/,U={};b[q]=r(i,0,o),b[x]=l=r(i,1,a),l.noEscape=function(n){n=n||"";var t=e.map(n.split(""),encodeURIComponent);m=RegExp(t.join("|"),"g")},l.noEscape(",/"),e.deparam=s=function(n,t){var r={},a={"true":!0,"false":!1,"null":null};return e.each(n.replace(/\+/g," ").split("&"),function(n,o){var i,c=o.split("="),u=v(c[0]),l=r,s=0,p=u.split("]["),h=p.length-1;if(/\[/.test(p[0])&&/\]$/.test(p[h])?(p[h]=p[h].replace(/\]$/,""),p=p.shift().split("[").concat(p),h=p.length-1):h=0,2===c.length)if(i=v(c[1]),t&&(i=i&&!isNaN(i)?+i:"undefined"===i?f:a[i]!==f?a[i]:i),h)for(;h>=s;s++)u=""===p[s]?l.length:p[s],l=l[u]=h>s?l[u]||(p[s+1]&&isNaN(p[s+1])?{}:[]):i;else e.isArray(r[u])?r[u].push(i):r[u]=r[u]!==f?[r[u],i]:i;else u&&(r[u]=t?f:"")}),r},s[q]=r(c,0),s[x]=p=r(c,1),e[N]||(e[N]=function(n){return e.extend(U,n)})({a:S,base:S,iframe:C,img:C,input:C,form:"action",link:S,script:C}),g=e[N],e.fn[q]=r(u,q),e.fn[x]=r(u,x),$.pushState=h=function(e,r){t(e)&&/^#/.test(e)&&r===f&&(r=2);var a=e!==f,o=l(n[A][S],a?e:{},a?r:2);n[A][S]=o+(/#/.test(o)?"":"#")},$.getState=d=function(e,n){return e===f||"boolean"==typeof e?p(e):p(n)[e]},$.removeState=function(n){var t={};n!==f&&(t=d(),e.each(e.isArray(n)?n:arguments,function(e,n){delete t[n]})),h(t,2)},w[j]=e.extend(w[j],{add:function(n){function t(e){var n=e[x]=l();e.getState=function(e,t){return e===f||"boolean"==typeof e?s(n,e):s(n,t)[e]},r.apply(this,arguments)}var r;return e.isFunction(n)?(r=n,t):(r=n.handler,n.handler=t,f)}})};"function"==typeof define&&define.amd?define('js/lib/jquery.bbq',["jquery","js/lib/jquery.hashchange"],function(n){e(n,window)}):e(window.$,window)})();
define('pages/forum/views/WidgetView',["backbone","jquery","underscore","js/lib/util","js/lib/jquery.bbq"],function(e,t,r){var s="-state-",i=e.View.extend({getWidgetId:function(){return this.widgetId=this.widgetId||this.options.widgetId||r.uniqueId(),this.widgetId},getWidgetKey:function(e){return this.getWidgetId()+s+e},addWidgetStateListener:function(){function e(e){if(e.indexOf("#")>-1){var i=t.deparam(e.split("#")[1]);return r.each(i,function(e,t){-1==t.indexOf(o.getWidgetId()+s)&&delete i[t]}),i}return{}}var i,o=this,a=window.location.href;t(window).bind("hashchange",function(){i=window.location.href;var t=e(a),n=e(i),h=[];r.each(n,function(e,r){t[r]&&t[r]!==e&&h.push(r)}),h=r.union(h,r.difference(r.keys(n),r.keys(t))),h=r.map(h,function(e){return e.split(s)[1]}),o.trigger("widget:changed",h),a=window.location.href})},getWidgetState:function(e){return t.bbq.getState(this.getWidgetKey(e))},changeWidgetState:function(e){var s=this,i={};r.each(e,function(e,t){i[s.getWidgetKey(t)]=e}),t.bbq.pushState(i)}});return i});
(function(wndw){var jadify=function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{}){var interp,currentPage=forumThreads.get("current_page"),maxPages=forumThreads.get("max_pages");if(forumThreads.get("total_threads")>0){if(buf.push('<div class="course-forum-threads-listing"><table class="table"><caption style="min-height:42px;">'),threads.length>0&&showSortControls&&buf.push('<ul class="course-forum-threads-sort nav nav-pills pull-right"><li data-sort-name="topquestions"><a href="javascript:void(0)">Top threads</a></li><li data-sort-name="lastupdated"><a href="javascript:void(0)">Last updated</a></li><li data-sort-name="firstposted"><a href="javascript:void(0)">Last created</a></li></ul>'),forumThreads.get("tag_name")?buf.push("<h4>Threads tagged with: "+escape(null==(interp=forumThreads.get("tag_name"))?"":interp)+"</h4>"):"subscribed"==forumThreads.get("sort")?buf.push("<h4>Your Subscribed Threads</h4>"):(buf.push("<h4>All Threads"),currentPage>1&&buf.push("<small> (Page\n"+escape(null==(interp=currentPage)?"":interp)+"\nof\n"+escape(null==(interp=maxPages)?"":interp)+"\n)</small>"),buf.push("</h4>")),showNewThread&&(buf.push("<a"),buf.push(attrs({href:newThreadLink,"class":"btn btn-small course-forum-threads-new-button"},{href:!0})),buf.push(">Start New Thread</a>")),buf.push('</caption><thead class="hidden"><tr><th> <h5 class="hidden">Thread title and author</h5></th><th><h5 class="hidden">Thread Status</h5></th><th><h5 class="hidden">Number of points</h5></th><th><h5 class="hidden">Number of posts</h5></th><th><h5 class="hidden">Number of views</h5></th></tr></thead><tbody>'),threads.each(function(e,t){var s=1==e.get("is_spam")&&user.canModerateForum()?"course-forum-threads-listing-spam":"";buf.push("<tr"),buf.push(attrs({style:showMore&&t>=maxDisplayed?"display:none;":"","class":"course-forum-threads-listing-row "+s},{"class":!0,style:!0})),buf.push("><td>");var a=e.get("_viewer_read")?"":"course-forum-threads-listing-unread";buf.push("<div"),buf.push(attrs({style:"font-size:16px;","class":a},{style:!0,"class":!0})),buf.push(">"),1==e.get("approved")&&buf.push('<span title="Approved by staff" class="icon-thumbs-up"></span><span class="hidden">Approved</span>&nbsp;'),1==e.get("unresolved")&&buf.push('<span title="Unresolved" class="icon-question-sign"></span><span class="hidden">Unresolved</span>&nbsp;'),1==e.get("stickied")&&buf.push('<span title="Pinned by staff" class="icon-pushpin"></span><span class="hidden">Pinned</span>&nbsp;'),buf.push("<a"),buf.push(attrs({href:e.get("_link")},{href:!0})),buf.push("> <span>"+escape(null==(interp=e.get("title"))?"":interp)+"</span>"),e.get("_viewer_read")||buf.push('<span class="hidden"> (Un-read)</span>'),buf.push('</a></div><div style="opacity:.8">'),1==e.get("instructor_replied")&&buf.push('<span class="course-forum-profile-badge">Staff Replied</span><span> &middot; </span>'),buf.push("<span>Started by ");var n=e.get("_starter");-1==n.id?buf.push("<span>Anonymous</span>"):(buf.push("<a"),buf.push(attrs({href:n._user_profile_link},{href:!0})),buf.push(">"),n._user_profile?(n._user_profile.photo_24&&(buf.push("<img"),buf.push(attrs({src:n._user_profile.photo_24},{src:!0})),buf.push("/>")),buf.push(""+escape(null==(interp=n._user_profile.display_name)?"":interp)+" ")):buf.push(""+escape(null==(interp=n.full_name)?"":interp)+" "),buf.push("</a>")),-1!=n.id&&n.forum_title&&"Student"!=n.forum_title&&buf.push('<span class="course-forum-profile-badge">'+escape(null==(interp=n.forum_title)?"":interp)+"</span>"),buf.push("</span><span> &middot; </span><span>Last post by ");var n=e.get("_last_poster");-1==n.id?buf.push("<span>Anonymous</span>"):(buf.push("<a"),buf.push(attrs({href:n._user_profile_link},{href:!0})),buf.push(">"),n._user_profile?(n._user_profile.photo_24&&(buf.push("<img"),buf.push(attrs({src:n._user_profile.photo_24},{src:!0})),buf.push("/>")),buf.push(""+escape(null==(interp=n._user_profile.display_name)?"":interp)+" ")):buf.push(""+escape(null==(interp=n.full_name)?"":interp)+" "),buf.push("</a>")),-1!=n.id&&n.forum_title&&"Student"!=n.forum_title&&buf.push('<span class="course-forum-profile-badge">'+escape(null==(interp=n.forum_title)?"":interp)+"</span>"),buf.push("</span> (<time"),buf.push(attrs({datetime:e.get("last_updated_time")},{datetime:!0})),buf.push('></time>)</div><div></div></td><td class="course-forum-thread-triage-status">'),e.get("_triage_status")&&(e.get("_triage_status").status_resolved?buf.push("Issue Resolved"):buf.push(""+escape(null==(interp=e.get("_triage_status").status_label)?"":interp)+"<br/>("+escape(null==(interp=e.get("_triage_status").priority_label)?"":interp)+")")),buf.push("</td><td"),buf.push(attrs({"class":"course-forum-stat "+(e.get("votes")>0?"course-forum-stat-important":"")},{"class":!0})),buf.push("><span>"+escape(null==(interp=e.get("votes"))?"":interp)+"</span><br/> "+escape(null==(interp=1==e.get("votes")?"point":"points")?"":interp)+"</td><td"),buf.push(attrs({"class":"course-forum-stat "+(e.get("num_posts")>0?"course-forum-stat-important":"")},{"class":!0})),buf.push("><span>"+escape(null==(interp=e.get("num_posts"))?"":interp)+"</span><br/> "+escape(null==(interp=1==e.get("num_posts")?"post":"posts")?"":interp)+'</td><td class="course-forum-stat"><span>'+escape(null==(interp=e.get("num_views"))?"":interp)+"</span><br/> "+escape(null==(interp=1==e.get("num_views")?"view":"views")?"":interp)+"</td></tr>")}),buf.push("</tbody></table>"),showMore&&buf.push('<a class="course-forum-thread-showmore btn">Show More <span class="icon-double-angle-down"></span></a>'),maxPages>1){buf.push("<div"),buf.push(attrs({style:showMore?"display:none;":"","class":"pagination course-forum-thread-paginator"},{style:!0})),buf.push("><ul>"),currentPage>1&&(buf.push('<li class="prev"><a'),buf.push(attrs({href:"javascript:void(0);","data-page-num":currentPage-1},{href:!0,"data-page-num":!0})),buf.push(">&larr; Previous</a></li>"));for(var displayedDots=!1,i=1;currentPage>i;i++)i>2&&currentPage-2>i?displayedDots||(displayedDots=!0,buf.push('<li><a href="javascript:void(0);">...</a></li>')):(buf.push("<li><a"),buf.push(attrs({href:"javascript:void(0);","data-page-num":i},{href:!0,"data-page-num":!0})),buf.push(">"+escape(null==(interp=i)?"":interp)+"</a></li>"));buf.push('<li class="active"><a href="javascript:void(0);">'+escape(null==(interp=currentPage)?"":interp)+"</a></li>");for(var displayedDots=!1,i=currentPage+1;maxPages>=i;i++)i>currentPage+2&&maxPages-1>i?displayedDots||(displayedDots=!0,buf.push('<li><a href="javascript:void(0);">...</a></li>')):(buf.push("<li><a"),buf.push(attrs({href:"javascript:void(0);","data-page-num":i},{href:!0,"data-page-num":!0})),buf.push(">"+escape(null==(interp=i)?"":interp)+"</a></li>"));maxPages>currentPage&&(buf.push('<li class="prev"><a'),buf.push(attrs({href:"javascript:void(0);","data-page-num":currentPage+1},{href:!0,"data-page-num":!0})),buf.push(">&rarr; Next</a></li>")),buf.push("</ul></div>")}buf.push("</div>")}else 0==forumThreads.get("total_threads")?showEmptyMessage&&(forumThreads.get("tag_name")&&buf.push("<h4>Threads tagged with: "+escape(null==(interp=forumThreads.get("tag_name"))?"":interp)+"</h4>"),showNewThread?(buf.push("<p>There's nothing here yet, you can be the first!</p><a"),buf.push(attrs({href:newThreadLink,"class":"btn course-forum-threads-new-button"},{href:!0})),buf.push(">Start New Thread</a><br/><br/>")):buf.push("<p>There's nothing here yet. Sorry! â¹</p>")):buf.push("<p>Loading...</p>")}return buf.join("")}};"function"==typeof define&&define.amd?define('pages/forum/views/ForumThreadsView.html',["js/lib/jade"],function(e){return jadify(e)}):wndw.jade.templates["pages.forum.views.ForumThreadsView"]=jadify(wndw.jade.helpers)})(window);
define('pages/forum/views/ForumThreadsView',["backbone","jquery","underscore","js/lib/util","js/lib/jquery.bbq","pages/forum/app","pages/forum/views/WidgetView","pages/forum/views/ForumThreadsView.html"],function(e,t,s,r,a,i,o,n){var h=o.extend({events:{"click .course-forum-thread-paginator":"onPageClick","click .course-forum-thread-showmore":"onShowMoreClick","click .course-forum-threads-sort li a":"onSortClick"},initialize:function(){var e=this;this.forum=this.model,this.forumThreads=this.options.threads,this.showNewThread=s.isUndefined(this.options.showNewThread)?!1:this.options.showNewThread,this.showSortControls=s.isUndefined(this.options.showSortControls)?!0:this.options.showSortControls,this.maxDisplayed=s.isUndefined(this.options.maxDisplayed)?this.forumThreads.get("page_size"):this.options.maxDisplayed,this.showEmptyMessage=s.isUndefined(this.options.showEmptyMessage)?!0:this.options.showEmptyMessage,this.mode=this.options.mode||"widget",this.getWidgetState("sort")&&this.forumThreads.set("sort",this.getWidgetState("sort"),{silent:!0}),this.forum.bind("change",this.onForumChange,this),this.forumThreads.bind("change",this.onThreadsChange,this);var t=this.getWidgetState("page_num")||1;this.forumThreads.loadPage(t),e.addWidgetStateListener(),e.bind("widget:changed",function(t){s.contains(t,"sort")&&e.changeSort(e.getWidgetState("sort")),s.contains(t,"page_num")&&e.changePage(e.getWidgetState("page_num"))})},onForumChange:function(){this.forum.changedAttributes()&&this.forum.changedAttributes()._marked_as_read&&(this.forumThreads.get("threads").each(function(e){e.set("_viewer_read",!0,{silent:!0})}),this.render()),this.forum.changedAttributes()&&this.forum.changedAttributes()._new_thread_link&&this.render()},onThreadsChange:function(){this.render()},render:function(){function e(e){e.parent("ul").remove(".course-forum-threads-sort-selected-marker"),e.parent("ul").find("li").removeClass("active"),e.addClass("active"),e.append(t("<span>").addClass("course-forum-threads-sort-selected-marker").append("(selected)"))}var a=this,o=1==this.forumThreads.get("current_page")&&this.forumThreads.get("page_size")>this.maxDisplayed&&this.forumThreads.get("threads").size()>this.maxDisplayed,h=this.showNewThread;this.forum.get("_new_thread_link")?(h=this.showNewThread&&-1!=this.forum.get("parent_id")&&(this.forum.get("can_post")||i.user.canModerateForum()),this.newThreadLink=this.forum.get("_new_thread_link"),this.forumThreads.get("tag_name")&&(this.newThreadLink=r.changeUrlParam(this.newThreadLink,"tag_name",this.forumThreads.get("tag_name")))):h=!1,this.$el.html(n({_:s,user:i.user,forum:this.forum,forumThreads:this.forumThreads,threads:this.forumThreads.get("threads"),newThreadLink:this.newThreadLink,showNewThread:h,showSortControls:this.showSortControls,showMore:o,maxDisplayed:this.maxDisplayed,showEmptyMessage:this.showEmptyMessage})),this.$el.find("time").each(function(){r.prettifyTime(t(this))});var d=null,u=a.$(".course-forum-threads-sort li");return u.each(function(t,s){var r=a.$(s);r.attr("data-sort-name")===a.forumThreads.get("sort")&&(e(r),d=r)}),this},onShowMoreClick:function(){this.$(".course-forum-thread-paginator").show(),this.$(".course-forum-threads-listing-row").show(),this.$(".course-forum-thread-showmore").hide()},onPageClick:function(e){this.changeWidgetState({page_num:t(e.target).attr("data-page-num")})},onSortClick:function(e){this.changeWidgetState({page_num:1,sort:t(e.target).parent().attr("data-sort-name")})},changePage:function(e){var s=this;s.forumThreads.loadPage(e).done(function(){t("html,body").scrollTop(s.$el.position().top)})},changeSort:function(e){this.forumThreads.set("sort",e),this.forumThreads.loadPage(1)}});return h});
define('pages/forum/views/ForumView',["backbone","jquery","underscore","js/lib/util","js/lib/popups","pages/forum/app","pages/forum/views/ForumView.html","pages/forum/views/ForumCrumbsView.html","pages/forum/views/ForumHeaderView","pages/forum/views/ForumListView","pages/forum/views/ForumThreadsView","pages/forum/models/ForumThreadsModel","js/lib/badgeville"],function(e,t,r,s,o,i,a,h,n,u,d,m,f){var c=e.View.extend({events:{},initialize:function(){this.forum=this.model,this.forum.bind("change",this.render,this),this.forum.read(),this.mode=this.options.mode||"widget"},render:function(){var e=this;e.$(".course-forum-header").length||(e.$el.html(a({config:i.config,forum:e.forum})),f.isEnabled()&&e.$(".course-forum-reputations-link").hide(),e.$(".course-forum-crumbs").html(h({_:r,crumbs:r.initial(e.forum.get("crumbs")||[])})),e.$(".course-forum-header-wrapper").html(new n({model:this.forum}).render().el),e.$(".course-forum-subforums-listing-wrapper").html(new u({model:this.forum}).render().el),("1"==this.forum.get("show_threads")||-1==this.forum.get("parent_id"))&&(e.$(".course-forum-your-threads-listing-wrapper").append(new d({model:this.forum,threads:new m({id:this.forum.get("id"),course_id:this.forum.get("course_id"),sort:"subscribed"}),showNewThread:!1,mode:this.mode,showSortControls:!1,maxDisplayed:3,showEmptyMessage:!1,widgetId:"forum-threads-subscribed-"+this.forum.get("id")}).render().el),e.$(".course-forum-threads-listing-wrapper").append(new d({model:this.forum,threads:new m({id:this.forum.get("id"),course_id:this.forum.get("course_id")}),showNewThread:!0,mode:this.mode,showSortControls:!0,widgetId:"forum-threads-all-"+this.forum.get("id")}).render().el)))}});return c});
(function(wndw){var jadify=function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{}){var interp;buf.push('<div class="course-forum-threads-listing"><table><caption><h4 style="text-align: left;" class="hidden">Threads</h4></caption><thead class="hidden"><tr><th> <h5>Thread title</h5></th></tr></thead><tbody>'),threads.each(function(e){var t=1==e.get("is_spam")&&user.canModerateForum()?"course-forum-threads-listing-spam":"";buf.push("<tr"),buf.push(attrs({"class":t},{"class":!0})),buf.push("><td>");var r=e.get("_viewer_read")?"":"course-forum-threads-listing-unread";buf.push("<div"),buf.push(attrs({style:"font-size: 14px; line-height: 16px; margin-bottom: 3px;","class":r},{"class":!0,style:!0})),buf.push("><a"),buf.push(attrs({href:e.get("_link")},{href:!0})),buf.push("> <span>"+escape(null==(interp=e.get("title"))?"":interp)+"</span>"),e.get("_viewer_read")||buf.push('<span class="hidden"> (Un-read)</span>'),buf.push('</a></div><div style="opacity:.8; opacity: .8; font-size: 11px; margin-bottom: 6px; line-height: 13px;"><span>Last post by ');var s=e.get("_last_poster");-1==s.id?buf.push("<span>Anonymous</span>"):(buf.push("<a"),buf.push(attrs({href:s._user_profile_link},{href:!0})),buf.push(">"),s._user_profile?(s._user_profile.photo_24&&(buf.push("<img"),buf.push(attrs({src:s._user_profile.photo_24},{src:!0})),buf.push("/>")),buf.push(""+escape(null==(interp=s._user_profile.display_name)?"":interp)+" ")):buf.push(""+escape(null==(interp=s.full_name)?"":interp)+" "),buf.push("</a>")),-1!=s.id&&s.forum_title&&"Student"!=s.forum_title&&buf.push('<span class="course-forum-profile-badge">'+escape(null==(interp=s.forum_title)?"":interp)+"</span>"),buf.push("</span> (<time"),buf.push(attrs({datetime:e.get("last_updated_time")},{datetime:!0})),buf.push("></time>)</div></td></tr>")}),buf.push("</tbody></table></div>")}return buf.join("")}};"function"==typeof define&&define.amd?define('pages/forum/views/ForumThreadsMiniView.html',["js/lib/jade"],function(e){return jadify(e)}):wndw.jade.templates.ForumThreadsMiniView=jadify(wndw.jade.helpers)})(window);
define('pages/forum/views/ForumThreadsMiniView',["backbone","jquery","underscore","js/lib/util","pages/forum/app","pages/forum/views/ForumThreadsMiniView.html"],function(e,t,r,s,a,i){var o=e.View.extend({events:{},initialize:function(){this.forumThreads=this.model,this.forumThreads.bind("change",this.render,this),this.forumThreads.loadPage(1)},render:function(){return this.$el.html(i({user:a.user,threads:this.forumThreads.get("threads")})),this.$el.find("time").each(function(){s.prettifyTime(t(this))}),this}});return o});
(function(wndw){var jadify=function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{}){var interp;buf.push('<h2 class="course-page-header">Forum Reputations</h2><br/><table class="table table-bordered table-striped"><thead><tr><th style="width:60%">Name</th><th style="width:10%">Threads</th><th style="width:10%">Posts/Comments</th><th style="width:10%" colspan="2">Upvoted/Downvoted</th><th style="width:10%">Points</th></tr></thead><tbody>'),reputations.each(function(e){buf.push("<tr><td> ");var t=e.toJSON();-1==t.id?buf.push("<span>Anonymous</span>"):(buf.push("<a"),buf.push(attrs({href:t._user_profile_link},{href:!0})),buf.push(">"),t._user_profile?(t._user_profile.photo_24&&(buf.push("<img"),buf.push(attrs({src:t._user_profile.photo_24},{src:!0})),buf.push("/>")),buf.push(""+escape(null==(interp=t._user_profile.display_name)?"":interp)+" ")):buf.push(""+escape(null==(interp=t.full_name)?"":interp)+" "),buf.push("</a>")),-1!=t.id&&t.forum_title&&"Student"!=t.forum_title&&buf.push('<span class="course-forum-profile-badge">'+escape(null==(interp=t.forum_title)?"":interp)+"</span>"),user.canAccessAdmin()&&(buf.push(" (<a"),buf.push(attrs({target:"_blank",href:e.get("_user_details_link")},{target:!0,href:!0})),buf.push(">View Grades</a>)")),buf.push("</td><td>"+escape(null==(interp=e.get("thread_count"))?"":interp)+"</td><td>"+escape(null==(interp=e.get("entry_count"))?"":interp)+'</td><td style="color:green;font-weight:bold;text-align:right;"><span>'+escape(null==(interp=e.get("upvote_count"))?"":interp)+'</span></td><td style="text-align:left;color:#DB7676;"><span>'+escape(null==(interp=Math.abs(e.get("downvote_count")))?"":interp)+"</span></td><td>"+escape(null==(interp=e.get("points"))?"":interp)+"</td></tr>")}),buf.push("</tbody></table><br/><p>*Forum points are awarded based on the sum of the square root of all the votes received for each post.</p>")}return buf.join("")}};"function"==typeof define&&define.amd?define('pages/forum/views/ForumReputationsView.html',["js/lib/jade"],function(e){return jadify(e)}):wndw.jade.templates.ForumReputationsView=jadify(wndw.jade.helpers)})(window);
define('pages/forum/views/ForumReputationsView',["backbone","jquery","underscore","js/lib/util","pages/forum/app","pages/forum/views/ForumReputationsView.html"],function(e,r,t,a,i,o){var s=e.View.extend({events:{},initialize:function(){this.reputations=this.collection,this.reputations.bind("reset",this.render,this),this.reputations.read()},render:function(){return this.$el.html(o({user:i.user,reputations:this.reputations,_:t})),this}});return s});
define('pages/forum/widgets',["jquery","underscore","backbone","js/lib/util","pages/forum/app","pages/forum/models/UserModel","pages/forum/models/ThreadModel","pages/forum/models/ForumModel","pages/forum/models/ForumThreadsModel","pages/forum/models/ReputationsCollection","pages/forum/views/ThreadView","pages/forum/views/ThreadNewView","pages/forum/views/UserProfileView","pages/forum/views/ForumView","pages/forum/views/ForumThreadsView","pages/forum/views/ForumThreadsMiniView","pages/forum/views/ForumReputationsView"],function(u,e,t,r,a,s,n,i,o,E,l,d,c,g,f,h,F){u(document).ready(function(){var t=new s({id:"current"});t.read().done(function(){a.user=t,u("[data-coursera-forum-thread-widget]").each(function(){var t=u(this).is("[data-triage-enabled]"),a=u(this).is("[data-hangouts-enabled]"),s=Number(u(this).attr("data-course-id")),i=Number(u(this).attr("data-thread-id")),o=u(this).attr("data-thread-mode"),E=window.location.hash.replace("#","").split("-"),d={};d[E[0]]=E[1];var c=r.getUrlParam(window.location.href,"sort"),g=new n({courseId:s,triageEnabled:t,id:i,_sort_order:c});new l(e.extend(d,{el:u(this)[0],model:g,mode:o,hangoutsEnabled:a}))}),u("[data-coursera-forum-thread-new-widget]").each(function(){var e=new n({forum_id:u(this).attr("data-forum-id")});new d({el:u(this)[0],model:e,tagName:u(this).attr("data-tag-name")})}),u("[data-coursera-forum-widget]").each(function(){var e=u(this).attr("data-forum-id"),t=u(this).attr("data-embed-mode"),r=new i({id:e,course_id:Number(u(this).attr("data-course-id"))});new g({el:u(this)[0],mode:t,model:r})}),u("[data-coursera-forum-threads-widget]").each(function(){var e=new i({id:u(this).attr("data-forum-id")||"0",course_id:Number(u(this).attr("data-course-id"))}),t=new o({id:e.get("id"),tag_id:u(this).attr("data-tag-id"),tag_name:u(this).attr("data-tag-name"),course_id:Number(u(this).attr("data-course-id")),sort:r.getUrlParam(window.location.href,"sort")});new f({el:u(this)[0],mode:u(this).attr("data-embed-mode"),model:e,threads:t,showNewThread:!0}),e.read()}),u("[data-coursera-forum-mini-threads-widget]").each(function(){var e=new o({id:u(this).attr("data-forum-id")||"0",page_size:5});new h({el:u(this)[0],model:e})}),u("[data-coursera-forum-user-profile-widget]").each(function(){new c({el:u(this)[0],mode:u(this).attr("data-embed-mode"),model:new s({id:u(this).attr("data-user-id")})})}),u("[data-coursera-forum-reputations-widget]").each(function(){new F({el:u(this)[0],mode:u(this).attr("data-embed-mode"),collection:new E})}),r.setupPromos()})})});