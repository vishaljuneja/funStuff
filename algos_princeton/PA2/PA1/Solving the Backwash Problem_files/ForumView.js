define(["backbone","jquery","underscore","js/lib/util","js/lib/popups","pages/forum/app","pages/forum/views/ForumView.html","pages/forum/views/ForumCrumbsView.html","pages/forum/views/ForumHeaderView","pages/forum/views/ForumListView","pages/forum/views/ForumThreadsView","pages/forum/models/ForumThreadsModel","js/lib/badgeville"],function(e,t,r,s,o,i,a,h,n,u,d,m,f){var c=e.View.extend({events:{},initialize:function(){this.forum=this.model,this.forum.bind("change",this.render,this),this.forum.read(),this.mode=this.options.mode||"widget"},render:function(){var e=this;e.$(".course-forum-header").length||(e.$el.html(a({config:i.config,forum:e.forum})),f.isEnabled()&&e.$(".course-forum-reputations-link").hide(),e.$(".course-forum-crumbs").html(h({_:r,crumbs:r.initial(e.forum.get("crumbs")||[])})),e.$(".course-forum-header-wrapper").html(new n({model:this.forum}).render().el),e.$(".course-forum-subforums-listing-wrapper").html(new u({model:this.forum}).render().el),("1"==this.forum.get("show_threads")||-1==this.forum.get("parent_id"))&&(e.$(".course-forum-your-threads-listing-wrapper").append(new d({model:this.forum,threads:new m({id:this.forum.get("id"),course_id:this.forum.get("course_id"),sort:"subscribed"}),showNewThread:!1,mode:this.mode,showSortControls:!1,maxDisplayed:3,showEmptyMessage:!1,widgetId:"forum-threads-subscribed-"+this.forum.get("id")}).render().el),e.$(".course-forum-threads-listing-wrapper").append(new d({model:this.forum,threads:new m({id:this.forum.get("id"),course_id:this.forum.get("course_id")}),showNewThread:!0,mode:this.mode,showSortControls:!0,widgetId:"forum-threads-all-"+this.forum.get("id")}).render().el)))}});return c});