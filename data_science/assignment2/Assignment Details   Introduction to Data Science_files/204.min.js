(function(wndw){var src=/.*\/204\.(min\.)?js(\?.*)?$/;var _204v="0.02";var cookie=function(key,value,options){if(arguments.length>1&&(typeof value!=="object"||value===null||value===undefined)){options=options||{};if(value===null||value===undefined){options.expires=-1}if(!options.path){options.path="/"}if(typeof options.expires==="number"){var days=options.expires,t=options.expires=new Date;t.setDate(t.getDate()+days)}value=String(value);return document.cookie=[encodeURIComponent(key),"=",options.raw?value:encodeURIComponent(value),options.expires?"; expires="+options.expires.toUTCString():"",options.path?"; path="+options.path:"",options.domain?"; domain="+options.domain:"",options.secure?"; secure":""].join("")}options=value||{};var decode=options.raw?function(s){return s}:decodeURIComponent;var pairs=document.cookie.split("; ");for(var i=0,pair;pairs[i];i++){pair=pairs[i].split("=");if(decode(pair[0])===key)return decode(pair[1]||"")}return null};var parse=function(data){var qs=[];for(var key in data){if(typeof data[key]!="string"&&wndw.JSON)qs.push(key+"="+encodeURIComponent(wndw.JSON.stringify(data[key])));else qs.push(key+"="+encodeURIComponent(data[key].toString()))}if(!wndw.JSON)qs.push("_noJSON_=true");return qs.join("&")};var post=function(beacon,data,callback){var iframe=document.createElement("iframe");var uniqueString=(new Date).getTime().toString();document.body.appendChild(iframe);iframe.style.display="none";iframe.name=uniqueString;iframe.contentWindow.name=uniqueString;var div=document.createElement("div");div.style.display="none";var form=document.createElement("form");form.target=uniqueString;form.action=beacon;form.method="POST";div.appendChild(form);var input;for(var key in data){input=document.createElement("input");input.type="hidden";input.name=key;if(typeof data[key]!="string"&&wndw.JSON)input.value=wndw.JSON.stringify(data[key]);else input.value=data[key].toString();form.appendChild(input)}document.body.appendChild(div);iframe.onload=iframe.onreadystatechange=function(){if(!this.readyState||this.readyState=="complete"){iframe.onreadystatechange=iframe.onload=null;iframe.parentNode.removeChild(iframe);form.parentNode.removeChild(form);if(callback&&typeof callback=="function"){callback()}}};form.submit()};var ping=function(beacon,data,callback){var script=document.createElement("script");script.type="text/javascript";script.async=true;script.src=beacon+"?"+parse(data);script.onload=script.onreadystatechange=function(){if(!this.readyState||this.readyState=="complete"){script.onreadystatechange=script.onload=null;script.parentNode.removeChild(script);if(callback&&typeof callback=="function"){callback()}}};script.onerror=function(){post(beacon,data,callback)};document.getElementsByTagName("head")[0].appendChild(script)};var TwoOhFour=function(){var scripts=document.scripts||document.getElementsByTagName("script");var count=scripts.length;this.options={user:null,version:null,session:null,client:"204",from:wndw.document.referrer,tracker:"__204u",beacon:"https://eventing.coursera.org/info"};for(var i=0;i<count;i++){if(src.test(scripts[i].src)){var match=/^.+\?(.*)$/.exec(scripts[i].src);if(match){var params=match[1].split("&");for(var j=0;j<params.length;j++){var param=params[j].split("=");if(/client|user|version|tracker|beacon/.test(param[0]))this.options[param[0]]=decodeURIComponent(param[1])}}break}}this.options.session=this.session()};TwoOhFour.prototype.session=function(id){var session=cookie(this.options.tracker,{domain:this.options.domain,expires:356});if(!session||id){session=id?id:(Math.random()*1e10).toFixed()+"-"+(new Date).getTime();cookie(this.options.tracker,session,{domain:this.options.domain,expires:356})}return session};TwoOhFour.prototype.push=function(command){if(typeof command=="object"){if(Array.isArray&&Array.isArray(command)||command.constructor==Array){switch(command[0]){case"send":this.send(command[1],command[2]);break;case"tracker":this.options.tracker=command[1];this.options.session=this.session();break;case"session":this.session=this.session(command[1]);break;case"post":this.send(command[1],command[2],true);break;default:this.options[command[0]]=command[1];break}}else{this.send(command)}}return this};TwoOhFour.prototype.send=function(data,callback,isPost){if(typeof data=="string"){data={key:data}}else{data=data||{}}if(this.options.user)data.user=this.options.user;if(this.options.version)data.version=this.options.version;if(this.options.from)data.from=this.options.from;data.session=this.options.session;data.client=this.options.client;data.url=wndw.location.href;data.time=(new Date).getTime();if(wndw.screen){data.screen={height:wndw.screen.height,width:wndw.screen.width}}if(isPost)post(this.options.beacon,data,callback);else ping(this.options.beacon,data,callback);this.options.from=wndw.location.href;return this};TwoOhFour.prototype.batch=function(batch){while(batch.length){this.push(batch.shift())}return this};var twoohfour=new TwoOhFour;if(wndw._204){if(typeof wndw._204=="object"&&wndw._204.constructor==Array){twoohfour.batch(wndw._204)}}wndw._204=twoohfour;if(typeof define==="function"&&define.amd){define("_204",[],function(){return twoohfour})}})(window);